import*as sw from"node:fs";import{existsSync as U_}from"node:fs";import pi,{resolve as W_,basename as H_}from"node:path";import{fileURLToPath as K_,pathToFileURL as V_}from"node:url";import{isatty as X_}from"tty";import Y_,{stripVTControlCharacters as J_}from"node:util";import Q_ from"util";import mi from"path";import Z_ from"os";import eC from"crypto";import tC from"net";import nC from"url";import ro from"fs";import rC from"child_process";import{invariant as Ie,defaultTheme as qt,DefaultRelationshipColor as io,
nonexhaustive as Me,hierarchyDistance as iC,DefaultThemeColor as Zs,nameFromFqn as Ap,nonNullable as Zt,isThemeColor as aw,compareFqnHierarchically as sC,DefaultArrowType as Yi,ComputedNode as ad,extractStep as aC,ComputedView as so,delay as oC,DefaultLineStyle as cC,ThemeColors as uC,stringHash as lC,AsFqn as dC,ancestorsFqn as fC,compareNatural as ow,DeploymentElement as cw,computeColorValues as hC,sortByFqnHierarchically as uw,parentFqn as lw,LikeC4Model as ao,isScopedElementView as pC,FqnRef as oo,
isSameHierarchy as dw,isAncestor as _p,FqnExpr as co,isNonEmptyArray as Dn,LinkedList as fw,isAutoLayoutDirection as mC,isOrOperator as hw,isAndOperator as pw,hasAtLeast as gC}from"@likec4/core";import{ComputedNode as mw,DefaultShapeSize as yC,DefaultTextSize as vC,DefaultPaddingSize as wC,AsFqn as bC}from"@likec4/core/types";import{EventEmitter as $C}from"events";import{Buffer as Cp}from"buffer";import{Graphviz as Pp}from"@hpcc-js/wasm-graphviz";import{resolveRulesExtendedViews as RC}from"@likec4/core/compute-view";
import{DefaultWeakMap as kC,compareNatural as gw,sortNaturalByFqn as TC,ancestorsFqn as EC}from"@likec4/core/utils";import gi,{hrtime as yw}from"node:process";import SC from"boxen";import{spawn as AC}from"node:child_process";import{once as vw,on as _C}from"node:events";import{stat as CC}from"node:fs/promises";import{pipeline as PC}from"node:stream/promises";import xC from"node:os";import ww from"fs/promises";import{LikeC4Model as DC}from"@likec4/core/model";const NC={},ea=IC(globalThis,NC);function IC(t,e){
return new Proxy(t,{get(n,r,i){return r in e?e[r]:t[r]},set(n,r,i){return r in e&&delete e[r],t[r]=i,!0},deleteProperty(n,r){let i=!1;return r in e&&(delete e[r],i=!0),r in t&&(delete t[r],i=!0),i},ownKeys(n){const r=Reflect.ownKeys(t),i=Reflect.ownKeys(e),s=new Set(i);return[...r.filter(a=>!s.has(a)),...i]},defineProperty(n,r,i){return r in e&&delete e[r],Reflect.defineProperty(t,r,i),!0},getOwnPropertyDescriptor(n,r){return r in e?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(
t,r)},has(n,r){return r in e||r in t}})}function bw(t){return typeof t=="function"?t:OC(t)}function OC(t){if(t==null)return()=>!1;if(t==="fatal")return e=>e.level==="fatal";if(t==="error")return e=>e.level==="fatal"||e.level==="error";if(t==="warning")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning";if(t==="info")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning"||e.level==="info";if(t==="debug")return()=>!0;throw new TypeError(`Invalid log level: ${t}.`)}const $w=[
"debug","info","warning","error","fatal"];function Rw(t,e){const n=$w.indexOf(t);if(n<0)throw new TypeError(`Invalid log level: ${JSON.stringify(t)}.`);const r=$w.indexOf(e);if(r<0)throw new TypeError(`Invalid log level: ${JSON.stringify(e)}.`);return n-r}function LC(t=[]){return xn.getLogger(t)}const xp=Symbol.for("logtape.rootLogger");class xn{static getLogger(e=[]){let n=xp in ea?ea[xp]??null:null;return n==null&&(n=new xn(null,[]),ea[xp]=n),typeof e=="string"?n.getChild(e):e.length===0?n:n.getChild(
e)}constructor(e,n){Object.defineProperty(this,"parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"category",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sinks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parentSinks",{enumerable:!0,configurable:!0,writable:!0,value:"inherit"}),
Object.defineProperty(this,"filters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowestLevel",{enumerable:!0,configurable:!0,writable:!0,value:"debug"}),Object.defineProperty(this,"contextLocalStorage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.parent=e,this.children={},this.category=n,this.sinks=[],this.filters=[]}getChild(e){const n=typeof e=="string"?e:e[0],r=this.children[n];let i=r instanceof xn?r:r?.deref();return i==null&&(i=new xn(
this,[...this.category,n]),this.children[n]="WeakRef"in ea?new WeakRef(i):i),typeof e=="string"||e.length===1?i:i.getChild(e.slice(1))}reset(){for(;this.sinks.length>0;)this.sinks.shift();for(this.parentSinks="inherit";this.filters.length>0;)this.filters.shift();this.lowestLevel="debug"}resetDescendants(){for(const e of Object.values(this.children)){const n=e instanceof xn?e:e.deref();n?.resetDescendants()}this.reset()}with(e){return new Zv(this,{...e})}filter(e){for(const n of this.filters)if(!n(
e))return!1;return this.filters.length<1?this.parent?.filter(e)??!0:!0}*getSinks(e){if(!(this.lowestLevel===null||Rw(e,this.lowestLevel)<0)){if(this.parent!=null&&this.parentSinks==="inherit")for(const n of this.parent.getSinks(e))yield n;for(const n of this.sinks)yield n}}emit(e,n){if(!(this.lowestLevel===null||Rw(e.level,this.lowestLevel)<0||!this.filter(e))){for(const r of this.getSinks(e.level))if(!n?.has(r))try{r(e)}catch(i){const s=new Set(n);s.add(r),MC.log("fatal","Failed to emit a log r\
ecord to sink {sink}: {error}",{sink:r,error:i,record:e},s)}}}log(e,n,r,i){const s=xn.getLogger().contextLocalStorage?.getStore()??{};let a;const o=typeof r=="function"?{category:this.category,level:e,timestamp:Date.now(),get message(){return kw(n,this.properties)},rawMessage:n,get properties(){return a==null&&(a={...s,...r()}),a}}:{category:this.category,level:e,timestamp:Date.now(),message:kw(n,{...s,...r}),rawMessage:n,properties:{...s,...r}};this.emit(o,i)}logLazily(e,n,r={}){const i=xn.getLogger().
contextLocalStorage?.getStore()??{};let s,a;function o(){if((a==null||s==null)&&(a=n((c,...u)=>(s=c,Tw(c,u))),s==null))throw new TypeError("No log record was made.");return[a,s]}this.emit({category:this.category,level:e,get message(){return o()[0]},get rawMessage(){return o()[1]},timestamp:Date.now(),properties:{...i,...r}})}logTemplate(e,n,r,i={}){const s=xn.getLogger().contextLocalStorage?.getStore()??{};this.emit({category:this.category,level:e,message:Tw(n,r),rawMessage:n,timestamp:Date.now(),
properties:{...s,...i}})}debug(e,...n){typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.logLazily("debug",e):this.logTemplate("debug",e,n)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):this.logTemplate("info",e,n)}warn(e,...n){typeof e=="string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily("warning",e):this.logTemplate("warning",e,n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??
{}):typeof e=="function"?this.logLazily("error",e):this.logTemplate("error",e,n)}fatal(e,...n){typeof e=="string"?this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):this.logTemplate("fatal",e,n)}}class Zv{constructor(e,n){Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"properties",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.logger=e,this.properties=n}get category(){return this.logger.
category}get parent(){return this.logger.parent}getChild(e){return this.logger.getChild(e).with(this.properties)}with(e){return new Zv(this.logger,{...this.properties,...e})}log(e,n,r,i){this.logger.log(e,n,typeof r=="function"?()=>({...this.properties,...r()}):{...this.properties,...r},i)}logLazily(e,n){this.logger.logLazily(e,n,this.properties)}logTemplate(e,n,r){this.logger.logTemplate(e,n,r,this.properties)}debug(e,...n){typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.
logLazily("debug",e):this.logTemplate("debug",e,n)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):this.logTemplate("info",e,n)}warn(e,...n){typeof e=="string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily("warning",e):this.logTemplate("warning",e,n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??{}):typeof e=="function"?this.logLazily("error",e):this.logTemplate("error",e,n)}fatal(e,...n){typeof e=="string"?
this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):this.logTemplate("fatal",e,n)}}const MC=xn.getLogger(["logtape","meta"]);function kw(t,e){const n=[];let r="";for(let i=0;i<t.length;i++){const s=t.charAt(i),a=t.charAt(i+1);if(s==="{"&&a==="{")r=r+s,i++;else if(s==="}"&&a==="}")r=r+s,i++;else if(s==="{")n.push(r),r="";else if(s==="}"){let o;r.match(/^\s|\s$/)?o=r in e?e[r]:e[r.trim()]:o=e[r],n.push(o),r=""}else r=r+s}return n.push(r),n}function Tw(t,e){const n=[];for(let r=0;r<
t.length;r++)n.push(t[r]),r<e.length&&n.push(e[r]);return n}function Dr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zC(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(
t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}function Dp(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Np,Ew;function FC(){if(Ew)return Np;Ew=1;let t=null;if(typeof window>"u"&&("process"in globalThis&&"versions"in globalThis.process&&"node"in globalThis.process.versions&&typeof globalThis.
caches>"u"&&typeof globalThis.addEventListener!="function"||"Bun"in globalThis))try{t=[Dp][0](`${["node","util"].join(":")}`)}catch{t=null}return Np=t,Np}var qC=FC();const od=Dr(qC),Ip={debug:"DBG",info:"INF",warning:"WRN",error:"ERR",fatal:"FTL"},Sw="Deno"in globalThis&&"inspect"in globalThis.Deno&&typeof globalThis.Deno.inspect=="function"?(t,e)=>globalThis.Deno.inspect(t,{strAbbreviateSize:1/0,iterableLimit:1/0,...e}):od!=null&&"inspect"in od&&typeof od.inspect=="function"?(t,e)=>od.inspect(t,
{maxArrayLength:1/0,maxStringLength:1/0,...e}):t=>JSON.stringify(t);function Aw(t={}){const e=t.timestamp==null||t.timestamp==="date-time-timezone"?a=>new Date(a).toISOString().replace("T"," ").replace("Z"," +00:00"):t.timestamp==="date-time-tz"?a=>new Date(a).toISOString().replace("T"," ").replace("Z"," +00"):t.timestamp==="date-time"?a=>new Date(a).toISOString().replace("T"," ").replace("Z",""):t.timestamp==="time-timezone"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z"," +00:00"):
t.timestamp==="time-tz"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z"," +00"):t.timestamp==="time"?a=>new Date(a).toISOString().replace(/.*T/,"").replace("Z",""):t.timestamp==="date"?a=>new Date(a).toISOString().replace(/T.*/,""):t.timestamp==="rfc3339"?a=>new Date(a).toISOString():t.timestamp,n=t.category??"\xB7",r=t.value??Sw,i=t.level==null||t.level==="ABBR"?a=>Ip[a]:t.level==="abbr"?a=>Ip[a].toLowerCase():t.level==="FULL"?a=>a.toUpperCase():t.level==="full"?a=>a:t.level==="L"?a=>a.
charAt(0).toUpperCase():t.level==="l"?a=>a.charAt(0):t.level,s=t.format??(({timestamp:a,level:o,category:c,message:u})=>`${a} [${o}] ${c}: ${u}`);return a=>{let o="";for(let d=0;d<a.message.length;d++)d%2===0?o+=a.message[d]:o+=r(a.message[d]);const c=e(a.timestamp),u=i(a.level),l=typeof n=="function"?n(a.category):a.category.join(n);return`${s({timestamp:c,level:u,category:l,message:o,record:a})}
`}}Aw();const Op="\x1B[0m",Lp={black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},Mp={bold:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m",strikethrough:"\x1B[9m"},GC={debug:"blue",info:"green",warning:"yellow",error:"red",fatal:"magenta"};function _w(t={}){const e=t.format,n=typeof t.timestampStyle>"u"?"dim":t.timestampStyle,r=t.timestampColor??null,i=`${n==null?"":Mp[n]}${r==null?"":Lp[r]}`,s=n==null&&
r==null?"":Op,a=typeof t.levelStyle>"u"?"bold":t.levelStyle,o=t.levelColors??GC,c=typeof t.categoryStyle>"u"?"dim":t.categoryStyle,u=t.categoryColor??null,l=`${c==null?"":Mp[c]}${u==null?"":Lp[u]}`,f=c==null&&u==null?"":Op;return Aw({timestamp:"date-time-tz",value(d){return Sw(d,{colors:!0})},...t,format({timestamp:d,level:h,category:m,message:b,record:$}){const w=o[$.level];return d=`${i}${d}${s}`,h=`${a==null?"":Mp[a]}${w==null?"":Lp[w]}${h}${a==null&&w==null?"":Op}`,e==null?`${d} ${h} ${l}${m}\
:${f} ${b}`:e({timestamp:d,level:h,category:`${l}${m}${f}`,message:b,record:$})}})}_w();const jC={debug:"background-color: gray; color: white;",info:"background-color: white; color: black;",warning:"background-color: orange; color: black;",error:"background-color: red; color: white;",fatal:"background-color: maroon; color: white;"};function BC(t){let e="";const n=[];for(let s=0;s<t.message.length;s++)s%2===0?e+=t.message[s]:(e+="%o",n.push(t.message[s]));const r=new Date(t.timestamp);return[`%c${`${r.
getUTCHours().toString().padStart(2,"0")}:${r.getUTCMinutes().toString().padStart(2,"0")}:${r.getUTCSeconds().toString().padStart(2,"0")}.${r.getUTCMilliseconds().toString().padStart(3,"0")}`} %c${Ip[t.level]}%c %c${t.category.join("\xB7")} %c${e}`,"color: gray;",jC[t.level],"background-color: default;","color: gray;","color: default;",...n]}function Cw(t={}){const e=t.formatter??BC,n=t.console??globalThis.console;return r=>{const i=e(r);if(typeof i=="string"){const s=i.replace(/\r?\n$/,"");if(r.
level==="debug")n.debug(s);else if(r.level==="info")n.info(s);else if(r.level==="warning")n.warn(s);else if(r.level==="error"||r.level==="fatal")n.error(s);else throw new TypeError(`Invalid log level: ${r.level}.`)}else if(r.level==="debug")n.debug(...i);else if(r.level==="info")n.info(...i);else if(r.level==="warning")n.warn(...i);else if(r.level==="error"||r.level==="fatal")n.error(...i);else throw new TypeError(`Invalid log level: ${r.level}.`)}}let zp=null;const Pw=new Set,cd=new Set,ud=new Set;
async function UC(t){if(zp!=null&&!t.reset)throw new Gp("Already configured; if you want to reset, turn on the reset flag.");await Fp(),zp=t;let e=!1,n=!1;for(const i of t.loggers){(i.category.length===0||i.category.length===1&&i.category[0]==="logtape"||i.category.length===2&&i.category[0]==="logtape"&&i.category[1]==="meta")&&(e=!0);const s=xn.getLogger(i.category);for(const a of i.sinks??[]){const o=t.sinks[a];if(!o)throw await Fp(),new Gp(`Sink not found: ${a}.`);s.sinks.push(o)}s.parentSinks=
i.parentSinks??"inherit",i.lowestLevel!==void 0&&(s.lowestLevel=i.lowestLevel),i.level!==void 0&&(n=!0,s.filters.push(bw(i.level)));for(const a of i.filters??[]){const o=t.filters?.[a];if(o===void 0)throw await Fp(),new Gp(`Filter not found: ${a}.`);s.filters.push(bw(o))}Pw.add(s)}xn.getLogger().contextLocalStorage=t.contextLocalStorage;for(const i of Object.values(t.sinks))Symbol.asyncDispose in i&&ud.add(i),Symbol.dispose in i&&cd.add(i);for(const i of Object.values(t.filters??{}))i==null||typeof i==
"string"||(Symbol.asyncDispose in i&&ud.add(i),Symbol.dispose in i&&cd.add(i));"process"in ea&&!("Deno"in ea)?process.on("exit",qp):addEventListener("unload",qp);const r=xn.getLogger(["logtape","meta"]);e||r.sinks.push(Cw()),r.info("LogTape loggers are configured.  Note that LogTape itself uses the meta logger, which has category {metaLoggerCategory}.  The meta logger purposes to log internal errors such as sink exceptions.  If you are seeing this message, the meta logger is somehow configured. \
 It's recommended to configure the meta logger with a separate sink so that you can easily notice if logging itself fails or is misconfigured.  To turn off this message, configure the meta logger with higher log levels than {dismissLevel}.  See also <https://logtape.org/manual/categories#meta-logger>.",{metaLoggerCategory:["logtape","meta"],dismissLevel:"info"}),n&&r.warn("The level option is deprecated in favor of lowestLevel option.  Please update your configuration.  See also <https://logtape\
.org/manual/levels#configuring-severity-levels>.")}async function Fp(){await qp();const t=xn.getLogger([]);t.resetDescendants(),delete t.contextLocalStorage,Pw.clear(),zp=null}async function qp(){for(const e of cd)e[Symbol.dispose]();cd.clear();const t=[];for(const e of ud)t.push(e[Symbol.asyncDispose]()),ud.delete(e);await Promise.all(t)}class Gp extends Error{constructor(e){super(e),this.name="ConfigureError"}}var jp,xw;function WC(){if(xw)return jp;xw=1;let t=null;if(typeof window>"u"&&("proc\
ess"in globalThis&&"versions"in globalThis.process&&"node"in globalThis.process.versions&&typeof globalThis.caches>"u"&&typeof globalThis.addEventListener!="function"||"Bun"in globalThis))try{t=[Dp][0](`${["node","fs"].join(":")}`)}catch{t=null}return jp=t,jp}var HC=WC();const KC=Dr(HC),VC={},ta=KC;ta==null||(ta.writeSync,ta.fsyncSync,ta.closeSync,ta.statSync,ta.renameSync);const XC=t=>{Bp.forEach(e=>{YC(t,e)})},Bp=["name","message","stack","cause","errors"],YC=(t,e)=>{const n=Up(t,e);if(n!==void 0){
if(JC(n)){Nr(t,e,t[e]);return}QC(n)&&Dw(t,e,n)}},Up=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?void 0:Up(r,e)},JC=({get:t,set:e})=>t!==void 0&&e===void 0,QC=({enumerable:t,writable:e})=>t||!e,Nr=(t,e,n)=>{Dw(t,e,{value:n})},Dw=(t,e,n)=>{Object.defineProperty(t,e,{...n,..."get"in n||"set"in n?{}:{writable:!0},enumerable:!1,configurable:!0})},ZC=(t,e)=>{if(Array.isArray(t.errors)){const n=t.errors.filter(eP).map(e).filter(
Boolean);Nr(t,"errors",n)}else tP(t)?Nr(t,"errors",[]):t.errors!==void 0&&nP(t)},eP=t=>t!==void 0,tP=t=>"AggregateError"in globalThis&&(t.name==="AggregateError"||t instanceof AggregateError),nP=t=>{delete t.errors,t.errors!==void 0&&Nr(t,"errors",[])},rP=(t,e)=>{if(!("cause"in t))return;const n=t.cause===void 0?t.cause:e(t.cause);n===void 0?delete t.cause:Nr(t,"cause",n)},iP=t=>sP(t)||aP(t),sP=t=>{try{return t instanceof Error}catch{return!1}},aP=t=>{try{return oP.has(Object.prototype.toString.
call(t))}catch{return!1}},oP=new Set(["[object Error]","[object DOMException]","[object DOMError]","[object Exception]"]);function ld(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}const cP=t=>!Object.isExtensible(t)||Bp.some(e=>uP(t,e)||lP(t,e)),uP=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);return n!==void 0&&!n.configurable},lP=(t,e)=>{
try{return t[e],!1}catch{return!0}},Wp=t=>{const e=dP(t.message,t.name);Nr(t,"stack",e)},dP=(t="",e="Error")=>{const n=fP(e),{stack:r}=new n(t);return typeof r=="string"&&r!==""?r:`${e}: ${t}`},fP=t=>{const e={value:t,enumerable:!1,writable:!0,configurable:!0},n=Object.defineProperty(class extends Error{},"name",e);return Object.defineProperty(n.prototype,"name",e),n},hP=t=>{const e={};for(const n of pP(t))try{const r=t[n],{enumerable:i,configurable:s,writable:a=!0}=Up(t,n);Object.defineProperty(
e,n,{value:r,enumerable:i,configurable:s,writable:a})}catch{}return e},pP=t=>{const e=mP(t);for(const n of Bp)gP(t,n)&&e.push(n);return e},mP=t=>{try{return Reflect.ownKeys(t)}catch{return[]}},gP=(t,e)=>{try{return e in t&&!Object.hasOwn(t,e)}catch{return!1}},Nw=t=>{const{name:e,message:n,stack:r,cause:i,errors:s,...a}=hP(t),o=yP(n,a),c=$P(e,o);return n===o&&RP(c,a),Object.entries({name:e,stack:r,cause:i,errors:s}).forEach(([u,l])=>{kP(c,u,l)}),r===void 0&&Wp(c),c},yP=(t,e)=>typeof t=="string"&&
t!==""?t:bP(vP(e)),vP=t=>{try{return JSON.stringify(t)}catch{return wP(t)}},wP=t=>{try{return String(t)}catch{return"Invalid error"}},bP=t=>t.length<Iw?t:`${t.slice(0,Iw)}...`,Iw=1e3,$P=(t,e)=>t==="AggregateError"&&"AggregateError"in globalThis?new AggregateError([],e):t in Ow?new Ow[t](e):new Error(e),Ow={Error,ReferenceError,TypeError,SyntaxError,RangeError,URIError,EvalError},RP=(t,e)=>{for(const n in e)n in t||(t[n]=e[n])},kP=(t,e,n)=>{n!==void 0&&Nr(t,e,n)},TP=t=>{try{const e=new Error(String(
t));return Wp(e),e}catch(e){return e}},{toString:EP}=Object.prototype,SP=t=>AP(t)?Nw(t):iP(t)?_P(t)?Nw(t):t:TP(t),AP=t=>{try{return ld(t)}catch{return!1}},_P=t=>CP(t)||cP(t)||PP(t),CP=t=>{try{return EP.call(t)==="[object Object]"}catch{return!0}},PP=t=>typeof t.constructor!="function"||typeof t.constructor.name!="string"||t.constructor.name===""||t.constructor.prototype!==Object.getPrototypeOf(t),dd=(t,{shallow:e=!1}={})=>Lw(t,[],e),Lw=(t,e,n)=>{if(e.includes(t))return;const r=n?xP:s=>Lw(s,[...e,
t],n),i=SP(t);return DP(i,r),i},xP=t=>t,DP=(t,e)=>{NP(t),IP(t),OP(t),rP(t,e),ZC(t,e),XC(t)},NP=t=>{if(fd(t.name))return;const e=Object.getPrototypeOf(t).name,n=fd(e)?e:t.constructor.name;Nr(t,"name",n)},IP=t=>{fd(t.message)||Nr(t,"message","")},OP=t=>{fd(t.stack)||Wp(t)},fd=t=>typeof t=="string"&&t!=="",LP=(t,e,n=t.name)=>{if(MP(e),typeof n!="string")throw new TypeError(`currentName must be a string: ${n}`);return n},MP=t=>{if(!zP(t))throw new TypeError(`ErrorClass must be a class: ${t}`);if(!Mw(
t.prototype))throw new TypeError(`ErrorClass must inherit from Error: ${t}`);if(!FP(t))throw new TypeError(`ErrorClass must be have a valid constructor: ${t}`)},zP=t=>typeof t=="function"&&typeof t.prototype=="object"&&t.prototype!==null,Mw=t=>t!==null&&(t.name==="Error"||Mw(Object.getPrototypeOf(t))),FP=t=>typeof t.prototype.constructor=="function",zw=(t,e,n)=>{Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},qP=(t,e)=>{Object.getPrototypeOf(t)!==e.prototype&&(GP(
t,e),Gw(t,"constructor"),jP(t,e))},GP=(t,e)=>{Object.setPrototypeOf(t,e.prototype)},jP=(t,e)=>{Gw(t,"name");const n=Fw(e.prototype);t.name!==n&&zw(t,"name",n)},Fw=t=>BP(t)??UP(t)??Fw(Object.getPrototypeOf(t)),BP=t=>Object.hasOwn(t,"name")&&qw(t.name)?t.name:void 0,UP=t=>typeof t.constructor=="function"&&qw(t.constructor.name)?t.constructor.name:void 0,qw=t=>typeof t=="string"&&t!=="",Gw=(t,e)=>{Object.hasOwn(t,e)&&delete t[e]},WP=(t,e)=>{if(!HP(t,e))return;const n=VP(t,e);zw(t,"stack",n)},HP=(t,e)=>e!==
t.name&&e!==""&&t.stack.includes(e)&&KP(),KP=()=>{class t extends Error{}const e={value:jw,enumerable:!1,writable:!0,configurable:!0};Object.defineProperty(t,"name",e),Object.defineProperty(t.prototype,"name",e);const{stack:n}=new t("");return typeof n=="string"&&n.includes(jw)},jw="SetErrorClassError",VP=({name:t,stack:e},n)=>{if(e.startsWith(`${n}: `))return e.replace(n,t);const r=XP(n,t),[i,s]=r.find(([a])=>e.includes(a));return e.replace(i,s)},XP=(t,e)=>[[`
${t}: `,`
${e}: `],[`${t}: `,`${e}: `],[`${t} `,`${e} `],[t,e]],YP=(t,e,n)=>{const r=dd(t),i=LP(r,e,n);return qP(r,e),WP(r,i),r},JP=(t,e)=>e.configurable===!1?QP(t,e):tx(t,e),QP=(t,e)=>({...e,...ZP(t,e),...ex(t,e)}),ZP=(t,e)=>e.writable===!0&&t.writable===!1?{writable:!1}:{},ex=(t,e)=>t.hasValue&&"value"in e&&e.writable===!0?{value:t.value}:{},tx=(t,e)=>{const n=uo(t.enumerable,e.enumerable,!0),r=uo(t.writable,e.writable,!0),i=uo(t.configurable,e.configurable,!0);return{...nx(t,e,r),enumerable:n,configurable:i}},
nx=(t,e,n)=>t.hasValue?{value:t.value,writable:n}:!Bw(t)&&!Bw(e)?{value:e.value,writable:n}:{get:uo(t.get,e.get),set:uo(t.set,e.set)},Bw=({get:t,set:e})=>t!==void 0||e!==void 0,uo=(t,e,n)=>t??e??n,rx=(t,e,n)=>{if(!ix(t))throw new TypeError(`Argument must be an object: ${t}`);if(!sx(e))throw new TypeError(`Property key must be a string, a symbol or an integer: ${e}`);return ax(n)},ix=t=>typeof t=="object"&&t!==null,sx=t=>{const e=typeof t;return e==="string"||e==="symbol"||e==="number"},ax=t=>{if(!ld(
t))throw new TypeError(`Descriptor must be a plain object: ${t}`);const{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,...o}=t,c="value"in t;return ox({enumerable:e,writable:n,configurable:r,get:s,set:a,unknownProps:o,hasValue:c}),{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,hasValue:c}},ox=({enumerable:t,writable:e,configurable:n,get:r,set:i,unknownProps:s,hasValue:a})=>{Uw(a,r,"get"),Uw(a,i,"set"),Hp(t,"enumerable"),Hp(e,"writable"),Hp(n,"configurable"),ux(s)},Uw=(t,e,n)=>{
if(cx(e,n),t&&e!==void 0)throw new TypeError(`Descriptor property "value" and "${n}" must not both be defined: ${e}`)},cx=(t,e)=>{if(t!==void 0&&typeof t!="function")throw new TypeError(`Descriptor property "${e}" must be a function: ${t}`)},Hp=(t,e)=>{if(t!==void 0&&typeof t!="boolean")throw new TypeError(`Descriptor property "${e}" must be a boolean: ${t}`)},ux=t=>{const[e]=Object.keys(t);if(e!==void 0)throw new TypeError(`Unknown descriptor property "${e}": ${t[e]}`)},lx=(t,e,n)=>{const r=rx(
t,e,n),i=Ww(t,e),s=JP(r,i);return dx(t,e,s),t},Ww=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?{}:Ww(r,e)},dx=(t,e,n)=>{try{Object.defineProperty(t,e,n)}catch{}},fx=(t,e,n)=>{if(n!==void 0)return Hw(t,e,n);try{delete t[e]}catch{}if(t[e]!==void 0)return Hw(t,e)},Hw=(t,e,n)=>{const r=hx(e);lx(t,e,{value:n,...r})},hx=t=>typeof t=="string"&&t.startsWith("_")?{enumerable:!1}:{},px=t=>mx(t)||gx(t),mx=t=>{try{return t instanceof
Error}catch{return!1}},gx=t=>{try{return yx.has(Object.prototype.toString.call(t))}catch{return!1}},yx=new Set(["[object Error]","[object DOMException]","[object DOMError]","[object Exception]"]),vx=(t,e,n={})=>{if(Kw(t,"First argument"),Kw(e,"Second argument"),!ld(n))throw new TypeError(`Options must be a plain object: ${n}`);const{soft:r=!1}=n;if(typeof r!="boolean")throw new TypeError(`Option "soft" must be a boolean: ${r}`);return{soft:r}},Kw=(t,e)=>{if(t===void 0)throw new TypeError(`${e} i\
s required.`);if(!wx(t))throw new TypeError(`${e} must be a plain object or an error: ${t}`)},wx=t=>ld(t)||px(t),bx=({error:t,props:e,propName:n,soft:r})=>$x(n)||!Tx.call(e,n)||r&&t[n]!==void 0,$x=t=>t in Rx||kx.has(t),Rx=new Error("check"),kx=new Set(["prototype","errors","cause"]),{propertyIsEnumerable:Tx}=Object.prototype,Ex=(t,e,n)=>{const{soft:r}=vx(t,e,n);for(const i of Reflect.ownKeys(e))Sx({error:t,props:e,propName:i,soft:r});return t},Sx=({error:t,props:e,propName:n,soft:r})=>{bx({error:t,
props:e,propName:n,soft:r})||fx(t,n,e[n])},hd=(t,e,n)=>{Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!1,configurable:!0})},Ax=(t,e)=>{if(t.errors===void 0)return;const n=t.errors.map(r=>e(r).error).filter(Boolean);hd(t,"errors",n)},_x=({target:t,source:e,parent:n,child:r})=>{if(!Vw(t)){Cx(t,e);return}Vw(e)&&hd(t,"errors",[...r.errors,...n.errors])},Cx=(t,e)=>{e.errors!==void 0&&hd(t,"errors",e.errors)},Vw=t=>t.errors!==void 0&&t.errors.length!==0,Px=(t,e,n=t.message)=>{if(typeof e!=
"string")throw new TypeError(`newMessage must be a string: ${e}`);if(typeof n!="string")throw new TypeError(`currentMessage must be a string: ${n}`);return n},xx=({name:t,stack:e},n,r)=>r!==""&&e.includes(r)?Dx({name:t,stack:e,newMessage:n,currentMessage:r}):Ix(t,e,n),Dx=({name:t,stack:e,newMessage:n,currentMessage:r})=>{const i=Nx(t,n,r),[s,a]=i.find(([o])=>e.includes(o));return e.replace(s,a)},Nx=(t,e,n)=>[[`${t}: ${n}`,`${t}: ${e}`],[`: ${n}`,`: ${e}`],[`
${n}`,`
${e}`],[` ${n}`,` ${e}`],[n,e]],Ix=(t,e,n)=>{const r=`${t}: `,i=n.trimEnd();return e===t||e.startsWith(`${t}
`)?e.replace(t,`${r}${i}`):e.startsWith(r)?e.replace(r,`${r}${i}
`):`${r}${i}
${e}`},Ox=(t,e,n)=>{const r=dd(t),i=Px(r,e,n);return Yw(r,"message",e),Lx(r,e,i),r},Lx=(t,e,n)=>{if(e===n||!Mx())return;const r=xx(t,e,n);Yw(t,"stack",r)},Mx=()=>{const{stack:t}=new Error(Xw);return typeof t=="string"&&t.includes(Xw)},Xw="set-error-message test message",Yw=(t,e,n)=>{Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},zx=(t,e,n)=>{if(typeof e!="string")throw new TypeError(`Second argument must be a message string: ${e}`);const r=dd(t),i=Fx(e,r.message);
return Ox(r,i,n)},Fx=(t,e)=>{const n=t.trim(),r=e.trim();return n===""?r:r===""?n:qx(n,r,t)},qx=(t,e,n)=>t.endsWith(Gx)?n.endsWith(jx)?`${t}
${e}`:`${t} ${e}`:`${e}
${t}`,Gx=":",jx=`
`,Bx=({parent:t,child:e,target:n,stackError:r})=>{const i=t.message;return n.message=e.message,zx(n,i,r.message)},Ux=(t,e)=>Jw(t)===e,Jw=t=>typeof t=="object"&&t!==null?t.stack:void 0,Wx=({wrap:t,target:e,source:n,childHasStack:r})=>t===r?e:(hd(e,"stack",n.stack),n),Hx=t=>{const{wrap:e,name:n}=t;return typeof e!="boolean"?n==="Error":(Object.hasOwn(t,"wrap")&&delete t.wrap,e)},Qw=t=>Zw(t,[]).error,Zw=(t,e)=>{if(e.includes(t))return{};const n=c=>Zw(c,[...e,t]),r=Jw(t),i=dd(t,{shallow:!0}),s=Ux(i,
r);Ax(i,n);const{parent:a,childHasStack:o}=Kx(i,n);return{error:a,errorHasStack:s||o}},Kx=(t,e)=>{const n=Hx(t);if(t.cause===void 0)return{parent:t,childHasStack:!1};const{error:r,errorHasStack:i}=e(t.cause);return delete t.cause,{parent:Vx({parent:t,child:r,childHasStack:i,wrap:n}),childHasStack:i}},Vx=({parent:t,child:e,childHasStack:n,wrap:r})=>{if(e===void 0)return t;const[i,s]=r?[e,t]:[t,e],a=Wx({wrap:r,target:i,source:s,childHasStack:n}),o=YP(i,i.constructor,a.name),c=Bx({parent:t,child:e,
target:o,stackError:a});return _x({target:c,source:s,parent:t,child:e}),Ex(c,s,{soft:!r})};function eb(t){return function(e,n){if(typeof n?.toJSON=="function"&&(n=n.toJSON()),!(n!==null&&typeof n=="object"))return n;if(t.has(n))return"[Circular]";t.add(n);const r=Array.isArray(n)?[]:{};for(const[i,s]of Object.entries(n))r[i]=eb(t)(i,s);return t.delete(n),r}}function Xx(t,{indentation:e}={}){return JSON.stringify(t,eb(new WeakSet),e)}const tb=t=>t.split(`
`).map(e=>e.trim().replace("file://",""));function Kp(t,e=2){return t=Array.isArray(t)?t:t.split(`
`),t.map(n=>`${" ".repeat(e)}${n}`).join(`
`)}function Ji(t){if(typeof t=="string")return t;if(t instanceof Error){const e=Qw(t);if(e.stack){const n=tb(e.stack);return e.message+`
`+Kp(n.slice(1))}return e.message}return Xx(t)}function Yx(t){const e=Object.values(t.properties).filter(n=>n instanceof Error).map(n=>{const r=Qw(n);return r.stack&&(r.stack=tb(r.stack).join(`
`)),r});return e.length===0?null:e.length===1?e[0]:new AggregateError(e)}function Jx(t,e){const n=Yx(t.record);if(n){let r=n.message;return n.stack&&(r=r+`
`+Kp(n.stack.split(`
`).slice(1))),r=`${tD.red}${r}${eD}`,{...t,message:t.message+`
`+Kp(r)}}return t}const Qx={debug:"DEBUG",info:"INFO ",warning:"WARN ",error:"ERROR",fatal:"FATAL"},Zx=t=>Qx[t],eD="\x1B[0m",tD={red:"\x1B[31m"};function nD(t){const e=({timestamp:n,level:r,category:i,message:s})=>`${n} ${r} ${i} ${s}`;return _w({timestamp:"time",level:Zx,categoryStyle:"bold",categoryColor:"cyan",category:".",...t,format:n=>e(Jx(n))})}function nb(t){return Cw({formatter:nD(),...t})}const un=LC("likec4");function rD(t){return un.getChild(t)}let iD=!1;async function sD(t){try{iD=!0;
const e=t?.sinks??{};await UC({...t,sinks:{...e,console:e.console??nb()},loggers:[{category:["logtape","meta"],sinks:["console"],lowestLevel:"warning"},...t?.loggers??[{category:"likec4",sinks:["console"],lowestLevel:"debug"}]]})}catch(e){console.error(e)}}function Vp(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)===
"[object Module]":!0}function Xp(t,e,n=".",r){if(!Vp(e))return Xp(t,{},n,r);const i=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const a=t[s];a!=null&&(r&&r(i,s,a,n)||(Array.isArray(a)&&Array.isArray(i[s])?i[s]=[...a,...i[s]]:Vp(a)&&Vp(i[s])?i[s]=Xp(a,i[s],(n?`${n}.`:"")+s.toString(),r):i[s]=a))}return i}function aD(t){return(...e)=>e.reduce((n,r)=>Xp(n,r,"",t),{})}const Yp=aD();function bt(t){return typeof t=="object"&&t!==null&&typeof t.$type=="string"}function Bn(t){
return typeof t=="object"&&t!==null&&typeof t.$refText=="string"}function oD(t){return typeof t=="object"&&t!==null&&typeof t.name=="string"&&typeof t.type=="string"&&typeof t.path=="string"}function pd(t){return typeof t=="object"&&t!==null&&bt(t.container)&&Bn(t.reference)&&typeof t.message=="string"}class rb{constructor(){this.subtypes={},this.allSubtypes={}}isInstance(e,n){return bt(e)&&this.isSubtype(e.$type,n)}isSubtype(e,n){if(e===n)return!0;let r=this.subtypes[e];r||(r=this.subtypes[e]={});
const i=r[n];if(i!==void 0)return i;{const s=this.computeIsSubtype(e,n);return r[n]=s,s}}getAllSubTypes(e){const n=this.allSubtypes[e];if(n)return n;{const r=this.getAllTypes(),i=[];for(const s of r)this.isSubtype(s,e)&&i.push(s);return this.allSubtypes[e]=i,i}}}function yi(t){return typeof t=="object"&&t!==null&&Array.isArray(t.content)}function Qi(t){return typeof t=="object"&&t!==null&&typeof t.tokenType=="object"}function ib(t){return yi(t)&&typeof t.fullText=="string"}class Mt{constructor(e,n){
this.startFn=e,this.nextFn=n}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){return!!this.iterator().next().done}count(){const e=this.iterator();let n=0,r=e.next();for(;!r.done;)n++,r=e.next();return n}toArray(){const e=[],n=this.iterator();let r;do r=n.next(),r.value!==void 0&&e.push(r.value);while(!r.done);return e}toSet(){return new Set(this)}toMap(e,n){const r=this.map(i=>[e?e(i):i,n?
n(i):i]);return new Map(r)}toString(){return this.join()}concat(e){return new Mt(()=>({first:this.startFn(),firstDone:!1,iterator:e[Symbol.iterator]()}),n=>{let r;if(!n.firstDone){do if(r=this.nextFn(n.first),!r.done)return r;while(!r.done);n.firstDone=!0}do if(r=n.iterator.next(),!r.done)return r;while(!r.done);return ln})}join(e=","){const n=this.iterator();let r="",i,s=!1;do i=n.next(),i.done||(s&&(r+=e),r+=cD(i.value)),s=!0;while(!i.done);return r}indexOf(e,n=0){const r=this.iterator();let i=0,
s=r.next();for(;!s.done;){if(i>=n&&s.value===e)return i;s=r.next(),i++}return-1}every(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(!e(r.value))return!1;r=n.next()}return!0}some(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return!0;r=n.next()}return!1}forEach(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;)e(i.value,r),i=n.next(),r++}map(e){return new Mt(this.startFn,n=>{const{done:r,value:i}=this.nextFn(n);return r?ln:{done:!1,value:e(i)}})}filter(e){
return new Mt(this.startFn,n=>{let r;do if(r=this.nextFn(n),!r.done&&e(r.value))return r;while(!r.done);return ln})}nonNullable(){return this.filter(e=>e!=null)}reduce(e,n){const r=this.iterator();let i=n,s=r.next();for(;!s.done;)i===void 0?i=s.value:i=e(i,s.value),s=r.next();return i}reduceRight(e,n){return this.recursiveReduce(this.iterator(),e,n)}recursiveReduce(e,n,r){const i=e.next();if(i.done)return r;const s=this.recursiveReduce(e,n,r);return s===void 0?i.value:n(s,i.value)}find(e){const n=this.
iterator();let r=n.next();for(;!r.done;){if(e(r.value))return r.value;r=n.next()}}findIndex(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;){if(e(i.value))return r;i=n.next(),r++}return-1}includes(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(r.value===e)return!0;r=n.next()}return!1}flatMap(e){return new Mt(()=>({this:this.startFn()}),n=>{do{if(n.iterator){const s=n.iterator.next();if(s.done)n.iterator=void 0;else return s}const{done:r,value:i}=this.nextFn(n.this);if(!r){
const s=e(i);if(md(s))n.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}}while(n.iterator);return ln})}flat(e){if(e===void 0&&(e=1),e<=0)return this;const n=e>1?this.flat(e-1):this;return new Mt(()=>({this:n.startFn()}),r=>{do{if(r.iterator){const a=r.iterator.next();if(a.done)r.iterator=void 0;else return a}const{done:i,value:s}=n.nextFn(r.this);if(!i)if(md(s))r.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}while(r.iterator);return ln})}head(){const n=this.iterator().next();
if(!n.done)return n.value}tail(e=1){return new Mt(()=>{const n=this.startFn();for(let r=0;r<e;r++)if(this.nextFn(n).done)return n;return n},this.nextFn)}limit(e){return new Mt(()=>({size:0,state:this.startFn()}),n=>(n.size++,n.size>e?ln:this.nextFn(n.state)))}distinct(e){return new Mt(()=>({set:new Set,internalState:this.startFn()}),n=>{let r;do if(r=this.nextFn(n.internalState),!r.done){const i=e?e(r.value):r.value;if(!n.set.has(i))return n.set.add(i),r}while(!r.done);return ln})}exclude(e,n){const r=new Set;
for(const i of e){const s=n?n(i):i;r.add(s)}return this.filter(i=>{const s=n?n(i):i;return!r.has(s)})}}function cD(t){return typeof t=="string"?t:typeof t>"u"?"undefined":typeof t.toString=="function"?t.toString():Object.prototype.toString.call(t)}function md(t){return!!t&&typeof t[Symbol.iterator]=="function"}const na=new Mt(()=>{},()=>ln),ln=Object.freeze({done:!0,value:void 0});function et(...t){if(t.length===1){const e=t[0];if(e instanceof Mt)return e;if(md(e))return new Mt(()=>e[Symbol.iterator](),
n=>n.next());if(typeof e.length=="number")return new Mt(()=>({index:0}),n=>n.index<e.length?{done:!1,value:e[n.index++]}:ln)}return t.length>1?new Mt(()=>({collIndex:0,arrIndex:0}),e=>{do{if(e.iterator){const n=e.iterator.next();if(!n.done)return n;e.iterator=void 0}if(e.array){if(e.arrIndex<e.array.length)return{done:!1,value:e.array[e.arrIndex++]};e.array=void 0,e.arrIndex=0}if(e.collIndex<t.length){const n=t[e.collIndex++];md(n)?e.iterator=n[Symbol.iterator]():n&&typeof n.length=="number"&&(e.
array=n)}}while(e.iterator||e.array||e.collIndex<t.length);return ln}):na}class ra extends Mt{constructor(e,n,r){super(()=>({iterators:r?.includeRoot?[[e][Symbol.iterator]()]:[n(e)[Symbol.iterator]()],pruned:!1}),i=>{for(i.pruned&&(i.iterators.pop(),i.pruned=!1);i.iterators.length>0;){const a=i.iterators[i.iterators.length-1].next();if(a.done)i.iterators.pop();else return i.iterators.push(n(a.value)[Symbol.iterator]()),a}return ln})}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.
state),prune:()=>{e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}var Jp;(function(t){function e(s){return s.reduce((a,o)=>a+o,0)}t.sum=e;function n(s){return s.reduce((a,o)=>a*o,0)}t.product=n;function r(s){return s.reduce((a,o)=>Math.min(a,o))}t.min=r;function i(s){return s.reduce((a,o)=>Math.max(a,o))}t.max=i})(Jp||(Jp={}));function gd(t){return new ra(t,e=>yi(e)?e.content:[],{includeRoot:!0})}function uD(t){return gd(t).filter(Qi)}function lD(t,e){for(;t.container;)if(t=t.container,t===
e)return!0;return!1}function Qp(t){return{start:{character:t.startColumn-1,line:t.startLine-1},end:{character:t.endColumn,line:t.endLine-1}}}function yd(t){if(!t)return;const{offset:e,end:n,range:r}=t;return{range:r,offset:e,end:n,length:n-e}}var Ir;(function(t){t[t.Before=0]="Before",t[t.After=1]="After",t[t.OverlapFront=2]="OverlapFront",t[t.OverlapBack=3]="OverlapBack",t[t.Inside=4]="Inside",t[t.Outside=5]="Outside"})(Ir||(Ir={}));function dD(t,e){if(t.end.line<e.start.line||t.end.line===e.start.
line&&t.end.character<=e.start.character)return Ir.Before;if(t.start.line>e.end.line||t.start.line===e.end.line&&t.start.character>=e.end.character)return Ir.After;const n=t.start.line>e.start.line||t.start.line===e.start.line&&t.start.character>=e.start.character,r=t.end.line<e.end.line||t.end.line===e.end.line&&t.end.character<=e.end.character;return n&&r?Ir.Inside:n?Ir.OverlapBack:r?Ir.OverlapFront:Ir.Outside}function sb(t,e){return dD(t,e)>Ir.After}const ab=/^[\w\p{L}]$/u;function Zi(t,e,n=ab){
if(t){if(e>0){const r=e-t.offset,i=t.text.charAt(r);n.test(i)||e--}return cb(t,e)}}function Zp(t,e){if(t){const n=fD(t,!0);if(n&&ob(n,e))return n;if(ib(t)){const r=t.content.findIndex(i=>!i.hidden);for(let i=r-1;i>=0;i--){const s=t.content[i];if(ob(s,e))return s}}}}function ob(t,e){return Qi(t)&&e.includes(t.tokenType.name)}function cb(t,e){if(Qi(t))return t;if(yi(t)){const n=ub(t,e,!1);if(n)return cb(n,e)}}function em(t,e){if(Qi(t))return t;if(yi(t)){const n=ub(t,e,!0);if(n)return em(n,e)}}function ub(t,e,n){
let r=0,i=t.content.length-1,s;for(;r<=i;){const a=Math.floor((r+i)/2),o=t.content[a];if(o.offset<=e&&o.end>e)return o;o.end<=e?(s=n?o:void 0,r=a+1):i=a-1}return s}function fD(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);for(;r>0;){r--;const i=n.content[r];if(e||!i.hidden)return i}t=n}}function hD(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);const i=n.content.length-1;for(;r<i;){r++;const s=n.content[r];if(e||!s.hidden)return s}t=n}}function pD(t,e){
const n=mD(t,e);return n?n.parent.content.slice(n.a+1,n.b):[]}function mD(t,e){const n=lb(t),r=lb(e);let i;for(let s=0;s<n.length&&s<r.length;s++){const a=n[s],o=r[s];if(a.parent===o.parent)i={parent:a.parent,a:a.index,b:o.index};else break}return i}function lb(t){const e=[];for(;t.container;){const n=t.container,r=n.content.indexOf(t);e.push({parent:n,index:r}),t=n}return e.reverse()}class db extends Error{constructor(e,n){super(e?`${n} at ${e.range.start.line}:${e.range.start.character}`:n)}}function lo(t){
throw new Error("Error! The input value was not handled.")}const vd="AbstractRule",wd="AbstractType",tm="Condition",fb="TypeDefinition",nm="ValueLiteral",fo="AbstractElement";function rm(t){return We.isInstance(t,fo)}const bd="ArrayLiteral",ho="ArrayType";function gD(t){return We.isInstance(t,ho)}const po="BooleanLiteral";function yD(t){return We.isInstance(t,po)}const mo="Conjunction";function vD(t){return We.isInstance(t,mo)}const go="Disjunction";function wD(t){return We.isInstance(t,go)}const $d="\
Grammar",im="GrammarImport",yo="InferredType";function hb(t){return We.isInstance(t,yo)}const vo="Interface";function pb(t){return We.isInstance(t,vo)}const sm="NamedArgument",wo="Negation";function bD(t){return We.isInstance(t,wo)}const Rd="NumberLiteral",kd="Parameter",bo="ParameterReference";function $D(t){return We.isInstance(t,bo)}const $o="ParserRule";function en(t){return We.isInstance(t,$o)}const Ro="ReferenceType";function RD(t){return We.isInstance(t,Ro)}const Td="ReturnType";function kD(t){
return We.isInstance(t,Td)}const ko="SimpleType";function mb(t){return We.isInstance(t,ko)}const Ed="StringLiteral",ia="TerminalRule";function Or(t){return We.isInstance(t,ia)}const To="Type";function am(t){return We.isInstance(t,To)}const om="TypeAttribute",Eo="UnionType";function TD(t){return We.isInstance(t,Eo)}const So="Action";function es(t){return We.isInstance(t,So)}const Ao="Alternatives";function cm(t){return We.isInstance(t,Ao)}const _o="Assignment";function vr(t){return We.isInstance(
t,_o)}const Co="CharacterRange";function ED(t){return We.isInstance(t,Co)}const Po="CrossReference";function xo(t){return We.isInstance(t,Po)}const Do="EndOfFile";function SD(t){return We.isInstance(t,Do)}const No="Group";function vi(t){return We.isInstance(t,No)}const Io="Keyword";function wr(t){return We.isInstance(t,Io)}const Oo="NegatedToken";function AD(t){return We.isInstance(t,Oo)}const Lo="RegexToken";function _D(t){return We.isInstance(t,Lo)}const Mo="RuleCall";function Lr(t){return We.
isInstance(t,Mo)}const zo="TerminalAlternatives";function CD(t){return We.isInstance(t,zo)}const Fo="TerminalGroup";function PD(t){return We.isInstance(t,Fo)}const qo="TerminalRuleCall";function gb(t){return We.isInstance(t,qo)}const Go="UnorderedGroup";function um(t){return We.isInstance(t,Go)}const jo="UntilToken";function xD(t){return We.isInstance(t,jo)}const Bo="Wildcard";function DD(t){return We.isInstance(t,Bo)}class yb extends rb{getAllTypes(){return[fo,vd,wd,So,Ao,bd,ho,_o,po,Co,tm,mo,Po,
go,Do,$d,im,No,yo,vo,Io,sm,Oo,wo,Rd,kd,bo,$o,Ro,Lo,Td,Mo,ko,Ed,zo,Fo,ia,qo,To,om,fb,Eo,Go,jo,nm,Bo]}computeIsSubtype(e,n){switch(e){case So:case Ao:case _o:case Co:case Po:case Do:case No:case Io:case Oo:case Lo:case Mo:case zo:case Fo:case qo:case Go:case jo:case Bo:return this.isSubtype(fo,n);case bd:case Rd:case Ed:return this.isSubtype(nm,n);case ho:case Ro:case ko:case Eo:return this.isSubtype(fb,n);case po:return this.isSubtype(tm,n)||this.isSubtype(nm,n);case mo:case go:case wo:case bo:return this.
isSubtype(tm,n);case yo:case vo:case To:return this.isSubtype(wd,n);case $o:return this.isSubtype(vd,n)||this.isSubtype(wd,n);case ia:return this.isSubtype(vd,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"Action:type":case"CrossReference:type":case"Interface:superTypes":case"ParserRule:returnType":case"SimpleType:typeRef":return wd;case"Grammar:hiddenTokens":case"ParserRule:hiddenTokens":case"RuleCall:rule":return vd;case"Grammar:usedGrammar\
s":return $d;case"NamedArgument:parameter":case"ParameterReference:parameter":return kd;case"TerminalRuleCall:rule":return ia;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case fo:return{name:fo,properties:[{name:"cardinality"},{name:"lookahead"}]};case bd:return{name:bd,properties:[{name:"elements",defaultValue:[]}]};case ho:return{name:ho,properties:[{name:"elementType"}]};case po:return{name:po,properties:[{name:"true",defaultValue:!1}]};case mo:return{
name:mo,properties:[{name:"left"},{name:"right"}]};case go:return{name:go,properties:[{name:"left"},{name:"right"}]};case $d:return{name:$d,properties:[{name:"definesHiddenTokens",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"interfaces",defaultValue:[]},{name:"isDeclared",defaultValue:!1},{name:"name"},{name:"rules",defaultValue:[]},{name:"types",defaultValue:[]},{name:"usedGrammars",defaultValue:[]}]};case im:return{name:im,properties:[{name:"pa\
th"}]};case yo:return{name:yo,properties:[{name:"name"}]};case vo:return{name:vo,properties:[{name:"attributes",defaultValue:[]},{name:"name"},{name:"superTypes",defaultValue:[]}]};case sm:return{name:sm,properties:[{name:"calledByName",defaultValue:!1},{name:"parameter"},{name:"value"}]};case wo:return{name:wo,properties:[{name:"value"}]};case Rd:return{name:Rd,properties:[{name:"value"}]};case kd:return{name:kd,properties:[{name:"name"}]};case bo:return{name:bo,properties:[{name:"parameter"}]};case $o:
return{name:$o,properties:[{name:"dataType"},{name:"definesHiddenTokens",defaultValue:!1},{name:"definition"},{name:"entry",defaultValue:!1},{name:"fragment",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"inferredType"},{name:"name"},{name:"parameters",defaultValue:[]},{name:"returnType"},{name:"wildcard",defaultValue:!1}]};case Ro:return{name:Ro,properties:[{name:"referenceType"}]};case Td:return{name:Td,properties:[{name:"name"}]};case ko:return{name:ko,properties:[{name:"primit\
iveType"},{name:"stringType"},{name:"typeRef"}]};case Ed:return{name:Ed,properties:[{name:"value"}]};case ia:return{name:ia,properties:[{name:"definition"},{name:"fragment",defaultValue:!1},{name:"hidden",defaultValue:!1},{name:"name"},{name:"type"}]};case To:return{name:To,properties:[{name:"name"},{name:"type"}]};case om:return{name:om,properties:[{name:"defaultValue"},{name:"isOptional",defaultValue:!1},{name:"name"},{name:"type"}]};case Eo:return{name:Eo,properties:[{name:"types",defaultValue:[]}]};case So:
return{name:So,properties:[{name:"cardinality"},{name:"feature"},{name:"inferredType"},{name:"lookahead"},{name:"operator"},{name:"type"}]};case Ao:return{name:Ao,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case _o:return{name:_o,properties:[{name:"cardinality"},{name:"feature"},{name:"lookahead"},{name:"operator"},{name:"terminal"}]};case Co:return{name:Co,properties:[{name:"cardinality"},{name:"left"},{name:"lookahead"},{name:"right"}]};case Po:return{
name:Po,properties:[{name:"cardinality"},{name:"deprecatedSyntax",defaultValue:!1},{name:"lookahead"},{name:"terminal"},{name:"type"}]};case Do:return{name:Do,properties:[{name:"cardinality"},{name:"lookahead"}]};case No:return{name:No,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"guardCondition"},{name:"lookahead"}]};case Io:return{name:Io,properties:[{name:"cardinality"},{name:"lookahead"},{name:"value"}]};case Oo:return{name:Oo,properties:[{name:"cardinality"},{name:"\
lookahead"},{name:"terminal"}]};case Lo:return{name:Lo,properties:[{name:"cardinality"},{name:"lookahead"},{name:"regex"}]};case Mo:return{name:Mo,properties:[{name:"arguments",defaultValue:[]},{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case zo:return{name:zo,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case Fo:return{name:Fo,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case qo:return{name:qo,properties:[
{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case Go:return{name:Go,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case jo:return{name:jo,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case Bo:return{name:Bo,properties:[{name:"cardinality"},{name:"lookahead"}]};default:return{name:e,properties:[]}}}}const We=new yb;function lm(t){for(const[e,n]of Object.entries(t))e.startsWith("$")||(Array.isArray(n)?n.forEach((r,i)=>{bt(
r)&&(r.$container=t,r.$containerProperty=e,r.$containerIndex=i)}):bt(n)&&(n.$container=t,n.$containerProperty=e))}function dn(t,e){let n=t;for(;n;){if(e(n))return n;n=n.$container}}function wi(t,e){let n=t;for(;n;){if(e(n))return!0;n=n.$container}return!1}function ht(t){const n=Sd(t).$document;if(!n)throw new Error("AST node has no document.");return n}function Sd(t){for(;t.$container;)t=t.$container;return t}function Uo(t,e){if(!t)throw new Error("Node must be an AstNode.");const n=e?.range;return new Mt(
()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),r=>{for(;r.keyIndex<r.keys.length;){const i=r.keys[r.keyIndex];if(!i.startsWith("$")){const s=t[i];if(bt(s)){if(r.keyIndex++,dm(s,n))return{done:!1,value:s}}else if(Array.isArray(s)){for(;r.arrayIndex<s.length;){const a=r.arrayIndex++,o=s[a];if(bt(o)&&dm(o,n))return{done:!1,value:o}}r.arrayIndex=0}}r.keyIndex++}return ln})}function br(t,e){if(!t)throw new Error("Root node must be an AstNode.");return new ra(t,n=>Uo(n,e))}function Mr(t,e){if(t){
if(e?.range&&!dm(t,e.range))return new ra(t,()=>[])}else throw new Error("Root node must be an AstNode.");return new ra(t,n=>Uo(n,e),{includeRoot:!0})}function dm(t,e){var n;if(!e)return!0;const r=(n=t.$cstNode)===null||n===void 0?void 0:n.range;return r?sb(r,e):!1}function Ad(t){return new Mt(()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),e=>{for(;e.keyIndex<e.keys.length;){const n=e.keys[e.keyIndex];if(!n.startsWith("$")){const r=t[n];if(Bn(r))return e.keyIndex++,{done:!1,value:{reference:r,
container:t,property:n}};if(Array.isArray(r)){for(;e.arrayIndex<r.length;){const i=e.arrayIndex++,s=r[i];if(Bn(s))return{done:!1,value:{reference:s,container:t,property:n,index:i}}}e.arrayIndex=0}}e.keyIndex++}return ln})}function ND(t,e=ht(t).parseResult.value){const n=[];return Mr(e).forEach(r=>{Ad(r).forEach(i=>{i.reference.ref===t&&n.push(i.reference)})}),et(n)}function fm(t,e){const n=t.getTypeMetaData(e.$type),r=e;for(const i of n.properties)i.defaultValue!==void 0&&r[i.name]===void 0&&(r[i.
name]=vb(i.defaultValue))}function vb(t){return Array.isArray(t)?[...t.map(vb)]:t}function hm(t,e){const n={$type:t.$type};for(const[r,i]of Object.entries(t))if(!r.startsWith("$"))if(bt(i))n[r]=hm(i,e);else if(Bn(i))n[r]=e(n,r,i.$refNode,i.$refText);else if(Array.isArray(i)){const s=[];for(const a of i)bt(a)?s.push(hm(a,e)):Bn(a)?s.push(e(n,r,a.$refNode,a.$refText)):s.push(a);n[r]=s}else n[r]=i;return lm(n),n}const Wo={__proto__:null,assignMandatoryProperties:fm,copyAstNode:hm,findLocalReferences:ND,
findRootNode:Sd,getContainerOfType:dn,getDocument:ht,hasContainerOfType:wi,linkContentToContainer:lm,streamAllContents:br,streamAst:Mr,streamContents:Uo,streamReferences:Ad};function Ae(t){return t.charCodeAt(0)}function pm(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function Ho(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function sa(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function ID(){throw Error("Internal Error - Shoul\
d never get here!")}function wb(t){return t.type==="Character"}const _d=[];for(let t=Ae("0");t<=Ae("9");t++)_d.push(t);const Cd=[Ae("_")].concat(_d);for(let t=Ae("a");t<=Ae("z");t++)Cd.push(t);for(let t=Ae("A");t<=Ae("Z");t++)Cd.push(t);const bb=[Ae(" "),Ae("\f"),Ae(`
`),Ae("\r"),Ae("	"),Ae("\v"),Ae("	"),Ae("\xA0"),Ae("\u1680"),Ae("\u2000"),Ae("\u2001"),Ae("\u2002"),Ae("\u2003"),Ae("\u2004"),Ae("\u2005"),Ae("\u2006"),Ae("\u2007"),Ae("\u2008"),Ae("\u2009"),Ae("\u200A"),Ae("\u2028"),Ae("\u2029"),Ae("\u202F"),Ae("\u205F"),Ae("\u3000"),Ae("\uFEFF")],OD=/[0-9a-fA-F]/,Pd=/[0-9]/,LD=/[1-9]/;class $b{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=
e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Ho(r,"global");break;case"i":Ho(r,"ignoreCase");break;case"m":Ho(r,"multiLine");break;case"u":Ho(r,"unicode");break;case"y":Ho(r,"sticky");break}if(this.idx!==this.input.length)
throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){
const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}sa(n);const r=this.disjunction();return this.consumeChar("\
)"),{type:n,value:r,loc:this.loc(e)}}return ID()}quantifier(e=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;sa(
n);break}if(!(e===!0&&n===void 0)&&sa(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),sa(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),
e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Ae(`
`),Ae("\r"),Ae("\u2028"),Ae("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.
regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=_d;break;case"D":e=_d,n=!0;break;case"s":e=bb;break;case"S":e=bb,n=!0;break;case"w":e=Cd;break;case"W":e=Cd,n=!0;break}if(sa(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Ae("\f");break;case"n":e=Ae(`
`);break;case"r":e=Ae("\r");break;case"t":e=Ae("	");break;case"v":e=Ae("\v");break}if(sa(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Ae("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){
return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Ae(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Ae(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,wb(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,wb(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.
value})}else pm(r.value,e),e.push(Ae("-")),pm(i.value,e)}else pm(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Ae("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"\
x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:n};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(LD.test(e)===!1)throw Error("Expecting a\
 positive integer");for(;Pd.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(Pd.test(e)===!1)throw Error("Expecting an integer");for(;Pd.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Ae(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return Pd.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){
const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let i=0;i<e;i++){const s=this.popChar();if(OD.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+
this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class xd{visitChildren(e){for(const n in e){const r=e[n];e.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"Sta\
rtAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.
visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}const Rb=/\r?\n/gm,MD=new $b;class zD extends xd{constructor(){super(...arguments),this.isStarting=!0,this.endRegexpStack=[],this.multiline=!1}get endRegex(){
return this.endRegexpStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegexp="",this.isStarting=!0,this.endRegexpStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexpStack=[])}visitCharacter(e){const n=String.fromCharCode(e.value);if(!this.multiline&&n===`
`&&(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const r=Dd(n);this.endRegexpStack.push(r),this.isStarting&&(this.startRegexp+=r)}}visitSet(e){if(!this.multiline){const n=this.regex.substring(e.loc.begin,e.loc.end),r=new RegExp(n);this.multiline=!!`
`.match(r)}if(e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const n=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexpStack.push(n),this.isStarting&&(this.startRegexp+=n)}}visitChildren(e){e.type==="Group"&&e.quantifier||super.visitChildren(e)}}const mm=new zD;function FD(t){try{return typeof t=="string"&&(t=new RegExp(t)),t=t.toString(),mm.reset(t),mm.visit(MD.pattern(t)),mm.multiline}catch{return!1}}const qD=`\f
\r	\v \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF`.split("");function gm(t){const e=typeof t=="string"?new RegExp(t):t;return qD.some(n=>e.test(n))}function Dd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function GD(t){return Array.prototype.map.call(t,e=>/\w/.test(e)?`[${e.toLowerCase()}${e.toUpperCase()}]`:Dd(e)).join("")}function jD(t,e){const n=BD(t),r=e.match(n);return!!r&&r[0].length>0}function BD(t){typeof t=="stri\
ng"&&(t=new RegExp(t));const e=t,n=t.source;let r=0;function i(){let s="",a;function o(u){s+=n.substr(r,u),r+=u}function c(u){s+="(?:"+n.substr(r,u)+"|$)",r+=u}for(;r<n.length;)switch(n[r]){case"\\":switch(n[r+1]){case"c":c(3);break;case"x":c(4);break;case"u":e.unicode?n[r+2]==="{"?c(n.indexOf("}",r)-r+1):c(6):c(2);break;case"p":case"P":e.unicode?c(n.indexOf("}",r)-r+1):c(2);break;case"k":c(n.indexOf(">",r)-r+1);break;default:c(2);break}break;case"[":a=/\[(?:\\.|.)*?\]/g,a.lastIndex=r,a=a.exec(n)||
[],c(a[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":o(1);break;case"{":a=/\{\d+,?\d*\}/g,a.lastIndex=r,a=a.exec(n),a?o(a[0].length):c(1);break;case"(":if(n[r+1]==="?")switch(n[r+2]){case":":s+="(?:",r+=3,s+=i()+"|$)";break;case"=":s+="(?=",r+=3,s+=i()+")";break;case"!":a=r,r+=3,i(),s+=n.substr(a,r-a);break;case"<":switch(n[r+3]){case"=":case"!":a=r,r+=4,i(),s+=n.substr(a,r-a);break;default:o(n.indexOf(">",r)-r+1),s+=i()+"|$)";break}break}else o(1),s+=i()+"|$)";break;case")":return++r,
s;default:c(1);break}return s}return new RegExp(i(),t.flags)}function Nd(t){return t.rules.find(e=>en(e)&&e.entry)}function kb(t){return t.rules.filter(e=>Or(e)&&e.hidden)}function ym(t,e){const n=new Set,r=Nd(t);if(!r)return new Set(t.rules);const i=[r].concat(kb(t));for(const a of i)Tb(a,n,e);const s=new Set;for(const a of t.rules)(n.has(a.name)||Or(a)&&a.hidden)&&s.add(a);return s}function Tb(t,e,n){e.add(t.name),br(t).forEach(r=>{if(Lr(r)||n&&gb(r)){const i=r.rule.ref;i&&!e.has(i.name)&&Tb(i,
e,n)}})}function vm(t){if(t.terminal)return t.terminal;if(t.type.ref){const e=Rm(t.type.ref);return e?.terminal}}function Eb(t){return t.hidden&&!gm(Xo(t))}function aa(t,e){return!t||!e?[]:wm(t,e,t.astNode,!0)}function tn(t,e,n){if(!t||!e)return;const r=wm(t,e,t.astNode,!0);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function wm(t,e,n,r){if(!r){const i=dn(t.grammarSource,vr);if(i&&i.feature===e)return[t]}return yi(t)&&t.astNode===n?t.content.flatMap(i=>wm(i,e,
n,!1)):[]}function bm(t,e){return t?$m(t,e,t?.astNode):[]}function Ko(t,e,n){if(!t)return;const r=$m(t,e,t?.astNode);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function $m(t,e,n){if(t.astNode!==n)return[];if(wr(t.grammarSource)&&t.grammarSource.value===e)return[t];const r=gd(t).iterator();let i;const s=[];do if(i=r.next(),!i.done){const a=i.value;a.astNode===n?wr(a.grammarSource)&&a.grammarSource.value===e&&s.push(a):r.prune()}while(!i.done);return s}function Sb(t){
var e;const n=t.astNode;for(;n===((e=t.container)===null||e===void 0?void 0:e.astNode);){const r=dn(t.grammarSource,vr);if(r)return r;t=t.container}}function Rm(t){let e=t;return hb(e)&&(es(e.$container)?e=e.$container.$container:en(e.$container)?e=e.$container:lo(e.$container)),Ab(t,e,new Map)}function Ab(t,e,n){var r;function i(s,a){let o;return dn(s,vr)||(o=Ab(a,a,n)),n.set(t,o),o}if(n.has(t))return n.get(t);n.set(t,void 0);for(const s of br(e)){if(vr(s)&&s.feature.toLowerCase()==="name")return n.
set(t,s),s;if(Lr(s)&&en(s.rule.ref))return i(s,s.rule.ref);if(mb(s)&&(!((r=s.typeRef)===null||r===void 0)&&r.ref))return i(s,s.typeRef.ref)}}function _b(t){const e=t.$container;if(vi(e)){const n=e.elements,r=n.indexOf(t);for(let i=r-1;i>=0;i--){const s=n[i];if(es(s))return s;{const a=br(n[i]).find(es);if(a)return a}}}if(rm(e))return _b(e)}function oa(t,e){return t==="?"||t==="*"||vi(e)&&!!e.guardCondition}function Cb(t){return t==="*"||t==="+"}function UD(t){return t==="+="}function Id(t){return Pb(
t,new Set)}function Pb(t,e){if(e.has(t))return!0;e.add(t);for(const n of br(t))if(Lr(n)){if(!n.rule.ref||en(n.rule.ref)&&!Pb(n.rule.ref,e))return!1}else{if(vr(n))return!1;if(es(n))return!1}return!!t.definition}function WD(t){return km(t.type,new Set)}function km(t,e){if(e.has(t))return!0;if(e.add(t),gD(t))return!1;if(RD(t))return!1;if(TD(t))return t.types.every(n=>km(n,e));if(mb(t)){if(t.primitiveType!==void 0)return!0;if(t.stringType!==void 0)return!0;if(t.typeRef!==void 0){const n=t.typeRef.ref;
return am(n)?km(n.type,e):!1}else return!1}else return!1}function ts(t){if(t.inferredType)return t.inferredType.name;if(t.dataType)return t.dataType;if(t.returnType){const e=t.returnType.ref;if(e){if(en(e))return e.name;if(pb(e)||am(e))return e.name}}}function Vo(t){var e;if(en(t))return Id(t)?t.name:(e=ts(t))!==null&&e!==void 0?e:t.name;if(pb(t)||am(t)||kD(t))return t.name;if(es(t)){const n=xb(t);if(n)return n}else if(hb(t))return t.name;throw new Error("Cannot get name of Unknown Type")}function xb(t){
var e;if(t.inferredType)return t.inferredType.name;if(!((e=t.type)===null||e===void 0)&&e.ref)return Vo(t.type.ref)}function HD(t){var e,n,r;return Or(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":Id(t)?t.name:(r=ts(t))!==null&&r!==void 0?r:t.name}function Db(t){var e,n,r;return Or(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":(r=ts(t))!==null&&r!==void 0?r:t.name}function Xo(t){const e={s:!1,i:!1,u:!1},n=ca(t.definition,e),r=Object.
entries(e).filter(([,i])=>i).map(([i])=>i).join("");return new RegExp(n,r)}const Tm=/[\s\S]/.source;function ca(t,e){if(CD(t))return KD(t);if(PD(t))return VD(t);if(ED(t))return JD(t);if(gb(t)){const n=t.rule.ref;if(!n)throw new Error("Missing rule reference.");return zr(ca(n.definition),{cardinality:t.cardinality,lookahead:t.lookahead})}else{if(AD(t))return YD(t);if(xD(t))return XD(t);if(_D(t)){const n=t.regex.lastIndexOf("/"),r=t.regex.substring(1,n),i=t.regex.substring(n+1);return e&&(e.i=i.includes(
"i"),e.s=i.includes("s"),e.u=i.includes("u")),zr(r,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}else{if(DD(t))return zr(Tm,{cardinality:t.cardinality,lookahead:t.lookahead});throw new Error(`Invalid terminal element: ${t?.$type}`)}}}function KD(t){return zr(t.elements.map(e=>ca(e)).join("|"),{cardinality:t.cardinality,lookahead:t.lookahead})}function VD(t){return zr(t.elements.map(e=>ca(e)).join(""),{cardinality:t.cardinality,lookahead:t.lookahead})}function XD(t){return zr(`${Tm}*\
?${ca(t.terminal)}`,{cardinality:t.cardinality,lookahead:t.lookahead})}function YD(t){return zr(`(?!${ca(t.terminal)})${Tm}*?`,{cardinality:t.cardinality,lookahead:t.lookahead})}function JD(t){return t.right?zr(`[${Em(t.left)}-${Em(t.right)}]`,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1}):zr(Em(t.left),{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}function Em(t){return Dd(t.value)}function zr(t,e){var n;return(e.wrap!==!1||e.lookahead)&&(t=`(${(n=e.lookahead)!==null&&n!==
void 0?n:""}${t})`),e.cardinality?`${t}${e.cardinality}`:t}const Sm={__proto__:null,findAssignment:Sb,findNameAssignment:Rm,findNodeForKeyword:Ko,findNodeForProperty:tn,findNodesForKeyword:bm,findNodesForKeywordInternal:$m,findNodesForProperty:aa,getActionAtElement:_b,getActionType:xb,getAllReachableRules:ym,getCrossReferenceTerminal:vm,getEntryRule:Nd,getExplicitRuleType:ts,getHiddenRules:kb,getRuleType:Db,getRuleTypeName:HD,getTypeName:Vo,isArrayCardinality:Cb,isArrayOperator:UD,isCommentTerminal:Eb,
isDataType:WD,isDataTypeRule:Id,isOptionalCardinality:oa,terminalRegex:Xo};function QD(t){const e=[],n=t.Grammar;for(const r of n.rules)Or(r)&&Eb(r)&&FD(Xo(r))&&e.push(r.name);return{multilineCommentRules:e,nameRegexp:ab}}var Nb=typeof global=="object"&&global&&global.Object===Object&&global,ZD=typeof self=="object"&&self&&self.Object===Object&&self,$r=Nb||ZD||Function("return this")(),Un=$r.Symbol,Ib=Object.prototype,eN=Ib.hasOwnProperty,tN=Ib.toString,Yo=Un?Un.toStringTag:void 0;function nN(t){
var e=eN.call(t,Yo),n=t[Yo];try{t[Yo]=void 0;var r=!0}catch{}var i=tN.call(t);return r&&(e?t[Yo]=n:delete t[Yo]),i}var rN=Object.prototype,iN=rN.toString;function sN(t){return iN.call(t)}var aN="[object Null]",oN="[object Undefined]",Ob=Un?Un.toStringTag:void 0;function bi(t){return t==null?t===void 0?oN:aN:Ob&&Ob in Object(t)?nN(t):sN(t)}function tr(t){return t!=null&&typeof t=="object"}var cN="[object Symbol]";function Jo(t){return typeof t=="symbol"||tr(t)&&bi(t)==cN}function Od(t,e){for(var n=-1,
r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var He=Array.isArray,Lb=Un?Un.prototype:void 0,Mb=Lb?Lb.toString:void 0;function zb(t){if(typeof t=="string")return t;if(He(t))return Od(t,zb)+"";if(Jo(t))return Mb?Mb.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var uN=/\s/;function lN(t){for(var e=t.length;e--&&uN.test(t.charAt(e)););return e}var dN=/^\s+/;function fN(t){return t&&t.slice(0,lN(t)+1).replace(dN,"")}function Wn(t){var e=typeof t;return t!=null&&(e=="object"||
e=="function")}var Fb=NaN,hN=/^[-+]0x[0-9a-f]+$/i,pN=/^0b[01]+$/i,mN=/^0o[0-7]+$/i,gN=parseInt;function yN(t){if(typeof t=="number")return t;if(Jo(t))return Fb;if(Wn(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Wn(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=fN(t);var n=pN.test(t);return n||mN.test(t)?gN(t.slice(2),n?2:8):hN.test(t)?Fb:+t}var vN=1/0,wN=17976931348623157e292;function bN(t){if(!t)return t===0?t:0;if(t=yN(t),t===vN||t===-1/0){var e=t<0?-1:1;return e*wN}return t===t?
t:0}function Ld(t){var e=bN(t),n=e%1;return e===e?n?e-n:e:0}function ns(t){return t}var $N="[object AsyncFunction]",RN="[object Function]",kN="[object GeneratorFunction]",TN="[object Proxy]";function Fr(t){if(!Wn(t))return!1;var e=bi(t);return e==RN||e==kN||e==$N||e==TN}var Am=$r["__core-js_shared__"],qb=function(){var t=/[^.]+$/.exec(Am&&Am.keys&&Am.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function EN(t){return!!qb&&qb in t}var SN=Function.prototype,AN=SN.toString;function rs(t){if(t!=
null){try{return AN.call(t)}catch{}try{return t+""}catch{}}return""}var _N=/[\\^$.*+?()[\]{}|]/g,CN=/^\[object .+?Constructor\]$/,PN=Function.prototype,xN=Object.prototype,DN=PN.toString,NN=xN.hasOwnProperty,IN=RegExp("^"+DN.call(NN).replace(_N,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ON(t){if(!Wn(t)||EN(t))return!1;var e=Fr(t)?IN:CN;return e.test(rs(t))}function LN(t,e){return t?.[e]}function is(t,e){var n=LN(t,e);return ON(n)?n:void 0}var _m=is(
$r,"WeakMap"),Gb=Object.create,MN=function(){function t(){}return function(e){if(!Wn(e))return{};if(Gb)return Gb(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function zN(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Nt(){}function FN(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var qN=800,GN=16,jN=Date.now;function BN(t){var e=0,
n=0;return function(){var r=jN(),i=GN-(r-n);if(n=r,i>0){if(++e>=qN)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function UN(t){return function(){return t}}var Md=function(){try{var t=is(Object,"defineProperty");return t({},"",{}),t}catch{}}(),WN=Md?function(t,e){return Md(t,"toString",{configurable:!0,enumerable:!1,value:UN(e),writable:!0})}:ns,HN=BN(WN);function jb(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function Bb(t,e,n,r){for(var i=t.length,
s=n+-1;++s<i;)if(e(t[s],s,t))return s;return-1}function KN(t){return t!==t}function VN(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Cm(t,e,n){return e===e?VN(t,e,n):Bb(t,KN,n)}function Ub(t,e){var n=t==null?0:t.length;return!!n&&Cm(t,e,0)>-1}var XN=9007199254740991,YN=/^(?:0|[1-9]\d*)$/;function zd(t,e){var n=typeof t;return e=e??XN,!!e&&(n=="number"||n!="symbol"&&YN.test(t))&&t>-1&&t%1==0&&t<e}function Pm(t,e,n){e=="__proto__"&&Md?Md(t,e,{configurable:!0,enumerable:!0,
value:n,writable:!0}):t[e]=n}function Qo(t,e){return t===e||t!==t&&e!==e}var JN=Object.prototype,QN=JN.hasOwnProperty;function Fd(t,e,n){var r=t[e];(!(QN.call(t,e)&&Qo(r,n))||n===void 0&&!(e in t))&&Pm(t,e,n)}function Zo(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],c=void 0;c===void 0&&(c=t[o]),i?Pm(n,o,c):Fd(n,o,c)}return n}var Wb=Math.max;function ZN(t,e,n){return e=Wb(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=Wb(r.length-e,0),a=Array(s);++i<s;)
a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),zN(t,this,o)}}function xm(t,e){return HN(ZN(t,e,ns),t+"")}var eI=9007199254740991;function Dm(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=eI}function Rr(t){return t!=null&&Dm(t.length)&&!Fr(t)}function Hb(t,e,n){if(!Wn(n))return!1;var r=typeof e;return(r=="number"?Rr(n)&&zd(e,n.length):r=="string"&&e in n)?Qo(n[e],t):!1}function tI(t){return xm(function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=
t.length>3&&typeof s=="function"?(i--,s):void 0,a&&Hb(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=n[r];o&&t(e,o,r,s)}return e})}var nI=Object.prototype;function ec(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||nI;return t===n}function rI(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var iI="[object Arguments]";function Kb(t){return tr(t)&&bi(t)==iI}var Vb=Object.prototype,sI=Vb.hasOwnProperty,aI=Vb.propertyIsEnumerable,qd=Kb(function(){return arguments}())?
Kb:function(t){return tr(t)&&sI.call(t,"callee")&&!aI.call(t,"callee")};function oI(){return!1}var Xb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Yb=Xb&&typeof module=="object"&&module&&!module.nodeType&&module,cI=Yb&&Yb.exports===Xb,Jb=cI?$r.Buffer:void 0,uI=Jb?Jb.isBuffer:void 0,tc=uI||oI,lI="[object Arguments]",dI="[object Array]",fI="[object Boolean]",hI="[object Date]",pI="[object Error]",mI="[object Function]",gI="[object Map]",yI="[object Number]",vI="[object Object]",wI="\
[object RegExp]",bI="[object Set]",$I="[object String]",RI="[object WeakMap]",kI="[object ArrayBuffer]",TI="[object DataView]",EI="[object Float32Array]",SI="[object Float64Array]",AI="[object Int8Array]",_I="[object Int16Array]",CI="[object Int32Array]",PI="[object Uint8Array]",xI="[object Uint8ClampedArray]",DI="[object Uint16Array]",NI="[object Uint32Array]",pt={};pt[EI]=pt[SI]=pt[AI]=pt[_I]=pt[CI]=pt[PI]=pt[xI]=pt[DI]=pt[NI]=!0,pt[lI]=pt[dI]=pt[kI]=pt[fI]=pt[TI]=pt[hI]=pt[pI]=pt[mI]=pt[gI]=pt[yI]=
pt[vI]=pt[wI]=pt[bI]=pt[$I]=pt[RI]=!1;function II(t){return tr(t)&&Dm(t.length)&&!!pt[bi(t)]}function Gd(t){return function(e){return t(e)}}var Qb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,nc=Qb&&typeof module=="object"&&module&&!module.nodeType&&module,OI=nc&&nc.exports===Qb,Nm=OI&&Nb.process,$i=function(){try{var t=nc&&nc.require&&nc.require("util").types;return t||Nm&&Nm.binding&&Nm.binding("util")}catch{}}(),Zb=$i&&$i.isTypedArray,Im=Zb?Gd(Zb):II,LI=Object.prototype,MI=LI.
hasOwnProperty;function e$(t,e){var n=He(t),r=!n&&qd(t),i=!n&&!r&&tc(t),s=!n&&!r&&!i&&Im(t),a=n||r||i||s,o=a?rI(t.length,String):[],c=o.length;for(var u in t)(e||MI.call(t,u))&&!(a&&(u=="length"||i&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||zd(u,c)))&&o.push(u);return o}function t$(t,e){return function(n){return t(e(n))}}var zI=t$(Object.keys,Object),FI=Object.prototype,qI=FI.hasOwnProperty;function n$(t){if(!ec(t))return zI(t);var e=[];for(var n in Object(t))
qI.call(t,n)&&n!="constructor"&&e.push(n);return e}function Hn(t){return Rr(t)?e$(t):n$(t)}var GI=Object.prototype,jI=GI.hasOwnProperty,Nn=tI(function(t,e){if(ec(e)||Rr(e)){Zo(e,Hn(e),t);return}for(var n in e)jI.call(e,n)&&Fd(t,n,e[n])});function BI(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var UI=Object.prototype,WI=UI.hasOwnProperty;function HI(t){if(!Wn(t))return BI(t);var e=ec(t),n=[];for(var r in t)r=="constructor"&&(e||!WI.call(t,r))||n.push(r);return n}function Om(t){
return Rr(t)?e$(t,!0):HI(t)}var KI=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,VI=/^\w*$/;function Lm(t,e){if(He(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Jo(t)?!0:VI.test(t)||!KI.test(t)||e!=null&&t in Object(e)}var rc=is(Object,"create");function XI(){this.__data__=rc?rc(null):{},this.size=0}function YI(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var JI="__lodash_hash_undefined__",QI=Object.prototype,ZI=QI.hasOwnProperty;
function eO(t){var e=this.__data__;if(rc){var n=e[t];return n===JI?void 0:n}return ZI.call(e,t)?e[t]:void 0}var tO=Object.prototype,nO=tO.hasOwnProperty;function rO(t){var e=this.__data__;return rc?e[t]!==void 0:nO.call(e,t)}var iO="__lodash_hash_undefined__";function sO(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rc&&e===void 0?iO:e,this}function ss(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ss.prototype.clear=XI,ss.prototype.delete=
YI,ss.prototype.get=eO,ss.prototype.has=rO,ss.prototype.set=sO;function aO(){this.__data__=[],this.size=0}function jd(t,e){for(var n=t.length;n--;)if(Qo(t[n][0],e))return n;return-1}var oO=Array.prototype,cO=oO.splice;function uO(t){var e=this.__data__,n=jd(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():cO.call(e,n,1),--this.size,!0}function lO(t){var e=this.__data__,n=jd(e,t);return n<0?void 0:e[n][1]}function dO(t){return jd(this.__data__,t)>-1}function fO(t,e){var n=this.__data__,r=jd(
n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function qr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}qr.prototype.clear=aO,qr.prototype.delete=uO,qr.prototype.get=lO,qr.prototype.has=dO,qr.prototype.set=fO;var ic=is($r,"Map");function hO(){this.size=0,this.__data__={hash:new ss,map:new(ic||qr),string:new ss}}function pO(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Bd(t,e){
var n=t.__data__;return pO(e)?n[typeof e=="string"?"string":"hash"]:n.map}function mO(t){var e=Bd(this,t).delete(t);return this.size-=e?1:0,e}function gO(t){return Bd(this,t).get(t)}function yO(t){return Bd(this,t).has(t)}function vO(t,e){var n=Bd(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Gr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Gr.prototype.clear=hO,Gr.prototype.delete=mO,Gr.prototype.get=gO,Gr.prototype.has=yO,
Gr.prototype.set=vO;var wO="Expected a function";function Mm(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(wO);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(Mm.Cache||Gr),n}Mm.Cache=Gr;var bO=500;function $O(t){var e=Mm(t,function(r){return n.size===bO&&n.clear(),r}),n=e.cache;return e}var RO=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,
kO=/\\(\\)?/g,TO=$O(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(RO,function(n,r,i,s){e.push(i?s.replace(kO,"$1"):r||n)}),e});function EO(t){return t==null?"":zb(t)}function Ud(t,e){return He(t)?t:Lm(t,e)?[t]:TO(EO(t))}function sc(t){if(typeof t=="string"||Jo(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function zm(t,e){e=Ud(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[sc(e[n++])];return n&&n==r?t:void 0}function SO(t,e,n){var r=t==null?void 0:zm(t,e);return r===
void 0?n:r}function Fm(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var r$=Un?Un.isConcatSpreadable:void 0;function AO(t){return He(t)||qd(t)||!!(r$&&t&&t[r$])}function qm(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=AO),i||(i=[]);++s<a;){var o=t[s];n(o)?Fm(i,o):r||(i[i.length]=o)}return i}function Kn(t){var e=t==null?0:t.length;return e?qm(t):[]}var i$=t$(Object.getPrototypeOf,Object);function s$(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>
0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}function _O(t,e,n,r){var i=-1,s=t==null?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function CO(){this.__data__=new qr,this.size=0}function PO(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function xO(t){return this.__data__.get(t)}function DO(t){return this.__data__.has(t)}var NO=200;function IO(t,e){var n=this.__data__;if(n instanceof qr){var r=n.__data__;if(!ic||r.length<NO-1)return r.push([t,e]),this.
size=++n.size,this;n=this.__data__=new Gr(r)}return n.set(t,e),this.size=n.size,this}function kr(t){var e=this.__data__=new qr(t);this.size=e.size}kr.prototype.clear=CO,kr.prototype.delete=PO,kr.prototype.get=xO,kr.prototype.has=DO,kr.prototype.set=IO;function OO(t,e){return t&&Zo(e,Hn(e),t)}function LO(t,e){return t&&Zo(e,Om(e),t)}var a$=typeof exports=="object"&&exports&&!exports.nodeType&&exports,o$=a$&&typeof module=="object"&&module&&!module.nodeType&&module,MO=o$&&o$.exports===a$,c$=MO?$r.
Buffer:void 0,u$=c$?c$.allocUnsafe:void 0;function zO(t,e){var n=t.length,r=u$?u$(n):new t.constructor(n);return t.copy(r),r}function Gm(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}function l$(){return[]}var FO=Object.prototype,qO=FO.propertyIsEnumerable,d$=Object.getOwnPropertySymbols,jm=d$?function(t){return t==null?[]:(t=Object(t),Gm(d$(t),function(e){return qO.call(t,e)}))}:l$;function GO(t,e){return Zo(t,jm(t),e)}var jO=Object.getOwnPropertySymbols,
f$=jO?function(t){for(var e=[];t;)Fm(e,jm(t)),t=i$(t);return e}:l$;function BO(t,e){return Zo(t,f$(t),e)}function h$(t,e,n){var r=e(t);return He(t)?r:Fm(r,n(t))}function Bm(t){return h$(t,Hn,jm)}function UO(t){return h$(t,Om,f$)}var Um=is($r,"DataView"),Wm=is($r,"Promise"),ua=is($r,"Set"),p$="[object Map]",WO="[object Object]",m$="[object Promise]",g$="[object Set]",y$="[object WeakMap]",v$="[object DataView]",HO=rs(Um),KO=rs(ic),VO=rs(Wm),XO=rs(ua),YO=rs(_m),Vn=bi;(Um&&Vn(new Um(new ArrayBuffer(
1)))!=v$||ic&&Vn(new ic)!=p$||Wm&&Vn(Wm.resolve())!=m$||ua&&Vn(new ua)!=g$||_m&&Vn(new _m)!=y$)&&(Vn=function(t){var e=bi(t),n=e==WO?t.constructor:void 0,r=n?rs(n):"";if(r)switch(r){case HO:return v$;case KO:return p$;case VO:return m$;case XO:return g$;case YO:return y$}return e});var JO=Object.prototype,QO=JO.hasOwnProperty;function ZO(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&QO.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var Wd=$r.Uint8Array;function e1(t){
var e=new t.constructor(t.byteLength);return new Wd(e).set(new Wd(t)),e}function t1(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var n1=/\w*$/;function r1(t){var e=new t.constructor(t.source,n1.exec(t));return e.lastIndex=t.lastIndex,e}var w$=Un?Un.prototype:void 0,b$=w$?w$.valueOf:void 0;function i1(t){return b$?Object(b$.call(t)):{}}function s1(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var a1="[object Boolean]",o1="[object Date]",c1="[ob\
ject Map]",u1="[object Number]",l1="[object RegExp]",d1="[object Set]",f1="[object String]",h1="[object Symbol]",p1="[object ArrayBuffer]",m1="[object DataView]",g1="[object Float32Array]",y1="[object Float64Array]",v1="[object Int8Array]",w1="[object Int16Array]",b1="[object Int32Array]",$1="[object Uint8Array]",R1="[object Uint8ClampedArray]",k1="[object Uint16Array]",T1="[object Uint32Array]";function E1(t,e,n){var r=t.constructor;switch(e){case p1:return e1(t);case a1:case o1:return new r(+t);case m1:
return t1(t);case g1:case y1:case v1:case w1:case b1:case $1:case R1:case k1:case T1:return s1(t);case c1:return new r;case u1:case f1:return new r(t);case l1:return r1(t);case d1:return new r;case h1:return i1(t)}}function S1(t){return typeof t.constructor=="function"&&!ec(t)?MN(i$(t)):{}}var A1="[object Map]";function _1(t){return tr(t)&&Vn(t)==A1}var $$=$i&&$i.isMap,C1=$$?Gd($$):_1,P1="[object Set]";function x1(t){return tr(t)&&Vn(t)==P1}var R$=$i&&$i.isSet,D1=R$?Gd(R$):x1,N1=2,k$="[object Ar\
guments]",I1="[object Array]",O1="[object Boolean]",L1="[object Date]",M1="[object Error]",T$="[object Function]",z1="[object GeneratorFunction]",F1="[object Map]",q1="[object Number]",E$="[object Object]",G1="[object RegExp]",j1="[object Set]",B1="[object String]",U1="[object Symbol]",W1="[object WeakMap]",H1="[object ArrayBuffer]",K1="[object DataView]",V1="[object Float32Array]",X1="[object Float64Array]",Y1="[object Int8Array]",J1="[object Int16Array]",Q1="[object Int32Array]",Z1="[object Ui\
nt8Array]",eL="[object Uint8ClampedArray]",tL="[object Uint16Array]",nL="[object Uint32Array]",lt={};lt[k$]=lt[I1]=lt[H1]=lt[K1]=lt[O1]=lt[L1]=lt[V1]=lt[X1]=lt[Y1]=lt[J1]=lt[Q1]=lt[F1]=lt[q1]=lt[E$]=lt[G1]=lt[j1]=lt[B1]=lt[U1]=lt[Z1]=lt[eL]=lt[tL]=lt[nL]=!0,lt[M1]=lt[T$]=lt[W1]=!1;function Hd(t,e,n,r,i,s){var a,o=e&N1;if(a!==void 0)return a;if(!Wn(t))return t;var c=He(t);if(c)return a=ZO(t),FN(t,a);var u=Vn(t),l=u==T$||u==z1;if(tc(t))return zO(t);if(u==E$||u==k$||l&&!i)return a=l?{}:S1(t),o?BO(t,
LO(a,t)):GO(t,OO(a,t));if(!lt[u])return i?t:{};a=E1(t,u),s||(s=new kr);var f=s.get(t);if(f)return f;s.set(t,a),D1(t)?t.forEach(function(m){a.add(Hd(m,e,n,m,t,s))}):C1(t)&&t.forEach(function(m,b){a.set(b,Hd(m,e,n,b,t,s))});var d=Bm,h=c?void 0:d(t);return jb(h||t,function(m,b){h&&(b=m,m=t[b]),Fd(a,b,Hd(m,e,n,b,t,s))}),a}var rL=4;function Wt(t){return Hd(t,rL)}function ac(t){for(var e=-1,n=t==null?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i}var iL="__lodash_hash_undefined__";function sL(t){
return this.__data__.set(t,iL),this}function aL(t){return this.__data__.has(t)}function la(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Gr;++e<n;)this.add(t[e])}la.prototype.add=la.prototype.push=sL,la.prototype.has=aL;function S$(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Hm(t,e){return t.has(e)}var oL=1,cL=2;function A$(t,e,n,r,i,s){var a=n&oL,o=t.length,c=e.length;if(o!=c&&!(a&&c>o))return!1;var u=s.get(t),l=s.get(e);if(u&&l)return u==e&&
l==t;var f=-1,d=!0,h=n&cL?new la:void 0;for(s.set(t,e),s.set(e,t);++f<o;){var m=t[f],b=e[f];if(r)var $=a?r(b,m,f,e,t,s):r(m,b,f,t,e,s);if($!==void 0){if($)continue;d=!1;break}if(h){if(!S$(e,function(w,k){if(!Hm(h,k)&&(m===w||i(m,w,n,r,s)))return h.push(k)})){d=!1;break}}else if(!(m===b||i(m,b,n,r,s))){d=!1;break}}return s.delete(t),s.delete(e),d}function uL(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}function Km(t){var e=-1,n=Array(t.size);return t.forEach(function(r){
n[++e]=r}),n}var lL=1,dL=2,fL="[object Boolean]",hL="[object Date]",pL="[object Error]",mL="[object Map]",gL="[object Number]",yL="[object RegExp]",vL="[object Set]",wL="[object String]",bL="[object Symbol]",$L="[object ArrayBuffer]",RL="[object DataView]",_$=Un?Un.prototype:void 0,Vm=_$?_$.valueOf:void 0;function kL(t,e,n,r,i,s,a){switch(n){case RL:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case $L:return!(t.byteLength!=e.byteLength||!s(new Wd(t),new Wd(
e)));case fL:case hL:case gL:return Qo(+t,+e);case pL:return t.name==e.name&&t.message==e.message;case yL:case wL:return t==e+"";case mL:var o=uL;case vL:var c=r&lL;if(o||(o=Km),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;r|=dL,a.set(t,e);var l=A$(o(t),o(e),r,i,s,a);return a.delete(t),l;case bL:if(Vm)return Vm.call(t)==Vm.call(e)}return!1}var TL=1,EL=Object.prototype,SL=EL.hasOwnProperty;function AL(t,e,n,r,i,s){var a=n&TL,o=Bm(t),c=o.length,u=Bm(e),l=u.length;if(c!=l&&!a)return!1;
for(var f=c;f--;){var d=o[f];if(!(a?d in e:SL.call(e,d)))return!1}var h=s.get(t),m=s.get(e);if(h&&m)return h==e&&m==t;var b=!0;s.set(t,e),s.set(e,t);for(var $=a;++f<c;){d=o[f];var w=t[d],k=e[d];if(r)var S=a?r(k,w,d,e,t,s):r(w,k,d,t,e,s);if(!(S===void 0?w===k||i(w,k,n,r,s):S)){b=!1;break}$||($=d=="constructor")}if(b&&!$){var D=t.constructor,F=e.constructor;D!=F&&"constructor"in t&&"constructor"in e&&!(typeof D=="function"&&D instanceof D&&typeof F=="function"&&F instanceof F)&&(b=!1)}return s.delete(
t),s.delete(e),b}var _L=1,C$="[object Arguments]",P$="[object Array]",Kd="[object Object]",CL=Object.prototype,x$=CL.hasOwnProperty;function PL(t,e,n,r,i,s){var a=He(t),o=He(e),c=a?P$:Vn(t),u=o?P$:Vn(e);c=c==C$?Kd:c,u=u==C$?Kd:u;var l=c==Kd,f=u==Kd,d=c==u;if(d&&tc(t)){if(!tc(e))return!1;a=!0,l=!1}if(d&&!l)return s||(s=new kr),a||Im(t)?A$(t,e,n,r,i,s):kL(t,e,c,n,r,i,s);if(!(n&_L)){var h=l&&x$.call(t,"__wrapped__"),m=f&&x$.call(e,"__wrapped__");if(h||m){var b=h?t.value():t,$=m?e.value():e;return s||
(s=new kr),i(b,$,n,r,s)}}return d?(s||(s=new kr),AL(t,e,n,r,i,s)):!1}function Xm(t,e,n,r,i){return t===e?!0:t==null||e==null||!tr(t)&&!tr(e)?t!==t&&e!==e:PL(t,e,n,r,Xm,i)}var xL=1,DL=2;function NL(t,e,n,r){var i=n.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var a=n[i];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=n[i];var o=a[0],c=t[o],u=a[1];if(a[2]){if(c===void 0&&!(o in t))return!1}else{var l=new kr,f;if(!(f===void 0?Xm(u,c,xL|DL,r,l):f))return!1}}return!0}function D$(t){
return t===t&&!Wn(t)}function IL(t){for(var e=Hn(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,D$(i)]}return e}function N$(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function OL(t){var e=IL(t);return e.length==1&&e[0][2]?N$(e[0][0],e[0][1]):function(n){return n===t||NL(n,t,e)}}function LL(t,e){return t!=null&&e in Object(t)}function I$(t,e,n){e=Ud(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var a=sc(e[r]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++r!=
i?s:(i=t==null?0:t.length,!!i&&Dm(i)&&zd(a,i)&&(He(t)||qd(t)))}function ML(t,e){return t!=null&&I$(t,e,LL)}var zL=1,FL=2;function qL(t,e){return Lm(t)&&D$(e)?N$(sc(t),e):function(n){var r=SO(n,t);return r===void 0&&r===e?ML(n,t):Xm(e,r,zL|FL)}}function GL(t){return function(e){return e?.[t]}}function jL(t){return function(e){return zm(e,t)}}function BL(t){return Lm(t)?GL(sc(t)):jL(t)}function nr(t){return typeof t=="function"?t:t==null?ns:typeof t=="object"?He(t)?qL(t[0],t[1]):OL(t):BL(t)}function UL(t,e,n,r){
for(var i=-1,s=t==null?0:t.length;++i<s;){var a=t[i];e(r,a,n(a),t)}return r}function WL(t){return function(e,n,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var c=a[++i];if(n(s[c],c,s)===!1)break}return e}}var HL=WL();function KL(t,e){return t&&HL(t,e,Hn)}function VL(t,e){return function(n,r){if(n==null)return n;if(!Rr(n))return t(n,r);for(var i=n.length,s=-1,a=Object(n);++s<i&&r(a[s],s,a)!==!1;);return n}}var as=VL(KL);function XL(t,e,n,r){return as(t,function(i,s,a){e(r,i,n(i),a)}),r}function YL(t,e){
return function(n,r){var i=He(n)?UL:XL,s=e?e():{};return i(n,t,nr(r),s)}}var O$=Object.prototype,JL=O$.hasOwnProperty,Ym=xm(function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&Hb(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],a=Om(s),o=-1,c=a.length;++o<c;){var u=a[o],l=t[u];(l===void 0||Qo(l,O$[u])&&!JL.call(t,u))&&(t[u]=s[u])}return t});function L$(t){return tr(t)&&Rr(t)}var QL=200;function ZL(t,e,n,r){var i=-1,s=Ub,a=!0,o=t.length,c=[],u=e.length;if(!o)return c;e.length>=QL&&(s=
Hm,a=!1,e=new la(e));e:for(;++i<o;){var l=t[i],f=l;if(l=l!==0?l:0,a&&f===f){for(var d=u;d--;)if(e[d]===f)continue e;c.push(l)}else s(e,f,r)||c.push(l)}return c}var Vd=xm(function(t,e){return L$(t)?ZL(t,qm(e,1,L$,!0)):[]});function da(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function Ht(t,e,n){var r=t==null?0:t.length;return r?(e=e===void 0?1:Ld(e),s$(t,e<0?0:e,r)):[]}function oc(t,e,n){var r=t==null?0:t.length;return r?(e=e===void 0?1:Ld(e),e=r-e,s$(t,0,e<0?0:e)):[]}function eM(t){return typeof t==
"function"?t:ns}function Te(t,e){var n=He(t)?jb:as;return n(t,eM(e))}function tM(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function nM(t,e){var n=!0;return as(t,function(r,i,s){return n=!!e(r,i,s),n}),n}function rr(t,e,n){var r=He(t)?tM:nM;return r(t,nr(e))}function M$(t,e){var n=[];return as(t,function(r,i,s){e(r,i,s)&&n.push(r)}),n}function In(t,e){var n=He(t)?Gm:M$;return n(t,nr(e))}function rM(t){return function(e,n,r){var i=Object(e);if(!Rr(e)){var s=nr(
n);e=Hn(e),n=function(o){return s(i[o],o,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:void 0}}var iM=Math.max;function sM(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:Ld(n);return i<0&&(i=iM(r+i,0)),Bb(t,nr(e),i)}var fa=rM(sM);function ir(t){return t&&t.length?t[0]:void 0}function aM(t,e){var n=-1,r=Rr(t)?Array(t.length):[];return as(t,function(i,s,a){r[++n]=e(i,s,a)}),r}function ge(t,e){var n=He(t)?Od:aM;return n(t,nr(e))}function On(t,e){return qm(ge(t,e))}var oM=Object.prototype,
cM=oM.hasOwnProperty,uM=YL(function(t,e,n){cM.call(t,n)?t[n].push(e):Pm(t,n,[e])}),lM=Object.prototype,dM=lM.hasOwnProperty;function fM(t,e){return t!=null&&dM.call(t,e)}function Ee(t,e){return t!=null&&I$(t,e,fM)}var hM="[object String]";function Rn(t){return typeof t=="string"||!He(t)&&tr(t)&&bi(t)==hM}function pM(t,e){return Od(e,function(n){return t[n]})}function It(t){return t==null?[]:pM(t,Hn(t))}var mM=Math.max;function fn(t,e,n,r){t=Rr(t)?t:It(t),n=n?Ld(n):0;var i=t.length;return n<0&&(n=
mM(i+n,0)),Rn(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Cm(t,e,n)>-1}function z$(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=0;return Cm(t,e,i)}var gM="[object Map]",yM="[object Set]",vM=Object.prototype,wM=vM.hasOwnProperty;function st(t){if(t==null)return!0;if(Rr(t)&&(He(t)||typeof t=="string"||typeof t.splice=="function"||tc(t)||Im(t)||qd(t)))return!t.length;var e=Vn(t);if(e==gM||e==yM)return!t.size;if(ec(t))return!n$(t).length;for(var n in t)if(wM.call(t,n))return!1;return!0}var bM="[object R\
egExp]";function $M(t){return tr(t)&&bi(t)==bM}var F$=$i&&$i.isRegExp,jr=F$?Gd(F$):$M;function Br(t){return t===void 0}function RM(t,e){return t<e}function kM(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(a!=null&&(o===void 0?a===a&&!Jo(a):n(a,o)))var o=a,c=s}return c}function TM(t){return t&&t.length?kM(t,ns,RM):void 0}var EM="Expected a function";function SM(t){if(typeof t!="function")throw new TypeError(EM);return function(){var e=arguments;switch(e.length){case 0:return!t.call(
this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function AM(t,e,n,r){if(!Wn(t))return t;e=Ud(e,t);for(var i=-1,s=e.length,a=s-1,o=t;o!=null&&++i<s;){var c=sc(e[i]),u=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(i!=a){var l=o[c];u=void 0,u===void 0&&(u=Wn(l)?l:zd(e[i+1])?[]:{})}Fd(o,c,u),o=o[c]}return t}function _M(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=zm(t,a);n(
o,a)&&AM(s,Ud(a,t),o)}return s}function sr(t,e){if(t==null)return{};var n=Od(UO(t),function(r){return[r]});return e=nr(e),_M(t,n,function(r,i){return e(r,i[0])})}function CM(t,e,n,r,i){return i(t,function(s,a,o){n=r?(r=!1,s):e(n,s,a,o)}),n}function hn(t,e,n){var r=He(t)?_O:CM,i=arguments.length<3;return r(t,nr(e),n,i,as)}function Xd(t,e){var n=He(t)?Gm:M$;return n(t,SM(nr(e)))}function PM(t,e){var n;return as(t,function(r,i,s){return n=e(r,i,s),!n}),!!n}function q$(t,e,n){var r=He(t)?S$:PM;return r(
t,nr(e))}var xM=1/0,DM=ua&&1/Km(new ua([,-0]))[1]==xM?function(t){return new ua(t)}:Nt,NM=200;function G$(t,e,n){var r=-1,i=Ub,s=t.length,a=!0,o=[],c=o;if(s>=NM){var u=e?null:DM(t);if(u)return Km(u);a=!1,i=Hm,c=new la}else c=e?[]:o;e:for(;++r<s;){var l=t[r],f=e?e(l):l;if(l=l!==0?l:0,a&&f===f){for(var d=c.length;d--;)if(c[d]===f)continue e;e&&c.push(f),o.push(l)}else i(c,f,n)||(c!==o&&c.push(f),o.push(l))}return o}function Jm(t){return t&&t.length?G$(t):[]}function IM(t,e){return t&&t.length?G$(t,
nr(e)):[]}function Qm(t){console&&console.error&&console.error(`Error: ${t}`)}function j$(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function B$(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function U$(t){function e(){}e.prototype=t;const n=new e;function r(){return typeof n.bar}return r(),r(),t}function OM(t){return LM(t)?t.LABEL:t.name}function LM(t){return Rn(t.LABEL)&&t.LABEL!==""}class Tr{get definition(){return this._definition}set definition(e){
this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Te(this.definition,n=>{n.accept(e)})}}class pn extends Tr{constructor(e){super([]),this.idx=1,Nn(this,sr(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class ha extends Tr{constructor(e){super(e.definition),this.orgText="",Nn(this,sr(e,n=>n!==void 0))}}class kn extends Tr{constructor(e){super(e.definition),this.ignoreAmbiguities=
!1,Nn(this,sr(e,n=>n!==void 0))}}class Kt extends Tr{constructor(e){super(e.definition),this.idx=1,Nn(this,sr(e,n=>n!==void 0))}}class Ln extends Tr{constructor(e){super(e.definition),this.idx=1,Nn(this,sr(e,n=>n!==void 0))}}class Mn extends Tr{constructor(e){super(e.definition),this.idx=1,Nn(this,sr(e,n=>n!==void 0))}}class $t extends Tr{constructor(e){super(e.definition),this.idx=1,Nn(this,sr(e,n=>n!==void 0))}}class Tn extends Tr{constructor(e){super(e.definition),this.idx=1,Nn(this,sr(e,n=>n!==
void 0))}}class En extends Tr{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Nn(this,sr(e,n=>n!==void 0))}}class mt{constructor(e){this.idx=1,Nn(this,sr(e,n=>n!==void 0))}accept(e){e.visit(this)}}function MM(t){return ge(t,Yd)}function Yd(t){function e(n){return ge(n,Yd)}if(t instanceof pn){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return Rn(t.label)&&(n.
label=t.label),n}else{if(t instanceof kn)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Kt)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof Ln)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof Mn)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:Yd(new mt({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Tn)return{type:"RepetitionWithSeparator",idx:t.idx,separator:Yd(new mt(
{terminalType:t.separator})),definition:e(t.definition)};if(t instanceof $t)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof En)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof mt){const n={type:"Terminal",name:t.terminalType.name,label:OM(t.terminalType),idx:t.idx};Rn(t.label)&&(n.terminalLabel=t.label);const r=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=jr(r)?r.source:r),n}else{if(t instanceof ha)return{type:"Rul\
e",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class pa{visit(e){const n=e;switch(n.constructor){case pn:return this.visitNonTerminal(n);case kn:return this.visitAlternative(n);case Kt:return this.visitOption(n);case Ln:return this.visitRepetitionMandatory(n);case Mn:return this.visitRepetitionMandatoryWithSeparator(n);case Tn:return this.visitRepetitionWithSeparator(n);case $t:return this.visitRepetition(n);case En:return this.visitAlternation(
n);case mt:return this.visitTerminal(n);case ha:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function zM(t){return t instanceof kn||t instanceof Kt||t instanceof $t||t instanceof Ln||t instanceof Mn||t instanceof Tn||t instanceof mt||t instanceof
ha}function Jd(t,e=[]){return t instanceof Kt||t instanceof $t||t instanceof Tn?!0:t instanceof En?q$(t.definition,r=>Jd(r,e)):t instanceof pn&&fn(e,t)?!1:t instanceof Tr?(t instanceof pn&&e.push(t),rr(t.definition,r=>Jd(r,e))):!1}function FM(t){return t instanceof En}function Er(t){if(t instanceof pn)return"SUBRULE";if(t instanceof Kt)return"OPTION";if(t instanceof En)return"OR";if(t instanceof Ln)return"AT_LEAST_ONE";if(t instanceof Mn)return"AT_LEAST_ONE_SEP";if(t instanceof Tn)return"MANY_SE\
P";if(t instanceof $t)return"MANY";if(t instanceof mt)return"CONSUME";throw Error("non exhaustive match")}class Qd{walk(e,n=[]){Te(e.definition,(r,i)=>{const s=Ht(e.definition,i+1);if(r instanceof pn)this.walkProdRef(r,s,n);else if(r instanceof mt)this.walkTerminal(r,s,n);else if(r instanceof kn)this.walkFlat(r,s,n);else if(r instanceof Kt)this.walkOption(r,s,n);else if(r instanceof Ln)this.walkAtLeastOne(r,s,n);else if(r instanceof Mn)this.walkAtLeastOneSep(r,s,n);else if(r instanceof Tn)this.walkManySep(
r,s,n);else if(r instanceof $t)this.walkMany(r,s,n);else if(r instanceof En)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,r){}walkProdRef(e,n,r){}walkFlat(e,n,r){const i=n.concat(r);this.walk(e,i)}walkOption(e,n,r){const i=n.concat(r);this.walk(e,i)}walkAtLeastOne(e,n,r){const i=[new Kt({definition:e.definition})].concat(n,r);this.walk(e,i)}walkAtLeastOneSep(e,n,r){const i=W$(e,n,r);this.walk(e,i)}walkMany(e,n,r){const i=[new Kt({definition:e.definition})].concat(
n,r);this.walk(e,i)}walkManySep(e,n,r){const i=W$(e,n,r);this.walk(e,i)}walkOr(e,n,r){const i=n.concat(r);Te(e.definition,s=>{const a=new kn({definition:[s]});this.walk(a,i)})}}function W$(t,e,n){return[new Kt({definition:[new mt({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function cc(t){if(t instanceof pn)return cc(t.referencedRule);if(t instanceof mt)return jM(t);if(zM(t))return qM(t);if(FM(t))return GM(t);throw Error("non exhaustive match")}function qM(t){let e=[];const n=t.
definition;let r=0,i=n.length>r,s,a=!0;for(;i&&a;)s=n[r],a=Jd(s),e=e.concat(cc(s)),r=r+1,i=n.length>r;return Jm(e)}function GM(t){const e=ge(t.definition,n=>cc(n));return Jm(Kn(e))}function jM(t){return[t.terminalType]}const H$="_~IN~_";class BM extends Qd{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,r){}walkProdRef(e,n,r){const i=WM(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(r),a=new kn({definition:s}),
o=cc(a);this.follows[i]=o}}function UM(t){const e={};return Te(t,n=>{const r=new BM(n).startWalking();Nn(e,r)}),e}function WM(t,e){return t.name+e+H$}let Zd={};const HM=new $b;function ef(t){const e=t.toString();if(Zd.hasOwnProperty(e))return Zd[e];{const n=HM.pattern(e);return Zd[e]=n,n}}function KM(){Zd={}}const K$="Complement Sets are not supported for first char optimization",tf=`Unable to use "first char" lexer optimizations:
`;function VM(t,e=!1){try{const n=ef(t);return Zm(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===K$)e&&j$(`${tf}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Qm(`${tf}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Zm(t,e,n){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)Zm(t.value[i],e,n);break;case"Alternative":const r=t.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":nf(a.value,e,n);break;case"\
Set":if(a.complement===!0)throw Error(K$);Te(a.value,c=>{if(typeof c=="number")nf(c,e,n);else{const u=c;if(n===!0)for(let l=u.from;l<=u.to;l++)nf(l,e,n);else{for(let l=u.from;l<=u.to&&l<lc;l++)nf(l,e,n);if(u.to>=lc){const l=u.from>=lc?u.from:lc,f=u.to,d=Ri(l),h=Ri(f);for(let m=d;m<=h;m++)e[m]=m}}}});break;case"Group":Zm(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&eg(a)===!1||a.type!=="Group"&&o===!1)break}
break;default:throw Error("non exhaustive match!")}return It(e)}function nf(t,e,n){const r=Ri(t);e[r]=r,n===!0&&XM(t,e)}function XM(t,e){const n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){const i=Ri(r.charCodeAt(0));e[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=Ri(i.charCodeAt(0));e[s]=s}}}function V$(t,e){return fa(t.value,n=>{if(typeof n=="number")return fn(e,n);{const r=n;return fa(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function eg(t){const e=t.quantifier;return e&&e.atLeast===0?
!0:t.value?He(t.value)?rr(t.value,eg):eg(t.value):!1}class YM extends xd{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){fn(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?V$(e,this.targetCharCodes)===void 0&&(this.found=!0):V$(e,this.targetCharCodes)!==void 0&&
(this.found=!0)}}function tg(t,e){if(e instanceof RegExp){const n=ef(e),r=new YM(t);return r.visit(n),r.found}else return fa(e,n=>fn(t,n.charCodeAt(0)))!==void 0}const os="PATTERN",uc="defaultMode",rf="modes";let X$=typeof new RegExp("(?:)").sticky=="boolean";function JM(t,e){e=Ym(e,{useSticky:X$,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(k,S)=>S()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{bz()});let r;n("Reject Lexer.NA",()=>{r=Xd(t,k=>k[os]===Sn.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=ge(r,k=>{const S=k[os];if(jr(S)){const D=S.source;return D.length===1&&D!=="^"&&D!=="$"&&D!=="."&&!S.ignoreCase?D:D.length===2&&D[0]==="\\"&&!fn(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],D[1])?D[1]:e.useSticky?J$(S):Y$(S)}else{if(Fr(S))return i=!0,{exec:S};if(typeof S=="object")return i=
!0,S;if(typeof S=="string"){if(S.length===1)return S;{const D=S.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),F=new RegExp(D);return e.useSticky?J$(F):Y$(F)}}else throw Error("non exhaustive match")}})});let a,o,c,u,l;n("misc mapping",()=>{a=ge(r,k=>k.tokenTypeIdx),o=ge(r,k=>{const S=k.GROUP;if(S!==Sn.SKIPPED){if(Rn(S))return S;if(Br(S))return!1;throw Error("non exhaustive match")}}),c=ge(r,k=>{const S=k.LONGER_ALT;if(S)return He(S)?ge(S,F=>z$(r,F)):[z$(r,S)]}),u=ge(r,k=>k.PUSH_MODE),l=ge(r,k=>Ee(k,"POP\
_MODE"))});let f;n("Line Terminator Handling",()=>{const k=eR(e.lineTerminatorCharacters);f=ge(r,S=>!1),e.positionTracking!=="onlyOffset"&&(f=ge(r,S=>Ee(S,"LINE_BREAKS")?!!S.LINE_BREAKS:Z$(S,k)===!1&&tg(k,S.PATTERN)))});let d,h,m,b;n("Misc Mapping #2",()=>{d=ge(r,Q$),h=ge(s,yz),m=hn(r,(k,S)=>{const D=S.GROUP;return Rn(D)&&D!==Sn.SKIPPED&&(k[D]=[]),k},{}),b=ge(s,(k,S)=>({pattern:s[S],longerAlt:c[S],canLineTerminator:f[S],isCustom:d[S],short:h[S],group:o[S],push:u[S],pop:l[S],tokenTypeIdx:a[S],tokenType:r[S]}))});
let $=!0,w=[];return e.safeMode||n("First Char Optimization",()=>{w=hn(r,(k,S,D)=>{if(typeof S.PATTERN=="string"){const F=S.PATTERN.charCodeAt(0),Y=Ri(F);ng(k,Y,b[D])}else if(He(S.START_CHARS_HINT)){let F;Te(S.START_CHARS_HINT,Y=>{const J=typeof Y=="string"?Y.charCodeAt(0):Y,ie=Ri(J);F!==ie&&(F=ie,ng(k,ie,b[D]))})}else if(jr(S.PATTERN))if(S.PATTERN.unicode)$=!1,e.ensureOptimizations&&Qm(`${tf}	Unable to analyze < ${S.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const F=VM(S.PATTERN,e.ensureOptimizations);st(F)&&($=!1),Te(F,Y=>{ng(k,Y,b[D])})}else e.ensureOptimizations&&Qm(`${tf}	TokenType: <${S.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),$=!1;return k},[])}),{emptyGroups:m,patternIdxToConfig:b,charCodeToPatternIdxToConfig:w,hasCustom:i,canBeOptimized:$}}function QM(t,e){let n=[];const r=ez(t);n=n.concat(r.errors);const i=tz(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(ZM(s)),n=n.concat(uz(s)),n=n.concat(lz(s,e)),n=n.concat(dz(s)),n}function ZM(t){let e=[];const n=In(t,r=>jr(r[os]));return e=e.concat(rz(n)),e=e.concat(az(
n)),e=e.concat(oz(n)),e=e.concat(cz(n)),e=e.concat(iz(n)),e}function ez(t){const e=In(t,i=>!Ee(i,os)),n=ge(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Rt.MISSING_PATTERN,tokenTypes:[i]})),r=Vd(t,e);return{errors:n,valid:r}}function tz(t){const e=In(t,i=>{const s=i[os];return!jr(s)&&!Fr(s)&&!Ee(s,"exec")&&!Rn(s)}),n=ge(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or \
an Object matching the {ICustomPattern} interface.",type:Rt.INVALID_PATTERN,tokenTypes:[i]})),r=Vd(t,e);return{errors:n,valid:r}}const nz=/[^\\][$]/;function rz(t){class e extends xd{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=In(t,i=>{const s=i.PATTERN;try{const a=ef(s),o=new e;return o.visit(a),o.found}catch{return nz.test(s.source)}});return ge(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Rt.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function iz(t){const e=In(t,r=>r.PATTERN.test(""));return ge(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:Rt.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const sz=/[^\\[][\^]|^\^/;function az(t){class e extends xd{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=In(t,i=>{const s=i.PATTERN;
try{const a=ef(s),o=new e;return o.visit(a),o.found}catch{return sz.test(s.source)}});return ge(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Rt.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function oz(t){const e=In(t,r=>{const i=r[os];return i instanceof RegExp&&(i.multiline||i.global)});return ge(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Rt.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function cz(t){const e=[];let n=ge(t,s=>hn(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!fn(e,o)&&o.
PATTERN!==Sn.NA&&(e.push(o),a.push(o)),a),[]));n=ac(n);const r=In(n,s=>s.length>1);return ge(r,s=>{const a=ge(s,c=>c.name);return{message:`The same RegExp pattern ->${ir(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:Rt.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function uz(t){const e=In(t,r=>{if(!Ee(r,"GROUP"))return!1;const i=r.GROUP;return i!==Sn.SKIPPED&&i!==Sn.NA&&!Rn(i)});return ge(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be\
 Lexer.SKIPPED/Lexer.NA/A String",type:Rt.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function lz(t,e){const n=In(t,i=>i.PUSH_MODE!==void 0&&!fn(e,i.PUSH_MODE));return ge(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:Rt.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function dz(t){const e=[],n=hn(t,(r,i,s)=>{const a=i.PATTERN;return a===Sn.NA||(Rn(a)?r.push({str:a,idx:s,tokenType:i}):jr(a)&&hz(a)&&r.push({str:a.
source,idx:s,tokenType:i})),r},[]);return Te(t,(r,i)=>{Te(n,({str:s,idx:a,tokenType:o})=>{if(i<a&&fz(s,r.PATTERN)){const c=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:Rt.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function fz(t,e){if(jr(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(Fr(e))return e(t,0,[],{});if(Ee(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function hz(t){return fa([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function Y$(t){
const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function J$(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function pz(t,e,n){const r=[];return Ee(t,uc)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+uc+`> property in its definition
`,type:Rt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ee(t,rf)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+rf+`> property in its definition
`,type:Rt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ee(t,rf)&&Ee(t,uc)&&!Ee(t.modes,t.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${uc}: <${t.defaultMode}>which does not exist
`,type:Rt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ee(t,rf)&&Te(t.modes,(i,s)=>{Te(i,(a,o)=>{if(Br(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:Rt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Ee(a,"LONGER_ALT")){const c=He(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];Te(c,u=>{!Br(u)&&!fn(i,u)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${u.name}> on token <${a.name}> outside of mode <${s}>
`,type:Rt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function mz(t,e,n){const r=[];let i=!1;const s=ac(Kn(It(t.modes))),a=Xd(s,c=>c[os]===Sn.NA),o=eR(n);return e&&Te(a,c=>{const u=Z$(c,o);if(u!==!1){const f={message:wz(c,u),type:u.issue,tokenType:c};r.push(f)}else Ee(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(i=!0):tg(o,c.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Rt.NO_LINE_BREAKS_FLAGS}),r}function gz(t){const e={},n=Hn(t);return Te(n,r=>{const i=t[r];if(He(i))e[r]=[];else throw Error("non exhaustive match")}),e}function Q$(t){const e=t.PATTERN;if(jr(e))return!1;if(Fr(e))return!0;if(Ee(e,"exec"))return!0;if(Rn(e))return!1;throw Error("non exhaustive match")}function yz(t){return Rn(t)&&t.length===1?t.charCodeAt(0):!1}const vz={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const r=t.charCodeAt(n);if(r===10)return this.
lastIndex=n+1,!0;if(r===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Z$(t,e){if(Ee(t,"LINE_BREAKS"))return!1;if(jr(t.PATTERN)){try{tg(e,t.PATTERN)}catch(n){return{issue:Rt.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(Rn(t.PATTERN))return!1;if(Q$(t))return{issue:Rt.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function wz(t,e){if(e.issue===Rt.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usag\
e in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===Rt.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function eR(t){return ge(t,n=>Rn(n)?n.charCodeAt(0):n)}function ng(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const lc=256;let sf=[];function Ri(t){return t<lc?t:sf[t]}function bz(){if(st(sf)){sf=new Array(65536);for(let t=0;t<65536;t++)sf[t]=t>255?255+~~(t/255):t}}function dc(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===
!0}function af(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let tR=1;const nR={};function fc(t){const e=$z(t);Rz(e),Tz(e),kz(e),Te(e,n=>{n.isParent=n.categoryMatches.length>0})}function $z(t){let e=Wt(t),n=t,r=!0;for(;r;){n=ac(Kn(ge(n,s=>s.CATEGORIES)));const i=Vd(n,e);e=e.concat(i),st(i)?r=!1:n=i}return e}function Rz(t){Te(t,e=>{iR(e)||(nR[tR]=e,e.tokenTypeIdx=tR++),sR(e)&&!He(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),sR(e)||(e.CATEGORIES=[]),Ez(e)||(e.categoryMatches=[]),Sz(e)||(e.categoryMatchesMap=
{})})}function kz(t){Te(t,e=>{e.categoryMatches=[],Te(e.categoryMatchesMap,(n,r)=>{e.categoryMatches.push(nR[r].tokenTypeIdx)})})}function Tz(t){Te(t,e=>{rR([],e)})}function rR(t,e){Te(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),Te(e.CATEGORIES,n=>{const r=t.concat(e);fn(r,n)||rR(r,n)})}function iR(t){return Ee(t,"tokenTypeIdx")}function sR(t){return Ee(t,"CATEGORIES")}function Ez(t){return Ee(t,"categoryMatches")}function Sz(t){return Ee(t,"categoryMatchesMap")}function Az(t){return Ee(t,"t\
okenTypeIdx")}const rg={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,r,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var Rt;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.
DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=
10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Rt||(Rt={}));const hc={deferDefinitionErrorsHandling:!1,
positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:rg,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(hc);class Sn{constructor(e,n=hc){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.
traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:c}=B$(s),u=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Nn({},hc,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===hc.lineTerminatorsPattern)this.config.lineTerminatorsPattern=vz;else if(this.config.lineTerminatorCharacters===
hc.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),He(e)?i={modes:{defaultMode:Wt(e)},defaultMode:uc}:(s=!1,i=Wt(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",
()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(pz(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(mz(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},Te(i.modes,(o,c)=>{i.modes[c]=Xd(o,u=>Br(u))});const a=Hn(i.modes);if(Te(i.modes,(o,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),
this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(QM(o,a))}),st(this.lexerDefinitionErrors)){fc(o);let u;this.TRACE_INIT("analyzeTokenTypes",()=>{u=JM(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=u.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=
u.charCodeToPatternIdxToConfig,this.emptyGroups=Nn({},this.emptyGroups,u.emptyGroups),this.hasCustom=u.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=u.canBeOptimized}})}),this.defaultMode=i.defaultMode,!st(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=ge(this.lexerDefinitionErrors,u=>u.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}Te(this.lexerDefinitionWarning,o=>{j$(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(X$?(this.chopInput=ns,this.match=this.matchWithTest):(this.updateLastIndex=Nt,this.match=this.matchWithExec),s&&(this.handleModes=Nt),this.trackStartLines===!1&&(this.computeNewColumn=ns),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Nt),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.
positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optim\
ization Warnings",()=>{const o=hn(this.canModeBeOptimized,(c,u,l)=>(u===!1&&c.push(l),c),[]);if(n.ensureOptimizations&&!st(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{KM()}),this.TRACE_INIT("toFastProperties",()=>{U$(this)})})}tokenize(e,n=this.defaultMode){if(!st(this.lexerDefinitionErrors)){const i=ge(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let r,i,s,a,o,c,u,l,f,d,h,m,b,$,w;const k=e,S=k.length;let D=0,F=0;const Y=this.hasCustom?0:Math.floor(e.length/10),J=new Array(Y),ie=[];let re=this.trackStartLines?1:void 0,ye=this.trackStartLines?1:void 0;const z=gz(this.emptyGroups),E=this.trackStartLines,R=this.config.lineTerminatorsPattern;let M=0,_=[],P=[];const I=[],Z=[];Object.freeze(Z);let H;function A(){return _}function te(_e){const ue=Ri(_e),$e=P[ue];return $e===void 0?Z:$e}
const me=_e=>{if(I.length===1&&_e.tokenType.PUSH_MODE===void 0){const ue=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(_e);ie.push({offset:_e.startOffset,line:_e.startLine,column:_e.startColumn,length:_e.image.length,message:ue})}else{I.pop();const ue=da(I);_=this.patternIdxToConfig[ue],P=this.charCodeToPatternIdxToConfig[ue],M=_.length;const $e=this.canModeBeOptimized[ue]&&this.config.safeMode===!1;P&&$e?H=te:H=A}};function Ce(_e){I.push(_e),P=this.charCodeToPatternIdxToConfig[_e],
_=this.patternIdxToConfig[_e],M=_.length,M=_.length;const ue=this.canModeBeOptimized[_e]&&this.config.safeMode===!1;P&&ue?H=te:H=A}Ce.call(this,n);let L;const K=this.config.recoveryEnabled;for(;D<S;){c=null;const _e=k.charCodeAt(D),ue=H(_e),$e=ue.length;for(r=0;r<$e;r++){L=ue[r];const Pe=L.pattern;u=null;const le=L.short;if(le!==!1?_e===le&&(c=Pe):L.isCustom===!0?(w=Pe.exec(k,D,J,z),w!==null?(c=w[0],w.payload!==void 0&&(u=w.payload)):c=null):(this.updateLastIndex(Pe,D),c=this.match(Pe,e,D)),c!==
null){if(o=L.longerAlt,o!==void 0){const N=o.length;for(s=0;s<N;s++){const j=_[o[s]],fe=j.pattern;if(l=null,j.isCustom===!0?(w=fe.exec(k,D,J,z),w!==null?(a=w[0],w.payload!==void 0&&(l=w.payload)):a=null):(this.updateLastIndex(fe,D),a=this.match(fe,e,D)),a&&a.length>c.length){c=a,u=l,L=j;break}}}break}}if(c!==null){if(f=c.length,d=L.group,d!==void 0&&(h=L.tokenTypeIdx,m=this.createTokenInstance(c,D,h,L.tokenType,re,ye,f),this.handlePayload(m,u),d===!1?F=this.addToken(J,F,m):z[d].push(m)),e=this.chopInput(
e,f),D=D+f,ye=this.computeNewColumn(ye,f),E===!0&&L.canLineTerminator===!0){let Pe=0,le,N;R.lastIndex=0;do le=R.test(c),le===!0&&(N=R.lastIndex-1,Pe++);while(le===!0);Pe!==0&&(re=re+Pe,ye=f-N,this.updateTokenEndLineColumnLocation(m,d,N,Pe,re,ye,f))}this.handleModes(L,me,Ce,m)}else{const Pe=D,le=re,N=ye;let j=K===!1;for(;j===!1&&D<S;)for(e=this.chopInput(e,1),D++,i=0;i<M;i++){const fe=_[i],B=fe.pattern,de=fe.short;if(de!==!1?k.charCodeAt(D)===de&&(j=!0):fe.isCustom===!0?j=B.exec(k,D,J,z)!==null:(this.
updateLastIndex(B,D),j=B.exec(e)!==null),j===!0)break}if(b=D-Pe,ye=this.computeNewColumn(ye,b),$=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(k,Pe,b,le,N),ie.push({offset:Pe,line:le,column:N,length:b,message:$}),K===!1)break}}return this.hasCustom||(J.length=F),{tokens:J,groups:z,errors:ie}}handleModes(e,n,r,i){if(e.pop===!0){const s=e.push;n(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=
n}updateTokenEndLineColumnLocation(e,n,r,i,s,a,o){let c,u;n!==void 0&&(c=r===o-1,u=c?-1:0,i===1&&c===!0||(e.endLine=s+u,e.endColumn=a-1+-u))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,r,i){return{image:e,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,n,r,i,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+
o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,n,r){return e.push(r),n}addTokenUsingMemberAccess(e,n,r){return e[n]=r,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,r){return e.test(n)===!0?n.substring(r,e.lastIndex):null}matchWithExec(e,n){const r=e.exec(n);return r!==null?r[0]:null}}Sn.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used \
to for example to completely ignore whitespace.",Sn.NA=/NOT_APPLICABLE/;function ma(t){return aR(t)?t.LABEL:t.name}function aR(t){return Rn(t.LABEL)&&t.LABEL!==""}const _z="parent",oR="categories",cR="label",uR="group",lR="push_mode",dR="pop_mode",fR="longer_alt",hR="line_breaks",pR="start_chars_hint";function mR(t){return Cz(t)}function Cz(t){const e=t.pattern,n={};if(n.name=t.name,Br(e)||(n.PATTERN=e),Ee(t,_z))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ee(t,oR)&&(n.CATEGORIES=t[oR]),fc([n]),Ee(t,cR)&&(n.LABEL=t[cR]),Ee(t,uR)&&(n.GROUP=t[uR]),Ee(t,dR)&&(n.POP_MODE=t[dR]),Ee(t,lR)&&(n.PUSH_MODE=t[lR]),Ee(t,fR)&&(n.LONGER_ALT=t[fR]),Ee(t,hR)&&(n.LINE_BREAKS=t[hR]),Ee(t,pR)&&(n.START_CHARS_HINT=t[pR]),n}const ki=mR({name:"EOF",pattern:Sn.NA});fc([ki]);function ig(t,e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:a,
endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function gR(t,e){return dc(t,e)}const ga={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:r}){return`Expecting ${aR(t)?`--> ${ma(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:r,ruleName:i}){
const s="Expecting: ",o=`
but found: '`+ir(e).image+"'";if(r)return s+r+o;{const c=hn(t,(d,h)=>d.concat(h),[]),u=ge(c,d=>`[${ge(d,h=>ma(h)).join(", ")}]`),f=`one of these possible Token sequences:
${ge(u,(d,h)=>`  ${h+1}. ${d}`).join(`
`)}`;return s+f+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:r}){const i="Expecting: ",a=`
but found: '`+ir(e).image+"'";if(n)return i+n+a;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${ge(t,u=>`[${ge(u,l=>ma(l)).join(",")}]`).join(" ,")}>`;return i+c+a}}};Object.freeze(ga);const Pz={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},cs={buildDuplicateFoundError(t,e){function n(l){return l instanceof mt?l.terminalType.name:l instanceof pn?l.nonTerminalName:""}const r=t.name,i=ir(e),s=i.idx,a=Er(i),o=n(i),c=s>0;let u=`->${a}${c?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=ge(t.prefixPath,i=>ma(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=ge(t.prefixPath,i=>ma(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(t){let e=Er(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=ge(t.leftRecursionPath,s=>s.name),r=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof ha?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function xz(t,e){const n=new Dz(t,e);return n.resolveRefs(),n.errors}class Dz extends pa{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){
Te(It(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:mn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class Nz extends Qd{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=
0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Wt(this.path.ruleStack).reverse(),this.occurrenceStack=Wt(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,r){if(e.referencedRule.name===
this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){st(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class Iz extends Nz{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=
this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new kn({definition:i});this.possibleTokTypes=cc(s),this.found=!0}}}class of extends Qd{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}
class Oz extends of{walkMany(e,n,r){if(e.idx===this.occurrence){const i=ir(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof mt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,n,r)}}class yR extends of{walkManySep(e,n,r){if(e.idx===this.occurrence){const i=ir(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof mt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,n,r)}}class Lz extends of{walkAtLeastOne(e,n,r){
if(e.idx===this.occurrence){const i=ir(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof mt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,n,r)}}class vR extends of{walkAtLeastOneSep(e,n,r){if(e.idx===this.occurrence){const i=ir(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof mt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,n,r)}}function sg(t,e,n=[]){n=Wt(n);let r=[],i=0;function s(o){
return o.concat(Ht(t,i+1))}function a(o){const c=sg(s(o),e,n);return r.concat(c)}for(;n.length<e&&i<t.length;){const o=t[i];if(o instanceof kn)return a(o.definition);if(o instanceof pn)return a(o.definition);if(o instanceof Kt)r=a(o.definition);else if(o instanceof Ln){const c=o.definition.concat([new $t({definition:o.definition})]);return a(c)}else if(o instanceof Mn){const c=[new kn({definition:o.definition}),new $t({definition:[new mt({terminalType:o.separator})].concat(o.definition)})];return a(
c)}else if(o instanceof Tn){const c=o.definition.concat([new $t({definition:[new mt({terminalType:o.separator})].concat(o.definition)})]);r=a(c)}else if(o instanceof $t){const c=o.definition.concat([new $t({definition:o.definition})]);r=a(c)}else{if(o instanceof En)return Te(o.definition,c=>{st(c.definition)===!1&&(r=a(c.definition))}),r;if(o instanceof mt)n.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:Ht(t,i)}),r}function wR(t,e,n,r){const i="\
EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const c=e.length,u=c-r-1,l=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!st(f);){const d=f.pop();if(d===a){o&&da(f).idx<=u&&f.pop();continue}const h=d.def,m=d.idx,b=d.ruleStack,$=d.occurrenceStack;if(st(h))continue;const w=h[0];if(w===i){const k={idx:m,def:Ht(h),ruleStack:oc(b),occurrenceStack:oc($)};f.push(k)}else if(w instanceof mt)if(m<c-1){const k=m+1,S=e[k];if(n(S,w.terminalType)){const D={idx:k,def:Ht(h),ruleStack:b,
occurrenceStack:$};f.push(D)}}else if(m===c-1)l.push({nextTokenType:w.terminalType,nextTokenOccurrence:w.idx,ruleStack:b,occurrenceStack:$}),o=!0;else throw Error("non exhaustive match");else if(w instanceof pn){const k=Wt(b);k.push(w.nonTerminalName);const S=Wt($);S.push(w.idx);const D={idx:m,def:w.definition.concat(s,Ht(h)),ruleStack:k,occurrenceStack:S};f.push(D)}else if(w instanceof Kt){const k={idx:m,def:Ht(h),ruleStack:b,occurrenceStack:$};f.push(k),f.push(a);const S={idx:m,def:w.definition.
concat(Ht(h)),ruleStack:b,occurrenceStack:$};f.push(S)}else if(w instanceof Ln){const k=new $t({definition:w.definition,idx:w.idx}),S=w.definition.concat([k],Ht(h)),D={idx:m,def:S,ruleStack:b,occurrenceStack:$};f.push(D)}else if(w instanceof Mn){const k=new mt({terminalType:w.separator}),S=new $t({definition:[k].concat(w.definition),idx:w.idx}),D=w.definition.concat([S],Ht(h)),F={idx:m,def:D,ruleStack:b,occurrenceStack:$};f.push(F)}else if(w instanceof Tn){const k={idx:m,def:Ht(h),ruleStack:b,occurrenceStack:$};
f.push(k),f.push(a);const S=new mt({terminalType:w.separator}),D=new $t({definition:[S].concat(w.definition),idx:w.idx}),F=w.definition.concat([D],Ht(h)),Y={idx:m,def:F,ruleStack:b,occurrenceStack:$};f.push(Y)}else if(w instanceof $t){const k={idx:m,def:Ht(h),ruleStack:b,occurrenceStack:$};f.push(k),f.push(a);const S=new $t({definition:w.definition,idx:w.idx}),D=w.definition.concat([S],Ht(h)),F={idx:m,def:D,ruleStack:b,occurrenceStack:$};f.push(F)}else if(w instanceof En)for(let k=w.definition.length-
1;k>=0;k--){const S=w.definition[k],D={idx:m,def:S.definition.concat(Ht(h)),ruleStack:b,occurrenceStack:$};f.push(D),f.push(a)}else if(w instanceof kn)f.push({idx:m,def:w.definition.concat(Ht(h)),ruleStack:b,occurrenceStack:$});else if(w instanceof ha)f.push(Mz(w,m,b,$));else throw Error("non exhaustive match")}return l}function Mz(t,e,n,r){const i=Wt(n);i.push(t.name);const s=Wt(r);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}var gt;(function(t){t[t.OPTION=0]="OPTION",
t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(gt||(gt={}));function ag(t){if(t instanceof Kt||t==="Option")return gt.OPTION;if(t instanceof $t||t==="Repetition")return gt.REPETITION;if(t instanceof Ln||t==="RepetitionMandatory")return gt.REPETITION_MANDATORY;if(t instanceof Mn||t==="Rep\
etitionMandatoryWithSeparator")return gt.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Tn||t==="RepetitionWithSeparator")return gt.REPETITION_WITH_SEPARATOR;if(t instanceof En||t==="Alternation")return gt.ALTERNATION;throw Error("non exhaustive match")}function bR(t){const{occurrence:e,rule:n,prodType:r,maxLookahead:i}=t,s=ag(r);return s===gt.ALTERNATION?cf(e,n,i):uf(e,n,s,i)}function zz(t,e,n,r,i,s){const a=cf(t,e,n),o=TR(a)?af:dc;return s(a,r,o,i)}function Fz(t,e,n,r,i,s){const a=uf(t,e,
i,n),o=TR(a)?af:dc;return s(a[0],o,r)}function qz(t,e,n,r){const i=t.length,s=rr(t,a=>rr(a,o=>o.length===1));if(e)return function(a){const o=ge(a,c=>c.GATE);for(let c=0;c<i;c++){const u=t[c],l=u.length,f=o[c];if(!(f!==void 0&&f.call(this)===!1))e:for(let d=0;d<l;d++){const h=u[d],m=h.length;for(let b=0;b<m;b++){const $=this.LA(b+1);if(n($,h[b])===!1)continue e}return c}}};if(s&&!r){const a=ge(t,c=>Kn(c)),o=hn(a,(c,u,l)=>(Te(u,f=>{Ee(c,f.tokenTypeIdx)||(c[f.tokenTypeIdx]=l),Te(f.categoryMatches,d=>{
Ee(c,d)||(c[d]=l)})}),c),{});return function(){const c=this.LA(1);return o[c.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=t[a],c=o.length;e:for(let u=0;u<c;u++){const l=o[u],f=l.length;for(let d=0;d<f;d++){const h=this.LA(d+1);if(n(h,l[d])===!1)continue e}return a}}}}function Gz(t,e,n){const r=rr(t,s=>s.length===1),i=t.length;if(r&&!n){const s=Kn(t);if(s.length===1&&st(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{
const a=hn(s,(o,c,u)=>(o[c.tokenTypeIdx]=!0,Te(c.categoryMatches,l=>{o[l]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=t[s],o=a.length;for(let c=0;c<o;c++){const u=this.LA(c+1);if(e(u,a[c])===!1)continue e}return!0}return!1}}class jz extends Qd{constructor(e,n,r){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,r,i){
return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(e,n,r){this.checkIsTarget(e,gt.OPTION,n,r)||super.walkOption(e,n,r)}walkAtLeastOne(e,n,r){this.checkIsTarget(e,gt.REPETITION_MANDATORY,n,r)||super.walkOption(e,n,r)}walkAtLeastOneSep(e,n,r){this.checkIsTarget(e,gt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}walkMany(e,n,r){this.checkIsTarget(e,gt.REPETITION,n,r)||super.walkOption(e,n,r)}walkManySep(e,n,r){this.checkIsTarget(
e,gt.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}}class $R extends pa{constructor(e,n,r){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,gt.OPTION)}visitRepetition(e){this.checkIsTarget(e,gt.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,gt.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){
this.checkIsTarget(e,gt.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,gt.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,gt.ALTERNATION)}}function RR(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function og(t){let e=[""];for(let n=0;n<t.length;n++){const r=t[n],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const c="_"+r.categoryMatches[o];i.push(
a+c)}}e=i}return e}function Bz(t,e,n){for(let r=0;r<t.length;r++){if(r===n)continue;const i=t[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function kR(t,e){const n=ge(t,a=>sg([a],1)),r=RR(n.length),i=ge(n,a=>{const o={};return Te(a,c=>{const u=og(c.partialPath);Te(u,l=>{o[l]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=RR(o.length);for(let c=0;c<o.length;c++){const u=o[c];for(let l=0;l<u.length;l++){const f=u[l].partialPath,d=u[l].suffixDef,h=og(f);if(Bz(i,
h,c)||st(d)||f.length===e){const b=r[c];if(cg(b,f)===!1){b.push(f);for(let $=0;$<h.length;$++){const w=h[$];i[c][w]=!0}}}else{const b=sg(d,a+1,f);s[c]=s[c].concat(b),Te(b,$=>{const w=og($.partialPath);Te(w,k=>{i[c][k]=!0})})}}}}return r}function cf(t,e,n,r){const i=new $R(t,gt.ALTERNATION,r);return e.accept(i),kR(i.result,n)}function uf(t,e,n,r){const i=new $R(t,n);e.accept(i);const s=i.result,o=new jz(e,t,n).startWalking(),c=new kn({definition:s}),u=new kn({definition:o});return kR([c,u],r)}function cg(t,e){
e:for(let n=0;n<t.length;n++){const r=t[n];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Uz(t,e){return t.length<e.length&&rr(t,(n,r)=>{const i=e[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function TR(t){return rr(t,e=>rr(e,n=>rr(n,r=>st(r.categoryMatches))))}function Wz(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.
grammarName});return ge(e,n=>Object.assign({type:mn.CUSTOM_LOOKAHEAD_VALIDATION},n))}function Hz(t,e,n,r){const i=On(t,c=>Kz(c,n)),s=sF(t,e,n),a=On(t,c=>tF(c,n)),o=On(t,c=>Yz(c,t,r,n));return i.concat(s,a,o)}function Kz(t,e){const n=new Xz;t.accept(n);const r=n.allProductions,i=uM(r,Vz),s=sr(i,o=>o.length>1);return ge(It(s),o=>{const c=ir(o),u=e.buildDuplicateFoundError(t,o),l=Er(c),f={message:u,type:mn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:l,occurrence:c.idx},d=ER(c);return d&&(f.parameter=
d),f})}function Vz(t){return`${Er(t)}_#_${t.idx}_#_${ER(t)}`}function ER(t){return t instanceof mt?t.terminalType.name:t instanceof pn?t.nonTerminalName:""}class Xz extends pa{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.
push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function Yz(t,e,n,r){const i=[];if(hn(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:a,type:mn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function Jz(t,e,n){const r=[];let i;return fn(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}\
<-as it is not defined in any of the super grammars `,r.push({message:i,type:mn.INVALID_RULE_OVERRIDE,ruleName:t})),r}function SR(t,e,n,r=[]){const i=[],s=lf(e.definition);if(st(s))return[];{const a=t.name;fn(s,t)&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:mn.LEFT_RECURSION,ruleName:a});const c=Vd(s,r.concat([t])),u=On(c,l=>{const f=Wt(r);return f.push(l),SR(t,l,n,f)});return i.concat(u)}}function lf(t){let e=[];if(st(t))return e;const n=ir(t);if(n instanceof
pn)e.push(n.referencedRule);else if(n instanceof kn||n instanceof Kt||n instanceof Ln||n instanceof Mn||n instanceof Tn||n instanceof $t)e=e.concat(lf(n.definition));else if(n instanceof En)e=Kn(ge(n.definition,s=>lf(s.definition)));else if(!(n instanceof mt))throw Error("non exhaustive match");const r=Jd(n),i=t.length>1;if(r&&i){const s=Ht(t);return e.concat(lf(s))}else return e}class ug extends pa{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(
e)}}function Qz(t,e){const n=new ug;t.accept(n);const r=n.alternations;return On(r,s=>{const a=oc(s.definition);return On(a,(o,c)=>{const u=wR([o],[],dc,1);return st(u)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:c}),type:mn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:c+1}]:[]})})}function Zz(t,e,n){const r=new ug;t.accept(r);let i=r.alternations;return i=Xd(i,a=>a.ignoreAmbiguities===!0),On(i,a=>{const o=a.idx,c=a.maxLookahead||e,u=cf(
o,t,c,a),l=rF(u,a,t,n),f=iF(u,a,t,n);return l.concat(f)})}class eF extends pa{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function tF(t,e){const n=new ug;t.accept(n);const r=n.alternations;return On(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError(
{topLevelRule:t,alternation:s}),type:mn.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function nF(t,e,n){const r=[];return Te(t,i=>{const s=new eF;i.accept(s);const a=s.allProductions;Te(a,o=>{const c=ag(o),u=o.maxLookahead||e,l=o.idx,d=uf(l,i,c,u)[0];if(st(Kn(d))){const h=n.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:h,type:mn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function rF(t,e,n,r){const i=[],s=hn(t,(o,c,u)=>(e.definition[u].ignoreAmbiguities===!0||
Te(c,l=>{const f=[u];Te(t,(d,h)=>{u!==h&&cg(d,l)&&e.definition[h].ignoreAmbiguities!==!0&&f.push(h)}),f.length>1&&!cg(i,l)&&(i.push(l),o.push({alts:f,path:l}))}),o),[]);return ge(s,o=>{const c=ge(o.alts,l=>l+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:c,prefixPath:o.path}),type:mn.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function iF(t,e,n,r){const i=hn(t,(a,o,c)=>{const u=ge(o,l=>({idx:c,path:l}));return a.concat(
u)},[]);return ac(On(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const c=a.idx,u=a.path,l=In(i,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<c&&Uz(d.path,u));return ge(l,d=>{const h=[d.idx+1,c+1],m=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:h,prefixPath:d.path}),type:mn.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:m,alternatives:h}})}))}function sF(t,e,n){const r=[],i=ge(e,s=>s.name);return Te(
t,s=>{const a=s.name;if(fn(i,a)){const o=n.buildNamespaceConflictError(s);r.push({message:o,type:mn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function aF(t){const e=Ym(t,{errMsgProvider:Pz}),n={};return Te(t.rules,r=>{n[r.name]=r}),xz(n,e.errMsgProvider)}function oF(t){return t=Ym(t,{errMsgProvider:cs}),Hz(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const AR="MismatchedTokenException",_R="NoViableAltException",CR="EarlyExitException",PR="NotAllInputParsedException",xR=[AR,_R,CR,
PR];Object.freeze(xR);function df(t){return fn(xR,t.name)}class ff extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class DR extends ff{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=AR}}class cF extends ff{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=_R}}class uF extends ff{constructor(e,n){super(e,n),this.name=PR}}class lF extends ff{constructor(e,n,r){
super(e,n),this.previousToken=r,this.name=CR}}const lg={},NR="InRuleRecoveryException";class dF extends Error{constructor(e){super(e),this.name=NR}}class fF{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ee(e,"recoveryEnabled")?e.recoveryEnabled:Ur.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=hF)}getTokenToInsert(e){const n=ig(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){
return!0}tryInRepetitionRecovery(e,n,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let c=!1;const u=this.LA(1);let l=this.LA(1);const f=()=>{const d=this.LA(0),h=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:u,previous:d,ruleName:this.getCurrRuleFullName()}),m=new DR(h,u,this.LA(0));m.resyncedTokens=oc(o),this.SAVE_ERROR(m)};for(;!c;)if(this.tokenMatcher(l,i)){f();return}else if(r.call(this)){f(),e.apply(this,n);return}else this.tokenMatcher(l,s)?
c=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const r=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(
e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new dF("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||st(n))return!1;const r=this.LA(1);return fa(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){
const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return fn(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=fa(e,s=>gR(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return lg;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.
shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return ge(e,(r,i)=>i===0?lg:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=ge(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return Kn(e)}getFollowSetFromFollowKey(e){if(e===lg)return[ki];const n=e.ruleName+e.idxInCallingRule+H$+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){
return this.tokenMatcher(e,ki)||n.push(e),n}reSyncTo(e){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return oc(n)}attemptInRepetitionRecovery(e,n,r,i,s,a,o){}getCurrentGrammarPath(e,n){const r=this.getHumanReadableRuleStack(),i=Wt(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return ge(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function hF(t,e,n,r,i,s,a){
const o=this.getKeyForAutomaticLookahead(r,i);let c=this.firstAfterRepMap[o];if(c===void 0){const d=this.getCurrRuleFullName(),h=this.getGAstProductions()[d];c=new s(h,i).startWalking(),this.firstAfterRepMap[o]=c}let u=c.token,l=c.occurrence;const f=c.isEndOfRule;this.RULE_STACK.length===1&&f&&u===void 0&&(u=ki,l=1),!(u===void 0||l===void 0)&&this.shouldInRepetitionRecoveryBeTried(u,l,a)&&this.tryInRepetitionRecovery(t,e,n,u)}const pF=4,Ti=8,IR=1<<Ti,OR=2<<Ti,dg=3<<Ti,fg=4<<Ti,hg=5<<Ti,hf=6<<Ti;
function pg(t,e,n){return n|e|t}class mg{constructor(e){var n;this.maxLookahead=(n=e?.maxLookahead)!==null&&n!==void 0?n:Ur.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(st(n)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(e){return On(e,n=>SR(n,n,cs))}validateEmptyOrAlternatives(e){
return On(e,n=>Qz(n,cs))}validateAmbiguousAlternationAlternatives(e,n){return On(e,r=>Zz(r,n,cs))}validateSomeNonEmptyLookaheadPath(e,n){return nF(e,n,cs)}buildLookaheadForAlternation(e){return zz(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,qz)}buildLookaheadForOptional(e){return Fz(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,ag(e.prodType),Gz)}}class mF{initLooksAhead(e){this.dynamicTokensEnabled=Ee(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:
Ur.dynamicTokensEnabled,this.maxLookahead=Ee(e,"maxLookahead")?e.maxLookahead:Ur.maxLookahead,this.lookaheadStrategy=Ee(e,"lookaheadStrategy")?e.lookaheadStrategy:new mg({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Te(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:c}=yF(n);Te(r,u=>{const l=u.idx===0?"":u.idx;this.TRACE_INIT(
`${Er(u)}${l}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:u.idx,rule:n,maxLookahead:u.maxLookahead||this.maxLookahead,hasPredicates:u.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=pg(this.fullRuleNameToShort[n.name],IR,u.idx);this.setLaFuncCache(d,f)})}),Te(i,u=>{this.computeLookaheadFunc(n,u.idx,dg,"Repetition",u.maxLookahead,Er(u))}),Te(s,u=>{this.computeLookaheadFunc(n,u.idx,OR,"Option",u.maxLookahead,Er(u))}),Te(a,u=>{this.computeLookaheadFunc(
n,u.idx,fg,"RepetitionMandatory",u.maxLookahead,Er(u))}),Te(o,u=>{this.computeLookaheadFunc(n,u.idx,hf,"RepetitionMandatoryWithSeparator",u.maxLookahead,Er(u))}),Te(c,u=>{this.computeLookaheadFunc(n,u.idx,hg,"RepetitionWithSeparator",u.maxLookahead,Er(u))})})})}computeLookaheadFunc(e,n,r,i,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,
prodType:i}),c=pg(this.fullRuleNameToShort[e.name],r,n);this.setLaFuncCache(c,o)})}getKeyForAutomaticLookahead(e,n){const r=this.getLastExplicitRuleShortName();return pg(r,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class gF extends pa{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.
dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){
this.dslMethods.alternation.push(e)}}const pf=new gF;function yF(t){pf.reset(),t.accept(pf);const e=pf.dslMethods;return pf.reset(),e}function LR(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function MR(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&
(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function vF(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function wF(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const bF="name";function zR(t,e){Object.defineProperty(t,bF,{enumerable:!1,configurable:!0,writable:!1,value:e})}function $F(t,e){const n=Hn(t),r=n.length;for(let i=0;i<r;i++){const s=n[i],a=t[s],o=a.length;for(let c=0;c<o;c++){const u=a[c];u.tokenTypeIdx===void 0&&
this[u.name](u.children,e)}}}function RF(t,e){const n=function(){};zR(n,t+"BaseSemantics");const r={visit:function(i,s){if(He(i)&&(i=i[0]),!Br(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=TF(this,e);if(!st(i)){const s=ge(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=e,n}function kF(t,e,n){const r=function(){};zR(r,t+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return Te(e,s=>{i[s]=$F}),r.prototype=i,r.prototype.constructor=r,r}var gg;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(gg||(gg={}));function TF(t,e){return EF(t,e)}function EF(t,e){const n=In(e,i=>Fr(t[i])===!1),r=ge(n,i=>({msg:`Missing visitor method: <${i}> o\
n ${t.constructor.name} CST Visitor.`,type:gg.MISSING_METHOD,methodName:i}));return ac(r)}class SF{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Ee(e,"nodeLocationTracking")?e.nodeLocationTracking:Ur.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Nt,this.cstFinallyStateUpdate=Nt,this.cstPostTerminal=Nt,this.cstPostNonTerminal=Nt,this.cstPostRule=Nt;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=
MR,this.setNodeLocationFromNode=MR,this.cstPostRule=Nt,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Nt,this.setNodeLocationFromNode=Nt,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=LR,this.setNodeLocationFromNode=LR,this.cstPostRule=Nt,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):
(this.setNodeLocationFromToken=Nt,this.setNodeLocationFromNode=Nt,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Nt,this.setNodeLocationFromNode=Nt,this.cstPostRule=Nt,this.setInitialNodeLocation=Nt;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,
endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.
create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.
length-1];vF(r,n,e),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.length-1];wF(r,n,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(Br(this.baseCstVisitorConstructor)){const e=RF(this.className,Hn(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Br(this.baseCstVisitorWithDefaultsConstructor)){const e=kF(
this.className,Hn(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class AF{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=
0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):yf}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?yf:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){
this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class _F{ACTION(e){return e.call(this)}consume(e,n,r){return this.consumeInternal(n,e,r)}subrule(e,n,r){return this.subruleInternal(n,e,r)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(
e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){
return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(
e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.
orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(
9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){
return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(
1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,r=vf){if(fn(this.definedRulesNames,
e)){const a={message:cs.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:mn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,n,r);return this[e]=i,i}OVERRIDE_RULE(e,n,r=vf){const i=Jz(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,n,r);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const r=this.
saveRecogState();try{return e.apply(this,n),!0}catch(i){if(df(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return MM(It(this.gastProductionsCache))}}class CF{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=af,this.subruleIdx=0,this.definedRulesNames=[],this.
tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ee(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(He(e)){if(st(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(He(e))this.tokensMap=hn(e,(s,a)=>(s[a.name]=a,s),{});else if(Ee(e,"modes")&&rr(Kn(It(e.modes)),Az)){const s=Kn(It(e.modes)),a=Jm(s);this.tokensMap=hn(a,(o,c)=>(o[c.name]=c,o),{})}else if(Wn(e))this.tokensMap=Wt(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=ki;const r=Ee(e,"modes")?Kn(It(e.modes)):It(e),i=rr(r,s=>st(s.categoryMatches));this.
tokenMatcher=i?af:dc,fc(It(this.tokensMap))}defineRule(e,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=Ee(r,"resyncEnabled")?r.resyncEnabled:vf.resyncEnabled,s=Ee(r,"recoveryValueFunc")?r.recoveryValueFunc:vf.recoveryValueFunc,a=this.ruleShortNameIdx<<pF+Ti;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...l){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,l);const f=this.CST_STACK[this.CST_STACK.
length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...l){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,l)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(df(e)){const a=e;if(s){const o=this.
findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return r(e);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,a.partialCstResult=c}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,n){const r=this.getKeyForAutomaticLookahead(OR,n);return this.optionInternalLogic(e,n,
r)}optionInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const r=this.getKeyForAutomaticLookahead(fg,e);return this.atLeastOneInternalLogic(e,n,r)}atLeastOneInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(
this)}}else s=n;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,gt.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],i,fg,e,Lz)}atLeastOneSepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(hf,e);this.atLeastOneSepFirstInternalLogic(e,n,r)}atLeastOneSepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(
this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,vR],o,hf,e,vR)}else throw this.raiseEarlyExitException(e,gt.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const r=this.getKeyForAutomaticLookahead(dg,e);return this.manyInternalLogic(e,n,r)}manyInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="f\
unction"){s=n.DEF;const o=n.GATE;if(o!==void 0){const c=i;i=()=>o.call(this)&&c.call(this)}}else s=n;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],i,dg,e,Oz,a)}manySepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(hg,e);this.manySepFirstInternalLogic(e,n,r)}manySepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.
LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,yR],o,hg,e,yR)}}repetitionSepSecondInternal(e,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,i,s],r,hf,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const r=this.getKeyForAutomaticLookahead(IR,n),
i=He(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new uF(n,e))}}subruleInternal(e,n,r){let i;try{
const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,n,r){throw df(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):
this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new DR(i,n,s))}consumeInternalRecovery(e,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.
isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===NR?r:s}}else throw r}saveRecogState(){const e=this.errors,n=Wt(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.
cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),ki)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class PF{initErrorHandler(e){this.
_errors=[],this.errorMessageProvider=Ee(e,"errorMessageProvider")?e.errorMessageProvider:Ur.errorMessageProvider}SAVE_ERROR(e){if(df(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Wt(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Wt(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],
o=uf(e,s,n,this.maxLookahead)[0],c=[];for(let l=1;l<=this.maxLookahead;l++)c.push(this.LA(l));const u=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:c,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new lF(u,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=cf(e,i,this.maxLookahead),a=[];for(let u=1;u<=this.maxLookahead;u++)a.push(this.LA(u));const o=this.LA(0),c=this.
errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new cF(c,this.LA(1),o))}}class xF{initContentAssist(){}computeContentAssist(e,n){const r=this.gastProductionsCache[e];if(Br(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return wR([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=ir(e.ruleStack),i=this.getGAstProductions()[n];return new Iz(
i,e).startWalking()}}const mf={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(mf);const FR=!0,qR=Math.pow(2,Ti)-1,GR=mR({name:"RECORDING_PHASE_TOKEN",pattern:Sn.NA});fc([GR]);const jR=ig(GR,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(jR);const DF={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class NF{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(
r,e)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${n}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,n,r){return this.consumeInternalRecord(n,e,r)},this.subrule=function(e,n,r){return this.subruleInternalRecord(n,e,r)},this.
option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete e[`CONSUME${r}`],delete e[`\
SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return yf}topLevelRuleRecord(e,n){try{const r=new ha({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),
n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,n){return pc.call(this,Kt,e,n)}atLeastOneInternalRecord(e,n){pc.call(this,Ln,n,e)}atLeastOneSepFirstInternalRecord(e,n){pc.call(this,Mn,n,e,FR)}manyInternalRecord(e,n){pc.call(this,$t,n,e)}manySepFirstInternalRecord(e,n){pc.call(this,Tn,n,e,FR)}orInternalRecord(e,n){return IF.call(this,e,n)}subruleInternalRecord(e,n,r){if(gf(n),!e||Ee(e,"ruleName")===!1){const o=new Error(`<SUBRULE${BR(
n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=da(this.recordingProdStack),s=e.ruleName,a=new pn({idx:n,nonTerminalName:s,label:r?.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?DF:mf}consumeInternalRecord(e,n,r){if(gf(n),!iR(e)){const a=new Error(`<CONSUME${BR(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=da(this.recordingProdStack),s=new mt({idx:n,terminalType:e,label:r?.LABEL});return i.definition.push(s),jR}}function pc(t,e,n,r=!1){gf(n);const i=da(this.recordingProdStack),s=Fr(e)?e:e.DEF,a=new t({definition:[],idx:n});return r&&(a.separator=e.SEP),Ee(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.
pop(),mf}function IF(t,e){gf(e);const n=da(this.recordingProdStack),r=He(t)===!1,i=r===!1?t:t.DEF,s=new En({definition:[],idx:e,ignoreAmbiguities:r&&t.IGNORE_AMBIGUITIES===!0});Ee(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=q$(i,o=>Fr(o.GATE));return s.hasPredicates=a,n.definition.push(s),Te(i,o=>{const c=new kn({definition:[]});s.definition.push(c),Ee(o,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:Ee(o,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.
push(c),o.ALT.call(this),this.recordingProdStack.pop()}),mf}function BR(t){return t===0?"":`${t}`}function gf(t){if(t<0||t>qR){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${qR+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class OF{initPerformanceTracer(e){if(Ee(e,"traceInitPerf")){const n=e.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=Ur.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&
console.log(`${r}--> <${e}>`);const{time:i,value:s}=B$(n),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function LF(t,e){e.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=n.prototype[i]})})}const yf=ig(ki,"",NaN,NaN,
NaN,NaN,NaN,NaN);Object.freeze(yf);const Ur=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:ga,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),vf=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var mn;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",
t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAH\
EAD_VALIDATION"})(mn||(mn={}));function UR(t=void 0){return function(){return t}}class id{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{U$(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Te(this.definedRulesNames,
i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=aF({rules:It(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(st(r)&&this.skipValidations===!1){const i=oF({rules:It(this.gastProductionsCache),tokenTypes:It(this.tokensMap),errMsgProvider:cs,
grammarName:n}),s=Wz({lookaheadStrategy:this.lookaheadStrategy,rules:It(this.gastProductionsCache),tokenTypes:It(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),st(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=UM(It(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:It(
this.gastProductionsCache)}),this.preComputeLookaheadFunctions(It(this.gastProductionsCache))})),!id.DEFER_DEFINITION_ERRORS_HANDLING&&!st(this.definitionErrors))throw e=ge(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(e,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),Ee(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Ee(n,"skipValidations")?n.skipValidations:Ur.skipValidations}}id.DEFER_DEFINITION_ERRORS_HANDLING=!1,LF(id,[fF,mF,SF,AF,CF,_F,PF,xF,NF,OF]);class MF extends id{constructor(e,n=Ur){const r=Wt(n);r.outputCst=!1,super(e,r)}}function ya(t,e,n){return`${t.name}_${e}_${n}`}const Ei=1,zF=2,WR=4,HR=5,mc=7,FF=8,qF=9,GF=10,jF=11,KR=12;class yg{constructor(e){this.target=e}isEpsilon(){return!1}}class vg extends yg{constructor(e,n){super(e),this.tokenType=n}}class VR extends yg{constructor(e){
super(e)}isEpsilon(){return!0}}class wg extends yg{constructor(e,n,r){super(e),this.rule=n,this.followState=r}isEpsilon(){return!0}}function BF(t){const e={decisionMap:{},decisionStates:[],ruleToStartState:new Map,ruleToStopState:new Map,states:[]};UF(e,t);const n=t.length;for(let r=0;r<n;r++){const i=t[r],s=us(e,i,i);s!==void 0&&tq(e,i,s)}return e}function UF(t,e){const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=Gt(t,i,void 0,{type:zF}),a=Gt(t,i,void 0,{type:mc});s.stop=a,t.ruleToStartState.
set(i,s),t.ruleToStopState.set(i,a)}}function XR(t,e,n){return n instanceof mt?bg(t,e,n.terminalType,n):n instanceof pn?eq(t,e,n):n instanceof En?XF(t,e,n):n instanceof Kt?YF(t,e,n):n instanceof $t?WF(t,e,n):n instanceof Tn?HF(t,e,n):n instanceof Ln?KF(t,e,n):n instanceof Mn?VF(t,e,n):us(t,e,n)}function WF(t,e,n){const r=Gt(t,e,n,{type:HR});Si(t,r);const i=va(t,e,r,n,us(t,e,n));return JR(t,e,n,i)}function HF(t,e,n){const r=Gt(t,e,n,{type:HR});Si(t,r);const i=va(t,e,r,n,us(t,e,n)),s=bg(t,e,n.separator,
n);return JR(t,e,n,i,s)}function KF(t,e,n){const r=Gt(t,e,n,{type:WR});Si(t,r);const i=va(t,e,r,n,us(t,e,n));return YR(t,e,n,i)}function VF(t,e,n){const r=Gt(t,e,n,{type:WR});Si(t,r);const i=va(t,e,r,n,us(t,e,n)),s=bg(t,e,n.separator,n);return YR(t,e,n,i,s)}function XF(t,e,n){const r=Gt(t,e,n,{type:Ei});Si(t,r);const i=ge(n.definition,a=>XR(t,e,a));return va(t,e,r,n,...i)}function YF(t,e,n){const r=Gt(t,e,n,{type:Ei});Si(t,r);const i=va(t,e,r,n,us(t,e,n));return JF(t,e,n,i)}function us(t,e,n){const r=In(
ge(n.definition,i=>XR(t,e,i)),i=>i!==void 0);return r.length===1?r[0]:r.length===0?void 0:ZF(t,r)}function YR(t,e,n,r,i){const s=r.left,a=r.right,o=Gt(t,e,n,{type:jF});Si(t,o);const c=Gt(t,e,n,{type:KR});return s.loopback=o,c.loopback=o,t.decisionMap[ya(e,i?"RepetitionMandatoryWithSeparator":"RepetitionMandatory",n.idx)]=o,Ct(a,o),i===void 0?(Ct(o,s),Ct(o,c)):(Ct(o,c),Ct(o,i.left),Ct(i.right,s)),{left:s,right:c}}function JR(t,e,n,r,i){const s=r.left,a=r.right,o=Gt(t,e,n,{type:GF});Si(t,o);const c=Gt(
t,e,n,{type:KR}),u=Gt(t,e,n,{type:qF});return o.loopback=u,c.loopback=u,Ct(o,s),Ct(o,c),Ct(a,u),i!==void 0?(Ct(u,c),Ct(u,i.left),Ct(i.right,s)):Ct(u,o),t.decisionMap[ya(e,i?"RepetitionWithSeparator":"Repetition",n.idx)]=o,{left:o,right:c}}function JF(t,e,n,r){const i=r.left,s=r.right;return Ct(i,s),t.decisionMap[ya(e,"Option",n.idx)]=i,r}function Si(t,e){return t.decisionStates.push(e),e.decision=t.decisionStates.length-1,e.decision}function va(t,e,n,r,...i){const s=Gt(t,e,r,{type:FF,start:n});n.
end=s;for(const o of i)o!==void 0?(Ct(n,o.left),Ct(o.right,s)):Ct(n,s);const a={left:n,right:s};return t.decisionMap[ya(e,QF(r),r.idx)]=n,a}function QF(t){if(t instanceof En)return"Alternation";if(t instanceof Kt)return"Option";if(t instanceof $t)return"Repetition";if(t instanceof Tn)return"RepetitionWithSeparator";if(t instanceof Ln)return"RepetitionMandatory";if(t instanceof Mn)return"RepetitionMandatoryWithSeparator";throw new Error("Invalid production type encountered")}function ZF(t,e){const n=e.
length;for(let s=0;s<n-1;s++){const a=e[s];let o;a.left.transitions.length===1&&(o=a.left.transitions[0]);const c=o instanceof wg,u=o,l=e[s+1].left;a.left.type===Ei&&a.right.type===Ei&&o!==void 0&&(c&&u.followState===a.right||o.target===a.right)?(c?u.followState=l:o.target=l,nq(t,a.right)):Ct(a.right,l)}const r=e[0],i=e[n-1];return{left:r.left,right:i.right}}function bg(t,e,n,r){const i=Gt(t,e,r,{type:Ei}),s=Gt(t,e,r,{type:Ei});return $g(i,new vg(s,n)),{left:i,right:s}}function eq(t,e,n){const r=n.
referencedRule,i=t.ruleToStartState.get(r),s=Gt(t,e,n,{type:Ei}),a=Gt(t,e,n,{type:Ei}),o=new wg(i,r,a);return $g(s,o),{left:s,right:a}}function tq(t,e,n){const r=t.ruleToStartState.get(e);Ct(r,n.left);const i=t.ruleToStopState.get(e);return Ct(n.right,i),{left:r,right:i}}function Ct(t,e){const n=new VR(e);$g(t,n)}function Gt(t,e,n,r){const i=Object.assign({atn:t,production:n,epsilonOnlyTransitions:!1,rule:e,transitions:[],nextTokenWithinRule:[],stateNumber:t.states.length},r);return t.states.push(
i),i}function $g(t,e){t.transitions.length===0&&(t.epsilonOnlyTransitions=e.isEpsilon()),t.transitions.push(e)}function nq(t,e){t.states.splice(t.states.indexOf(e),1)}const wf={};class Rg{constructor(){this.map={},this.configs=[]}get size(){return this.configs.length}finalize(){this.map={}}add(e){const n=QR(e);n in this.map||(this.map[n]=this.configs.length,this.configs.push(e))}get elements(){return this.configs}get alts(){return ge(this.configs,e=>e.alt)}get key(){let e="";for(const n in this.
map)e+=n+":";return e}}function QR(t,e=!0){return`${e?`a${t.alt}`:""}s${t.state.stateNumber}:${t.stack.map(n=>n.stateNumber.toString()).join("_")}`}function rq(t,e){const n={};return r=>{const i=r.toString();let s=n[i];return s!==void 0||(s={atnStartState:t,decision:e,states:{}},n[i]=s),s}}class ZR{constructor(){this.predicates=[]}is(e){return e>=this.predicates.length||this.predicates[e]}set(e,n){this.predicates[e]=n}toString(){let e="";const n=this.predicates.length;for(let r=0;r<n;r++)e+=this.
predicates[r]===!0?"1":"0";return e}}const ek=new ZR;class iq extends mg{constructor(e){var n;super(),this.logging=(n=e?.logging)!==null&&n!==void 0?n:r=>console.log(r)}initialize(e){this.atn=BF(e.rules),this.dfas=sq(this.atn)}validateAmbiguousAlternationAlternatives(){return[]}validateEmptyOrAlternatives(){return[]}buildLookaheadForAlternation(e){const{prodOccurrence:n,rule:r,hasPredicates:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,c=ya(r,"Alternation",n),l=this.atn.decisionMap[c].decision,
f=ge(bR({maxLookahead:1,occurrence:n,prodType:"Alternation",rule:r}),d=>ge(d,h=>h[0]));if(tk(f,!1)&&!s){const d=hn(f,(h,m,b)=>(Te(m,$=>{$&&(h[$.tokenTypeIdx]=b,Te($.categoryMatches,w=>{h[w]=b}))}),h),{});return i?function(h){var m;const b=this.LA(1),$=d[b.tokenTypeIdx];if(h!==void 0&&$!==void 0){const w=(m=h[$])===null||m===void 0?void 0:m.GATE;if(w!==void 0&&w.call(this)===!1)return}return $}:function(){const h=this.LA(1);return d[h.tokenTypeIdx]}}else return i?function(d){const h=new ZR,m=d===
void 0?0:d.length;for(let $=0;$<m;$++){const w=d?.[$].GATE;h.set($,w===void 0||w.call(this))}const b=kg.call(this,a,l,h,o);return typeof b=="number"?b:void 0}:function(){const d=kg.call(this,a,l,ek,o);return typeof d=="number"?d:void 0}}buildLookaheadForOptional(e){const{prodOccurrence:n,rule:r,prodType:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,c=ya(r,i,n),l=this.atn.decisionMap[c].decision,f=ge(bR({maxLookahead:1,occurrence:n,prodType:i,rule:r}),d=>ge(d,h=>h[0]));if(tk(f)&&f[0][0]&&
!s){const d=f[0],h=Kn(d);if(h.length===1&&st(h[0].categoryMatches)){const b=h[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===b}}else{const m=hn(h,(b,$)=>($!==void 0&&(b[$.tokenTypeIdx]=!0,Te($.categoryMatches,w=>{b[w]=!0})),b),{});return function(){const b=this.LA(1);return m[b.tokenTypeIdx]===!0}}}return function(){const d=kg.call(this,a,l,ek,o);return typeof d=="object"?!1:d===0}}}function tk(t,e=!0){const n=new Set;for(const r of t){const i=new Set;for(const s of r){if(s===
void 0){if(e)break;return!1}const a=[s.tokenTypeIdx].concat(s.categoryMatches);for(const o of a)if(n.has(o)){if(!i.has(o))return!1}else n.add(o),i.add(o)}}return!0}function sq(t){const e=t.decisionStates.length,n=Array(e);for(let r=0;r<e;r++)n[r]=rq(t.decisionStates[r],r);return n}function kg(t,e,n,r){const i=t[e](n);let s=i.start;if(s===void 0){const o=gq(i.atnStartState);s=ik(i,nk(o)),i.start=s}return aq.apply(this,[i,s,n,r])}function aq(t,e,n,r){let i=e,s=1;const a=[];let o=this.LA(s++);for(;;){
let c=fq(i,o);if(c===void 0&&(c=oq.apply(this,[t,i,o,s,n,r])),c===wf)return dq(a,i,o);if(c.isAcceptState===!0)return c.prediction;i=c,a.push(o),o=this.LA(s++)}}function oq(t,e,n,r,i,s){const a=hq(e.configs,n,i);if(a.size===0)return rk(t,e,n,wf),wf;let o=nk(a);const c=mq(a,i);if(c!==void 0)o.isAcceptState=!0,o.prediction=c,o.configs.uniqueAlt=c;else if(bq(a)){const u=TM(a.alts);o.isAcceptState=!0,o.prediction=u,o.configs.uniqueAlt=u,cq.apply(this,[t,r,a.alts,s])}return o=rk(t,e,n,o),o}function cq(t,e,n,r){
const i=[];for(let u=1;u<=e;u++)i.push(this.LA(u).tokenType);const s=t.atnStartState,a=s.rule,o=s.production,c=uq({topLevelRule:a,ambiguityIndices:n,production:o,prefixPath:i});r(c)}function uq(t){const e=ge(t.prefixPath,i=>ma(i)).join(", "),n=t.production.idx===0?"":t.production.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(", ")}> in <${lq(t.production)}${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r}function lq(t){if(t instanceof pn)return"SUBRULE";if(t instanceof Kt)return"OPTION";if(t instanceof En)return"OR";if(t instanceof Ln)return"AT_LEAST_ONE";if(t instanceof Mn)return"AT_LEAST_ONE_SEP";if(t instanceof Tn)return"MANY_SEP";if(t instanceof $t)return"MANY";if(t instanceof mt)return"CONSUME";throw Error("non exhaustive match")}function dq(t,e,n){const r=On(e.configs.elements,s=>s.state.transitions),i=IM(r.filter(s=>s instanceof vg).map(s=>s.tokenType),s=>s.tokenTypeIdx);
return{actualToken:n,possibleTokenTypes:i,tokenPath:t}}function fq(t,e){return t.edges[e.tokenTypeIdx]}function hq(t,e,n){const r=new Rg,i=[];for(const a of t.elements){if(n.is(a.alt)===!1)continue;if(a.state.type===mc){i.push(a);continue}const o=a.state.transitions.length;for(let c=0;c<o;c++){const u=a.state.transitions[c],l=pq(u,e);l!==void 0&&r.add({state:l,alt:a.alt,stack:a.stack})}}let s;if(i.length===0&&r.size===1&&(s=r),s===void 0){s=new Rg;for(const a of r.elements)bf(a,s)}if(i.length>0&&
!vq(s))for(const a of i)s.add(a);return s}function pq(t,e){if(t instanceof vg&&gR(e,t.tokenType))return t.target}function mq(t,e){let n;for(const r of t.elements)if(e.is(r.alt)===!0){if(n===void 0)n=r.alt;else if(n!==r.alt)return}return n}function nk(t){return{configs:t,edges:{},isAcceptState:!1,prediction:-1}}function rk(t,e,n,r){return r=ik(t,r),e.edges[n.tokenTypeIdx]=r,r}function ik(t,e){if(e===wf)return e;const n=e.configs.key,r=t.states[n];return r!==void 0?r:(e.configs.finalize(),t.states[n]=
e,e)}function gq(t){const e=new Rg,n=t.transitions.length;for(let r=0;r<n;r++){const s={state:t.transitions[r].target,alt:r,stack:[]};bf(s,e)}return e}function bf(t,e){const n=t.state;if(n.type===mc){if(t.stack.length>0){const i=[...t.stack],a={state:i.pop(),alt:t.alt,stack:i};bf(a,e)}else e.add(t);return}n.epsilonOnlyTransitions||e.add(t);const r=n.transitions.length;for(let i=0;i<r;i++){const s=n.transitions[i],a=yq(t,s);a!==void 0&&bf(a,e)}}function yq(t,e){if(e instanceof VR)return{state:e.target,
alt:t.alt,stack:t.stack};if(e instanceof wg){const n=[...t.stack,e.followState];return{state:e.target,alt:t.alt,stack:n}}}function vq(t){for(const e of t.elements)if(e.state.type===mc)return!0;return!1}function wq(t){for(const e of t.elements)if(e.state.type!==mc)return!1;return!0}function bq(t){if(wq(t))return!0;const e=$q(t.elements);return Rq(e)&&!kq(e)}function $q(t){const e=new Map;for(const n of t){const r=QR(n,!1);let i=e.get(r);i===void 0&&(i={},e.set(r,i)),i[n.alt]=!0}return e}function Rq(t){
for(const e of Array.from(t.values()))if(Object.keys(e).length>1)return!0;return!1}function kq(t){for(const e of Array.from(t.values()))if(Object.keys(e).length===1)return!0;return!1}var sk;(function(t){function e(n){return typeof n=="string"}t.is=e})(sk||(sk={}));var Tg;(function(t){function e(n){return typeof n=="string"}t.is=e})(Tg||(Tg={}));var ak;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(ak||(ak=
{}));var $f;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})($f||($f={}));var tt;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=$f.MAX_VALUE),i===Number.MAX_VALUE&&(i=$f.MAX_VALUE),{line:r,character:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&G.uinteger(i.line)&&G.uinteger(i.character)}t.is=n})(tt||(tt={}));var Ue;(function(t){function e(r,i,s,a){if(G.uinteger(r)&&G.uinteger(i)&&G.uinteger(
s)&&G.uinteger(a))return{start:tt.create(r,i),end:tt.create(s,a)};if(tt.is(r)&&tt.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&tt.is(i.start)&&tt.is(i.end)}t.is=n})(Ue||(Ue={}));var Rf;(function(t){function e(r,i){return{uri:r,range:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&Ue.is(i.range)&&(G.string(i.uri)||G.undefined(i.uri))}t.is=n})(Rf||(Rf={}));
var ok;(function(t){function e(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&Ue.is(i.targetRange)&&G.string(i.targetUri)&&Ue.is(i.targetSelectionRange)&&(Ue.is(i.originSelectionRange)||G.undefined(i.originSelectionRange))}t.is=n})(ok||(ok={}));var Eg;(function(t){function e(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.numberRange(
i.red,0,1)&&G.numberRange(i.green,0,1)&&G.numberRange(i.blue,0,1)&&G.numberRange(i.alpha,0,1)}t.is=n})(Eg||(Eg={}));var ck;(function(t){function e(r,i){return{range:r,color:i}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&Ue.is(i.range)&&Eg.is(i.color)}t.is=n})(ck||(ck={}));var uk;(function(t){function e(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.string(i.label)&&(G.undefined(i.textEdit)||An.is(i))&&(G.undefined(
i.additionalTextEdits)||G.typedArray(i.additionalTextEdits,An.is))}t.is=n})(uk||(uk={}));var lk;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(lk||(lk={}));var dk;(function(t){function e(r,i,s,a,o,c){const u={startLine:r,endLine:i};return G.defined(s)&&(u.startCharacter=s),G.defined(a)&&(u.endCharacter=a),G.defined(o)&&(u.kind=o),G.defined(c)&&(u.collapsedText=c),u}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.uinteger(i.startLine)&&G.uinteger(i.startLine)&&
(G.undefined(i.startCharacter)||G.uinteger(i.startCharacter))&&(G.undefined(i.endCharacter)||G.uinteger(i.endCharacter))&&(G.undefined(i.kind)||G.string(i.kind))}t.is=n})(dk||(dk={}));var Sg;(function(t){function e(r,i){return{location:r,message:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&Rf.is(i.location)&&G.string(i.message)}t.is=n})(Sg||(Sg={}));var gc;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(gc||(gc={}));var fk;(function(t){t.Unnecessary=1,t.Deprecated=2})(fk||
(fk={}));var hk;(function(t){function e(n){const r=n;return G.objectLiteral(r)&&G.string(r.href)}t.is=e})(hk||(hk={}));var kf;(function(t){function e(r,i,s,a,o,c){let u={range:r,message:i};return G.defined(s)&&(u.severity=s),G.defined(a)&&(u.code=a),G.defined(o)&&(u.source=o),G.defined(c)&&(u.relatedInformation=c),u}t.create=e;function n(r){var i;let s=r;return G.defined(s)&&Ue.is(s.range)&&G.string(s.message)&&(G.number(s.severity)||G.undefined(s.severity))&&(G.integer(s.code)||G.string(s.code)||
G.undefined(s.code))&&(G.undefined(s.codeDescription)||G.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(G.string(s.source)||G.undefined(s.source))&&(G.undefined(s.relatedInformation)||G.typedArray(s.relatedInformation,Sg.is))}t.is=n})(kf||(kf={}));var wa;(function(t){function e(r,i,...s){let a={title:r,command:i};return G.defined(s)&&s.length>0&&(a.arguments=s),a}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.title)&&G.string(i.command)}t.is=n})(wa||(wa={}));
var An;(function(t){function e(s,a){return{range:s,newText:a}}t.replace=e;function n(s,a){return{range:{start:s,end:s},newText:a}}t.insert=n;function r(s){return{range:s,newText:""}}t.del=r;function i(s){const a=s;return G.objectLiteral(a)&&G.string(a.newText)&&Ue.is(a.range)}t.is=i})(An||(An={}));var Ag;(function(t){function e(r,i,s){const a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=s),a}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&G.string(
i.label)&&(G.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(G.string(i.description)||i.description===void 0)}t.is=n})(Ag||(Ag={}));var ba;(function(t){function e(n){const r=n;return G.string(r)}t.is=e})(ba||(ba={}));var pk;(function(t){function e(s,a,o){return{range:s,newText:a,annotationId:o}}t.replace=e;function n(s,a,o){return{range:{start:s,end:s},newText:a,annotationId:o}}t.insert=n;function r(s,a){return{range:s,newText:"",annotationId:a}}t.del=r;function i(s){const a=s;return An.
is(a)&&(Ag.is(a.annotationId)||ba.is(a.annotationId))}t.is=i})(pk||(pk={}));var _g;(function(t){function e(r,i){return{textDocument:r,edits:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&Ng.is(i.textDocument)&&Array.isArray(i.edits)}t.is=n})(_g||(_g={}));var Cg;(function(t){function e(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind===
"create"&&G.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||G.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||G.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||ba.is(i.annotationId))}t.is=n})(Cg||(Cg={}));var Pg;(function(t){function e(r,i,s,a){let o={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(o.options=s),a!==void 0&&(o.annotationId=a),o}t.create=e;function n(r){let i=r;return i&&i.
kind==="rename"&&G.string(i.oldUri)&&G.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||G.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||G.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||ba.is(i.annotationId))}t.is=n})(Pg||(Pg={}));var xg;(function(t){function e(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;
return i&&i.kind==="delete"&&G.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||G.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||G.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||ba.is(i.annotationId))}t.is=n})(xg||(xg={}));var Dg;(function(t){function e(n){let r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>G.string(i.kind)?Cg.is(i)||Pg.is(i)||xg.is(i):_g.is(i)))}t.
is=e})(Dg||(Dg={}));var mk;(function(t){function e(r){return{uri:r}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)}t.is=n})(mk||(mk={}));var gk;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&G.integer(i.version)}t.is=n})(gk||(gk={}));var Ng;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&(i.version===null||G.integer(i.version))}
t.is=n})(Ng||(Ng={}));var yk;(function(t){function e(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.string(i.uri)&&G.string(i.languageId)&&G.integer(i.version)&&G.string(i.text)}t.is=n})(yk||(yk={}));var Ig;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){const r=n;return r===t.PlainText||r===t.Markdown}t.is=e})(Ig||(Ig={}));var yc;(function(t){function e(n){const r=n;return G.objectLiteral(n)&&Ig.is(r.kind)&&G.
string(r.value)}t.is=e})(yc||(yc={}));var kt;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(kt||(kt={}));var _n;(function(t){t.PlainText=1,t.Snippet=2})(_n||(_n={}));var vk;(function(t){t.Deprecated=1})(vk||(vk={}));var wk;
(function(t){function e(r,i,s){return{newText:r,insert:i,replace:s}}t.create=e;function n(r){const i=r;return i&&G.string(i.newText)&&Ue.is(i.insert)&&Ue.is(i.replace)}t.is=n})(wk||(wk={}));var bk;(function(t){t.asIs=1,t.adjustIndentation=2})(bk||(bk={}));var $k;(function(t){function e(n){const r=n;return r&&(G.string(r.detail)||r.detail===void 0)&&(G.string(r.description)||r.description===void 0)}t.is=e})($k||($k={}));var Rk;(function(t){function e(n){return{label:n}}t.create=e})(Rk||(Rk={}));var kk;
(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}t.create=e})(kk||(kk={}));var Tf;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(r){const i=r;return G.string(i)||G.objectLiteral(i)&&G.string(i.language)&&G.string(i.value)}t.is=n})(Tf||(Tf={}));var Tk;(function(t){function e(n){let r=n;return!!r&&G.objectLiteral(r)&&(yc.is(r.contents)||Tf.is(r.contents)||G.typedArray(r.contents,Tf.is))&&(n.range===void 0||Ue.is(n.range))}t.
is=e})(Tk||(Tk={}));var Ek;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}t.create=e})(Ek||(Ek={}));var Sk;(function(t){function e(n,r,...i){let s={label:n};return G.defined(r)&&(s.documentation=r),G.defined(i)?s.parameters=i:s.parameters=[],s}t.create=e})(Sk||(Sk={}));var Ak;(function(t){t.Text=1,t.Read=2,t.Write=3})(Ak||(Ak={}));var _k;(function(t){function e(n,r){let i={range:n};return G.number(r)&&(i.kind=r),i}t.create=e})(_k||(_k={}));var ar;(function(t){t.File=1,
t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(ar||(ar={}));var Ck;(function(t){t.Deprecated=1})(Ck||(Ck={}));var Pk;(function(t){function e(n,r,i,s,a){let o={name:n,kind:r,location:{uri:s,range:i}};return a&&(o.containerName=a),o}
t.create=e})(Pk||(Pk={}));var xk;(function(t){function e(n,r,i,s){return s!==void 0?{name:n,kind:r,location:{uri:i,range:s}}:{name:n,kind:r,location:{uri:i}}}t.create=e})(xk||(xk={}));var Dk;(function(t){function e(r,i,s,a,o,c){let u={name:r,detail:i,kind:s,range:a,selectionRange:o};return c!==void 0&&(u.children=c),u}t.create=e;function n(r){let i=r;return i&&G.string(i.name)&&G.number(i.kind)&&Ue.is(i.range)&&Ue.is(i.selectionRange)&&(i.detail===void 0||G.string(i.detail))&&(i.deprecated===void 0||
G.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}t.is=n})(Dk||(Dk={}));var Nk;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Nk||(Nk={}));var Ef;(function(t){t.Invoked=1,t.Automatic=2})(Ef||(Ef={}));var Ik;
(function(t){function e(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}t.create=e;function n(r){let i=r;return G.defined(i)&&G.typedArray(i.diagnostics,kf.is)&&(i.only===void 0||G.typedArray(i.only,G.string))&&(i.triggerKind===void 0||i.triggerKind===Ef.Invoked||i.triggerKind===Ef.Automatic)}t.is=n})(Ik||(Ik={}));var Ok;(function(t){function e(r,i,s){let a={title:r},o=!0;return typeof i=="string"?(o=!1,a.kind=i):wa.is(i)?a.command=i:a.edit=i,o&&s!==void 0&&(a.
kind=s),a}t.create=e;function n(r){let i=r;return i&&G.string(i.title)&&(i.diagnostics===void 0||G.typedArray(i.diagnostics,kf.is))&&(i.kind===void 0||G.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||wa.is(i.command))&&(i.isPreferred===void 0||G.boolean(i.isPreferred))&&(i.edit===void 0||Dg.is(i.edit))}t.is=n})(Ok||(Ok={}));var Lk;(function(t){function e(r,i){let s={range:r};return G.defined(i)&&(s.data=i),s}t.create=e;function n(r){let i=r;return G.defined(i)&&Ue.is(
i.range)&&(G.undefined(i.command)||wa.is(i.command))}t.is=n})(Lk||(Lk={}));var Mk;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}t.create=e;function n(r){let i=r;return G.defined(i)&&G.uinteger(i.tabSize)&&G.boolean(i.insertSpaces)}t.is=n})(Mk||(Mk={}));var zk;(function(t){function e(r,i,s){return{range:r,target:i,data:s}}t.create=e;function n(r){let i=r;return G.defined(i)&&Ue.is(i.range)&&(G.undefined(i.target)||G.string(i.target))}t.is=n})(zk||(zk={}));var Fk;(function(t){function e(r,i){
return{range:r,parent:i}}t.create=e;function n(r){let i=r;return G.objectLiteral(i)&&Ue.is(i.range)&&(i.parent===void 0||t.is(i.parent))}t.is=n})(Fk||(Fk={}));var xe;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="ke\
yword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(xe||(xe={}));var Ge;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(Ge||(Ge={}));var qk;(function(t){function e(n){const r=n;return G.
objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}t.is=e})(qk||(qk={}));var Gk;(function(t){function e(r,i){return{range:r,text:i}}t.create=e;function n(r){const i=r;return i!=null&&Ue.is(i.range)&&G.string(i.text)}t.is=n})(Gk||(Gk={}));var jk;(function(t){function e(r,i,s){return{range:r,variableName:i,caseSensitiveLookup:s}}t.create=e;function n(r){const i=r;return i!=null&&Ue.is(i.range)&&G.boolean(i.caseSensitiveLookup)&&
(G.string(i.variableName)||i.variableName===void 0)}t.is=n})(jk||(jk={}));var Bk;(function(t){function e(r,i){return{range:r,expression:i}}t.create=e;function n(r){const i=r;return i!=null&&Ue.is(i.range)&&(G.string(i.expression)||i.expression===void 0)}t.is=n})(Bk||(Bk={}));var Uk;(function(t){function e(r,i){return{frameId:r,stoppedLocation:i}}t.create=e;function n(r){const i=r;return G.defined(i)&&Ue.is(r.stoppedLocation)}t.is=n})(Uk||(Uk={}));var Og;(function(t){t.Type=1,t.Parameter=2;function e(n){
return n===1||n===2}t.is=e})(Og||(Og={}));var Lg;(function(t){function e(r){return{value:r}}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&(i.tooltip===void 0||G.string(i.tooltip)||yc.is(i.tooltip))&&(i.location===void 0||Rf.is(i.location))&&(i.command===void 0||wa.is(i.command))}t.is=n})(Lg||(Lg={}));var Wk;(function(t){function e(r,i,s){const a={position:r,label:i};return s!==void 0&&(a.kind=s),a}t.create=e;function n(r){const i=r;return G.objectLiteral(i)&&tt.is(i.position)&&(G.
string(i.label)||G.typedArray(i.label,Lg.is))&&(i.kind===void 0||Og.is(i.kind))&&i.textEdits===void 0||G.typedArray(i.textEdits,An.is)&&(i.tooltip===void 0||G.string(i.tooltip)||yc.is(i.tooltip))&&(i.paddingLeft===void 0||G.boolean(i.paddingLeft))&&(i.paddingRight===void 0||G.boolean(i.paddingRight))}t.is=n})(Wk||(Wk={}));var Hk;(function(t){function e(n){return{kind:"snippet",value:n}}t.createSnippet=e})(Hk||(Hk={}));var Kk;(function(t){function e(n,r,i,s){return{insertText:n,filterText:r,range:i,
command:s}}t.create=e})(Kk||(Kk={}));var Vk;(function(t){function e(n){return{items:n}}t.create=e})(Vk||(Vk={}));var Xk;(function(t){t.Invoked=0,t.Automatic=1})(Xk||(Xk={}));var Yk;(function(t){function e(n,r){return{range:n,text:r}}t.create=e})(Yk||(Yk={}));var Jk;(function(t){function e(n,r){return{triggerKind:n,selectedCompletionInfo:r}}t.create=e})(Jk||(Jk={}));var Qk;(function(t){function e(n){const r=n;return G.objectLiteral(r)&&Tg.is(r.uri)&&G.string(r.name)}t.is=e})(Qk||(Qk={}));var Zk;(function(t){
function e(s,a,o,c){return new Tq(s,a,o,c)}t.create=e;function n(s){let a=s;return!!(G.defined(a)&&G.string(a.uri)&&(G.undefined(a.languageId)||G.string(a.languageId))&&G.uinteger(a.lineCount)&&G.func(a.getText)&&G.func(a.positionAt)&&G.func(a.offsetAt))}t.is=n;function r(s,a){let o=s.getText(),c=i(a,(l,f)=>{let d=l.range.start.line-f.range.start.line;return d===0?l.range.start.character-f.range.start.character:d}),u=o.length;for(let l=c.length-1;l>=0;l--){let f=c[l],d=s.offsetAt(f.range.start),
h=s.offsetAt(f.range.end);if(h<=u)o=o.substring(0,d)+f.newText+o.substring(h,o.length);else throw new Error("Overlapping edit");u=d}return o}t.applyEdits=r;function i(s,a){if(s.length<=1)return s;const o=s.length/2|0,c=s.slice(0,o),u=s.slice(o);i(c,a),i(u,a);let l=0,f=0,d=0;for(;l<c.length&&f<u.length;)a(c[l],u[f])<=0?s[d++]=c[l++]:s[d++]=u[f++];for(;l<c.length;)s[d++]=c[l++];for(;f<u.length;)s[d++]=u[f++];return s}})(Zk||(Zk={}));let Tq=class{constructor(e,n,r,i){this._uri=e,this._languageId=n,
this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,r=!0;for(let i=0;i<n.length;i++){r&&(e.push(i),r=!1);let s=n.charAt(
i);r=s==="\r"||s===`
`,s==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return tt.create(0,e);for(;r<i;){let a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}let s=r-1;return tt.create(s,e-n[s])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.
max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};var G;(function(t){const e=Object.prototype.toString;function n(h){return typeof h<"u"}t.defined=n;function r(h){return typeof h>"u"}t.undefined=r;function i(h){return h===!0||h===!1}t.boolean=i;function s(h){return e.call(h)==="[object String]"}t.string=s;function a(h){return e.call(h)==="[object Number]"}t.number=a;function o(h,m,b){return e.call(h)==="[object Number]"&&m<=h&&h<=b}t.numberRange=o;function c(h){
return e.call(h)==="[object Number]"&&-2147483648<=h&&h<=2147483647}t.integer=c;function u(h){return e.call(h)==="[object Number]"&&0<=h&&h<=2147483647}t.uinteger=u;function l(h){return e.call(h)==="[object Function]"}t.func=l;function f(h){return h!==null&&typeof h=="object"}t.objectLiteral=f;function d(h,m){return Array.isArray(h)&&h.every(m)}t.typedArray=d})(G||(G={}));class Eq{constructor(){this.nodeStack=[]}get current(){var e;return(e=this.nodeStack[this.nodeStack.length-1])!==null&&e!==void 0?
e:this.rootNode}buildRootNode(e){return this.rootNode=new tT(e),this.rootNode.root=this.rootNode,this.nodeStack=[this.rootNode],this.rootNode}buildCompositeNode(e){const n=new zg;return n.grammarSource=e,n.root=this.rootNode,this.current.content.push(n),this.nodeStack.push(n),n}buildLeafNode(e,n){const r=new Mg(e.startOffset,e.image.length,Qp(e),e.tokenType,!n);return r.grammarSource=n,r.root=this.rootNode,this.current.content.push(r),r}removeNode(e){const n=e.container;if(n){const r=n.content.indexOf(
e);r>=0&&n.content.splice(r,1)}}addHiddenNodes(e){const n=[];for(const s of e){const a=new Mg(s.startOffset,s.image.length,Qp(s),s.tokenType,!0);a.root=this.rootNode,n.push(a)}let r=this.current,i=!1;if(r.content.length>0){r.content.push(...n);return}for(;r.container;){const s=r.container.content.indexOf(r);if(s>0){r.container.content.splice(s,0,...n),i=!0;break}r=r.container}i||this.rootNode.content.unshift(...n)}construct(e){const n=this.current;typeof e.$type=="string"&&(this.current.astNode=
e),e.$cstNode=n;const r=this.nodeStack.pop();r?.content.length===0&&this.removeNode(r)}}class eT{get parent(){return this.container}get feature(){return this.grammarSource}get hidden(){return!1}get astNode(){var e,n;const r=typeof((e=this._astNode)===null||e===void 0?void 0:e.$type)=="string"?this._astNode:(n=this.container)===null||n===void 0?void 0:n.astNode;if(!r)throw new Error("This node has no associated AST element");return r}set astNode(e){this._astNode=e}get element(){return this.astNode}get text(){
return this.root.fullText.substring(this.offset,this.end)}}class Mg extends eT{get offset(){return this._offset}get length(){return this._length}get end(){return this._offset+this._length}get hidden(){return this._hidden}get tokenType(){return this._tokenType}get range(){return this._range}constructor(e,n,r,i,s=!1){super(),this._hidden=s,this._offset=e,this._tokenType=i,this._length=n,this._range=r}}class zg extends eT{constructor(){super(...arguments),this.content=new ew(this)}get children(){return this.
content}get offset(){var e,n;return(n=(e=this.firstNonHiddenNode)===null||e===void 0?void 0:e.offset)!==null&&n!==void 0?n:0}get length(){return this.end-this.offset}get end(){var e,n;return(n=(e=this.lastNonHiddenNode)===null||e===void 0?void 0:e.end)!==null&&n!==void 0?n:0}get range(){const e=this.firstNonHiddenNode,n=this.lastNonHiddenNode;if(e&&n){if(this._rangeCache===void 0){const{range:r}=e,{range:i}=n;this._rangeCache={start:r.start,end:i.end.line<r.start.line?r.start:i.end}}return this.
_rangeCache}else return{start:tt.create(0,0),end:tt.create(0,0)}}get firstNonHiddenNode(){for(const e of this.content)if(!e.hidden)return e;return this.content[0]}get lastNonHiddenNode(){for(let e=this.content.length-1;e>=0;e--){const n=this.content[e];if(!n.hidden)return n}return this.content[this.content.length-1]}}class ew extends Array{constructor(e){super(),this.parent=e,Object.setPrototypeOf(this,ew.prototype)}push(...e){return this.addParents(e),super.push(...e)}unshift(...e){return this.
addParents(e),super.unshift(...e)}splice(e,n,...r){return this.addParents(r),super.splice(e,n,...r)}addParents(e){for(const n of e)n.container=this.parent}}class tT extends zg{get text(){return this._text.substring(this.offset,this.end)}get fullText(){return this._text}constructor(e){super(),this._text="",this._text=e??""}}const Fg=Symbol("Datatype");function qg(t){return t.$type===Fg}const nT="\u200B",rT=t=>t.endsWith(nT)?t:t+nT;class iT{constructor(e){this._unorderedGroups=new Map,this.allRules=
new Map,this.lexer=e.parser.Lexer;const n=this.lexer.definition,r=e.LanguageMetaData.mode==="production";this.wrapper=new Pq(n,Object.assign(Object.assign({},e.parser.ParserConfig),{skipValidations:r,errorMessageProvider:e.parser.ParserErrorMessageProvider}))}alternatives(e,n){this.wrapper.wrapOr(e,n)}optional(e,n){this.wrapper.wrapOption(e,n)}many(e,n){this.wrapper.wrapMany(e,n)}atLeastOne(e,n){this.wrapper.wrapAtLeastOne(e,n)}getRule(e){return this.allRules.get(e)}isRecording(){return this.wrapper.
IS_RECORDING}get unorderedGroups(){return this._unorderedGroups}getRuleStack(){return this.wrapper.RULE_STACK}finalize(){this.wrapper.wrapSelfAnalysis()}}class Sq extends iT{get current(){return this.stack[this.stack.length-1]}constructor(e){super(e),this.nodeBuilder=new Eq,this.stack=[],this.assignmentMap=new Map,this.linker=e.references.Linker,this.converter=e.parser.ValueConverter,this.astReflection=e.shared.AstReflection}rule(e,n){const r=this.computeRuleType(e),i=this.wrapper.DEFINE_RULE(rT(
e.name),this.startImplementation(r,n).bind(this));return this.allRules.set(e.name,i),e.entry&&(this.mainRule=i),i}computeRuleType(e){if(!e.fragment){if(Id(e))return Fg;{const n=ts(e);return n??e.name}}}parse(e,n={}){this.nodeBuilder.buildRootNode(e);const r=this.lexerResult=this.lexer.tokenize(e);this.wrapper.input=r.tokens;const i=n.rule?this.allRules.get(n.rule):this.mainRule;if(!i)throw new Error(n.rule?`No rule found with name '${n.rule}'`:"No main rule available.");const s=i.call(this.wrapper,
{});return this.nodeBuilder.addHiddenNodes(r.hidden),this.unorderedGroups.clear(),this.lexerResult=void 0,{value:s,lexerErrors:r.errors,lexerReport:r.report,parserErrors:this.wrapper.errors}}startImplementation(e,n){return r=>{const i=!this.isRecording()&&e!==void 0;if(i){const a={$type:e};this.stack.push(a),e===Fg&&(a.value="")}let s;try{s=n(r)}catch{s=void 0}return s===void 0&&i&&(s=this.construct()),s}}extractHiddenTokens(e){const n=this.lexerResult.hidden;if(!n.length)return[];const r=e.startOffset;
for(let i=0;i<n.length;i++)if(n[i].startOffset>r)return n.splice(0,i);return n.splice(0,n.length)}consume(e,n,r){const i=this.wrapper.wrapConsume(e,n);if(!this.isRecording()&&this.isValidToken(i)){const s=this.extractHiddenTokens(i);this.nodeBuilder.addHiddenNodes(s);const a=this.nodeBuilder.buildLeafNode(i,r),{assignment:o,isCrossRef:c}=this.getAssignment(r),u=this.current;if(o){const l=wr(r)?i.image:this.converter.convert(i.image,a);this.assign(o.operator,o.feature,l,a,c)}else if(qg(u)){let l=i.
image;wr(r)||(l=this.converter.convert(l,a).toString()),u.value+=l}}}isValidToken(e){return!e.isInsertedInRecovery&&!isNaN(e.startOffset)&&typeof e.endOffset=="number"&&!isNaN(e.endOffset)}subrule(e,n,r,i,s){let a;!this.isRecording()&&!r&&(a=this.nodeBuilder.buildCompositeNode(i));const o=this.wrapper.wrapSubrule(e,n,s);!this.isRecording()&&a&&a.length>0&&this.performSubruleAssignment(o,i,a)}performSubruleAssignment(e,n,r){const{assignment:i,isCrossRef:s}=this.getAssignment(n);if(i)this.assign(i.
operator,i.feature,e,r,s);else if(!i){const a=this.current;if(qg(a))a.value+=e.toString();else if(typeof e=="object"&&e){const c=this.assignWithoutOverride(e,a);this.stack.pop(),this.stack.push(c)}}}action(e,n){if(!this.isRecording()){let r=this.current;if(n.feature&&n.operator){r=this.construct(),this.nodeBuilder.removeNode(r.$cstNode),this.nodeBuilder.buildCompositeNode(n).content.push(r.$cstNode);const s={$type:e};this.stack.push(s),this.assign(n.operator,n.feature,r,r.$cstNode,!1)}else r.$type=
e}}construct(){if(this.isRecording())return;const e=this.current;return lm(e),this.nodeBuilder.construct(e),this.stack.pop(),qg(e)?this.converter.convert(e.value,e.$cstNode):(fm(this.astReflection,e),e)}getAssignment(e){if(!this.assignmentMap.has(e)){const n=dn(e,vr);this.assignmentMap.set(e,{assignment:n,isCrossRef:n?xo(n.terminal):!1})}return this.assignmentMap.get(e)}assign(e,n,r,i,s){const a=this.current;let o;switch(s&&typeof r=="string"?o=this.linker.buildReference(a,n,i,r):o=r,e){case"=":{
a[n]=o;break}case"?=":{a[n]=!0;break}case"+=":Array.isArray(a[n])||(a[n]=[]),a[n].push(o)}}assignWithoutOverride(e,n){for(const[i,s]of Object.entries(n)){const a=e[i];a===void 0?e[i]=s:Array.isArray(a)&&Array.isArray(s)&&(s.push(...a),e[i]=s)}const r=e.$cstNode;return r&&(r.astNode=void 0,e.$cstNode=void 0),e}get definitionErrors(){return this.wrapper.definitionErrors}}class Aq{buildMismatchTokenMessage(e){return ga.buildMismatchTokenMessage(e)}buildNotAllInputParsedMessage(e){return ga.buildNotAllInputParsedMessage(
e)}buildNoViableAltMessage(e){return ga.buildNoViableAltMessage(e)}buildEarlyExitMessage(e){return ga.buildEarlyExitMessage(e)}}class sT extends Aq{buildMismatchTokenMessage({expected:e,actual:n}){return`Expecting ${e.LABEL?"`"+e.LABEL+"`":e.name.endsWith(":KW")?`keyword '${e.name.substring(0,e.name.length-3)}'`:`token of type '${e.name}'`} but found \`${n.image}\`.`}buildNotAllInputParsedMessage({firstRedundant:e}){return`Expecting end of file but found \`${e.image}\`.`}}class _q extends iT{constructor(){
super(...arguments),this.tokens=[],this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}action(){}construct(){}parse(e){this.resetState();const n=this.lexer.tokenize(e,{mode:"partial"});return this.tokens=n.tokens,this.wrapper.input=[...this.tokens],this.mainRule.call(this.wrapper,{}),this.unorderedGroups.clear(),{tokens:this.tokens,elementStack:[...this.lastElementStack],tokenIndex:this.nextTokenIndex}}rule(e,n){const r=this.wrapper.DEFINE_RULE(rT(e.name),this.startImplementation(
n).bind(this));return this.allRules.set(e.name,r),e.entry&&(this.mainRule=r),r}resetState(){this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}startImplementation(e){return n=>{const r=this.keepStackSize();try{e(n)}finally{this.resetStackSize(r)}}}removeUnexpectedElements(){this.elementStack.splice(this.stackSize)}keepStackSize(){const e=this.elementStack.length;return this.stackSize=e,e}resetStackSize(e){this.removeUnexpectedElements(),this.stackSize=e}consume(e,n,r){
this.wrapper.wrapConsume(e,n),this.isRecording()||(this.lastElementStack=[...this.elementStack,r],this.nextTokenIndex=this.currIdx+1)}subrule(e,n,r,i,s){this.before(i),this.wrapper.wrapSubrule(e,n,s),this.after(i)}before(e){this.isRecording()||this.elementStack.push(e)}after(e){if(!this.isRecording()){const n=this.elementStack.lastIndexOf(e);n>=0&&this.elementStack.splice(n)}}get currIdx(){return this.wrapper.currIdx}}const Cq={recoveryEnabled:!0,nodeLocationTracking:"full",skipValidations:!0,errorMessageProvider:new sT};
class Pq extends MF{constructor(e,n){const r=n&&"maxLookahead"in n;super(e,Object.assign(Object.assign(Object.assign({},Cq),{lookaheadStrategy:r?new mg({maxLookahead:n.maxLookahead}):new iq({logging:n.skipValidations?()=>{}:void 0})}),n))}get IS_RECORDING(){return this.RECORDING_PHASE}DEFINE_RULE(e,n){return this.RULE(e,n)}wrapSelfAnalysis(){this.performSelfAnalysis()}wrapConsume(e,n){return this.consume(e,n)}wrapSubrule(e,n,r){return this.subrule(e,n,{ARGS:[r]})}wrapOr(e,n){this.or(e,n)}wrapOption(e,n){
this.option(e,n)}wrapMany(e,n){this.many(e,n)}wrapAtLeastOne(e,n){this.atLeastOne(e,n)}}function aT(t,e,n){return xq({parser:e,tokens:n,ruleNames:new Map},t),e}function xq(t,e){const n=ym(e,!1),r=et(e.rules).filter(en).filter(i=>n.has(i));for(const i of r){const s=Object.assign(Object.assign({},t),{consume:1,optional:1,subrule:1,many:1,or:1});t.parser.rule(i,ls(s,i.definition))}}function ls(t,e,n=!1){let r;if(wr(e))r=zq(t,e);else if(es(e))r=Dq(t,e);else if(vr(e))r=ls(t,e.terminal);else if(xo(e))
r=oT(t,e);else if(Lr(e))r=Nq(t,e);else if(cm(e))r=Oq(t,e);else if(um(e))r=Lq(t,e);else if(vi(e))r=Mq(t,e);else if(SD(e)){const i=t.consume++;r=()=>t.parser.consume(i,ki,e)}else throw new db(e.$cstNode,`Unexpected element type: ${e.$type}`);return cT(t,n?void 0:Sf(e),r,e.cardinality)}function Dq(t,e){const n=Vo(e);return()=>t.parser.action(n,e)}function Nq(t,e){const n=e.rule.ref;if(en(n)){const r=t.subrule++,i=n.fragment,s=e.arguments.length>0?Iq(n,e.arguments):()=>({});return a=>t.parser.subrule(
r,uT(t,n),i,e,s(a))}else if(Or(n)){const r=t.consume++,i=Gg(t,n.name);return()=>t.parser.consume(r,i,e)}else if(n)lo();else throw new db(e.$cstNode,`Undefined rule: ${e.rule.$refText}`)}function Iq(t,e){const n=e.map(r=>Wr(r.value));return r=>{const i={};for(let s=0;s<n.length;s++){const a=t.parameters[s],o=n[s];i[a.name]=o(r)}return i}}function Wr(t){if(wD(t)){const e=Wr(t.left),n=Wr(t.right);return r=>e(r)||n(r)}else if(vD(t)){const e=Wr(t.left),n=Wr(t.right);return r=>e(r)&&n(r)}else if(bD(t)){
const e=Wr(t.value);return n=>!e(n)}else if($D(t)){const e=t.parameter.ref.name;return n=>n!==void 0&&n[e]===!0}else if(yD(t)){const e=!!t.true;return()=>e}lo()}function Oq(t,e){if(e.elements.length===1)return ls(t,e.elements[0]);{const n=[];for(const i of e.elements){const s={ALT:ls(t,i,!0)},a=Sf(i);a&&(s.GATE=Wr(a)),n.push(s)}const r=t.or++;return i=>t.parser.alternatives(r,n.map(s=>{const a={ALT:()=>s.ALT(i)},o=s.GATE;return o&&(a.GATE=()=>o(i)),a}))}}function Lq(t,e){if(e.elements.length===1)
return ls(t,e.elements[0]);const n=[];for(const o of e.elements){const c={ALT:ls(t,o,!0)},u=Sf(o);u&&(c.GATE=Wr(u)),n.push(c)}const r=t.or++,i=(o,c)=>{const u=c.getRuleStack().join("-");return`uGroup_${o}_${u}`},s=o=>t.parser.alternatives(r,n.map((c,u)=>{const l={ALT:()=>!0},f=t.parser;l.ALT=()=>{if(c.ALT(o),!f.isRecording()){const h=i(r,f);f.unorderedGroups.get(h)||f.unorderedGroups.set(h,[]);const m=f.unorderedGroups.get(h);typeof m?.[u]>"u"&&(m[u]=!0)}};const d=c.GATE;return d?l.GATE=()=>d(o):
l.GATE=()=>{const h=f.unorderedGroups.get(i(r,f));return!h?.[u]},l})),a=cT(t,Sf(e),s,"*");return o=>{a(o),t.parser.isRecording()||t.parser.unorderedGroups.delete(i(r,t.parser))}}function Mq(t,e){const n=e.elements.map(r=>ls(t,r));return r=>n.forEach(i=>i(r))}function Sf(t){if(vi(t))return t.guardCondition}function oT(t,e,n=e.terminal){if(n)if(Lr(n)&&en(n.rule.ref)){const r=n.rule.ref,i=t.subrule++;return s=>t.parser.subrule(i,uT(t,r),!1,e,s)}else if(Lr(n)&&Or(n.rule.ref)){const r=t.consume++,i=Gg(
t,n.rule.ref.name);return()=>t.parser.consume(r,i,e)}else if(wr(n)){const r=t.consume++,i=Gg(t,n.value);return()=>t.parser.consume(r,i,e)}else throw new Error("Could not build cross reference parser");else{if(!e.type.ref)throw new Error("Could not resolve reference to type: "+e.type.$refText);const r=Rm(e.type.ref),i=r?.terminal;if(!i)throw new Error("Could not find name assignment for type: "+Vo(e.type.ref));return oT(t,e,i)}}function zq(t,e){const n=t.consume++,r=t.tokens[e.value];if(!r)throw new Error(
"Could not find token for keyword: "+e.value);return()=>t.parser.consume(n,r,e)}function cT(t,e,n,r){const i=e&&Wr(e);if(!r)if(i){const s=t.or++;return a=>t.parser.alternatives(s,[{ALT:()=>n(a),GATE:()=>i(a)},{ALT:UR(),GATE:()=>!i(a)}])}else return n;if(r==="*"){const s=t.many++;return a=>t.parser.many(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else if(r==="+"){const s=t.many++;if(i){const a=t.or++;return o=>t.parser.alternatives(a,[{ALT:()=>t.parser.atLeastOne(s,{DEF:()=>n(o)}),GATE:()=>i(o)},{ALT:UR(),
GATE:()=>!i(o)}])}else return a=>t.parser.atLeastOne(s,{DEF:()=>n(a)})}else if(r==="?"){const s=t.optional++;return a=>t.parser.optional(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else lo()}function uT(t,e){const n=Fq(t,e),r=t.parser.getRule(n);if(!r)throw new Error(`Rule "${n}" not found."`);return r}function Fq(t,e){if(en(e))return e.name;if(t.ruleNames.has(e))return t.ruleNames.get(e);{let n=e,r=n.$container,i=e.$type;for(;!en(r);)(vi(r)||cm(r)||um(r))&&(i=r.elements.indexOf(n).toString()+":"+i),
n=r,r=r.$container;return i=r.name+":"+i,t.ruleNames.set(e,i),i}}function Gg(t,e){const n=t.tokens[e];if(!n)throw new Error(`Token "${e}" not found."`);return n}function qq(t){const e=t.Grammar,n=t.parser.Lexer,r=new _q(t);return aT(e,r,n.definition),r.finalize(),r}function Gq(t){const e=jq(t);return e.finalize(),e}function jq(t){const e=t.Grammar,n=t.parser.Lexer,r=new Sq(t);return aT(e,r,n.definition)}class Bq{constructor(){this.diagnostics=[]}buildTokens(e,n){const r=et(ym(e,!1)),i=this.buildTerminalTokens(
r),s=this.buildKeywordTokens(r,i,n);return i.forEach(a=>{const o=a.PATTERN;typeof o=="object"&&o&&"test"in o&&gm(o)?s.unshift(a):s.push(a)}),s}flushLexingReport(e){return{diagnostics:this.popDiagnostics()}}popDiagnostics(){const e=[...this.diagnostics];return this.diagnostics=[],e}buildTerminalTokens(e){return e.filter(Or).filter(n=>!n.fragment).map(n=>this.buildTerminalToken(n)).toArray()}buildTerminalToken(e){const n=Xo(e),r=this.requiresCustomPattern(n)?this.regexPatternFunction(n):n,i={name:e.
name,PATTERN:r};return typeof r=="function"&&(i.LINE_BREAKS=!0),e.hidden&&(i.GROUP=gm(n)?Sn.SKIPPED:"hidden"),i}requiresCustomPattern(e){return e.flags.includes("u")||e.flags.includes("s")?!0:!!(e.source.includes("?<=")||e.source.includes("?<!"))}regexPatternFunction(e){const n=new RegExp(e,e.flags+"y");return(r,i)=>(n.lastIndex=i,n.exec(r))}buildKeywordTokens(e,n,r){return e.filter(en).flatMap(i=>br(i).filter(wr)).distinct(i=>i.value).toArray().sort((i,s)=>s.value.length-i.value.length).map(i=>this.
buildKeywordToken(i,n,!!r?.caseInsensitive))}buildKeywordToken(e,n,r){const i=this.buildKeywordPattern(e,r),s={name:e.value,PATTERN:i,LONGER_ALT:this.findLongerAlt(e,n)};return typeof i=="function"&&(s.LINE_BREAKS=!0),s}buildKeywordPattern(e,n){return n?new RegExp(GD(e.value)):e.value}findLongerAlt(e,n){return n.reduce((r,i)=>{const s=i?.PATTERN;return s?.source&&jD("^"+s.source+"$",e.value)&&r.push(i),r},[])}}class Uq{convert(e,n){let r=n.grammarSource;if(xo(r)&&(r=vm(r)),Lr(r)){const i=r.rule.
ref;if(!i)throw new Error("This cst node was not parsed by a rule.");return this.runConverter(i,e,n)}return e}runConverter(e,n,r){var i;switch(e.name.toUpperCase()){case"INT":return Hr.convertInt(n);case"STRING":return Hr.convertString(n);case"ID":return Hr.convertID(n)}switch((i=Db(e))===null||i===void 0?void 0:i.toLowerCase()){case"number":return Hr.convertNumber(n);case"boolean":return Hr.convertBoolean(n);case"bigint":return Hr.convertBigint(n);case"date":return Hr.convertDate(n);default:return n}}}
var Hr;(function(t){function e(u){let l="";for(let f=1;f<u.length-1;f++){const d=u.charAt(f);if(d==="\\"){const h=u.charAt(++f);l+=n(h)}else l+=d}return l}t.convertString=e;function n(u){switch(u){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"0":return"\0";default:return u}}function r(u){return u.charAt(0)==="^"?u.substring(1):u}t.convertID=r;function i(u){return parseInt(u)}t.convertInt=i;function s(u){return BigInt(u)}t.convertBigint=s;function a(u){return new Date(u)}t.convertDate=a;function o(u){return Number(u)}t.convertNumber=o;function c(u){return u.toLowerCase()==="true"}t.convertBoolean=c})(Hr||(Hr={}));var ds={},Af={},lT;function fs(){if(lT)return Af;lT=1,Object.
defineProperty(Af,"__esModule",{value:!0});let t;function e(){if(t===void 0)throw new Error("No runtime abstraction layer installed");return t}return function(n){function r(i){if(i===void 0)throw new Error("No runtime abstraction layer provided");t=i}n.install=r}(e||(e={})),Af.default=e,Af}var Vt={},dT;function vc(){if(dT)return Vt;dT=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.stringArray=Vt.array=Vt.func=Vt.error=Vt.number=Vt.string=Vt.boolean=void 0;function t(o){return o===!0||o===
!1}Vt.boolean=t;function e(o){return typeof o=="string"||o instanceof String}Vt.string=e;function n(o){return typeof o=="number"||o instanceof Number}Vt.number=n;function r(o){return o instanceof Error}Vt.error=r;function i(o){return typeof o=="function"}Vt.func=i;function s(o){return Array.isArray(o)}Vt.array=s;function a(o){return s(o)&&o.every(c=>e(c))}return Vt.stringArray=a,Vt}var hs={},fT;function $a(){if(fT)return hs;fT=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.Emitter=hs.Event=
void 0;const t=fs();var e;(function(i){const s={dispose(){}};i.None=function(){return s}})(e||(hs.Event=e={}));class n{add(s,a=null,o){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(a),Array.isArray(o)&&o.push({dispose:()=>this.remove(s,a)})}remove(s,a=null){if(!this._callbacks)return;let o=!1;for(let c=0,u=this._callbacks.length;c<u;c++)if(this._callbacks[c]===s)if(this._contexts[c]===a){this._callbacks.splice(c,1),this._contexts.splice(c,1);
return}else o=!0;if(o)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const a=[],o=this._callbacks.slice(0),c=this._contexts.slice(0);for(let u=0,l=o.length;u<l;u++)try{a.push(o[u].apply(c[u],s))}catch(f){(0,t.default)().console.error(f)}return a}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(s){this._options=s}get event(){
return this._event||(this._event=(s,a,o)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,a);const c={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,a),c.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(c),c}),this._event}fire(s){this._callbacks&&
this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return hs.Emitter=r,r._noop=function(){},hs}var hT;function _f(){if(hT)return ds;hT=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.CancellationTokenSource=ds.CancellationToken=void 0;const t=fs(),e=vc(),n=$a();var r;(function(o){o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,
onCancellationRequested:n.Event.None});function c(u){const l=u;return l&&(l===o.None||l===o.Cancelled||e.boolean(l.isCancellationRequested)&&!!l.onCancellationRequested)}o.is=c})(r||(ds.CancellationToken=r={}));const i=Object.freeze(function(o,c){const u=(0,t.default)().timer.setTimeout(o.bind(c),0);return{dispose(){u.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){
return this._isCancelled}get onCancellationRequested(){return this._isCancelled?i:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class a{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=r.None}}return ds.CancellationTokenSource=a,ds}var at=_f();
function Wq(){return new Promise(t=>{typeof setImmediate>"u"?setTimeout(t,0):setImmediate(t)})}let Cf=0,Hq=10;function Kq(){return Cf=performance.now(),new at.CancellationTokenSource}const Pf=Symbol("OperationCancelled");function xf(t){return t===Pf}async function jt(t){if(t===at.CancellationToken.None)return;const e=performance.now();if(e-Cf>=Hq&&(Cf=e,await Wq(),Cf=performance.now()),t.isCancellationRequested)throw Pf}class jg{constructor(){this.promise=new Promise((e,n)=>{this.resolve=r=>(e(r),
this),this.reject=r=>(n(r),this)})}}class sd{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(const r of e)if(sd.isIncremental(r)){const i=gT(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.
end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);const o=Math.max(i.start.line,0),c=Math.max(i.end.line,0);let u=this._lineOffsets;const l=pT(r.text,!1,s);if(c-o===l.length)for(let d=0,h=l.length;d<h;d++)u[d+o+1]=l[d];else l.length<1e4?u.splice(o+1,c-o,...l):this._lineOffsets=u=u.slice(0,o+1).concat(l,u.slice(c+1));const f=r.text.length-(a-s);if(f!==0)for(let d=o+1+l.length,h=u.length;d<h;d++)u[d]=u[d]+f}else if(sd.isFull(r))this._content=r.text,
this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=pT(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const s=r-1;return e=this.ensureBeforeEOL(e,n[s]),{line:s,character:e-n[s]}}offsetAt(e){const n=this.
getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line];if(e.character<=0)return r;const i=e.line+1<n.length?n[e.line+1]:this._content.length,s=Math.min(r+e.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(e,n){for(;e>n&&mT(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||
typeof n.rangeLength=="number")}static isFull(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}}var Df;(function(t){function e(i,s,a,o){return new sd(i,s,a,o)}t.create=e;function n(i,s,a){if(i instanceof sd)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,s){const a=i.getText(),o=Bg(s.map(Vq),(l,f)=>{const d=l.range.start.line-f.range.start.line;return d===0?l.range.
start.character-f.range.start.character:d});let c=0;const u=[];for(const l of o){const f=i.offsetAt(l.range.start);if(f<c)throw new Error("Overlapping edit");f>c&&u.push(a.substring(c,f)),l.newText.length&&u.push(l.newText),c=i.offsetAt(l.range.end)}return u.push(a.substr(c)),u.join("")}t.applyEdits=r})(Df||(Df={}));function Bg(t,e){if(t.length<=1)return t;const n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);Bg(r,e),Bg(i,e);let s=0,a=0,o=0;for(;s<r.length&&a<i.length;)e(r[s],i[a])<=0?t[o++]=r[s++]:t[o++]=
i[a++];for(;s<r.length;)t[o++]=r[s++];for(;a<i.length;)t[o++]=i[a++];return t}function pT(t,e,n=0){const r=e?[n]:[];for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);mT(s)&&(s===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function mT(t){return t===13||t===10}function gT(t){const e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function Vq(t){const e=gT(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var yT;(()=>{
var t={975:z=>{function E(_){if(typeof _!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(_))}function R(_,P){for(var I,Z="",H=0,A=-1,te=0,me=0;me<=_.length;++me){if(me<_.length)I=_.charCodeAt(me);else{if(I===47)break;I=47}if(I===47){if(!(A===me-1||te===1))if(A!==me-1&&te===2){if(Z.length<2||H!==2||Z.charCodeAt(Z.length-1)!==46||Z.charCodeAt(Z.length-2)!==46){if(Z.length>2){var Ce=Z.lastIndexOf("/");if(Ce!==Z.length-1){Ce===-1?(Z="",H=0):H=(Z=Z.slice(0,Ce)).length-
1-Z.lastIndexOf("/"),A=me,te=0;continue}}else if(Z.length===2||Z.length===1){Z="",H=0,A=me,te=0;continue}}P&&(Z.length>0?Z+="/..":Z="..",H=2)}else Z.length>0?Z+="/"+_.slice(A+1,me):Z=_.slice(A+1,me),H=me-A-1;A=me,te=0}else I===46&&te!==-1?++te:te=-1}return Z}var M={resolve:function(){for(var _,P="",I=!1,Z=arguments.length-1;Z>=-1&&!I;Z--){var H;Z>=0?H=arguments[Z]:(_===void 0&&(_=process.cwd()),H=_),E(H),H.length!==0&&(P=H+"/"+P,I=H.charCodeAt(0)===47)}return P=R(P,!I),I?P.length>0?"/"+P:"/":P.length>
0?P:"."},normalize:function(_){if(E(_),_.length===0)return".";var P=_.charCodeAt(0)===47,I=_.charCodeAt(_.length-1)===47;return(_=R(_,!P)).length!==0||P||(_="."),_.length>0&&I&&(_+="/"),P?"/"+_:_},isAbsolute:function(_){return E(_),_.length>0&&_.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var _,P=0;P<arguments.length;++P){var I=arguments[P];E(I),I.length>0&&(_===void 0?_=I:_+="/"+I)}return _===void 0?".":M.normalize(_)},relative:function(_,P){if(E(_),E(P),_===P||(_=
M.resolve(_))===(P=M.resolve(P)))return"";for(var I=1;I<_.length&&_.charCodeAt(I)===47;++I);for(var Z=_.length,H=Z-I,A=1;A<P.length&&P.charCodeAt(A)===47;++A);for(var te=P.length-A,me=H<te?H:te,Ce=-1,L=0;L<=me;++L){if(L===me){if(te>me){if(P.charCodeAt(A+L)===47)return P.slice(A+L+1);if(L===0)return P.slice(A+L)}else H>me&&(_.charCodeAt(I+L)===47?Ce=L:L===0&&(Ce=0));break}var K=_.charCodeAt(I+L);if(K!==P.charCodeAt(A+L))break;K===47&&(Ce=L)}var _e="";for(L=I+Ce+1;L<=Z;++L)L!==Z&&_.charCodeAt(L)!==
47||(_e.length===0?_e+="..":_e+="/..");return _e.length>0?_e+P.slice(A+Ce):(A+=Ce,P.charCodeAt(A)===47&&++A,P.slice(A))},_makeLong:function(_){return _},dirname:function(_){if(E(_),_.length===0)return".";for(var P=_.charCodeAt(0),I=P===47,Z=-1,H=!0,A=_.length-1;A>=1;--A)if((P=_.charCodeAt(A))===47){if(!H){Z=A;break}}else H=!1;return Z===-1?I?"/":".":I&&Z===1?"//":_.slice(0,Z)},basename:function(_,P){if(P!==void 0&&typeof P!="string")throw new TypeError('"ext" argument must be a string');E(_);var I,
Z=0,H=-1,A=!0;if(P!==void 0&&P.length>0&&P.length<=_.length){if(P.length===_.length&&P===_)return"";var te=P.length-1,me=-1;for(I=_.length-1;I>=0;--I){var Ce=_.charCodeAt(I);if(Ce===47){if(!A){Z=I+1;break}}else me===-1&&(A=!1,me=I+1),te>=0&&(Ce===P.charCodeAt(te)?--te==-1&&(H=I):(te=-1,H=me))}return Z===H?H=me:H===-1&&(H=_.length),_.slice(Z,H)}for(I=_.length-1;I>=0;--I)if(_.charCodeAt(I)===47){if(!A){Z=I+1;break}}else H===-1&&(A=!1,H=I+1);return H===-1?"":_.slice(Z,H)},extname:function(_){E(_);for(var P=-1,
I=0,Z=-1,H=!0,A=0,te=_.length-1;te>=0;--te){var me=_.charCodeAt(te);if(me!==47)Z===-1&&(H=!1,Z=te+1),me===46?P===-1?P=te:A!==1&&(A=1):P!==-1&&(A=-1);else if(!H){I=te+1;break}}return P===-1||Z===-1||A===0||A===1&&P===Z-1&&P===I+1?"":_.slice(P,Z)},format:function(_){if(_===null||typeof _!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof _);return function(P,I){var Z=I.dir||I.root,H=I.base||(I.name||"")+(I.ext||"");return Z?Z===I.root?Z+H:Z+"/"+
H:H}(0,_)},parse:function(_){E(_);var P={root:"",dir:"",base:"",ext:"",name:""};if(_.length===0)return P;var I,Z=_.charCodeAt(0),H=Z===47;H?(P.root="/",I=1):I=0;for(var A=-1,te=0,me=-1,Ce=!0,L=_.length-1,K=0;L>=I;--L)if((Z=_.charCodeAt(L))!==47)me===-1&&(Ce=!1,me=L+1),Z===46?A===-1?A=L:K!==1&&(K=1):A!==-1&&(K=-1);else if(!Ce){te=L+1;break}return A===-1||me===-1||K===0||K===1&&A===me-1&&A===te+1?me!==-1&&(P.base=P.name=te===0&&H?_.slice(1,me):_.slice(te,me)):(te===0&&H?(P.name=_.slice(1,A),P.base=
_.slice(1,me)):(P.name=_.slice(te,A),P.base=_.slice(te,me)),P.ext=_.slice(A,me)),te>0?P.dir=_.slice(0,te-1):H&&(P.dir="/"),P},sep:"/",delimiter:":",win32:null,posix:null};M.posix=M,z.exports=M}},e={};function n(z){var E=e[z];if(E!==void 0)return E.exports;var R=e[z]={exports:{}};return t[z](R,R.exports,n),R.exports}n.d=(z,E)=>{for(var R in E)n.o(E,R)&&!n.o(z,R)&&Object.defineProperty(z,R,{enumerable:!0,get:E[R]})},n.o=(z,E)=>Object.prototype.hasOwnProperty.call(z,E),n.r=z=>{typeof Symbol<"u"&&Symbol.
toStringTag&&Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(z,"__esModule",{value:!0})};var r={};let i;n.r(r),n.d(r,{URI:()=>d,Utils:()=>ye}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);const s=/^\w[\w\d+.-]*$/,a=/^\//,o=/^\/\//;function c(z,E){if(!z.scheme&&E)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${z.authority}", path: "${z.path}", query: "${z.
query}", fragment: "${z.fragment}"}`);if(z.scheme&&!s.test(z.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(z.path){if(z.authority){if(!a.test(z.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(z.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}
const u="",l="/",f=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class d{static isUri(E){return E instanceof d||!!E&&typeof E.authority=="string"&&typeof E.fragment=="string"&&typeof E.path=="string"&&typeof E.query=="string"&&typeof E.scheme=="string"&&typeof E.fsPath=="string"&&typeof E.with=="function"&&typeof E.toString=="function"}scheme;authority;path;query;fragment;constructor(E,R,M,_,P,I=!1){typeof E=="object"?(this.scheme=E.scheme||u,this.authority=E.authority||u,this.path=
E.path||u,this.query=E.query||u,this.fragment=E.fragment||u):(this.scheme=function(Z,H){return Z||H?Z:"file"}(E,I),this.authority=R||u,this.path=function(Z,H){switch(Z){case"https":case"http":case"file":H?H[0]!==l&&(H=l+H):H=l}return H}(this.scheme,M||u),this.query=_||u,this.fragment=P||u,c(this,I))}get fsPath(){return k(this)}with(E){if(!E)return this;let{scheme:R,authority:M,path:_,query:P,fragment:I}=E;return R===void 0?R=this.scheme:R===null&&(R=u),M===void 0?M=this.authority:M===null&&(M=u),
_===void 0?_=this.path:_===null&&(_=u),P===void 0?P=this.query:P===null&&(P=u),I===void 0?I=this.fragment:I===null&&(I=u),R===this.scheme&&M===this.authority&&_===this.path&&P===this.query&&I===this.fragment?this:new m(R,M,_,P,I)}static parse(E,R=!1){const M=f.exec(E);return M?new m(M[2]||u,Y(M[4]||u),Y(M[5]||u),Y(M[7]||u),Y(M[9]||u),R):new m(u,u,u,u,u)}static file(E){let R=u;if(i&&(E=E.replace(/\\/g,l)),E[0]===l&&E[1]===l){const M=E.indexOf(l,2);M===-1?(R=E.substring(2),E=l):(R=E.substring(2,M),
E=E.substring(M)||l)}return new m("file",R,E,u,u)}static from(E){const R=new m(E.scheme,E.authority,E.path,E.query,E.fragment);return c(R,!0),R}toString(E=!1){return S(this,E)}toJSON(){return this}static revive(E){if(E){if(E instanceof d)return E;{const R=new m(E);return R._formatted=E.external,R._fsPath=E._sep===h?E.fsPath:null,R}}return E}}const h=i?1:void 0;class m extends d{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=k(this)),this._fsPath}toString(E=!1){return E?
S(this,!0):(this._formatted||(this._formatted=S(this,!1)),this._formatted)}toJSON(){const E={$mid:1};return this._fsPath&&(E.fsPath=this._fsPath,E._sep=h),this._formatted&&(E.external=this._formatted),this.path&&(E.path=this.path),this.scheme&&(E.scheme=this.scheme),this.authority&&(E.authority=this.authority),this.query&&(E.query=this.query),this.fragment&&(E.fragment=this.fragment),E}}const b={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"\
%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function $(z,E,R){let M,_=-1;for(let P=0;P<z.length;P++){const I=z.charCodeAt(P);if(I>=97&&I<=122||I>=65&&I<=90||I>=48&&I<=57||I===45||I===46||I===95||I===126||E&&I===47||R&&I===91||R&&I===93||R&&I===58)_!==-1&&(M+=encodeURIComponent(z.substring(_,P)),_=-1),M!==void 0&&(M+=z.charAt(P));else{M===void 0&&(M=z.substr(0,P));const Z=b[I];Z!==void 0?(_!==-1&&(M+=encodeURIComponent(z.substring(_,P)),_=-1),M+=Z):_===-1&&(_=P)}}return _!==
-1&&(M+=encodeURIComponent(z.substring(_))),M!==void 0?M:z}function w(z){let E;for(let R=0;R<z.length;R++){const M=z.charCodeAt(R);M===35||M===63?(E===void 0&&(E=z.substr(0,R)),E+=b[M]):E!==void 0&&(E+=z[R])}return E!==void 0?E:z}function k(z,E){let R;return R=z.authority&&z.path.length>1&&z.scheme==="file"?`//${z.authority}${z.path}`:z.path.charCodeAt(0)===47&&(z.path.charCodeAt(1)>=65&&z.path.charCodeAt(1)<=90||z.path.charCodeAt(1)>=97&&z.path.charCodeAt(1)<=122)&&z.path.charCodeAt(2)===58?z.path[1].
toLowerCase()+z.path.substr(2):z.path,i&&(R=R.replace(/\//g,"\\")),R}function S(z,E){const R=E?w:$;let M="",{scheme:_,authority:P,path:I,query:Z,fragment:H}=z;if(_&&(M+=_,M+=":"),(P||_==="file")&&(M+=l,M+=l),P){let A=P.indexOf("@");if(A!==-1){const te=P.substr(0,A);P=P.substr(A+1),A=te.lastIndexOf(":"),A===-1?M+=R(te,!1,!1):(M+=R(te.substr(0,A),!1,!1),M+=":",M+=R(te.substr(A+1),!1,!0)),M+="@"}P=P.toLowerCase(),A=P.lastIndexOf(":"),A===-1?M+=R(P,!1,!0):(M+=R(P.substr(0,A),!1,!0),M+=P.substr(A))}if(I){
if(I.length>=3&&I.charCodeAt(0)===47&&I.charCodeAt(2)===58){const A=I.charCodeAt(1);A>=65&&A<=90&&(I=`/${String.fromCharCode(A+32)}:${I.substr(3)}`)}else if(I.length>=2&&I.charCodeAt(1)===58){const A=I.charCodeAt(0);A>=65&&A<=90&&(I=`${String.fromCharCode(A+32)}:${I.substr(2)}`)}M+=R(I,!0,!1)}return Z&&(M+="?",M+=R(Z,!1,!1)),H&&(M+="#",M+=E?H:$(H,!1,!1)),M}function D(z){try{return decodeURIComponent(z)}catch{return z.length>3?z.substr(0,3)+D(z.substr(3)):z}}const F=/(%[0-9A-Za-z][0-9A-Za-z])+/g;
function Y(z){return z.match(F)?z.replace(F,E=>D(E)):z}var J=n(975);const ie=J.posix||J,re="/";var ye;(function(z){z.joinPath=function(E,...R){return E.with({path:ie.join(E.path,...R)})},z.resolvePath=function(E,...R){let M=E.path,_=!1;M[0]!==re&&(M=re+M,_=!0);let P=ie.resolve(M,...R);return _&&P[0]===re&&!E.authority&&(P=P.substring(1)),E.with({path:P})},z.dirname=function(E){if(E.path.length===0||E.path===re)return E;let R=ie.dirname(E.path);return R.length===1&&R.charCodeAt(0)===46&&(R=""),E.
with({path:R})},z.basename=function(E){return ie.basename(E.path)},z.extname=function(E){return ie.extname(E.path)}})(ye||(ye={})),yT=r})();const{URI:Xt,Utils:wc}=yT;var Et;(function(t){t.basename=wc.basename,t.dirname=wc.dirname,t.extname=wc.extname,t.joinPath=wc.joinPath,t.resolvePath=wc.resolvePath;function e(i,s){return i?.toString()===s?.toString()}t.equals=e;function n(i,s){const a=typeof i=="string"?i:i.path,o=typeof s=="string"?s:s.path,c=a.split("/").filter(h=>h.length>0),u=o.split("/").
filter(h=>h.length>0);let l=0;for(;l<c.length&&c[l]===u[l];l++);const f="../".repeat(c.length-l),d=u.slice(l).join("/");return f+d}t.relative=n;function r(i){return Xt.parse(i.toString()).toString()}t.normalize=r})(Et||(Et={}));var ze;(function(t){t[t.Changed=0]="Changed",t[t.Parsed=1]="Parsed",t[t.IndexedContent=2]="IndexedContent",t[t.ComputedScopes=3]="ComputedScopes",t[t.Linked=4]="Linked",t[t.IndexedReferences=5]="IndexedReferences",t[t.Validated=6]="Validated"})(ze||(ze={}));class Xq{constructor(e){
this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}async fromUri(e,n=at.CancellationToken.None){const r=await this.fileSystemProvider.readFile(e);return this.createAsync(e,r,n)}fromTextDocument(e,n,r){return n=n??Xt.parse(e.uri),at.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromString(e,n,r){return at.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromModel(e,n){return this.
create(n,{$model:e})}create(e,n,r){if(typeof n=="string"){const i=this.parse(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else if("$model"in n){const i={value:n.$model,parserErrors:[],lexerErrors:[]};return this.createLangiumDocument(i,e)}else{const i=this.parse(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}async createAsync(e,n,r){if(typeof n=="string"){const i=await this.parseAsync(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else{const i=await this.parseAsync(
e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}createLangiumDocument(e,n,r,i){let s;if(r)s={parseResult:e,uri:n,state:ze.Parsed,references:[],textDocument:r};else{const a=this.createTextDocumentGetter(n,i);s={parseResult:e,uri:n,state:ze.Parsed,references:[],get textDocument(){return a()}}}return e.value.$document=s,s}async update(e,n){var r,i;const s=(r=e.parseResult.value.$cstNode)===null||r===void 0?void 0:r.root.fullText,a=(i=this.textDocuments)===null||i===void 0?void 0:i.get(e.
uri.toString()),o=a?a.getText():await this.fileSystemProvider.readFile(e.uri);if(a)Object.defineProperty(e,"textDocument",{value:a});else{const c=this.createTextDocumentGetter(e.uri,o);Object.defineProperty(e,"textDocument",{get:c})}return s!==o&&(e.parseResult=await this.parseAsync(e.uri,o,n),e.parseResult.value.$document=e),e.state=ze.Parsed,e}parse(e,n,r){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(n,r)}parseAsync(e,n,r){return this.serviceRegistry.getServices(e).parser.
AsyncParser.parse(n,r)}createTextDocumentGetter(e,n){const r=this.serviceRegistry;let i;return()=>i??(i=Df.create(e.toString(),r.getServices(e).LanguageMetaData.languageId,0,n??""))}}class Yq{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.serviceRegistry=e.ServiceRegistry}get all(){return et(this.documentMap.values())}addDocument(e){const n=e.uri.toString();if(this.documentMap.has(n))throw new Error(`A document with the URI '${n}' is a\
lready present.`);this.documentMap.set(n,e)}getDocument(e){const n=e.toString();return this.documentMap.get(n)}async getOrCreateDocument(e,n){let r=this.getDocument(e);return r||(r=await this.langiumDocumentFactory.fromUri(e,n),this.addDocument(r),r)}createDocument(e,n,r){if(r)return this.langiumDocumentFactory.fromString(n,e,r).then(i=>(this.addDocument(i),i));{const i=this.langiumDocumentFactory.fromString(n,e);return this.addDocument(i),i}}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){
const n=e.toString(),r=this.documentMap.get(n);return r&&(this.serviceRegistry.getServices(e).references.Linker.unlink(r),r.state=ze.Changed,r.precomputedScopes=void 0,r.diagnostics=void 0),r}deleteDocument(e){const n=e.toString(),r=this.documentMap.get(n);return r&&(r.state=ze.Changed,this.documentMap.delete(n)),r}}const Ug=Symbol("ref_resolving");class Jq{constructor(e){this.reflection=e.shared.AstReflection,this.langiumDocuments=()=>e.shared.workspace.LangiumDocuments,this.scopeProvider=e.references.
ScopeProvider,this.astNodeLocator=e.workspace.AstNodeLocator}async link(e,n=at.CancellationToken.None){for(const r of Mr(e.parseResult.value))await jt(n),Ad(r).forEach(i=>this.doLink(i,e))}doLink(e,n){var r;const i=e.reference;if(i._ref===void 0){i._ref=Ug;try{const s=this.getCandidate(e);if(pd(s))i._ref=s;else if(i._nodeDescription=s,this.langiumDocuments().hasDocument(s.documentUri)){const a=this.loadAstNode(s);i._ref=a??this.createLinkingError(e,s)}else i._ref=void 0}catch(s){console.error(`A\
n error occurred while resolving reference to '${i.$refText}':`,s);const a=(r=s.message)!==null&&r!==void 0?r:String(s);i._ref=Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${i.$refText}': ${a}`})}n.references.push(i)}}unlink(e){for(const n of e.references)delete n._ref,delete n._nodeDescription;e.references=[]}getCandidate(e){const r=this.scopeProvider.getScope(e).getElement(e.reference.$refText);return r??this.createLinkingError(e)}buildReference(e,n,r,i){
const s=this,a={$refNode:r,$refText:i,get ref(){var o;if(bt(this._ref))return this._ref;if(oD(this._nodeDescription)){const c=s.loadAstNode(this._nodeDescription);this._ref=c??s.createLinkingError({reference:a,container:e,property:n},this._nodeDescription)}else if(this._ref===void 0){this._ref=Ug;const c=Sd(e).$document,u=s.getLinkedNode({reference:a,container:e,property:n});if(u.error&&c&&c.state<ze.ComputedScopes)return this._ref=void 0;this._ref=(o=u.node)!==null&&o!==void 0?o:u.error,this._nodeDescription=
u.descr,c?.references.push(this)}else if(this._ref===Ug)throw new Error(`Cyclic reference resolution detected: ${s.astNodeLocator.getAstNodePath(e)}/${n} (symbol '${i}')`);return bt(this._ref)?this._ref:void 0},get $nodeDescription(){return this._nodeDescription},get error(){return pd(this._ref)?this._ref:void 0}};return a}getLinkedNode(e){var n;try{const r=this.getCandidate(e);if(pd(r))return{error:r};const i=this.loadAstNode(r);return i?{node:i,descr:r}:{descr:r,error:this.createLinkingError(e,
r)}}catch(r){console.error(`An error occurred while resolving reference to '${e.reference.$refText}':`,r);const i=(n=r.message)!==null&&n!==void 0?n:String(r);return{error:Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${e.reference.$refText}': ${i}`})}}}loadAstNode(e){if(e.node)return e.node;const n=this.langiumDocuments().getDocument(e.documentUri);if(n)return this.astNodeLocator.getAstNode(n.parseResult.value,e.path)}createLinkingError(e,n){const r=Sd(
e.container).$document;r&&r.state<ze.ComputedScopes&&console.warn(`Attempted reference resolution before document reached ComputedScopes state (${r.uri}).`);const i=this.reflection.getReferenceType(e);return Object.assign(Object.assign({},e),{message:`Could not resolve reference to ${i} named '${e.reference.$refText}'.`,targetDescription:n})}}function Nf(t){return typeof t.name=="string"}class vT{getName(e){if(Nf(e))return e.name}getNameNode(e){return tn(e.$cstNode,"name")}}class Qq{constructor(e){
this.nameProvider=e.references.NameProvider,this.index=e.shared.workspace.IndexManager,this.nodeLocator=e.workspace.AstNodeLocator}findDeclaration(e){if(e){const n=Sb(e),r=e.astNode;if(n&&r){const i=r[n.feature];if(Bn(i))return i.ref;if(Array.isArray(i)){for(const s of i)if(Bn(s)&&s.$refNode&&s.$refNode.offset<=e.offset&&s.$refNode.end>=e.end)return s.ref}}if(r){const i=this.nameProvider.getNameNode(r);if(i&&(i===e||lD(e,i)))return r}}}findDeclarationNode(e){const n=this.findDeclaration(e);if(n?.
$cstNode){const r=this.nameProvider.getNameNode(n);return r??n.$cstNode}}findReferences(e,n){const r=[];if(n.includeDeclaration){const s=this.getReferenceToSelf(e);s&&r.push(s)}let i=this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e));return n.documentUri&&(i=i.filter(s=>Et.equals(s.sourceUri,n.documentUri))),r.push(...i),et(r)}getReferenceToSelf(e){const n=this.nameProvider.getNameNode(e);if(n){const r=ht(e),i=this.nodeLocator.getAstNodePath(e);return{sourceUri:r.uri,sourcePath:i,
targetUri:r.uri,targetPath:i,segment:yd(n),local:!0}}}}class Ot{constructor(e){if(this.map=new Map,e)for(const[n,r]of e)this.add(n,r)}get size(){return Jp.sum(et(this.map.values()).map(e=>e.length))}clear(){this.map.clear()}delete(e,n){if(n===void 0)return this.map.delete(e);{const r=this.map.get(e);if(r){const i=r.indexOf(n);if(i>=0)return r.length===1?this.map.delete(e):r.splice(i,1),!0}return!1}}get(e){var n;return(n=this.map.get(e))!==null&&n!==void 0?n:[]}has(e,n){if(n===void 0)return this.
map.has(e);{const r=this.map.get(e);return r?r.indexOf(n)>=0:!1}}add(e,n){return this.map.has(e)?this.map.get(e).push(n):this.map.set(e,[n]),this}addAll(e,n){return this.map.has(e)?this.map.get(e).push(...n):this.map.set(e,Array.from(n)),this}forEach(e){this.map.forEach((n,r)=>n.forEach(i=>e(i,r,this)))}[Symbol.iterator](){return this.entries().iterator()}entries(){return et(this.map.entries()).flatMap(([e,n])=>n.map(r=>[e,r]))}keys(){return et(this.map.keys())}values(){return et(this.map.values()).
flat()}entriesGroupedByKey(){return et(this.map.entries())}}class wT{get size(){return this.map.size}constructor(e){if(this.map=new Map,this.inverse=new Map,e)for(const[n,r]of e)this.set(n,r)}clear(){this.map.clear(),this.inverse.clear()}set(e,n){return this.map.set(e,n),this.inverse.set(n,e),this}get(e){return this.map.get(e)}getKey(e){return this.inverse.get(e)}delete(e){const n=this.map.get(e);return n!==void 0?(this.map.delete(e),this.inverse.delete(n),!0):!1}}class bT{constructor(e){this.nameProvider=
e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider}async computeExports(e,n=at.CancellationToken.None){return this.computeExportsForNode(e.parseResult.value,e,void 0,n)}async computeExportsForNode(e,n,r=Uo,i=at.CancellationToken.None){const s=[];this.exportNode(e,s,n);for(const a of r(e))await jt(i),this.exportNode(a,s,n);return s}exportNode(e,n,r){const i=this.nameProvider.getName(e);i&&n.push(this.descriptions.createDescription(e,i,r))}async computeLocalScopes(e,n=at.
CancellationToken.None){const r=e.parseResult.value,i=new Ot;for(const s of br(r))await jt(n),this.processNode(s,e,i);return i}processNode(e,n,r){const i=e.$container;if(i){const s=this.nameProvider.getName(e);s&&r.add(i,this.descriptions.createDescription(e,s,n))}}}class Ai{constructor(e,n,r){var i;this.elements=e,this.outerScope=n,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1}getAllElements(){return this.outerScope?this.elements.concat(this.outerScope.getAllElements()):this.
elements}getElement(e){const n=this.caseInsensitive?this.elements.find(r=>r.name.toLowerCase()===e.toLowerCase()):this.elements.find(r=>r.name===e);if(n)return n;if(this.outerScope)return this.outerScope.getElement(e)}}class $T{constructor(e,n,r){var i;this.elements=new Map,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1;for(const s of e){const a=this.caseInsensitive?s.name.toLowerCase():s.name;this.elements.set(a,s)}this.outerScope=n}getElement(e){const n=this.caseInsensitive?
e.toLowerCase():e,r=this.elements.get(n);if(r)return r;if(this.outerScope)return this.outerScope.getElement(e)}getAllElements(){let e=et(this.elements.values());return this.outerScope&&(e=e.concat(this.outerScope.getAllElements())),e}}const If={getElement(){},getAllElements(){return na}};class RT{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach(e=>e.dispose())}throwIfDisposed(){
if(this.isDisposed)throw new Error("This cache has already been disposed")}}class Zq extends RT{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,n){this.throwIfDisposed(),this.cache.set(e,n)}get(e,n){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(n){const r=n();return this.cache.set(e,r),r}else return}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}
class kT extends RT{constructor(e){super(),this.cache=new Map,this.converter=e??(n=>n)}has(e,n){return this.throwIfDisposed(),this.cacheForContext(e).has(n)}set(e,n,r){this.throwIfDisposed(),this.cacheForContext(e).set(n,r)}get(e,n,r){this.throwIfDisposed();const i=this.cacheForContext(e);if(i.has(n))return i.get(n);if(r){const s=r();return i.set(n,s),s}else return}delete(e,n){return this.throwIfDisposed(),this.cacheForContext(e).delete(n)}clear(e){if(this.throwIfDisposed(),e){const n=this.converter(
e);this.cache.delete(n)}else this.cache.clear()}cacheForContext(e){const n=this.converter(e);let r=this.cache.get(n);return r||(r=new Map,this.cache.set(n,r)),r}}class eG extends kT{constructor(e,n){super(r=>r.toString()),n?(this.toDispose.push(e.workspace.DocumentBuilder.onDocumentPhase(n,r=>{this.clear(r.uri.toString())})),this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{for(const s of i)this.clear(s)}))):this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{const s=r.
concat(i);for(const a of s)this.clear(a)}))}}class TT extends Zq{constructor(e,n){super(),n?(this.toDispose.push(e.workspace.DocumentBuilder.onBuildPhase(n,()=>{this.clear()})),this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{i.length>0&&this.clear()}))):this.toDispose.push(e.workspace.DocumentBuilder.onUpdate(()=>{this.clear()}))}}class ET{constructor(e){this.reflection=e.shared.AstReflection,this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider,
this.indexManager=e.shared.workspace.IndexManager,this.globalScopeCache=new TT(e.shared)}getScope(e){const n=[],r=this.reflection.getReferenceType(e),i=ht(e.container).precomputedScopes;if(i){let a=e.container;do{const o=i.get(a);o.length>0&&n.push(et(o).filter(c=>this.reflection.isSubtype(c.type,r))),a=a.$container}while(a)}let s=this.getGlobalScope(r,e);for(let a=n.length-1;a>=0;a--)s=this.createScope(n[a],s);return s}createScope(e,n,r){return new Ai(et(e),n,r)}createScopeForNodes(e,n,r){const i=et(
e).map(s=>{const a=this.nameProvider.getName(s);if(a)return this.descriptions.createDescription(s,a)}).nonNullable();return new Ai(i,n,r)}getGlobalScope(e,n){return this.globalScopeCache.get(e,()=>new $T(this.indexManager.allElements(e)))}}function tG(t){return typeof t.$comment=="string"}function ST(t){return typeof t=="object"&&!!t&&("$ref"in t||"$error"in t)}class nG{constructor(e){this.ignoreProperties=new Set(["$container","$containerProperty","$containerIndex","$document","$cstNode"]),this.
langiumDocuments=e.shared.workspace.LangiumDocuments,this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider,this.commentProvider=e.documentation.CommentProvider}serialize(e,n){const r=n??{},i=n?.replacer,s=(o,c)=>this.replacer(o,c,r),a=i?(o,c)=>i(o,c,s):s;try{return this.currentDocument=ht(e),JSON.stringify(e,a,n?.space)}finally{this.currentDocument=void 0}}deserialize(e,n){const r=n??{},i=JSON.parse(e);return this.linkNode(i,i,r),i}replacer(e,n,{refText:r,sourceText:i,
textRegions:s,comments:a,uriConverter:o}){var c,u,l,f;if(!this.ignoreProperties.has(e))if(Bn(n)){const d=n.ref,h=r?n.$refText:void 0;if(d){const m=ht(d);let b="";this.currentDocument&&this.currentDocument!==m&&(o?b=o(m.uri,n):b=m.uri.toString());const $=this.astNodeLocator.getAstNodePath(d);return{$ref:`${b}#${$}`,$refText:h}}else return{$error:(u=(c=n.error)===null||c===void 0?void 0:c.message)!==null&&u!==void 0?u:"Could not resolve reference",$refText:h}}else if(bt(n)){let d;if(s&&(d=this.addAstNodeRegionWithAssignmentsTo(
Object.assign({},n)),(!e||n.$document)&&d?.$textRegion&&(d.$textRegion.documentURI=(l=this.currentDocument)===null||l===void 0?void 0:l.uri.toString())),i&&!e&&(d??(d=Object.assign({},n)),d.$sourceText=(f=n.$cstNode)===null||f===void 0?void 0:f.text),a){d??(d=Object.assign({},n));const h=this.commentProvider.getComment(n);h&&(d.$comment=h.replace(/\r/g,""))}return d??n}else return n}addAstNodeRegionWithAssignmentsTo(e){const n=r=>({offset:r.offset,end:r.end,length:r.length,range:r.range});if(e.$cstNode){
const r=e.$textRegion=n(e.$cstNode),i=r.assignments={};return Object.keys(e).filter(s=>!s.startsWith("$")).forEach(s=>{const a=aa(e.$cstNode,s).map(n);a.length!==0&&(i[s]=a)}),e}}linkNode(e,n,r,i,s,a){for(const[c,u]of Object.entries(e))if(Array.isArray(u))for(let l=0;l<u.length;l++){const f=u[l];ST(f)?u[l]=this.reviveReference(e,c,n,f,r):bt(f)&&this.linkNode(f,n,r,e,c,l)}else ST(u)?e[c]=this.reviveReference(e,c,n,u,r):bt(u)&&this.linkNode(u,n,r,e,c);const o=e;o.$container=i,o.$containerProperty=
s,o.$containerIndex=a}reviveReference(e,n,r,i,s){let a=i.$refText,o=i.$error;if(i.$ref){const c=this.getRefNode(r,i.$ref,s.uriConverter);if(bt(c))return a||(a=this.nameProvider.getName(c)),{$refText:a??"",ref:c};o=c}if(o){const c={$refText:a??""};return c.error={container:e,property:n,message:o,reference:c},c}else return}getRefNode(e,n,r){try{const i=n.indexOf("#");if(i===0){const c=this.astNodeLocator.getAstNode(e,n.substring(1));return c||"Could not resolve path: "+n}if(i<0){const c=r?r(n):Xt.
parse(n),u=this.langiumDocuments.getDocument(c);return u?u.parseResult.value:"Could not find document for URI: "+n}const s=r?r(n.substring(0,i)):Xt.parse(n.substring(0,i)),a=this.langiumDocuments.getDocument(s);if(!a)return"Could not find document for URI: "+n;if(i===n.length-1)return a.parseResult.value;const o=this.astNodeLocator.getAstNode(a.parseResult.value,n.substring(i+1));return o||"Could not resolve URI: "+n}catch(i){return String(i)}}}class rG{get map(){return this.fileExtensionMap}constructor(e){
this.languageIdMap=new Map,this.fileExtensionMap=new Map,this.textDocuments=e?.workspace.TextDocuments}register(e){const n=e.LanguageMetaData;for(const r of n.fileExtensions)this.fileExtensionMap.has(r)&&console.warn(`The file extension ${r} is used by multiple languages. It is now assigned to '${n.languageId}'.`),this.fileExtensionMap.set(r,e);this.languageIdMap.set(n.languageId,e),this.languageIdMap.size===1?this.singleton=e:this.singleton=void 0}getServices(e){var n,r;if(this.singleton!==void 0)
return this.singleton;if(this.languageIdMap.size===0)throw new Error("The service registry is empty. Use `register` to register the services of a language.");const i=(r=(n=this.textDocuments)===null||n===void 0?void 0:n.get(e))===null||r===void 0?void 0:r.languageId;if(i!==void 0){const o=this.languageIdMap.get(i);if(o)return o}const s=Et.extname(e),a=this.fileExtensionMap.get(s);if(!a)throw i?new Error(`The service registry contains no services for the extension '${s}' for language '${i}'.`):new Error(
`The service registry contains no services for the extension '${s}'.`);return a}hasServices(e){try{return this.getServices(e),!0}catch{return!1}}get all(){return Array.from(this.languageIdMap.values())}}function bc(t){return{code:t}}var Of;(function(t){t.all=["fast","slow","built-in"]})(Of||(Of={}));class iG{constructor(e){this.entries=new Ot,this.entriesBefore=[],this.entriesAfter=[],this.reflection=e.shared.AstReflection}register(e,n=this,r="fast"){if(r==="built-in")throw new Error("The 'built\
-in' category is reserved for lexer, parser, and linker errors.");for(const[i,s]of Object.entries(e)){const a=s;if(Array.isArray(a))for(const o of a){const c={check:this.wrapValidationException(o,n),category:r};this.addEntry(i,c)}else if(typeof a=="function"){const o={check:this.wrapValidationException(a,n),category:r};this.addEntry(i,o)}else lo()}}wrapValidationException(e,n){return async(r,i,s)=>{await this.handleException(()=>e.call(n,r,i,s),"An error occurred during validation",i,r)}}async handleException(e,n,r,i){
try{await e()}catch(s){if(xf(s))throw s;console.error(`${n}:`,s),s instanceof Error&&s.stack&&console.error(s.stack);const a=s instanceof Error?s.message:String(s);r("error",`${n}: ${a}`,{node:i})}}addEntry(e,n){if(e==="AstNode"){this.entries.add("AstNode",n);return}for(const r of this.reflection.getAllSubTypes(e))this.entries.add(r,n)}getChecks(e,n){let r=et(this.entries.get(e)).concat(this.entries.get("AstNode"));return n&&(r=r.filter(i=>n.includes(i.category))),r.map(i=>i.check)}registerBeforeDocument(e,n=this){
this.entriesBefore.push(this.wrapPreparationException(e,"An error occurred during set-up of the validation",n))}registerAfterDocument(e,n=this){this.entriesAfter.push(this.wrapPreparationException(e,"An error occurred during tear-down of the validation",n))}wrapPreparationException(e,n,r){return async(i,s,a,o)=>{await this.handleException(()=>e.call(r,i,s,a,o),n,s,i)}}get checksBefore(){return this.entriesBefore}get checksAfter(){return this.entriesAfter}}class sG{constructor(e){this.validationRegistry=
e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,n={},r=at.CancellationToken.None){const i=e.parseResult,s=[];if(await jt(r),(!n.categories||n.categories.includes("built-in"))&&(this.processLexingErrors(i,s,n),n.stopAfterLexingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===or.LexingError})||(this.processParsingErrors(i,s,n),n.stopAfterParsingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===or.ParsingError}))||
(this.processLinkingErrors(e,s,n),n.stopAfterLinkingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===or.LinkingError}))))return s;try{s.push(...await this.validateAst(i.value,n,r))}catch(a){if(xf(a))throw a;console.error("An error occurred during validation:",a)}return await jt(r),s}processLexingErrors(e,n,r){var i,s,a;const o=[...e.lexerErrors,...(s=(i=e.lexerReport)===null||i===void 0?void 0:i.diagnostics)!==null&&s!==void 0?s:[]];for(const c of o){const u=(a=c.severity)!==
null&&a!==void 0?a:"error",l={severity:Wg(u),range:{start:{line:c.line-1,character:c.column-1},end:{line:c.line-1,character:c.column+c.length-1}},message:c.message,data:oG(u),source:this.getSource()};n.push(l)}}processParsingErrors(e,n,r){for(const i of e.parserErrors){let s;if(isNaN(i.token.startOffset)){if("previousToken"in i){const a=i.previousToken;if(isNaN(a.startOffset)){const o={line:0,character:0};s={start:o,end:o}}else{const o={line:a.endLine-1,character:a.endColumn};s={start:o,end:o}}}}else
s=Qp(i.token);if(s){const a={severity:Wg("error"),range:s,message:i.message,data:bc(or.ParsingError),source:this.getSource()};n.push(a)}}}processLinkingErrors(e,n,r){for(const i of e.references){const s=i.error;if(s){const a={node:s.container,property:s.property,index:s.index,data:{code:or.LinkingError,containerType:s.container.$type,property:s.property,refText:s.reference.$refText}};n.push(this.toDiagnostic("error",s.message,a))}}}async validateAst(e,n,r=at.CancellationToken.None){const i=[],s=(a,o,c)=>{
i.push(this.toDiagnostic(a,o,c))};return await this.validateAstBefore(e,n,s,r),await this.validateAstNodes(e,n,s,r),await this.validateAstAfter(e,n,s,r),i}async validateAstBefore(e,n,r,i=at.CancellationToken.None){var s;const a=this.validationRegistry.checksBefore;for(const o of a)await jt(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}async validateAstNodes(e,n,r,i=at.CancellationToken.None){await Promise.all(Mr(e).map(async s=>{await jt(i);const a=this.validationRegistry.getChecks(
s.$type,n.categories);for(const o of a)await o(s,r,i)}))}async validateAstAfter(e,n,r,i=at.CancellationToken.None){var s;const a=this.validationRegistry.checksAfter;for(const o of a)await jt(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}toDiagnostic(e,n,r){return{message:n,range:aG(r),severity:Wg(e),code:r.code,codeDescription:r.codeDescription,tags:r.tags,relatedInformation:r.relatedInformation,data:r.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function aG(t){
if(t.range)return t.range;let e;return typeof t.property=="string"?e=tn(t.node.$cstNode,t.property,t.index):typeof t.keyword=="string"&&(e=Ko(t.node.$cstNode,t.keyword,t.index)),e??(e=t.node.$cstNode),e?e.range:{start:{line:0,character:0},end:{line:0,character:0}}}function Wg(t){switch(t){case"error":return 1;case"warning":return 2;case"info":return 3;case"hint":return 4;default:throw new Error("Invalid diagnostic severity: "+t)}}function oG(t){switch(t){case"error":return bc(or.LexingError);case"\
warning":return bc(or.LexingWarning);case"info":return bc(or.LexingInfo);case"hint":return bc(or.LexingHint);default:throw new Error("Invalid diagnostic severity: "+t)}}var or;(function(t){t.LexingError="lexing-error",t.LexingWarning="lexing-warning",t.LexingInfo="lexing-info",t.LexingHint="lexing-hint",t.ParsingError="parsing-error",t.LinkingError="linking-error"})(or||(or={}));class cG{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,n,r){
const i=r??ht(e);n??(n=this.nameProvider.getName(e));const s=this.astNodeLocator.getAstNodePath(e);if(!n)throw new Error(`Node at path ${s} has no name.`);let a;const o=()=>{var c;return a??(a=yd((c=this.nameProvider.getNameNode(e))!==null&&c!==void 0?c:e.$cstNode))};return{node:e,name:n,get nameSegment(){return o()},selectionSegment:yd(e.$cstNode),type:e.$type,documentUri:i.uri,path:s}}}class uG{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,n=at.CancellationToken.
None){const r=[],i=e.parseResult.value;for(const s of Mr(i))await jt(n),Ad(s).filter(a=>!pd(a)).forEach(a=>{const o=this.createDescription(a);o&&r.push(o)});return r}createDescription(e){const n=e.reference.$nodeDescription,r=e.reference.$refNode;if(!n||!r)return;const i=ht(e.container).uri;return{sourceUri:i,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:n.documentUri,targetPath:n.path,segment:yd(r),local:Et.equals(n.documentUri,i)}}}class lG{constructor(){this.segmentSeparator=
"/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){const n=this.getAstNodePath(e.$container),r=this.getPathSegment(e);return n+this.segmentSeparator+r}return""}getPathSegment({$containerProperty:e,$containerIndex:n}){if(!e)throw new Error("Missing '$containerProperty' in AST node.");return n!==void 0?e+this.indexSeparator+n:e}getAstNode(e,n){return n.split(this.segmentSeparator).reduce((i,s)=>{if(!i||s.length===0)return i;const a=s.indexOf(this.indexSeparator);if(a>0){const o=s.substring(
0,a),c=parseInt(s.substring(a+1)),u=i[o];return u?.[c]}return i[s]},e)}}var dG=$a();class fG{constructor(e){this._ready=new jg,this.settings={},this.workspaceConfig=!1,this.onConfigurationSectionUpdateEmitter=new dG.Emitter,this.serviceRegistry=e.ServiceRegistry}get ready(){return this._ready.promise}initialize(e){var n,r;this.workspaceConfig=(r=(n=e.capabilities.workspace)===null||n===void 0?void 0:n.configuration)!==null&&r!==void 0?r:!1}async initialized(e){if(this.workspaceConfig){if(e.register){
const n=this.serviceRegistry.all;e.register({section:n.map(r=>this.toSectionName(r.LanguageMetaData.languageId))})}if(e.fetchConfiguration){const n=this.serviceRegistry.all.map(i=>({section:this.toSectionName(i.LanguageMetaData.languageId)})),r=await e.fetchConfiguration(n);n.forEach((i,s)=>{this.updateSectionConfiguration(i.section,r[s])})}}this._ready.resolve()}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach(n=>{const r=e.settings[n];this.updateSectionConfiguration(n,r),this.
onConfigurationSectionUpdateEmitter.fire({section:n,configuration:r})})}updateSectionConfiguration(e,n){this.settings[e]=n}async getConfiguration(e,n){await this.ready;const r=this.toSectionName(e);if(this.settings[r])return this.settings[r][n]}toSectionName(e){return`${e}`}get onConfigurationSectionUpdate(){return this.onConfigurationSectionUpdateEmitter.event}}var ps;(function(t){function e(n){return{dispose:async()=>await n()}}t.create=e})(ps||(ps={}));class hG{constructor(e){this.updateBuildOptions=
{validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new Ot,this.documentPhaseListeners=new Ot,this.buildState=new Map,this.documentBuildWaiters=new Map,this.currentState=ze.Changed,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.textDocuments=e.workspace.TextDocuments,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,n={},r=at.CancellationToken.
None){var i,s;for(const a of e){const o=a.uri.toString();if(a.state===ze.Validated){if(typeof n.validation=="boolean"&&n.validation)a.state=ze.IndexedReferences,a.diagnostics=void 0,this.buildState.delete(o);else if(typeof n.validation=="object"){const c=this.buildState.get(o),u=(i=c?.result)===null||i===void 0?void 0:i.validationChecks;if(u){const f=((s=n.validation.categories)!==null&&s!==void 0?s:Of.all).filter(d=>!u.includes(d));f.length>0&&(this.buildState.set(o,{completed:!1,options:{validation:Object.
assign(Object.assign({},n.validation),{categories:f})},result:c.result}),a.state=ze.IndexedReferences)}}}else this.buildState.delete(o)}this.currentState=ze.Changed,await this.emitUpdate(e.map(a=>a.uri),[]),await this.buildDocuments(e,n,r)}async update(e,n,r=at.CancellationToken.None){this.currentState=ze.Changed;for(const a of n)this.langiumDocuments.deleteDocument(a),this.buildState.delete(a.toString()),this.indexManager.remove(a);for(const a of e){if(!this.langiumDocuments.invalidateDocument(
a)){const c=this.langiumDocumentFactory.fromModel({$type:"INVALID"},a);c.state=ze.Changed,this.langiumDocuments.addDocument(c)}this.buildState.delete(a.toString())}const i=et(e).concat(n).map(a=>a.toString()).toSet();this.langiumDocuments.all.filter(a=>!i.has(a.uri.toString())&&this.shouldRelink(a,i)).forEach(a=>{this.serviceRegistry.getServices(a.uri).references.Linker.unlink(a),a.state=Math.min(a.state,ze.ComputedScopes),a.diagnostics=void 0}),await this.emitUpdate(e,n),await jt(r);const s=this.
sortDocuments(this.langiumDocuments.all.filter(a=>{var o;return a.state<ze.Linked||!(!((o=this.buildState.get(a.uri.toString()))===null||o===void 0)&&o.completed)}).toArray());await this.buildDocuments(s,this.updateBuildOptions,r)}async emitUpdate(e,n){await Promise.all(this.updateListeners.map(r=>r(e,n)))}sortDocuments(e){let n=0,r=e.length-1;for(;n<r;){for(;n<e.length&&this.hasTextDocument(e[n]);)n++;for(;r>=0&&!this.hasTextDocument(e[r]);)r--;n<r&&([e[n],e[r]]=[e[r],e[n]])}return e}hasTextDocument(e){
var n;return!!(!((n=this.textDocuments)===null||n===void 0)&&n.get(e.uri))}shouldRelink(e,n){return e.references.some(r=>r.error!==void 0)?!0:this.indexManager.isAffected(e,n)}onUpdate(e){return this.updateListeners.push(e),ps.create(()=>{const n=this.updateListeners.indexOf(e);n>=0&&this.updateListeners.splice(n,1)})}async buildDocuments(e,n,r){this.prepareBuild(e,n),await this.runCancelable(e,ze.Parsed,r,s=>this.langiumDocumentFactory.update(s,r)),await this.runCancelable(e,ze.IndexedContent,r,
s=>this.indexManager.updateContent(s,r)),await this.runCancelable(e,ze.ComputedScopes,r,async s=>{const a=this.serviceRegistry.getServices(s.uri).references.ScopeComputation;s.precomputedScopes=await a.computeLocalScopes(s,r)}),await this.runCancelable(e,ze.Linked,r,s=>this.serviceRegistry.getServices(s.uri).references.Linker.link(s,r)),await this.runCancelable(e,ze.IndexedReferences,r,s=>this.indexManager.updateReferences(s,r));const i=e.filter(s=>this.shouldValidate(s));await this.runCancelable(
i,ze.Validated,r,s=>this.validate(s,r));for(const s of e){const a=this.buildState.get(s.uri.toString());a&&(a.completed=!0)}}prepareBuild(e,n){for(const r of e){const i=r.uri.toString(),s=this.buildState.get(i);(!s||s.completed)&&this.buildState.set(i,{completed:!1,options:n,result:s?.result})}}async runCancelable(e,n,r,i){const s=e.filter(o=>o.state<n);for(const o of s)await jt(r),await i(o),o.state=n,await this.notifyDocumentPhase(o,n,r);const a=e.filter(o=>o.state===n);await this.notifyBuildPhase(
a,n,r),this.currentState=n}onBuildPhase(e,n){return this.buildPhaseListeners.add(e,n),ps.create(()=>{this.buildPhaseListeners.delete(e,n)})}onDocumentPhase(e,n){return this.documentPhaseListeners.add(e,n),ps.create(()=>{this.documentPhaseListeners.delete(e,n)})}waitUntil(e,n,r){let i;if(n&&"path"in n?i=n:r=n,r??(r=at.CancellationToken.None),i){const s=this.langiumDocuments.getDocument(i);if(s&&s.state>e)return Promise.resolve(i)}return this.currentState>=e?Promise.resolve(void 0):r.isCancellationRequested?
Promise.reject(Pf):new Promise((s,a)=>{const o=this.onBuildPhase(e,()=>{if(o.dispose(),c.dispose(),i){const u=this.langiumDocuments.getDocument(i);s(u?.uri)}else s(void 0)}),c=r.onCancellationRequested(()=>{o.dispose(),c.dispose(),a(Pf)})})}async notifyDocumentPhase(e,n,r){const s=this.documentPhaseListeners.get(n).slice();for(const a of s)try{await a(e,r)}catch(o){if(!xf(o))throw o}}async notifyBuildPhase(e,n,r){if(e.length===0)return;const s=this.buildPhaseListeners.get(n).slice();for(const a of s)
await jt(r),await a(e,r)}shouldValidate(e){return!!this.getBuildOptions(e).validation}async validate(e,n){var r,i;const s=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,a=this.getBuildOptions(e).validation,o=typeof a=="object"?a:void 0,c=await s.validateDocument(e,o,n);e.diagnostics?e.diagnostics.push(...c):e.diagnostics=c;const u=this.buildState.get(e.uri.toString());if(u){(r=u.result)!==null&&r!==void 0||(u.result={});const l=(i=o?.categories)!==null&&i!==void 0?i:Of.all;
u.result.validationChecks?u.result.validationChecks.push(...l):u.result.validationChecks=[...l]}}getBuildOptions(e){var n,r;return(r=(n=this.buildState.get(e.uri.toString()))===null||n===void 0?void 0:n.options)!==null&&r!==void 0?r:{}}}class pG{constructor(e){this.symbolIndex=new Map,this.symbolByTypeIndex=new kT,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,n){const r=ht(e).uri,
i=[];return this.referenceIndex.forEach(s=>{s.forEach(a=>{Et.equals(a.targetUri,r)&&a.targetPath===n&&i.push(a)})}),et(i)}allElements(e,n){let r=et(this.symbolIndex.keys());return n&&(r=r.filter(i=>!n||n.has(i))),r.map(i=>this.getFileDescriptions(i,e)).flat()}getFileDescriptions(e,n){var r;return n?this.symbolByTypeIndex.get(e,n,()=>{var s;return((s=this.symbolIndex.get(e))!==null&&s!==void 0?s:[]).filter(o=>this.astReflection.isSubtype(o.type,n))}):(r=this.symbolIndex.get(e))!==null&&r!==void 0?
r:[]}remove(e){const n=e.toString();this.symbolIndex.delete(n),this.symbolByTypeIndex.clear(n),this.referenceIndex.delete(n)}async updateContent(e,n=at.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).references.ScopeComputation.computeExports(e,n),s=e.uri.toString();this.symbolIndex.set(s,i),this.symbolByTypeIndex.clear(s)}async updateReferences(e,n=at.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).workspace.ReferenceDescriptionProvider.
createDescriptions(e,n);this.referenceIndex.set(e.uri.toString(),i)}isAffected(e,n){const r=this.referenceIndex.get(e.uri.toString());return r?r.some(i=>!i.local&&n.has(i.targetUri.toString())):!1}}class AT{constructor(e){this.initialBuildOptions={},this._ready=new jg,this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.WorkspaceLock}get ready(){
return this._ready.promise}get workspaceFolders(){return this.folders}initialize(e){var n;this.folders=(n=e.workspaceFolders)!==null&&n!==void 0?n:void 0}initialized(e){return this.mutex.write(n=>{var r;return this.initializeWorkspace((r=this.folders)!==null&&r!==void 0?r:[],n)})}async initializeWorkspace(e,n=at.CancellationToken.None){const r=await this.performStartup(e);await jt(n),await this.documentBuilder.build(r,this.initialBuildOptions,n)}async performStartup(e){const n=this.serviceRegistry.
all.flatMap(s=>s.LanguageMetaData.fileExtensions),r=[],i=s=>{r.push(s),this.langiumDocuments.hasDocument(s.uri)||this.langiumDocuments.addDocument(s)};return await this.loadAdditionalDocuments(e,i),await Promise.all(e.map(s=>[s,this.getRootFolder(s)]).map(async s=>this.traverseFolder(...s,n,i))),this._ready.resolve(),r}loadAdditionalDocuments(e,n){return Promise.resolve()}getRootFolder(e){return Xt.parse(e.uri)}async traverseFolder(e,n,r,i){const s=await this.fileSystemProvider.readDirectory(n);
await Promise.all(s.map(async a=>{if(this.includeEntry(e,a,r)){if(a.isDirectory)await this.traverseFolder(e,a.uri,r,i);else if(a.isFile){const o=await this.langiumDocuments.getOrCreateDocument(a.uri);i(o)}}}))}includeEntry(e,n,r){const i=Et.basename(n.uri);if(i.startsWith("."))return!1;if(n.isDirectory)return i!=="node_modules"&&i!=="out";if(n.isFile){const s=Et.extname(n.uri);return r.includes(s)}return!1}}class mG{buildUnexpectedCharactersMessage(e,n,r,i,s){return rg.buildUnexpectedCharactersMessage(
e,n,r,i,s)}buildUnableToPopLexerModeMessage(e){return rg.buildUnableToPopLexerModeMessage(e)}}const gG={mode:"full"};class yG{constructor(e){this.errorMessageProvider=e.parser.LexerErrorMessageProvider,this.tokenBuilder=e.parser.TokenBuilder;const n=this.tokenBuilder.buildTokens(e.Grammar,{caseInsensitive:e.LanguageMetaData.caseInsensitive});this.tokenTypes=this.toTokenTypeDictionary(n);const r=CT(n)?Object.values(n):n,i=e.LanguageMetaData.mode==="production";this.chevrotainLexer=new Sn(r,{positionTracking:"\
full",skipValidations:i,errorMessageProvider:this.errorMessageProvider})}get definition(){return this.tokenTypes}tokenize(e,n=gG){var r,i,s;const a=this.chevrotainLexer.tokenize(e);return{tokens:a.tokens,errors:a.errors,hidden:(r=a.groups.hidden)!==null&&r!==void 0?r:[],report:(s=(i=this.tokenBuilder).flushLexingReport)===null||s===void 0?void 0:s.call(i,e)}}toTokenTypeDictionary(e){if(CT(e))return e;const n=_T(e)?Object.values(e.modes).flat():e,r={};return n.forEach(i=>r[i.name]=i),r}}function vG(t){
return Array.isArray(t)&&(t.length===0||"name"in t[0])}function _T(t){return t&&"modes"in t&&"defaultMode"in t}function CT(t){return!vG(t)&&!_T(t)}function wG(t,e,n){let r,i;typeof t=="string"?(i=e,r=n):(i=t.range.start,r=e),i||(i=tt.create(0,0));const s=PT(t),a=Kg(r),o=RG({lines:s,position:i,options:a});return AG({index:0,tokens:o,position:i})}function bG(t,e){const n=Kg(e),r=PT(t);if(r.length===0)return!1;const i=r[0],s=r[r.length-1],a=n.start,o=n.end;return!!a?.exec(i)&&!!o?.exec(s)}function PT(t){
let e="";return typeof t=="string"?e=t:e=t.text,e.split(Rb)}const xT=/\s*(@([\p{L}][\p{L}\p{N}]*)?)/uy,$G=/\{(@[\p{L}][\p{L}\p{N}]*)(\s*)([^\r\n}]+)?\}/gu;function RG(t){var e,n,r;const i=[];let s=t.position.line,a=t.position.character;for(let o=0;o<t.lines.length;o++){const c=o===0,u=o===t.lines.length-1;let l=t.lines[o],f=0;if(c&&t.options.start){const h=(e=t.options.start)===null||e===void 0?void 0:e.exec(l);h&&(f=h.index+h[0].length)}else{const h=(n=t.options.line)===null||n===void 0?void 0:
n.exec(l);h&&(f=h.index+h[0].length)}if(u){const h=(r=t.options.end)===null||r===void 0?void 0:r.exec(l);h&&(l=l.substring(0,h.index))}if(l=l.substring(0,SG(l)),Hg(l,f)>=l.length){if(i.length>0){const h=tt.create(s,a);i.push({type:"break",content:"",range:Ue.create(h,h)})}}else{xT.lastIndex=f;const h=xT.exec(l);if(h){const m=h[0],b=h[1],$=tt.create(s,a+f),w=tt.create(s,a+f+m.length);i.push({type:"tag",content:b,range:Ue.create($,w)}),f+=m.length,f=Hg(l,f)}if(f<l.length){const m=l.substring(f),b=Array.
from(m.matchAll($G));i.push(...kG(b,m,s,a+f))}}s++,a=0}return i.length>0&&i[i.length-1].type==="break"?i.slice(0,-1):i}function kG(t,e,n,r){const i=[];if(t.length===0){const s=tt.create(n,r),a=tt.create(n,r+e.length);i.push({type:"text",content:e,range:Ue.create(s,a)})}else{let s=0;for(const o of t){const c=o.index,u=e.substring(s,c);u.length>0&&i.push({type:"text",content:e.substring(s,c),range:Ue.create(tt.create(n,s+r),tt.create(n,c+r))});let l=u.length+1;const f=o[1];if(i.push({type:"inline-\
tag",content:f,range:Ue.create(tt.create(n,s+l+r),tt.create(n,s+l+f.length+r))}),l+=f.length,o.length===4){l+=o[2].length;const d=o[3];i.push({type:"text",content:d,range:Ue.create(tt.create(n,s+l+r),tt.create(n,s+l+d.length+r))})}else i.push({type:"text",content:"",range:Ue.create(tt.create(n,s+l+r),tt.create(n,s+l+r))});s=c+o[0].length}const a=e.substring(s);a.length>0&&i.push({type:"text",content:a,range:Ue.create(tt.create(n,s+r),tt.create(n,s+r+a.length))})}return i}const TG=/\S/,EG=/\s*$/;
function Hg(t,e){const n=t.substring(e).match(TG);return n?e+n.index:t.length}function SG(t){const e=t.match(EG);if(e&&typeof e.index=="number")return e.index}function AG(t){var e,n,r,i;const s=tt.create(t.position.line,t.position.character);if(t.tokens.length===0)return new OT([],Ue.create(s,s));const a=[];for(;t.index<t.tokens.length;){const u=_G(t,a[a.length-1]);u&&a.push(u)}const o=(n=(e=a[0])===null||e===void 0?void 0:e.range.start)!==null&&n!==void 0?n:s,c=(i=(r=a[a.length-1])===null||r===
void 0?void 0:r.range.end)!==null&&i!==void 0?i:s;return new OT(a,Ue.create(o,c))}function _G(t,e){const n=t.tokens[t.index];if(n.type==="tag")return NT(t,!1);if(n.type==="text"||n.type==="inline-tag")return DT(t);CG(n,e),t.index++}function CG(t,e){if(e){const n=new LT("",t.range);"inlines"in e?e.inlines.push(n):e.content.inlines.push(n)}}function DT(t){let e=t.tokens[t.index];const n=e;let r=e;const i=[];for(;e&&e.type!=="break"&&e.type!=="tag";)i.push(PG(t)),r=e,e=t.tokens[t.index];return new Yg(
i,Ue.create(n.range.start,r.range.end))}function PG(t){return t.tokens[t.index].type==="inline-tag"?NT(t,!0):IT(t)}function NT(t,e){const n=t.tokens[t.index++],r=n.content.substring(1),i=t.tokens[t.index];if(i?.type==="text")if(e){const s=IT(t);return new Xg(r,new Yg([s],s.range),e,Ue.create(n.range.start,s.range.end))}else{const s=DT(t);return new Xg(r,s,e,Ue.create(n.range.start,s.range.end))}else{const s=n.range;return new Xg(r,new Yg([],s),e,s)}}function IT(t){const e=t.tokens[t.index++];return new LT(
e.content,e.range)}function Kg(t){if(!t)return Kg({start:"/**",end:"*/",line:"*"});const{start:e,end:n,line:r}=t;return{start:Vg(e,!0),end:Vg(n,!1),line:Vg(r,!0)}}function Vg(t,e){if(typeof t=="string"||typeof t=="object"){const n=typeof t=="string"?Dd(t):t.source;return e?new RegExp(`^\\s*${n}`):new RegExp(`\\s*${n}\\s*$`)}else return t}class OT{constructor(e,n){this.elements=e,this.range=n}getTag(e){return this.getAllTags().find(n=>n.name===e)}getTags(e){return this.getAllTags().filter(n=>n.name===
e)}getAllTags(){return this.elements.filter(e=>"name"in e)}toString(){let e="";for(const n of this.elements)if(e.length===0)e=n.toString();else{const r=n.toString();e+=MT(e)+r}return e.trim()}toMarkdown(e){let n="";for(const r of this.elements)if(n.length===0)n=r.toMarkdown(e);else{const i=r.toMarkdown(e);n+=MT(n)+i}return n.trim()}}class Xg{constructor(e,n,r,i){this.name=e,this.content=n,this.inline=r,this.range=i}toString(){let e=`@${this.name}`;const n=this.content.toString();return this.content.
inlines.length===1?e=`${e} ${n}`:this.content.inlines.length>1&&(e=`${e}
${n}`),this.inline?`{${e}}`:e}toMarkdown(e){var n,r;return(r=(n=e?.renderTag)===null||n===void 0?void 0:n.call(e,this))!==null&&r!==void 0?r:this.toMarkdownDefault(e)}toMarkdownDefault(e){const n=this.content.toMarkdown(e);if(this.inline){const s=xG(this.name,n,e??{});if(typeof s=="string")return s}let r="";e?.tag==="italic"||e?.tag===void 0?r="*":e?.tag==="bold"?r="**":e?.tag==="bold-italic"&&(r="***");let i=`${r}@${this.name}${r}`;return this.content.inlines.length===1?i=`${i} \u2014 ${n}`:this.
content.inlines.length>1&&(i=`${i}
${n}`),this.inline?`{${i}}`:i}}function xG(t,e,n){var r,i;if(t==="linkplain"||t==="linkcode"||t==="link"){const s=e.indexOf(" ");let a=e;if(s>0){const c=Hg(e,s);a=e.substring(c),e=e.substring(0,s)}return(t==="linkcode"||t==="link"&&n.link==="code")&&(a=`\`${a}\``),(i=(r=n.renderLink)===null||r===void 0?void 0:r.call(n,e,a))!==null&&i!==void 0?i:DG(e,a)}}function DG(t,e){try{return Xt.parse(t,!0),`[${e}](${t})`}catch{return t}}class Yg{constructor(e,n){this.inlines=e,this.range=n}toString(){let e="";
for(let n=0;n<this.inlines.length;n++){const r=this.inlines[n],i=this.inlines[n+1];e+=r.toString(),i&&i.range.start.line>r.range.start.line&&(e+=`
`)}return e}toMarkdown(e){let n="";for(let r=0;r<this.inlines.length;r++){const i=this.inlines[r],s=this.inlines[r+1];n+=i.toMarkdown(e),s&&s.range.start.line>i.range.start.line&&(n+=`
`)}return n}}class LT{constructor(e,n){this.text=e,this.range=n}toString(){return this.text}toMarkdown(){return this.text}}function MT(t){return t.endsWith(`
`)?`
`:`

`}class NG{constructor(e){this.indexManager=e.shared.workspace.IndexManager,this.commentProvider=e.documentation.CommentProvider}getDocumentation(e){const n=this.commentProvider.getComment(e);if(n&&bG(n))return wG(n).toMarkdown({renderLink:(i,s)=>this.documentationLinkRenderer(e,i,s),renderTag:i=>this.documentationTagRenderer(e,i)})}documentationLinkRenderer(e,n,r){var i;const s=(i=this.findNameInPrecomputedScopes(e,n))!==null&&i!==void 0?i:this.findNameInGlobalScope(e,n);if(s&&s.nameSegment){const a=s.
nameSegment.range.start.line+1,o=s.nameSegment.range.start.character+1,c=s.documentUri.with({fragment:`L${a},${o}`});return`[${r}](${c.toString()})`}else return}documentationTagRenderer(e,n){}findNameInPrecomputedScopes(e,n){const i=ht(e).precomputedScopes;if(!i)return;let s=e;do{const o=i.get(s).find(c=>c.name===n);if(o)return o;s=s.$container}while(s)}findNameInGlobalScope(e,n){return this.indexManager.allElements().find(i=>i.name===n)}}class IG{constructor(e){this.grammarConfig=()=>e.parser.GrammarConfig}getComment(e){
var n;return tG(e)?e.$comment:(n=Zp(e.$cstNode,this.grammarConfig().multilineCommentRules))===null||n===void 0?void 0:n.text}}class OG{constructor(e){this.syncParser=e.parser.LangiumParser}parse(e,n){return Promise.resolve(this.syncParser.parse(e))}}class LG{constructor(){this.previousTokenSource=new at.CancellationTokenSource,this.writeQueue=[],this.readQueue=[],this.done=!0}write(e){this.cancelWrite();const n=Kq();return this.previousTokenSource=n,this.enqueue(this.writeQueue,e,n.token)}read(e){
return this.enqueue(this.readQueue,e)}enqueue(e,n,r=at.CancellationToken.None){const i=new jg,s={action:n,deferred:i,cancellationToken:r};return e.push(s),this.performNextOperation(),i.promise}async performNextOperation(){if(!this.done)return;const e=[];if(this.writeQueue.length>0)e.push(this.writeQueue.shift());else if(this.readQueue.length>0)e.push(...this.readQueue.splice(0,this.readQueue.length));else return;this.done=!1,await Promise.all(e.map(async({action:n,deferred:r,cancellationToken:i})=>{
try{const s=await Promise.resolve().then(()=>n(i));r.resolve(s)}catch(s){xf(s)?r.resolve(void 0):r.reject(s)}})),this.done=!0,this.performNextOperation()}cancelWrite(){this.previousTokenSource.cancel()}}class MG{constructor(e){this.grammarElementIdMap=new wT,this.tokenTypeIdMap=new wT,this.grammar=e.Grammar,this.lexer=e.parser.Lexer,this.linker=e.references.Linker}dehydrate(e){return{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport?this.dehydrateLexerReport(e.lexerReport):void 0,parserErrors:e.
parserErrors.map(n=>Object.assign(Object.assign({},n),{message:n.message})),value:this.dehydrateAstNode(e.value,this.createDehyrationContext(e.value))}}dehydrateLexerReport(e){return e}createDehyrationContext(e){const n=new Map,r=new Map;for(const i of Mr(e))n.set(i,{});if(e.$cstNode)for(const i of gd(e.$cstNode))r.set(i,{});return{astNodes:n,cstNodes:r}}dehydrateAstNode(e,n){const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.
$cstNode!==void 0&&(r.$cstNode=this.dehydrateCstNode(e.$cstNode,n));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)bt(o)?a.push(this.dehydrateAstNode(o,n)):Bn(o)?a.push(this.dehydrateReference(o,n)):a.push(o)}else bt(s)?r[i]=this.dehydrateAstNode(s,n):Bn(s)?r[i]=this.dehydrateReference(s,n):s!==void 0&&(r[i]=s);return r}dehydrateReference(e,n){const r={};return r.$refText=e.$refText,e.$refNode&&(r.$refNode=n.cstNodes.get(e.$refNode)),
r}dehydrateCstNode(e,n){const r=n.cstNodes.get(e);return ib(e)?r.fullText=e.fullText:r.grammarSource=this.getGrammarElementId(e.grammarSource),r.hidden=e.hidden,r.astNode=n.astNodes.get(e.astNode),yi(e)?r.content=e.content.map(i=>this.dehydrateCstNode(i,n)):Qi(e)&&(r.tokenType=e.tokenType.name,r.offset=e.offset,r.length=e.length,r.startLine=e.range.start.line,r.startColumn=e.range.start.character,r.endLine=e.range.end.line,r.endColumn=e.range.end.character),r}hydrate(e){const n=e.value,r=this.createHydrationContext(
n);return"$cstNode"in n&&this.hydrateCstNode(n.$cstNode,r),{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport,parserErrors:e.parserErrors,value:this.hydrateAstNode(n,r)}}createHydrationContext(e){const n=new Map,r=new Map;for(const s of Mr(e))n.set(s,{});let i;if(e.$cstNode)for(const s of gd(e.$cstNode)){let a;"fullText"in s?(a=new tT(s.fullText),i=a):"content"in s?a=new zg:"tokenType"in s&&(a=this.hydrateCstLeafNode(s)),a&&(r.set(s,a),a.root=i)}return{astNodes:n,cstNodes:r}}hydrateAstNode(e,n){
const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.$cstNode&&(r.$cstNode=n.cstNodes.get(e.$cstNode));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)bt(o)?a.push(this.setParent(this.hydrateAstNode(o,n),r)):Bn(o)?a.push(this.hydrateReference(o,r,i,n)):a.push(o)}else bt(s)?r[i]=this.setParent(this.hydrateAstNode(s,n),r):Bn(s)?r[i]=this.hydrateReference(s,r,i,n):s!==
void 0&&(r[i]=s);return r}setParent(e,n){return e.$container=n,e}hydrateReference(e,n,r,i){return this.linker.buildReference(n,r,i.cstNodes.get(e.$refNode),e.$refText)}hydrateCstNode(e,n,r=0){const i=n.cstNodes.get(e);if(typeof e.grammarSource=="number"&&(i.grammarSource=this.getGrammarElement(e.grammarSource)),i.astNode=n.astNodes.get(e.astNode),yi(i))for(const s of e.content){const a=this.hydrateCstNode(s,n,r++);i.content.push(a)}return i}hydrateCstLeafNode(e){const n=this.getTokenType(e.tokenType),
r=e.offset,i=e.length,s=e.startLine,a=e.startColumn,o=e.endLine,c=e.endColumn,u=e.hidden;return new Mg(r,i,{start:{line:s,character:a},end:{line:o,character:c}},n,u)}getTokenType(e){return this.lexer.definition[e]}getGrammarElementId(e){if(e)return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.get(e)}getGrammarElement(e){return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.getKey(e)}createGrammarElementIdMap(){
let e=0;for(const n of Mr(this.grammar))rm(n)&&this.grammarElementIdMap.set(n,e++)}}function zT(t){return{documentation:{CommentProvider:e=>new IG(e),DocumentationProvider:e=>new NG(e)},parser:{AsyncParser:e=>new OG(e),GrammarConfig:e=>QD(e),LangiumParser:e=>Gq(e),CompletionParser:e=>qq(e),ValueConverter:()=>new Uq,TokenBuilder:()=>new Bq,Lexer:e=>new yG(e),ParserErrorMessageProvider:()=>new sT,LexerErrorMessageProvider:()=>new mG},workspace:{AstNodeLocator:()=>new lG,AstNodeDescriptionProvider:e=>new cG(
e),ReferenceDescriptionProvider:e=>new uG(e)},references:{Linker:e=>new Jq(e),NameProvider:()=>new vT,ScopeProvider:e=>new ET(e),ScopeComputation:e=>new bT(e),References:e=>new Qq(e)},serializer:{Hydrator:e=>new MG(e),JsonSerializer:e=>new nG(e)},validation:{DocumentValidator:e=>new sG(e),ValidationRegistry:e=>new iG(e)},shared:()=>t.shared}}function FT(t){return{ServiceRegistry:e=>new rG(e),workspace:{LangiumDocuments:e=>new Yq(e),LangiumDocumentFactory:e=>new Xq(e),DocumentBuilder:e=>new hG(e),
IndexManager:e=>new pG(e),WorkspaceManager:e=>new AT(e),FileSystemProvider:e=>t.fileSystemProvider(e),WorkspaceLock:()=>new LG,ConfigurationProvider:e=>new fG(e)}}}var Lf;(function(t){t.merge=(e,n)=>zf(zf({},e),n)})(Lf||(Lf={}));function Mf(t,e,n,r,i,s,a,o,c){const u=[t,e,n,r,i,s,a,o,c].reduce(zf,{});return GT(u)}const qT=Symbol("isProxy");function Jg(t){if(t&&t[qT])for(const e of Object.values(t))Jg(e);return t}function GT(t,e){const n=new Proxy({},{deleteProperty:()=>!1,set:()=>{throw new Error(
"Cannot set property on injected service container")},get:(r,i)=>i===qT?!0:BT(r,i,t,e||n),getOwnPropertyDescriptor:(r,i)=>(BT(r,i,t,e||n),Object.getOwnPropertyDescriptor(r,i)),has:(r,i)=>i in t,ownKeys:()=>[...Object.getOwnPropertyNames(t)]});return n}const jT=Symbol();function BT(t,e,n,r){if(e in t){if(t[e]instanceof Error)throw new Error("Construction failure. Please make sure that your dependencies are constructable.",{cause:t[e]});if(t[e]===jT)throw new Error('Cycle detected. Please make "'+
String(e)+'" lazy. Visit https://langium.org/docs/reference/configuration-services/#resolving-cyclic-dependencies');return t[e]}else if(e in n){const i=n[e];t[e]=jT;try{t[e]=typeof i=="function"?i(r):GT(i,r)}catch(s){throw t[e]=s instanceof Error?s:void 0,s}return t[e]}else return}function zf(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=zf(i,r):t[n]=r}}return t}class zG{readFile(){throw new Error("No fil\
e system is available.")}async readDirectory(){return[]}}const UT={fileSystemProvider:()=>new zG},FG={Grammar:()=>{},LanguageMetaData:()=>({caseInsensitive:!1,fileExtensions:[".langium"],languageId:"langium"})},qG={AstReflection:()=>new yb};function GG(){const t=Mf(FT(UT),qG),e=Mf(zT({shared:t}),FG);return t.ServiceRegistry.register(e),e}function jG(t){var e;const n=GG(),r=n.serializer.JsonSerializer.deserialize(t);return n.shared.workspace.LangiumDocumentFactory.fromModel(r,Xt.parse(`memory://${(e=
r.name)!==null&&e!==void 0?e:"grammar"}.langium`)),r}var BG={done:!0,hasNext:!1},$c={done:!1,hasNext:!1},UG=()=>BG,WG=t=>({hasNext:!0,next:t,done:!1});function Ze(t,...e){let n=t,r=e.map(s=>"lazy"in s?HG(s):void 0),i=0;for(;i<e.length;){if(r[i]===void 0||!KG(n)){let c=e[i];n=c(n),i+=1;continue}let s=[];for(let c=i;c<e.length;c++){let u=r[c];if(u===void 0||(s.push(u),u.isSingle))break}let a=[];for(let c of n)if(WT(c,a,s))break;let{isSingle:o}=s.at(-1);n=o?a[0]:a,i+=s.length}return n}function WT(t,e,n){
if(n.length===0)return e.push(t),!1;let r=t,i=$c,s=!1;for(let[a,o]of n.entries()){let{index:c,items:u}=o;if(u.push(r),i=o(r,c,u),o.index+=1,i.hasNext){if(i.hasMany??!1){for(let l of i.next)if(WT(l,e,n.slice(a+1)))return!0;return s}r=i.next}if(!i.hasNext)break;i.done&&(s=!0)}return i.hasNext&&e.push(r),s}function HG(t){let{lazy:e,lazyArgs:n}=t,r=e(...n);return Object.assign(r,{isSingle:e.single??!1,index:0,items:[]})}function KG(t){return typeof t=="string"||typeof t=="object"&&t!==null&&Symbol.iterator in
t}function HT(t,e){let n=e.length-t.length;if(n===1){let[r,...i]=e;return Ze(r,{lazy:t,lazyArgs:i})}if(n===0){let r={lazy:t,lazyArgs:e};return Object.assign(i=>Ze(i,r),r)}throw new Error("Wrong number of arguments")}function VG(t,e,n){let r=i=>t(i,...e);return n===void 0?r:Object.assign(r,{lazy:n,lazyArgs:e})}function ot(t,e,n){let r=t.length-e.length;if(r===0)return t(...e);if(r===1)return VG(t,e,n);throw new Error("Wrong number of arguments")}function Ff(...t){return ot(Object.values,t)}function Ra(...t){
return HT(XG,t)}function XG(){let t=new Set;return e=>t.has(e)?$c:(t.add(e),{done:!1,hasNext:!0,next:e})}function YG(...t){return ot(JG,t,QG)}var JG=(t,e)=>e<0?[]:t.slice(0,e);function QG(t){if(t<=0)return UG;let e=t;return n=>(e-=1,{done:e<=0,hasNext:!0,next:n})}function ms(...t){return ot(ZG,t)}var ZG=(t,e)=>t.length>=e;function ej(...t){return ot(tj,t)}function tj(t,e){return e(t),t}function nj(...t){return ot(rj,t)}function rj(t,e){let n=[...t];return n.sort(e),n}function Qg(...t){return ot(
ij,t)}var ij=(t,e,n)=>t.reduce(e,n);function sj(...t){return ot(aj,t)}function aj(t){return[...t].reverse()}function Zg(...t){return ot(oj,t)}var oj=(t,e)=>t[e];function Rc(...t){return ot(cj,t)}function cj(t,e){let n={};for(let[r,i]of Object.entries(t)){let s=e(i,r,t);n[r]=s}return n}function ce(t){return!!t}function kc(...t){return ot(uj,t)}var uj=t=>t.at(-1);function nn(...t){return ot(lj,t,dj)}var lj=(t,e)=>t.map(e),dj=t=>(e,n,r)=>({done:!1,hasNext:!0,next:t(e,n,r)});function Sr(...t){return ot(
fj,t)}function fj(t,e){let n={};for(let[r,i]of t.entries()){let[s,a]=e(i,r,t);n[s]=a}return n}function qf(t){return typeof t=="number"&&!Number.isNaN(t)}function hj(t){return t instanceof Promise}function KT(t){return typeof t=="string"}function Pt(t){return t===void 0?!0:typeof t=="string"||Array.isArray(t)?t.length===0:Object.keys(t).length===0}function rn(t){return t!=null}function yt(t){return t==null}function pj(t){return Array.isArray(t)}function ey(t){return typeof t=="boolean"}function Yt(t){
return t!==void 0}function mj(t,{triggerAt:e="end",minQuietPeriodMs:n,maxBurstDurationMs:r,minGapMs:i,reducer:s=gj}){let a,o,c,u,l=()=>{let h=c;h!==void 0&&(c=void 0,t(h),o=setTimeout(f,i))},f=()=>{clearTimeout(o),o=void 0,a===void 0&&l()},d=()=>{clearTimeout(a),a=void 0,u=void 0,o===void 0&&l()};return{call:(...h)=>{let m=a===void 0&&o===void 0;if((e!=="start"||m)&&(c=s(c,...h)),!(a===void 0&&!m)){{clearTimeout(a);let b=Date.now();u??=b;let $=Math.min(n,r-(b-u));a=setTimeout(d,$)}e!=="end"&&m&&
l()}},cancel:()=>{clearTimeout(a),a=void 0,u=void 0,clearTimeout(o),o=void 0,c=void 0},flush:()=>{d(),f()},get isIdle(){return a===void 0&&o===void 0}}}var gj=()=>"";function Tc(...t){return ot(yj,t)}var yj=(t,e)=>{let n={};for(let[r,i]of t.entries()){let s=e(i,r,t);if(s!==void 0){let{[s]:a}=n;a===void 0&&(a=[],n[s]=a),a.push(i)}}return n};function vj(){return wj}var wj=t=>t;function ty(...t){return ot(bj,t)}function bj(t,e){let n={};for(let[r,i]of t.entries()){let s=e(i,r,t);n[s]=i}return n}function _i(...t){
return ot($j,t,Rj)}var $j=(t,e)=>t.flatMap(e),Rj=t=>(e,n,r)=>{let i=t(e,n,r);return Array.isArray(i)?{done:!1,hasNext:!0,hasMany:!0,next:i}:{done:!1,hasNext:!0,next:i}};function kj(...t){return ot(Tj,t,Ej)}function Tj(t,e){return t.forEach(e),t}var Ej=t=>(e,n,r)=>(t(e,n,r),{done:!1,hasNext:!0,next:e});function VT(...t){return ot(Sj,t)}function Sj(t,e){for(let[n,r]of Object.entries(t))e(r,n,t);return t}function Aj(...t){return ot(Object.fromEntries,t)}function Gf(...t){return ot(Object.entries,t)}
function je(...t){return ot(_j,t,Cj)}var _j=(t,e)=>t.filter(e),Cj=t=>(e,n,r)=>t(e,n,r)?{done:!1,hasNext:!0,next:e}:$c,XT=t=>Object.assign(t,{single:!0});function YT(...t){return ot(Pj,t,XT(xj))}var Pj=(t,e)=>t.find(e),xj=t=>(e,n,r)=>t(e,n,r)?{done:!0,hasNext:!0,next:e}:$c;function JT(...t){return ot(Dj,t)}var Dj=(t,e)=>{for(let n=t.length-1;n>=0;n--){let r=t[n];if(e(r,n,t))return r}};function ka(...t){return ot(Nj,t,XT(Ij))}var Nj=([t])=>t,Ij=()=>Oj,Oj=t=>({hasNext:!0,next:t,done:!0});function QT(...t){
return ot(Lj,t)}var Lj=(t,e)=>[...t,...e];function Mj(...t){return HT(zj,t)}function zj(t){if(t.length===0)return WG;let e=new Map;for(let n of t)e.set(n,(e.get(n)??0)+1);return n=>{let r=e.get(n);return r===void 0||r===0?{done:!1,hasNext:!0,next:n}:(e.set(n,r-1),$c)}}function Fj(...t){return ot(qj,t)}var qj=(t,e)=>e.some(n=>n(t));function Gj(...t){return ot(jj,t)}function jj(t,e){if(e<1)throw new RangeError(`chunk: A chunk size of '${e.toString()}' would result in an infinite array`);if(t.length===
0)return[];if(e>=t.length)return[[...t]];let n=Math.ceil(t.length/e),r=new Array(n);if(e===1)for(let[i,s]of t.entries())r[i]=[s];else for(let i=0;i<n;i+=1){let s=i*e;r[i]=t.slice(s,s+e)}return r}function ZT(...t){return ot(Bj,t)}var Bj=(t,{min:e,max:n})=>e!==void 0&&t<e?e:n!==void 0&&t>n?n:t,Uj={reset:[0,0],bold:[1,22,"\x1B[22m\x1B[1m"],dim:[2,22,"\x1B[22m\x1B[2m"],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,
39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[
106,49],bgWhiteBright:[107,49]},Wj=Object.entries(Uj);function ny(t){return String(t)}ny.open="",ny.close="";function Hj(t=!1){let e=typeof process<"u"?process:void 0,n=e?.env||{},r=e?.argv||[];return!("NO_COLOR"in n||r.includes("--no-color"))&&("FORCE_COLOR"in n||r.includes("--color")||e?.platform==="win32"||t&&n.TERM!=="dumb"||"CI"in n)||typeof window<"u"&&!!window.chrome}function Kj(t=!1){let e=Hj(t),n=(a,o,c,u)=>{let l="",f=0;do l+=a.substring(f,u)+c,f=u+o.length,u=a.indexOf(o,f);while(~u);return l+
a.substring(f)},r=(a,o,c=a)=>{let u=l=>{let f=String(l),d=f.indexOf(o,a.length);return~d?a+n(f,o,c,d)+o:a+f+o};return u.open=a,u.close=o,u},i={isColorSupported:e},s=a=>`\x1B[${a}m`;for(let[a,o]of Wj)i[a]=e?r(s(o[0]),s(o[1]),o[2]):ny;return i}var Vj=process.env.FORCE_TTY!==void 0||X_(1),Tt=Kj(Vj),gs={},St={},eE;function ry(){if(eE)return St;eE=1,Object.defineProperty(St,"__esModule",{value:!0}),St.thenable=St.typedArray=St.stringArray=St.array=St.func=St.error=St.number=St.string=St.boolean=void 0;
function t(u){return u===!0||u===!1}St.boolean=t;function e(u){return typeof u=="string"||u instanceof String}St.string=e;function n(u){return typeof u=="number"||u instanceof Number}St.number=n;function r(u){return u instanceof Error}St.error=r;function i(u){return typeof u=="function"}St.func=i;function s(u){return Array.isArray(u)}St.array=s;function a(u){return s(u)&&u.every(l=>e(l))}St.stringArray=a;function o(u,l){return Array.isArray(u)&&u.every(l)}St.typedArray=o;function c(u){return u&&
i(u.then)}return St.thenable=c,St}var Ke={},ys={},vs={},jf={},iy={},be={},tE;function nE(){if(tE)return be;tE=1,Object.defineProperty(be,"__esModule",{value:!0}),be.Message=be.NotificationType9=be.NotificationType8=be.NotificationType7=be.NotificationType6=be.NotificationType5=be.NotificationType4=be.NotificationType3=be.NotificationType2=be.NotificationType1=be.NotificationType0=be.NotificationType=be.RequestType9=be.RequestType8=be.RequestType7=be.RequestType6=be.RequestType5=be.RequestType4=be.
RequestType3=be.RequestType2=be.RequestType1=be.RequestType=be.RequestType0=be.AbstractMessageSignature=be.ParameterStructures=be.ResponseError=be.ErrorCodes=void 0;const t=vc();var e;(function(E){E.ParseError=-32700,E.InvalidRequest=-32600,E.MethodNotFound=-32601,E.InvalidParams=-32602,E.InternalError=-32603,E.jsonrpcReservedErrorRangeStart=-32099,E.serverErrorStart=-32099,E.MessageWriteError=-32099,E.MessageReadError=-32098,E.PendingResponseRejected=-32097,E.ConnectionInactive=-32096,E.ServerNotInitialized=
-32002,E.UnknownErrorCode=-32001,E.jsonrpcReservedErrorRangeEnd=-32e3,E.serverErrorEnd=-32e3})(e||(be.ErrorCodes=e={}));class n extends Error{constructor(R,M,_){super(M),this.code=t.number(R)?R:e.UnknownErrorCode,this.data=_,Object.setPrototypeOf(this,n.prototype)}toJson(){const R={code:this.code,message:this.message};return this.data!==void 0&&(R.data=this.data),R}}be.ResponseError=n;class r{constructor(R){this.kind=R}static is(R){return R===r.auto||R===r.byName||R===r.byPosition}toString(){return this.
kind}}be.ParameterStructures=r,r.auto=new r("auto"),r.byPosition=new r("byPosition"),r.byName=new r("byName");class i{constructor(R,M){this.method=R,this.numberOfParams=M}get parameterStructures(){return r.auto}}be.AbstractMessageSignature=i;class s extends i{constructor(R){super(R,0)}}be.RequestType0=s;class a extends i{constructor(R,M=r.auto){super(R,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}be.RequestType=a;class o extends i{constructor(R,M=r.auto){
super(R,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}be.RequestType1=o;class c extends i{constructor(R){super(R,2)}}be.RequestType2=c;class u extends i{constructor(R){super(R,3)}}be.RequestType3=u;class l extends i{constructor(R){super(R,4)}}be.RequestType4=l;class f extends i{constructor(R){super(R,5)}}be.RequestType5=f;class d extends i{constructor(R){super(R,6)}}be.RequestType6=d;class h extends i{constructor(R){super(R,7)}}be.RequestType7=h;class m extends i{constructor(R){
super(R,8)}}be.RequestType8=m;class b extends i{constructor(R){super(R,9)}}be.RequestType9=b;class $ extends i{constructor(R,M=r.auto){super(R,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}be.NotificationType=$;class w extends i{constructor(R){super(R,0)}}be.NotificationType0=w;class k extends i{constructor(R,M=r.auto){super(R,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}be.NotificationType1=k;class S extends i{constructor(R){
super(R,2)}}be.NotificationType2=S;class D extends i{constructor(R){super(R,3)}}be.NotificationType3=D;class F extends i{constructor(R){super(R,4)}}be.NotificationType4=F;class Y extends i{constructor(R){super(R,5)}}be.NotificationType5=Y;class J extends i{constructor(R){super(R,6)}}be.NotificationType6=J;class ie extends i{constructor(R){super(R,7)}}be.NotificationType7=ie;class re extends i{constructor(R){super(R,8)}}be.NotificationType8=re;class ye extends i{constructor(R){super(R,9)}}be.NotificationType9=
ye;var z;return function(E){function R(P){const I=P;return I&&t.string(I.method)&&(t.string(I.id)||t.number(I.id))}E.isRequest=R;function M(P){const I=P;return I&&t.string(I.method)&&P.id===void 0}E.isNotification=M;function _(P){const I=P;return I&&(I.result!==void 0||!!I.error)&&(t.string(I.id)||t.number(I.id)||I.id===null)}E.isResponse=_}(z||(be.Message=z={})),be}var Kr={},rE;function iE(){if(rE)return Kr;rE=1;var t;Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.LRUCache=Kr.LinkedMap=Kr.
Touch=void 0;var e;(function(i){i.None=0,i.First=1,i.AsOld=i.First,i.Last=2,i.AsNew=i.Last})(e||(Kr.Touch=e={}));class n{constructor(){this[t]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,a=e.
None){const o=this._map.get(s);if(o)return a!==e.None&&this.touch(o,a),o.value}set(s,a,o=e.None){let c=this._map.get(s);if(c)c.value=a,o!==e.None&&this.touch(c,o);else{switch(c={key:s,value:a,next:void 0,previous:void 0},o){case e.None:this.addItemLast(c);break;case e.First:this.addItemFirst(c);break;case e.Last:this.addItemLast(c);break;default:this.addItemLast(c);break}this._map.set(s,c),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const a=this._map.get(s);if(a)return this.
_map.delete(s),this.removeItem(a),this._size--,a.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this._size--,s.value}forEach(s,a){const o=this._state;let c=this._head;for(;c;){if(a?s.bind(a)(c.value,c.key,this):s(c.value,c.key,this),this._state!==o)throw new Error("LinkedMap got modified during iteration.");c=c.next}}keys(){const s=this._state;let a=this._head;const o={
[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const c={value:a.key,done:!1};return a=a.next,c}else return{value:void 0,done:!0}}};return o}values(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const c={value:a.value,done:!1};return a=a.next,c}else return{value:void 0,done:!0}}};return o}entries(){const s=this.
_state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const c={value:[a.key,a.value],done:!1};return a=a.next,c}else return{value:void 0,done:!0}}};return o}[(t=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let a=this._head,o=this.size;for(;a&&o>s;)this._map.delete(a.key),a=a.next,o--;this._head=a,this._size=o,a&&(a.previous=
void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)
throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const a=s.next,o=s.previous;if(!a||!o)throw new Error("Invalid list");a.previous=o,o.next=a}s.next=void 0,s.previous=void 0,this._state++}touch(s,a){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(a!==e.First&&a!==e.Last)){if(a===e.First){if(s===this._head)return;const o=s.next,c=s.previous;
s===this._tail?(c.next=void 0,this._tail=c):(o.previous=c,c.next=o),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(a===e.Last){if(s===this._tail)return;const o=s.next,c=s.previous;s===this._head?(o.previous=void 0,this._head=o):(o.previous=c,c.next=o),s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((a,o)=>{s.push([o,a])}),s}fromJSON(s){this.clear();for(const[a,o]of s)this.set(
a,o)}}Kr.LinkedMap=n;class r extends n{constructor(s,a=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,a),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.min(Math.max(0,s),1),this.checkTrim()}get(s,a=e.AsNew){return super.get(s,a)}peek(s){return super.get(s,e.None)}set(s,a){return super.set(s,a,e.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this.
_ratio))}}return Kr.LRUCache=r,Kr}var Ec={},sE;function Xj(){if(sE)return Ec;sE=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.Disposable=void 0;var t;return function(e){function n(r){return{dispose:r}}e.create=n}(t||(Ec.Disposable=t={})),Ec}var ws={},aE;function Yj(){if(aE)return ws;aE=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.SharedArrayReceiverStrategy=ws.SharedArraySenderStrategy=void 0;const t=_f();var e;(function(a){a.Continue=0,a.Cancelled=1})(e||(e={}));class n{constructor(){
this.buffers=new Map}enableCancellation(o){if(o.id===null)return;const c=new SharedArrayBuffer(4),u=new Int32Array(c,0,1);u[0]=e.Continue,this.buffers.set(o.id,c),o.$cancellationData=c}async sendCancellation(o,c){const u=this.buffers.get(c);if(u===void 0)return;const l=new Int32Array(u,0,1);Atomics.store(l,0,e.Cancelled)}cleanup(o){this.buffers.delete(o)}dispose(){this.buffers.clear()}}ws.SharedArraySenderStrategy=n;class r{constructor(o){this.data=new Int32Array(o,0,1)}get isCancellationRequested(){
return Atomics.load(this.data,0)===e.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class i{constructor(o){this.token=new r(o)}cancel(){}dispose(){}}class s{constructor(){this.kind="request"}createCancellationTokenSource(o){const c=o.$cancellationData;return c===void 0?new t.CancellationTokenSource:new i(c)}}return ws.SharedArrayReceiverStrategy=s,ws}var Vr={},Sc={},oE;function cE(){if(oE)return Sc;oE=1,Object.defineProperty(
Sc,"__esModule",{value:!0}),Sc.Semaphore=void 0;const t=fs();class e{constructor(r=1){if(r<=0)throw new Error("Capacity must be greater than 0");this._capacity=r,this._active=0,this._waiting=[]}lock(r){return new Promise((i,s)=>{this._waiting.push({thunk:r,resolve:i,reject:s}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,t.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===
this._capacity)return;const r=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const i=r.thunk();i instanceof Promise?i.then(s=>{this._active--,r.resolve(s),this.runNext()},s=>{this._active--,r.reject(s),this.runNext()}):(this._active--,r.resolve(i),this.runNext())}catch(i){this._active--,r.reject(i),this.runNext()}}}return Sc.Semaphore=e,Sc}var uE;function Jj(){if(uE)return Vr;uE=1,Object.defineProperty(Vr,"__esModule",{value:!0}),
Vr.ReadableStreamMessageReader=Vr.AbstractMessageReader=Vr.MessageReader=void 0;const t=fs(),e=vc(),n=$a(),r=cE();var i;(function(c){function u(l){let f=l;return f&&e.func(f.listen)&&e.func(f.dispose)&&e.func(f.onError)&&e.func(f.onClose)&&e.func(f.onPartialMessage)}c.is=u})(i||(Vr.MessageReader=i={}));class s{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){
return this.errorEmitter.event}fireError(u){this.errorEmitter.fire(this.asError(u))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(u){this.partialMessageEmitter.fire(u)}asError(u){return u instanceof Error?u:new Error(`Reader received error. Reason: ${e.string(u.message)?u.message:"unknown"}`)}}Vr.AbstractMessageReader=s;var a;(function(c){function u(l){let f,d;const h=new Map;
let m;const b=new Map;if(l===void 0||typeof l=="string")f=l??"utf-8";else{if(f=l.charset??"utf-8",l.contentDecoder!==void 0&&(d=l.contentDecoder,h.set(d.name,d)),l.contentDecoders!==void 0)for(const $ of l.contentDecoders)h.set($.name,$);if(l.contentTypeDecoder!==void 0&&(m=l.contentTypeDecoder,b.set(m.name,m)),l.contentTypeDecoders!==void 0)for(const $ of l.contentTypeDecoders)b.set($.name,$)}return m===void 0&&(m=(0,t.default)().applicationJson.decoder,b.set(m.name,m)),{charset:f,contentDecoder:d,
contentDecoders:h,contentTypeDecoder:m,contentTypeDecoders:b}}c.fromOptions=u})(a||(a={}));class o extends s{constructor(u,l){super(),this.readable=u,this.options=a.fromOptions(l),this.buffer=(0,t.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new r.Semaphore(1)}set partialMessageTimeout(u){this._partialMessageTimeout=u}get partialMessageTimeout(){return this._partialMessageTimeout}listen(u){this.
nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=u;const l=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),l}onData(u){try{for(this.buffer.append(u);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const d=f.get("content-length");if(!d){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const h=parseInt(d);if(isNaN(h)){this.fireError(new Error(`Content-Length value must be a number. Got ${d}`));return}this.nextMessageLength=h}const l=this.buffer.tryReadBody(this.nextMessageLength);if(l===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(l):l,d=await this.options.
contentTypeDecoder.decode(f,this.options);this.callback(d)}).catch(f=>{this.fireError(f)})}}catch(l){this.fireError(l)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,t.default)().timer.setTimeout((u,l)=>{this.partialMessageTimer=void 0,u===this.messageToken&&(this.firePartialMessage({messageToken:u,waitingTime:l}),
this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Vr.ReadableStreamMessageReader=o,Vr}var Xr={},lE;function Qj(){if(lE)return Xr;lE=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.WriteableStreamMessageWriter=Xr.AbstractMessageWriter=Xr.MessageWriter=void 0;const t=fs(),e=vc(),n=cE(),r=$a(),i="Content-Length: ",s=`\r
`;var a;(function(l){function f(d){let h=d;return h&&e.func(h.dispose)&&e.func(h.onClose)&&e.func(h.onError)&&e.func(h.write)}l.is=f})(a||(Xr.MessageWriter=a={}));class o{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,d,h){this.errorEmitter.fire([this.asError(f),d,h])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(
void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${e.string(f.message)?f.message:"unknown"}`)}}Xr.AbstractMessageWriter=o;var c;(function(l){function f(d){return d===void 0||typeof d=="string"?{charset:d??"utf-8",contentTypeEncoder:(0,t.default)().applicationJson.encoder}:{charset:d.charset??"utf-8",contentEncoder:d.contentEncoder,contentTypeEncoder:d.contentTypeEncoder??(0,t.default)().applicationJson.encoder}}l.fromOptions=f})(c||(c={}));class u extends o{constructor(f,d){
super(),this.writable=f,this.options=c.fromOptions(d),this.errorCount=0,this.writeSemaphore=new n.Semaphore(1),this.writable.onError(h=>this.fireError(h)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(h=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(h):h).then(h=>{const m=[];return m.push(i,h.byteLength.toString(),s),m.push(s),this.doWrite(f,m,h)},h=>{throw this.
fireError(h),h}))}async doWrite(f,d,h){try{return await this.writable.write(d.join(""),"ascii"),this.writable.write(h)}catch(m){return this.handleError(m,f),Promise.reject(m)}}handleError(f,d){this.errorCount++,this.fireError(f,d,this.errorCount)}end(){this.writable.end()}}return Xr.WriteableStreamMessageWriter=u,Xr}var Ac={},dE;function Zj(){if(dE)return Ac;dE=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.AbstractMessageBuffer=void 0;const t=13,e=10,n=`\r
`;class r{constructor(s="utf-8"){this._encoding=s,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(s){const a=typeof s=="string"?this.fromString(s,this._encoding):s;this._chunks.push(a),this._totalLength+=a.byteLength}tryReadHeaders(s=!1){if(this._chunks.length===0)return;let a=0,o=0,c=0,u=0;e:for(;o<this._chunks.length;){const h=this._chunks[o];for(c=0;c<h.length;){switch(h[c]){case t:switch(a){case 0:a=1;break;case 2:a=3;break;default:a=0}break;case e:switch(a){case 1:
a=2;break;case 3:a=4,c++;break e;default:a=0}break;default:a=0}c++}u+=h.byteLength,o++}if(a!==4)return;const l=this._read(u+c),f=new Map,d=this.toString(l,"ascii").split(n);if(d.length<2)return f;for(let h=0;h<d.length-2;h++){const m=d[h],b=m.indexOf(":");if(b===-1)throw new Error(`Message header must separate key and value using ':'
${m}`);const $=m.substr(0,b),w=m.substr(b+1).trim();f.set(s?$.toLowerCase():$,w)}return f}tryReadBody(s){if(!(this._totalLength<s))return this._read(s)}get numberOfBytes(){return this._totalLength}_read(s){if(s===0)return this.emptyBuffer();if(s>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===s){const u=this._chunks[0];return this._chunks.shift(),this._totalLength-=s,this.asNative(u)}if(this._chunks[0].byteLength>s){const u=this._chunks[0],l=this.asNative(
u,s);return this._chunks[0]=u.slice(s),this._totalLength-=s,l}const a=this.allocNative(s);let o=0,c=0;for(;s>0;){const u=this._chunks[c];if(u.byteLength>s){const l=u.slice(0,s);a.set(l,o),o+=s,this._chunks[c]=u.slice(s),this._totalLength-=s,s-=s}else a.set(u,o),o+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,s-=u.byteLength}return a}}return Ac.AbstractMessageBuffer=r,Ac}var sy={},fE;function e2(){return fE||(fE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.
createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const e=fs(),n=vc(),r=nE(),i=iE(),s=$a(),a=_f();var o;(function(R){R.type=new r.NotificationType(
"$/cancelRequest")})(o||(o={}));var c;(function(R){function M(_){return typeof _=="string"||typeof _=="number"}R.is=M})(c||(t.ProgressToken=c={}));var u;(function(R){R.type=new r.NotificationType("$/progress")})(u||(u={}));class l{constructor(){}}t.ProgressType=l;var f;(function(R){function M(_){return n.func(_)}R.is=M})(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var d;(function(R){R[R.Off=0]="Off",R[R.Messages=1]="Messages",R[R.Compact=2]="Compact",
R[R.Verbose=3]="Verbose"})(d||(t.Trace=d={}));var h;(function(R){R.Off="off",R.Messages="messages",R.Compact="compact",R.Verbose="verbose"})(h||(t.TraceValues=h={})),function(R){function M(P){if(!n.string(P))return R.Off;switch(P=P.toLowerCase(),P){case"off":return R.Off;case"messages":return R.Messages;case"compact":return R.Compact;case"verbose":return R.Verbose;default:return R.Off}}R.fromString=M;function _(P){switch(P){case R.Off:return"off";case R.Messages:return"messages";case R.Compact:return"\
compact";case R.Verbose:return"verbose";default:return"off"}}R.toString=_}(d||(t.Trace=d={}));var m;(function(R){R.Text="text",R.JSON="json"})(m||(t.TraceFormat=m={})),function(R){function M(_){return n.string(_)?(_=_.toLowerCase(),_==="json"?R.JSON:R.Text):R.Text}R.fromString=M}(m||(t.TraceFormat=m={}));var b;(function(R){R.type=new r.NotificationType("$/setTrace")})(b||(t.SetTraceNotification=b={}));var $;(function(R){R.type=new r.NotificationType("$/logTrace")})($||(t.LogTraceNotification=$={}));
var w;(function(R){R[R.Closed=1]="Closed",R[R.Disposed=2]="Disposed",R[R.AlreadyListening=3]="AlreadyListening"})(w||(t.ConnectionErrors=w={}));class k extends Error{constructor(M,_){super(_),this.code=M,Object.setPrototypeOf(this,k.prototype)}}t.ConnectionError=k;var S;(function(R){function M(_){const P=_;return P&&n.func(P.cancelUndispatched)}R.is=M})(S||(t.ConnectionStrategy=S={}));var D;(function(R){function M(_){const P=_;return P&&(P.kind===void 0||P.kind==="id")&&n.func(P.createCancellationTokenSource)&&
(P.dispose===void 0||n.func(P.dispose))}R.is=M})(D||(t.IdCancellationReceiverStrategy=D={}));var F;(function(R){function M(_){const P=_;return P&&P.kind==="request"&&n.func(P.createCancellationTokenSource)&&(P.dispose===void 0||n.func(P.dispose))}R.is=M})(F||(t.RequestCancellationReceiverStrategy=F={}));var Y;(function(R){R.Message=Object.freeze({createCancellationTokenSource(_){return new a.CancellationTokenSource}});function M(_){return D.is(_)||F.is(_)}R.is=M})(Y||(t.CancellationReceiverStrategy=
Y={}));var J;(function(R){R.Message=Object.freeze({sendCancellation(_,P){return _.sendNotification(o.type,{id:P})},cleanup(_){}});function M(_){const P=_;return P&&n.func(P.sendCancellation)&&n.func(P.cleanup)}R.is=M})(J||(t.CancellationSenderStrategy=J={}));var ie;(function(R){R.Message=Object.freeze({receiver:Y.Message,sender:J.Message});function M(_){const P=_;return P&&Y.is(P.receiver)&&J.is(P.sender)}R.is=M})(ie||(t.CancellationStrategy=ie={}));var re;(function(R){function M(_){const P=_;return P&&
n.func(P.handleMessage)}R.is=M})(re||(t.MessageStrategy=re={}));var ye;(function(R){function M(_){const P=_;return P&&(ie.is(P.cancellationStrategy)||S.is(P.connectionStrategy)||re.is(P.messageStrategy))}R.is=M})(ye||(t.ConnectionOptions=ye={}));var z;(function(R){R[R.New=1]="New",R[R.Listening=2]="Listening",R[R.Closed=3]="Closed",R[R.Disposed=4]="Disposed"})(z||(z={}));function E(R,M,_,P){const I=_!==void 0?_:t.NullLogger;let Z=0,H=0,A=0;const te="2.0";let me;const Ce=new Map;let L;const K=new Map,
_e=new Map;let ue,$e=new i.LinkedMap,Pe=new Map,le=new Set,N=new Map,j=d.Off,fe=m.Text,B,de=z.New;const Be=new s.Emitter,Qe=new s.Emitter,oe=new s.Emitter,De=new s.Emitter,ne=new s.Emitter,Re=P&&P.cancellationStrategy?P.cancellationStrategy:ie.Message;function Fe(v){if(v===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+v.toString()}function ft(v){return v===null?"res-unknown-"+(++A).toString():"res-"+v.toString()}function Ve(){return"\
not-"+(++H).toString()}function zt(v,U){r.Message.isRequest(U)?v.set(Fe(U.id),U):r.Message.isResponse(U)?v.set(ft(U.id),U):v.set(Ve(),U)}function Bt(v){}function on(){return de===z.Listening}function V(){return de===z.Closed}function X(){return de===z.Disposed}function he(){(de===z.New||de===z.Listening)&&(de=z.Closed,Qe.fire(void 0))}function Ut(v){Be.fire([v,void 0,void 0])}function Ft(v){Be.fire(v)}R.onClose(he),R.onError(Ut),M.onClose(he),M.onError(Ft);function mr(){ue||$e.size===0||(ue=(0,e.
default)().timer.setImmediate(()=>{ue=void 0,ji()}))}function di(v){r.Message.isRequest(v)?Ui(v):r.Message.isNotification(v)?fi(v):r.Message.isResponse(v)?Wi(v):hi(v)}function ji(){if($e.size===0)return;const v=$e.shift();try{const U=P?.messageStrategy;re.is(U)?U.handleMessage(v,di):di(v)}finally{mr()}}const Bi=v=>{try{if(r.Message.isNotification(v)&&v.method===o.type.method){const U=v.params.id,ee=Fe(U),se=$e.get(ee);if(r.Message.isRequest(se)){const Le=P?.connectionStrategy,Xe=Le&&Le.cancelUndispatched?
Le.cancelUndispatched(se,Bt):void 0;if(Xe&&(Xe.error!==void 0||Xe.result!==void 0)){$e.delete(ee),N.delete(U),Xe.id=se.id,gr(Xe,v.method,Date.now()),M.write(Xe).catch(()=>I.error("Sending response for canceled message failed."));return}}const qe=N.get(U);if(qe!==void 0){qe.cancel(),xr(v);return}else le.add(U)}zt($e,v)}finally{mr()}};function Ui(v){if(X())return;function U(Ne,rt,Ye){const Dt={jsonrpc:te,id:v.id};Ne instanceof r.ResponseError?Dt.error=Ne.toJson():Dt.result=Ne===void 0?null:Ne,gr(Dt,
rt,Ye),M.write(Dt).catch(()=>I.error("Sending response failed."))}function ee(Ne,rt,Ye){const Dt={jsonrpc:te,id:v.id,error:Ne.toJson()};gr(Dt,rt,Ye),M.write(Dt).catch(()=>I.error("Sending response failed."))}function se(Ne,rt,Ye){Ne===void 0&&(Ne=null);const Dt={jsonrpc:te,id:v.id,result:Ne};gr(Dt,rt,Ye),M.write(Dt).catch(()=>I.error("Sending response failed."))}Vi(v);const qe=Ce.get(v.method);let Le,Xe;qe&&(Le=qe.type,Xe=qe.handler);const we=Date.now();if(Xe||me){const Ne=v.id??String(Date.now()),
rt=D.is(Re.receiver)?Re.receiver.createCancellationTokenSource(Ne):Re.receiver.createCancellationTokenSource(v);v.id!==null&&le.has(v.id)&&rt.cancel(),v.id!==null&&N.set(Ne,rt);try{let Ye;if(Xe)if(v.params===void 0){if(Le!==void 0&&Le.numberOfParams!==0){ee(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${v.method} defines ${Le.numberOfParams} params but received none.`),v.method,we);return}Ye=Xe(rt.token)}else if(Array.isArray(v.params)){if(Le!==void 0&&Le.parameterStructures===r.ParameterStructures.
byName){ee(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by name but received parameters by position`),v.method,we);return}Ye=Xe(...v.params,rt.token)}else{if(Le!==void 0&&Le.parameterStructures===r.ParameterStructures.byPosition){ee(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by position but received parameters by name`),v.method,we);return}Ye=Xe(v.params,rt.token)}else me&&(Ye=me(v.method,v.params,rt.token));const Dt=Ye;
Ye?Dt.then?Dt.then(cn=>{N.delete(Ne),U(cn,v.method,we)},cn=>{N.delete(Ne),cn instanceof r.ResponseError?ee(cn,v.method,we):cn&&n.string(cn.message)?ee(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${cn.message}`),v.method,we):ee(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,we)}):(N.delete(Ne),U(Ye,v.method,we)):(N.delete(Ne),se(Ye,v.method,we))}catch(Ye){N.delete(Ne),Ye instanceof
r.ResponseError?U(Ye,v.method,we):Ye&&n.string(Ye.message)?ee(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${Ye.message}`),v.method,we):ee(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,we)}}else ee(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${v.method}`),v.method,we)}function Wi(v){if(!X())if(v.id===null)v.error?I.error(`Received response message \
without id: Error is: 
${JSON.stringify(v.error,void 0,4)}`):I.error("Received response message without id. No further error information provided.");else{const U=v.id,ee=Pe.get(U);if(Xi(v,ee),ee!==void 0){Pe.delete(U);try{if(v.error){const se=v.error;ee.reject(new r.ResponseError(se.code,se.message,se.data))}else if(v.result!==void 0)ee.resolve(v.result);else throw new Error("Should never happen.")}catch(se){se.message?I.error(`Response handler '${ee.method}' failed with message: ${se.message}`):I.error(`Response hand\
ler '${ee.method}' failed unexpectedly.`)}}}}function fi(v){if(X())return;let U,ee;if(v.method===o.type.method){const se=v.params.id;le.delete(se),xr(v);return}else{const se=K.get(v.method);se&&(ee=se.handler,U=se.type)}if(ee||L)try{if(xr(v),ee)if(v.params===void 0)U!==void 0&&U.numberOfParams!==0&&U.parameterStructures!==r.ParameterStructures.byName&&I.error(`Notification ${v.method} defines ${U.numberOfParams} params but received none.`),ee();else if(Array.isArray(v.params)){const se=v.params;
v.method===u.type.method&&se.length===2&&c.is(se[0])?ee({token:se[0],value:se[1]}):(U!==void 0&&(U.parameterStructures===r.ParameterStructures.byName&&I.error(`Notification ${v.method} defines parameters by name but received parameters by position`),U.numberOfParams!==v.params.length&&I.error(`Notification ${v.method} defines ${U.numberOfParams} params but received ${se.length} arguments`)),ee(...se))}else U!==void 0&&U.parameterStructures===r.ParameterStructures.byPosition&&I.error(`Notificatio\
n ${v.method} defines parameters by position but received parameters by name`),ee(v.params);else L&&L(v.method,v.params)}catch(se){se.message?I.error(`Notification handler '${v.method}' failed with message: ${se.message}`):I.error(`Notification handler '${v.method}' failed unexpectedly.`)}else oe.fire(v)}function hi(v){if(!v){I.error("Received empty message.");return}I.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(v,null,4)}`);const U=v;if(n.string(U.id)||n.number(U.id)){const ee=U.id,se=Pe.get(ee);se&&se.reject(new Error("The received response has neither a result nor an error property."))}}function $n(v){if(v!=null)switch(j){case d.Verbose:return JSON.stringify(v,null,4);case d.Compact:return JSON.stringify(v);default:return}}function Hi(v){if(!(j===d.Off||!B))if(fe===m.Text){let U;(j===d.Verbose||j===d.Compact)&&v.params&&(U=`Params: ${$n(v.params)}

`),B.log(`Sending request '${v.method} - (${v.id})'.`,U)}else jn("send-request",v)}function Ki(v){if(!(j===d.Off||!B))if(fe===m.Text){let U;(j===d.Verbose||j===d.Compact)&&(v.params?U=`Params: ${$n(v.params)}

`:U=`No parameters provided.

`),B.log(`Sending notification '${v.method}'.`,U)}else jn("send-notification",v)}function gr(v,U,ee){if(!(j===d.Off||!B))if(fe===m.Text){let se;(j===d.Verbose||j===d.Compact)&&(v.error&&v.error.data?se=`Error data: ${$n(v.error.data)}

`:v.result?se=`Result: ${$n(v.result)}

`:v.error===void 0&&(se=`No result returned.

`)),B.log(`Sending response '${U} - (${v.id})'. Processing request took ${Date.now()-ee}ms`,se)}else jn("send-response",v)}function Vi(v){if(!(j===d.Off||!B))if(fe===m.Text){let U;(j===d.Verbose||j===d.Compact)&&v.params&&(U=`Params: ${$n(v.params)}

`),B.log(`Received request '${v.method} - (${v.id})'.`,U)}else jn("receive-request",v)}function xr(v){if(!(j===d.Off||!B||v.method===$.type.method))if(fe===m.Text){let U;(j===d.Verbose||j===d.Compact)&&(v.params?U=`Params: ${$n(v.params)}

`:U=`No parameters provided.

`),B.log(`Received notification '${v.method}'.`,U)}else jn("receive-notification",v)}function Xi(v,U){if(!(j===d.Off||!B))if(fe===m.Text){let ee;if((j===d.Verbose||j===d.Compact)&&(v.error&&v.error.data?ee=`Error data: ${$n(v.error.data)}

`:v.result?ee=`Result: ${$n(v.result)}

`:v.error===void 0&&(ee=`No result returned.

`)),U){const se=v.error?` Request failed: ${v.error.message} (${v.error.code}).`:"";B.log(`Received response '${U.method} - (${v.id})' in ${Date.now()-U.timerStart}ms.${se}`,ee)}else B.log(`Received response ${v.id} without active response promise.`,ee)}else jn("receive-response",v)}function jn(v,U){if(!B||j===d.Off)return;const ee={isLSPMessage:!0,type:v,message:U,timestamp:Date.now()};B.log(ee)}function er(){if(V())throw new k(w.Closed,"Connection is closed.");if(X())throw new k(w.Disposed,"Co\
nnection is disposed.")}function Qs(){if(on())throw new k(w.AlreadyListening,"Connection is already listening")}function q(){if(!on())throw new Error("Call listen() first.")}function y(v){return v===void 0?null:v}function C(v){if(v!==null)return v}function p(v){return v!=null&&!Array.isArray(v)&&typeof v=="object"}function T(v,U){switch(v){case r.ParameterStructures.auto:return p(U)?C(U):[y(U)];case r.ParameterStructures.byName:if(!p(U))throw new Error("Received parameters by name but param is n\
ot an object literal.");return C(U);case r.ParameterStructures.byPosition:return[y(U)];default:throw new Error(`Unknown parameter structure ${v.toString()}`)}}function g(v,U){let ee;const se=v.numberOfParams;switch(se){case 0:ee=void 0;break;case 1:ee=T(v.parameterStructures,U[0]);break;default:ee=[];for(let qe=0;qe<U.length&&qe<se;qe++)ee.push(y(U[qe]));if(U.length<se)for(let qe=U.length;qe<se;qe++)ee.push(null);break}return ee}const x={sendNotification:(v,...U)=>{er();let ee,se;if(n.string(v)){
ee=v;const Le=U[0];let Xe=0,we=r.ParameterStructures.auto;r.ParameterStructures.is(Le)&&(Xe=1,we=Le);let Ne=U.length;const rt=Ne-Xe;switch(rt){case 0:se=void 0;break;case 1:se=T(we,U[Xe]);break;default:if(we===r.ParameterStructures.byName)throw new Error(`Received ${rt} parameters for 'by Name' notification parameter structure.`);se=U.slice(Xe,Ne).map(Ye=>y(Ye));break}}else{const Le=U;ee=v.method,se=g(v,Le)}const qe={jsonrpc:te,method:ee,params:se};return Ki(qe),M.write(qe).catch(Le=>{throw I.error(
"Sending notification failed."),Le})},onNotification:(v,U)=>{er();let ee;return n.func(v)?L=v:U&&(n.string(v)?(ee=v,K.set(v,{type:void 0,handler:U})):(ee=v.method,K.set(v.method,{type:v,handler:U}))),{dispose:()=>{ee!==void 0?K.delete(ee):L=void 0}}},onProgress:(v,U,ee)=>{if(_e.has(U))throw new Error(`Progress handler for token ${U} already registered`);return _e.set(U,ee),{dispose:()=>{_e.delete(U)}}},sendProgress:(v,U,ee)=>x.sendNotification(u.type,{token:U,value:ee}),onUnhandledProgress:De.event,
sendRequest:(v,...U)=>{er(),q();let ee,se,qe;if(n.string(v)){ee=v;const Ne=U[0],rt=U[U.length-1];let Ye=0,Dt=r.ParameterStructures.auto;r.ParameterStructures.is(Ne)&&(Ye=1,Dt=Ne);let cn=U.length;a.CancellationToken.is(rt)&&(cn=cn-1,qe=rt);const yr=cn-Ye;switch(yr){case 0:se=void 0;break;case 1:se=T(Dt,U[Ye]);break;default:if(Dt===r.ParameterStructures.byName)throw new Error(`Received ${yr} parameters for 'by Name' request parameter structure.`);se=U.slice(Ye,cn).map(B_=>y(B_));break}}else{const Ne=U;
ee=v.method,se=g(v,Ne);const rt=v.numberOfParams;qe=a.CancellationToken.is(Ne[rt])?Ne[rt]:void 0}const Le=Z++;let Xe;qe&&(Xe=qe.onCancellationRequested(()=>{const Ne=Re.sender.sendCancellation(x,Le);return Ne===void 0?(I.log(`Received no promise from cancellation strategy when cancelling id ${Le}`),Promise.resolve()):Ne.catch(()=>{I.log(`Sending cancellation messages for id ${Le} failed`)})}));const we={jsonrpc:te,id:Le,method:ee,params:se};return Hi(we),typeof Re.sender.enableCancellation=="fun\
ction"&&Re.sender.enableCancellation(we),new Promise(async(Ne,rt)=>{const Ye=yr=>{Ne(yr),Re.sender.cleanup(Le),Xe?.dispose()},Dt=yr=>{rt(yr),Re.sender.cleanup(Le),Xe?.dispose()},cn={method:ee,timerStart:Date.now(),resolve:Ye,reject:Dt};try{await M.write(we),Pe.set(Le,cn)}catch(yr){throw I.error("Sending request failed."),cn.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,yr.message?yr.message:"Unknown reason")),yr}})},onRequest:(v,U)=>{er();let ee=null;return f.is(v)?(ee=void 0,me=v):n.
string(v)?(ee=null,U!==void 0&&(ee=v,Ce.set(v,{handler:U,type:void 0}))):U!==void 0&&(ee=v.method,Ce.set(v.method,{type:v,handler:U})),{dispose:()=>{ee!==null&&(ee!==void 0?Ce.delete(ee):me=void 0)}}},hasPendingResponse:()=>Pe.size>0,trace:async(v,U,ee)=>{let se=!1,qe=m.Text;ee!==void 0&&(n.boolean(ee)?se=ee:(se=ee.sendNotification||!1,qe=ee.traceFormat||m.Text)),j=v,fe=qe,j===d.Off?B=void 0:B=U,se&&!V()&&!X()&&await x.sendNotification(b.type,{value:d.toString(v)})},onError:Be.event,onClose:Qe.event,
onUnhandledNotification:oe.event,onDispose:ne.event,end:()=>{M.end()},dispose:()=>{if(X())return;de=z.Disposed,ne.fire(void 0);const v=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const U of Pe.values())U.reject(v);Pe=new Map,N=new Map,le=new Set,$e=new i.LinkedMap,n.func(M.dispose)&&M.dispose(),n.func(R.dispose)&&R.dispose()},listen:()=>{er(),Qs(),de=z.Listening,R.listen(Bi)},inspect:()=>{(0,e.default)().console.log("ins\
pect")}};return x.onNotification($.type,v=>{if(j===d.Off||!B)return;const U=j===d.Verbose||j===d.Compact;B.log(v.message,U?v.verbose:void 0)}),x.onNotification(u.type,v=>{const U=_e.get(v.token);U?U(v.value):De.fire(v)}),x}t.createMessageConnection=E}(sy)),sy}var hE;function ay(){return hE||(hE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=
t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.
NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const e=nE();Object.defineProperty(t,"Me\
ssage",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){
return e.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.
defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(
t,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.
defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});
const n=iE();Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return n.Touch}});const r=Xj();Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=$a();Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,
get:function(){return i.Emitter}});const s=_f();Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const a=Yj();Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return a.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return a.SharedArrayReceiverStrategy}});
const o=Jj();Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return o.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return o.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return o.ReadableStreamMessageReader}});const c=Qj();Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",
{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=Zj();Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const l=e2();Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){
return l.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return l.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return l.Trace}}),
Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return l.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),
Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",
{enumerable:!0,get:function(){return l.MessageStrategy}});const f=fs();t.RAL=f.default}(iy)),iy}var pE;function t2(){if(pE)return jf;pE=1,Object.defineProperty(jf,"__esModule",{value:!0});const t=Q_,e=ay();class n extends e.AbstractMessageBuffer{constructor(c="utf-8"){super(c)}emptyBuffer(){return n.emptyBuffer}fromString(c,u){return Buffer.from(c,u)}toString(c,u){return c instanceof Buffer?c.toString(u):new t.TextDecoder(u).decode(c)}asNative(c,u){return u===void 0?c instanceof Buffer?c:Buffer.
from(c):c instanceof Buffer?c.slice(0,u):Buffer.from(c,0,u)}allocNative(c){return Buffer.allocUnsafe(c)}}n.emptyBuffer=Buffer.allocUnsafe(0);class r{constructor(c){this.stream=c}onClose(c){return this.stream.on("close",c),e.Disposable.create(()=>this.stream.off("close",c))}onError(c){return this.stream.on("error",c),e.Disposable.create(()=>this.stream.off("error",c))}onEnd(c){return this.stream.on("end",c),e.Disposable.create(()=>this.stream.off("end",c))}onData(c){return this.stream.on("data",c),
e.Disposable.create(()=>this.stream.off("data",c))}}class i{constructor(c){this.stream=c}onClose(c){return this.stream.on("close",c),e.Disposable.create(()=>this.stream.off("close",c))}onError(c){return this.stream.on("error",c),e.Disposable.create(()=>this.stream.off("error",c))}onEnd(c){return this.stream.on("end",c),e.Disposable.create(()=>this.stream.off("end",c))}write(c,u){return new Promise((l,f)=>{const d=h=>{h==null?l():f(h)};typeof c=="string"?this.stream.write(c,u,d):this.stream.write(
c,d)})}end(){this.stream.end()}}const s=Object.freeze({messageBuffer:Object.freeze({create:o=>new n(o)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(o,c)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(o,void 0,0),c.charset))}catch(u){return Promise.reject(u)}}}),decoder:Object.freeze({name:"application/json",decode:(o,c)=>{try{return o instanceof Buffer?Promise.resolve(JSON.parse(o.toString(c.charset))):Promise.resolve(JSON.parse(new t.TextDecoder(
c.charset).decode(o)))}catch(u){return Promise.reject(u)}}})}),stream:Object.freeze({asReadableStream:o=>new r(o),asWritableStream:o=>new i(o)}),console,timer:Object.freeze({setTimeout(o,c,...u){const l=setTimeout(o,c,...u);return{dispose:()=>clearTimeout(l)}},setImmediate(o,...c){const u=setImmediate(o,...c);return{dispose:()=>clearImmediate(u)}},setInterval(o,c,...u){const l=setInterval(o,c,...u);return{dispose:()=>clearInterval(l)}}})});function a(){return s}return function(o){function c(){e.
RAL.install(s)}o.install=c}(a||(a={})),jf.default=a,jf}var mE;function bs(){return mE||(mE=1,function(t){var e=vs&&vs.__createBinding||(Object.create?function(z,E,R,M){M===void 0&&(M=R);var _=Object.getOwnPropertyDescriptor(E,R);(!_||("get"in _?!E.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return E[R]}}),Object.defineProperty(z,M,_)}:function(z,E,R,M){M===void 0&&(M=R),z[M]=E[R]}),n=vs&&vs.__exportStar||function(z,E){for(var R in z)R!=="default"&&!Object.prototype.
hasOwnProperty.call(E,R)&&e(E,z,R)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.PortMessageWriter=t.PortMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=t2();r.default.install();const i=mi,s=Z_,a=eC,o=tC,c=ay();n(ay(),t);
class u extends c.AbstractMessageReader{constructor(E){super(),this.process=E;let R=this.process;R.on("error",M=>this.fireError(M)),R.on("close",()=>this.fireClose())}listen(E){return this.process.on("message",E),c.Disposable.create(()=>this.process.off("message",E))}}t.IPCMessageReader=u;class l extends c.AbstractMessageWriter{constructor(E){super(),this.process=E,this.errorCount=0;const R=this.process;R.on("error",M=>this.fireError(M)),R.on("close",()=>this.fireClose)}write(E){try{return typeof this.
process.send=="function"&&this.process.send(E,void 0,void 0,R=>{R?(this.errorCount++,this.handleError(R,E)):this.errorCount=0}),Promise.resolve()}catch(R){return this.handleError(R,E),Promise.reject(R)}}handleError(E,R){this.errorCount++,this.fireError(E,R,this.errorCount)}end(){}}t.IPCMessageWriter=l;class f extends c.AbstractMessageReader{constructor(E){super(),this.onData=new c.Emitter,E.on("close",()=>this.fireClose),E.on("error",R=>this.fireError(R)),E.on("message",R=>{this.onData.fire(R)})}listen(E){
return this.onData.event(E)}}t.PortMessageReader=f;class d extends c.AbstractMessageWriter{constructor(E){super(),this.port=E,this.errorCount=0,E.on("close",()=>this.fireClose()),E.on("error",R=>this.fireError(R))}write(E){try{return this.port.postMessage(E),Promise.resolve()}catch(R){return this.handleError(R,E),Promise.reject(R)}}handleError(E,R){this.errorCount++,this.fireError(E,R,this.errorCount)}end(){}}t.PortMessageWriter=d;class h extends c.ReadableStreamMessageReader{constructor(E,R="ut\
f-8"){super((0,r.default)().stream.asReadableStream(E),R)}}t.SocketMessageReader=h;class m extends c.WriteableStreamMessageWriter{constructor(E,R){super((0,r.default)().stream.asWritableStream(E),R),this.socket=E}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=m;class b extends c.ReadableStreamMessageReader{constructor(E,R){super((0,r.default)().stream.asReadableStream(E),R)}}t.StreamMessageReader=b;class $ extends c.WriteableStreamMessageWriter{constructor(E,R){super((0,r.
default)().stream.asWritableStream(E),R)}}t.StreamMessageWriter=$;const w=process.env.XDG_RUNTIME_DIR,k=new Map([["linux",107],["darwin",103]]);function S(){const z=(0,a.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${z}-sock`;let E;w?E=i.join(w,`vscode-ipc-${z}.sock`):E=i.join(s.tmpdir(),`vscode-${z}.sock`);const R=k.get(process.platform);return R!==void 0&&E.length>R&&(0,r.default)().console.warn(`WARNING: IPC handle "${E}" is longer than ${R}\
 characters.`),E}t.generateRandomPipeName=S;function D(z,E="utf-8"){let R;const M=new Promise((_,P)=>{R=_});return new Promise((_,P)=>{let I=(0,o.createServer)(Z=>{I.close(),R([new h(Z,E),new m(Z,E)])});I.on("error",P),I.listen(z,()=>{I.removeListener("error",P),_({onConnected:()=>M})})})}t.createClientPipeTransport=D;function F(z,E="utf-8"){const R=(0,o.createConnection)(z);return[new h(R,E),new m(R,E)]}t.createServerPipeTransport=F;function Y(z,E="utf-8"){let R;const M=new Promise((_,P)=>{R=_});
return new Promise((_,P)=>{const I=(0,o.createServer)(Z=>{I.close(),R([new h(Z,E),new m(Z,E)])});I.on("error",P),I.listen(z,"127.0.0.1",()=>{I.removeListener("error",P),_({onConnected:()=>M})})})}t.createClientSocketTransport=Y;function J(z,E="utf-8"){const R=(0,o.createConnection)(z,"127.0.0.1");return[new h(R,E),new m(R,E)]}t.createServerSocketTransport=J;function ie(z){const E=z;return E.read!==void 0&&E.addListener!==void 0}function re(z){const E=z;return E.write!==void 0&&E.addListener!==void 0}
function ye(z,E,R,M){R||(R=c.NullLogger);const _=ie(z)?new b(z):z,P=re(E)?new $(E):E;return c.ConnectionStrategy.is(M)&&(M={connectionStrategy:M}),(0,c.createMessageConnection)(_,P,R,M)}t.createMessageConnection=ye}(vs)),vs}var oy,gE;function yE(){return gE||(gE=1,oy=bs()),oy}var $s={},Bf={exports:{}},vE;function cy(){return vE||(vE=1,function(t,e){(function(n){{var r=n(Dp,e);r!==void 0&&(t.exports=r)}})(function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextDocument=r.EOL=r.WorkspaceFolder=
r.InlineCompletionContext=r.SelectedCompletionInfo=r.InlineCompletionTriggerKind=r.InlineCompletionList=r.InlineCompletionItem=r.StringValue=r.InlayHint=r.InlayHintLabelPart=r.InlayHintKind=r.InlineValueContext=r.InlineValueEvaluatableExpression=r.InlineValueVariableLookup=r.InlineValueText=r.SemanticTokens=r.SemanticTokenModifiers=r.SemanticTokenTypes=r.SelectionRange=r.DocumentLink=r.FormattingOptions=r.CodeLens=r.CodeAction=r.CodeActionContext=r.CodeActionTriggerKind=r.CodeActionKind=r.DocumentSymbol=
r.WorkspaceSymbol=r.SymbolInformation=r.SymbolTag=r.SymbolKind=r.DocumentHighlight=r.DocumentHighlightKind=r.SignatureInformation=r.ParameterInformation=r.Hover=r.MarkedString=r.CompletionList=r.CompletionItem=r.CompletionItemLabelDetails=r.InsertTextMode=r.InsertReplaceEdit=r.CompletionItemTag=r.InsertTextFormat=r.CompletionItemKind=r.MarkupContent=r.MarkupKind=r.TextDocumentItem=r.OptionalVersionedTextDocumentIdentifier=r.VersionedTextDocumentIdentifier=r.TextDocumentIdentifier=r.WorkspaceChange=
r.WorkspaceEdit=r.DeleteFile=r.RenameFile=r.CreateFile=r.TextDocumentEdit=r.AnnotatedTextEdit=r.ChangeAnnotationIdentifier=r.ChangeAnnotation=r.TextEdit=r.Command=r.Diagnostic=r.CodeDescription=r.DiagnosticTag=r.DiagnosticSeverity=r.DiagnosticRelatedInformation=r.FoldingRange=r.FoldingRangeKind=r.ColorPresentation=r.ColorInformation=r.Color=r.LocationLink=r.Location=r.Range=r.Position=r.uinteger=r.integer=r.URI=r.DocumentUri=void 0;var i;(function(y){function C(p){return typeof p=="string"}y.is=
C})(i||(r.DocumentUri=i={}));var s;(function(y){function C(p){return typeof p=="string"}y.is=C})(s||(r.URI=s={}));var a;(function(y){y.MIN_VALUE=-2147483648,y.MAX_VALUE=2147483647;function C(p){return typeof p=="number"&&y.MIN_VALUE<=p&&p<=y.MAX_VALUE}y.is=C})(a||(r.integer=a={}));var o;(function(y){y.MIN_VALUE=0,y.MAX_VALUE=2147483647;function C(p){return typeof p=="number"&&y.MIN_VALUE<=p&&p<=y.MAX_VALUE}y.is=C})(o||(r.uinteger=o={}));var c;(function(y){function C(T,g){return T===Number.MAX_VALUE&&
(T=o.MAX_VALUE),g===Number.MAX_VALUE&&(g=o.MAX_VALUE),{line:T,character:g}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&q.uinteger(g.line)&&q.uinteger(g.character)}y.is=p})(c||(r.Position=c={}));var u;(function(y){function C(T,g,x,v){if(q.uinteger(T)&&q.uinteger(g)&&q.uinteger(x)&&q.uinteger(v))return{start:c.create(T,g),end:c.create(x,v)};if(c.is(T)&&c.is(g))return{start:T,end:g};throw new Error("Range#create called with invalid arguments[".concat(T,", ").concat(g,", ").concat(x,
", ").concat(v,"]"))}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&c.is(g.start)&&c.is(g.end)}y.is=p})(u||(r.Range=u={}));var l;(function(y){function C(T,g){return{uri:T,range:g}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&u.is(g.range)&&(q.string(g.uri)||q.undefined(g.uri))}y.is=p})(l||(r.Location=l={}));var f;(function(y){function C(T,g,x,v){return{targetUri:T,targetRange:g,targetSelectionRange:x,originSelectionRange:v}}y.create=C;function p(T){var g=T;return q.objectLiteral(
g)&&u.is(g.targetRange)&&q.string(g.targetUri)&&u.is(g.targetSelectionRange)&&(u.is(g.originSelectionRange)||q.undefined(g.originSelectionRange))}y.is=p})(f||(r.LocationLink=f={}));var d;(function(y){function C(T,g,x,v){return{red:T,green:g,blue:x,alpha:v}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&q.numberRange(g.red,0,1)&&q.numberRange(g.green,0,1)&&q.numberRange(g.blue,0,1)&&q.numberRange(g.alpha,0,1)}y.is=p})(d||(r.Color=d={}));var h;(function(y){function C(T,g){return{range:T,
color:g}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&u.is(g.range)&&d.is(g.color)}y.is=p})(h||(r.ColorInformation=h={}));var m;(function(y){function C(T,g,x){return{label:T,textEdit:g,additionalTextEdits:x}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&q.string(g.label)&&(q.undefined(g.textEdit)||J.is(g))&&(q.undefined(g.additionalTextEdits)||q.typedArray(g.additionalTextEdits,J.is))}y.is=p})(m||(r.ColorPresentation=m={}));var b;(function(y){y.Comment="comment",y.Imports=
"imports",y.Region="region"})(b||(r.FoldingRangeKind=b={}));var $;(function(y){function C(T,g,x,v,U,ee){var se={startLine:T,endLine:g};return q.defined(x)&&(se.startCharacter=x),q.defined(v)&&(se.endCharacter=v),q.defined(U)&&(se.kind=U),q.defined(ee)&&(se.collapsedText=ee),se}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&q.uinteger(g.startLine)&&q.uinteger(g.startLine)&&(q.undefined(g.startCharacter)||q.uinteger(g.startCharacter))&&(q.undefined(g.endCharacter)||q.uinteger(g.endCharacter))&&
(q.undefined(g.kind)||q.string(g.kind))}y.is=p})($||(r.FoldingRange=$={}));var w;(function(y){function C(T,g){return{location:T,message:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&l.is(g.location)&&q.string(g.message)}y.is=p})(w||(r.DiagnosticRelatedInformation=w={}));var k;(function(y){y.Error=1,y.Warning=2,y.Information=3,y.Hint=4})(k||(r.DiagnosticSeverity=k={}));var S;(function(y){y.Unnecessary=1,y.Deprecated=2})(S||(r.DiagnosticTag=S={}));var D;(function(y){function C(p){var T=p;
return q.objectLiteral(T)&&q.string(T.href)}y.is=C})(D||(r.CodeDescription=D={}));var F;(function(y){function C(T,g,x,v,U,ee){var se={range:T,message:g};return q.defined(x)&&(se.severity=x),q.defined(v)&&(se.code=v),q.defined(U)&&(se.source=U),q.defined(ee)&&(se.relatedInformation=ee),se}y.create=C;function p(T){var g,x=T;return q.defined(x)&&u.is(x.range)&&q.string(x.message)&&(q.number(x.severity)||q.undefined(x.severity))&&(q.integer(x.code)||q.string(x.code)||q.undefined(x.code))&&(q.undefined(
x.codeDescription)||q.string((g=x.codeDescription)===null||g===void 0?void 0:g.href))&&(q.string(x.source)||q.undefined(x.source))&&(q.undefined(x.relatedInformation)||q.typedArray(x.relatedInformation,w.is))}y.is=p})(F||(r.Diagnostic=F={}));var Y;(function(y){function C(T,g){for(var x=[],v=2;v<arguments.length;v++)x[v-2]=arguments[v];var U={title:T,command:g};return q.defined(x)&&x.length>0&&(U.arguments=x),U}y.create=C;function p(T){var g=T;return q.defined(g)&&q.string(g.title)&&q.string(g.command)}
y.is=p})(Y||(r.Command=Y={}));var J;(function(y){function C(x,v){return{range:x,newText:v}}y.replace=C;function p(x,v){return{range:{start:x,end:x},newText:v}}y.insert=p;function T(x){return{range:x,newText:""}}y.del=T;function g(x){var v=x;return q.objectLiteral(v)&&q.string(v.newText)&&u.is(v.range)}y.is=g})(J||(r.TextEdit=J={}));var ie;(function(y){function C(T,g,x){var v={label:T};return g!==void 0&&(v.needsConfirmation=g),x!==void 0&&(v.description=x),v}y.create=C;function p(T){var g=T;return q.
objectLiteral(g)&&q.string(g.label)&&(q.boolean(g.needsConfirmation)||g.needsConfirmation===void 0)&&(q.string(g.description)||g.description===void 0)}y.is=p})(ie||(r.ChangeAnnotation=ie={}));var re;(function(y){function C(p){var T=p;return q.string(T)}y.is=C})(re||(r.ChangeAnnotationIdentifier=re={}));var ye;(function(y){function C(x,v,U){return{range:x,newText:v,annotationId:U}}y.replace=C;function p(x,v,U){return{range:{start:x,end:x},newText:v,annotationId:U}}y.insert=p;function T(x,v){return{
range:x,newText:"",annotationId:v}}y.del=T;function g(x){var v=x;return J.is(v)&&(ie.is(v.annotationId)||re.is(v.annotationId))}y.is=g})(ye||(r.AnnotatedTextEdit=ye={}));var z;(function(y){function C(T,g){return{textDocument:T,edits:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&te.is(g.textDocument)&&Array.isArray(g.edits)}y.is=p})(z||(r.TextDocumentEdit=z={}));var E;(function(y){function C(T,g,x){var v={kind:"create",uri:T};return g!==void 0&&(g.overwrite!==void 0||g.ignoreIfExists!==
void 0)&&(v.options=g),x!==void 0&&(v.annotationId=x),v}y.create=C;function p(T){var g=T;return g&&g.kind==="create"&&q.string(g.uri)&&(g.options===void 0||(g.options.overwrite===void 0||q.boolean(g.options.overwrite))&&(g.options.ignoreIfExists===void 0||q.boolean(g.options.ignoreIfExists)))&&(g.annotationId===void 0||re.is(g.annotationId))}y.is=p})(E||(r.CreateFile=E={}));var R;(function(y){function C(T,g,x,v){var U={kind:"rename",oldUri:T,newUri:g};return x!==void 0&&(x.overwrite!==void 0||x.
ignoreIfExists!==void 0)&&(U.options=x),v!==void 0&&(U.annotationId=v),U}y.create=C;function p(T){var g=T;return g&&g.kind==="rename"&&q.string(g.oldUri)&&q.string(g.newUri)&&(g.options===void 0||(g.options.overwrite===void 0||q.boolean(g.options.overwrite))&&(g.options.ignoreIfExists===void 0||q.boolean(g.options.ignoreIfExists)))&&(g.annotationId===void 0||re.is(g.annotationId))}y.is=p})(R||(r.RenameFile=R={}));var M;(function(y){function C(T,g,x){var v={kind:"delete",uri:T};return g!==void 0&&
(g.recursive!==void 0||g.ignoreIfNotExists!==void 0)&&(v.options=g),x!==void 0&&(v.annotationId=x),v}y.create=C;function p(T){var g=T;return g&&g.kind==="delete"&&q.string(g.uri)&&(g.options===void 0||(g.options.recursive===void 0||q.boolean(g.options.recursive))&&(g.options.ignoreIfNotExists===void 0||q.boolean(g.options.ignoreIfNotExists)))&&(g.annotationId===void 0||re.is(g.annotationId))}y.is=p})(M||(r.DeleteFile=M={}));var _;(function(y){function C(p){var T=p;return T&&(T.changes!==void 0||
T.documentChanges!==void 0)&&(T.documentChanges===void 0||T.documentChanges.every(function(g){return q.string(g.kind)?E.is(g)||R.is(g)||M.is(g):z.is(g)}))}y.is=C})(_||(r.WorkspaceEdit=_={}));var P=function(){function y(C,p){this.edits=C,this.changeAnnotations=p}return y.prototype.insert=function(C,p,T){var g,x;if(T===void 0?g=J.insert(C,p):re.is(T)?(x=T,g=ye.insert(C,p,T)):(this.assertChangeAnnotations(this.changeAnnotations),x=this.changeAnnotations.manage(T),g=ye.insert(C,p,x)),this.edits.push(
g),x!==void 0)return x},y.prototype.replace=function(C,p,T){var g,x;if(T===void 0?g=J.replace(C,p):re.is(T)?(x=T,g=ye.replace(C,p,T)):(this.assertChangeAnnotations(this.changeAnnotations),x=this.changeAnnotations.manage(T),g=ye.replace(C,p,x)),this.edits.push(g),x!==void 0)return x},y.prototype.delete=function(C,p){var T,g;if(p===void 0?T=J.del(C):re.is(p)?(g=p,T=ye.del(C,p)):(this.assertChangeAnnotations(this.changeAnnotations),g=this.changeAnnotations.manage(p),T=ye.del(C,g)),this.edits.push(T),
g!==void 0)return g},y.prototype.add=function(C){this.edits.push(C)},y.prototype.all=function(){return this.edits},y.prototype.clear=function(){this.edits.splice(0,this.edits.length)},y.prototype.assertChangeAnnotations=function(C){if(C===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},y}(),I=function(){function y(C){this._annotations=C===void 0?Object.create(null):C,this._counter=0,this._size=0}return y.prototype.all=function(){return this._annotations},
Object.defineProperty(y.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),y.prototype.manage=function(C,p){var T;if(re.is(C)?T=C:(T=this.nextId(),p=C),this._annotations[T]!==void 0)throw new Error("Id ".concat(T," is already in use."));if(p===void 0)throw new Error("No annotation provided for id ".concat(T));return this._annotations[T]=p,this._size++,T},y.prototype.nextId=function(){return this._counter++,this._counter.toString()},y}(),Z=function(){function y(C){
var p=this;this._textEditChanges=Object.create(null),C!==void 0?(this._workspaceEdit=C,C.documentChanges?(this._changeAnnotations=new I(C.changeAnnotations),C.changeAnnotations=this._changeAnnotations.all(),C.documentChanges.forEach(function(T){if(z.is(T)){var g=new P(T.edits,p._changeAnnotations);p._textEditChanges[T.textDocument.uri]=g}})):C.changes&&Object.keys(C.changes).forEach(function(T){var g=new P(C.changes[T]);p._textEditChanges[T]=g})):this._workspaceEdit={}}return Object.defineProperty(
y.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),y.prototype.getTextEditChange=function(C){if(te.is(C)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document cha\
nges.");var p={uri:C.uri,version:C.version},T=this._textEditChanges[p.uri];if(!T){var g=[],x={textDocument:p,edits:g};this._workspaceEdit.documentChanges.push(x),T=new P(g,this._changeAnnotations),this._textEditChanges[p.uri]=T}return T}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var T=this._textEditChanges[C];if(!T){var g=[];this._workspaceEdit.changes[C]=g,T=new P(g),this._textEditChanges[C]=T}
return T}},y.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new I,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},y.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},y.prototype.createFile=function(C,p,T){if(this.initDocumentChanges(),
this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var g;ie.is(p)||re.is(p)?g=p:T=p;var x,v;if(g===void 0?x=E.create(C,T):(v=re.is(g)?g:this._changeAnnotations.manage(g),x=E.create(C,T,v)),this._workspaceEdit.documentChanges.push(x),v!==void 0)return v},y.prototype.renameFile=function(C,p,T,g){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document\
 changes.");var x;ie.is(T)||re.is(T)?x=T:g=T;var v,U;if(x===void 0?v=R.create(C,p,g):(U=re.is(x)?x:this._changeAnnotations.manage(x),v=R.create(C,p,g,U)),this._workspaceEdit.documentChanges.push(v),U!==void 0)return U},y.prototype.deleteFile=function(C,p,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var g;ie.is(p)||re.is(p)?g=p:T=p;var x,v;if(g===void 0?x=M.create(C,T):(v=re.is(g)?g:this._changeAnnotations.
manage(g),x=M.create(C,T,v)),this._workspaceEdit.documentChanges.push(x),v!==void 0)return v},y}();r.WorkspaceChange=Z;var H;(function(y){function C(T){return{uri:T}}y.create=C;function p(T){var g=T;return q.defined(g)&&q.string(g.uri)}y.is=p})(H||(r.TextDocumentIdentifier=H={}));var A;(function(y){function C(T,g){return{uri:T,version:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&q.string(g.uri)&&q.integer(g.version)}y.is=p})(A||(r.VersionedTextDocumentIdentifier=A={}));var te;(function(y){
function C(T,g){return{uri:T,version:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&q.string(g.uri)&&(g.version===null||q.integer(g.version))}y.is=p})(te||(r.OptionalVersionedTextDocumentIdentifier=te={}));var me;(function(y){function C(T,g,x,v){return{uri:T,languageId:g,version:x,text:v}}y.create=C;function p(T){var g=T;return q.defined(g)&&q.string(g.uri)&&q.string(g.languageId)&&q.integer(g.version)&&q.string(g.text)}y.is=p})(me||(r.TextDocumentItem=me={}));var Ce;(function(y){y.PlainText=
"plaintext",y.Markdown="markdown";function C(p){var T=p;return T===y.PlainText||T===y.Markdown}y.is=C})(Ce||(r.MarkupKind=Ce={}));var L;(function(y){function C(p){var T=p;return q.objectLiteral(p)&&Ce.is(T.kind)&&q.string(T.value)}y.is=C})(L||(r.MarkupContent=L={}));var K;(function(y){y.Text=1,y.Method=2,y.Function=3,y.Constructor=4,y.Field=5,y.Variable=6,y.Class=7,y.Interface=8,y.Module=9,y.Property=10,y.Unit=11,y.Value=12,y.Enum=13,y.Keyword=14,y.Snippet=15,y.Color=16,y.File=17,y.Reference=18,
y.Folder=19,y.EnumMember=20,y.Constant=21,y.Struct=22,y.Event=23,y.Operator=24,y.TypeParameter=25})(K||(r.CompletionItemKind=K={}));var _e;(function(y){y.PlainText=1,y.Snippet=2})(_e||(r.InsertTextFormat=_e={}));var ue;(function(y){y.Deprecated=1})(ue||(r.CompletionItemTag=ue={}));var $e;(function(y){function C(T,g,x){return{newText:T,insert:g,replace:x}}y.create=C;function p(T){var g=T;return g&&q.string(g.newText)&&u.is(g.insert)&&u.is(g.replace)}y.is=p})($e||(r.InsertReplaceEdit=$e={}));var Pe;
(function(y){y.asIs=1,y.adjustIndentation=2})(Pe||(r.InsertTextMode=Pe={}));var le;(function(y){function C(p){var T=p;return T&&(q.string(T.detail)||T.detail===void 0)&&(q.string(T.description)||T.description===void 0)}y.is=C})(le||(r.CompletionItemLabelDetails=le={}));var N;(function(y){function C(p){return{label:p}}y.create=C})(N||(r.CompletionItem=N={}));var j;(function(y){function C(p,T){return{items:p||[],isIncomplete:!!T}}y.create=C})(j||(r.CompletionList=j={}));var fe;(function(y){function C(T){
return T.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}y.fromPlainText=C;function p(T){var g=T;return q.string(g)||q.objectLiteral(g)&&q.string(g.language)&&q.string(g.value)}y.is=p})(fe||(r.MarkedString=fe={}));var B;(function(y){function C(p){var T=p;return!!T&&q.objectLiteral(T)&&(L.is(T.contents)||fe.is(T.contents)||q.typedArray(T.contents,fe.is))&&(p.range===void 0||u.is(p.range))}y.is=C})(B||(r.Hover=B={}));var de;(function(y){function C(p,T){return T?{label:p,documentation:T}:{label:p}}y.create=
C})(de||(r.ParameterInformation=de={}));var Be;(function(y){function C(p,T){for(var g=[],x=2;x<arguments.length;x++)g[x-2]=arguments[x];var v={label:p};return q.defined(T)&&(v.documentation=T),q.defined(g)?v.parameters=g:v.parameters=[],v}y.create=C})(Be||(r.SignatureInformation=Be={}));var Qe;(function(y){y.Text=1,y.Read=2,y.Write=3})(Qe||(r.DocumentHighlightKind=Qe={}));var oe;(function(y){function C(p,T){var g={range:p};return q.number(T)&&(g.kind=T),g}y.create=C})(oe||(r.DocumentHighlight=oe=
{}));var De;(function(y){y.File=1,y.Module=2,y.Namespace=3,y.Package=4,y.Class=5,y.Method=6,y.Property=7,y.Field=8,y.Constructor=9,y.Enum=10,y.Interface=11,y.Function=12,y.Variable=13,y.Constant=14,y.String=15,y.Number=16,y.Boolean=17,y.Array=18,y.Object=19,y.Key=20,y.Null=21,y.EnumMember=22,y.Struct=23,y.Event=24,y.Operator=25,y.TypeParameter=26})(De||(r.SymbolKind=De={}));var ne;(function(y){y.Deprecated=1})(ne||(r.SymbolTag=ne={}));var Re;(function(y){function C(p,T,g,x,v){var U={name:p,kind:T,
location:{uri:x,range:g}};return v&&(U.containerName=v),U}y.create=C})(Re||(r.SymbolInformation=Re={}));var Fe;(function(y){function C(p,T,g,x){return x!==void 0?{name:p,kind:T,location:{uri:g,range:x}}:{name:p,kind:T,location:{uri:g}}}y.create=C})(Fe||(r.WorkspaceSymbol=Fe={}));var ft;(function(y){function C(T,g,x,v,U,ee){var se={name:T,detail:g,kind:x,range:v,selectionRange:U};return ee!==void 0&&(se.children=ee),se}y.create=C;function p(T){var g=T;return g&&q.string(g.name)&&q.number(g.kind)&&
u.is(g.range)&&u.is(g.selectionRange)&&(g.detail===void 0||q.string(g.detail))&&(g.deprecated===void 0||q.boolean(g.deprecated))&&(g.children===void 0||Array.isArray(g.children))&&(g.tags===void 0||Array.isArray(g.tags))}y.is=p})(ft||(r.DocumentSymbol=ft={}));var Ve;(function(y){y.Empty="",y.QuickFix="quickfix",y.Refactor="refactor",y.RefactorExtract="refactor.extract",y.RefactorInline="refactor.inline",y.RefactorRewrite="refactor.rewrite",y.Source="source",y.SourceOrganizeImports="source.organi\
zeImports",y.SourceFixAll="source.fixAll"})(Ve||(r.CodeActionKind=Ve={}));var zt;(function(y){y.Invoked=1,y.Automatic=2})(zt||(r.CodeActionTriggerKind=zt={}));var Bt;(function(y){function C(T,g,x){var v={diagnostics:T};return g!=null&&(v.only=g),x!=null&&(v.triggerKind=x),v}y.create=C;function p(T){var g=T;return q.defined(g)&&q.typedArray(g.diagnostics,F.is)&&(g.only===void 0||q.typedArray(g.only,q.string))&&(g.triggerKind===void 0||g.triggerKind===zt.Invoked||g.triggerKind===zt.Automatic)}y.is=
p})(Bt||(r.CodeActionContext=Bt={}));var on;(function(y){function C(T,g,x){var v={title:T},U=!0;return typeof g=="string"?(U=!1,v.kind=g):Y.is(g)?v.command=g:v.edit=g,U&&x!==void 0&&(v.kind=x),v}y.create=C;function p(T){var g=T;return g&&q.string(g.title)&&(g.diagnostics===void 0||q.typedArray(g.diagnostics,F.is))&&(g.kind===void 0||q.string(g.kind))&&(g.edit!==void 0||g.command!==void 0)&&(g.command===void 0||Y.is(g.command))&&(g.isPreferred===void 0||q.boolean(g.isPreferred))&&(g.edit===void 0||
_.is(g.edit))}y.is=p})(on||(r.CodeAction=on={}));var V;(function(y){function C(T,g){var x={range:T};return q.defined(g)&&(x.data=g),x}y.create=C;function p(T){var g=T;return q.defined(g)&&u.is(g.range)&&(q.undefined(g.command)||Y.is(g.command))}y.is=p})(V||(r.CodeLens=V={}));var X;(function(y){function C(T,g){return{tabSize:T,insertSpaces:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&q.uinteger(g.tabSize)&&q.boolean(g.insertSpaces)}y.is=p})(X||(r.FormattingOptions=X={}));var he;(function(y){
function C(T,g,x){return{range:T,target:g,data:x}}y.create=C;function p(T){var g=T;return q.defined(g)&&u.is(g.range)&&(q.undefined(g.target)||q.string(g.target))}y.is=p})(he||(r.DocumentLink=he={}));var Ut;(function(y){function C(T,g){return{range:T,parent:g}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&u.is(g.range)&&(g.parent===void 0||y.is(g.parent))}y.is=p})(Ut||(r.SelectionRange=Ut={}));var Ft;(function(y){y.namespace="namespace",y.type="type",y.class="class",y.enum="enum",y.
interface="interface",y.struct="struct",y.typeParameter="typeParameter",y.parameter="parameter",y.variable="variable",y.property="property",y.enumMember="enumMember",y.event="event",y.function="function",y.method="method",y.macro="macro",y.keyword="keyword",y.modifier="modifier",y.comment="comment",y.string="string",y.number="number",y.regexp="regexp",y.operator="operator",y.decorator="decorator"})(Ft||(r.SemanticTokenTypes=Ft={}));var mr;(function(y){y.declaration="declaration",y.definition="de\
finition",y.readonly="readonly",y.static="static",y.deprecated="deprecated",y.abstract="abstract",y.async="async",y.modification="modification",y.documentation="documentation",y.defaultLibrary="defaultLibrary"})(mr||(r.SemanticTokenModifiers=mr={}));var di;(function(y){function C(p){var T=p;return q.objectLiteral(T)&&(T.resultId===void 0||typeof T.resultId=="string")&&Array.isArray(T.data)&&(T.data.length===0||typeof T.data[0]=="number")}y.is=C})(di||(r.SemanticTokens=di={}));var ji;(function(y){
function C(T,g){return{range:T,text:g}}y.create=C;function p(T){var g=T;return g!=null&&u.is(g.range)&&q.string(g.text)}y.is=p})(ji||(r.InlineValueText=ji={}));var Bi;(function(y){function C(T,g,x){return{range:T,variableName:g,caseSensitiveLookup:x}}y.create=C;function p(T){var g=T;return g!=null&&u.is(g.range)&&q.boolean(g.caseSensitiveLookup)&&(q.string(g.variableName)||g.variableName===void 0)}y.is=p})(Bi||(r.InlineValueVariableLookup=Bi={}));var Ui;(function(y){function C(T,g){return{range:T,
expression:g}}y.create=C;function p(T){var g=T;return g!=null&&u.is(g.range)&&(q.string(g.expression)||g.expression===void 0)}y.is=p})(Ui||(r.InlineValueEvaluatableExpression=Ui={}));var Wi;(function(y){function C(T,g){return{frameId:T,stoppedLocation:g}}y.create=C;function p(T){var g=T;return q.defined(g)&&u.is(T.stoppedLocation)}y.is=p})(Wi||(r.InlineValueContext=Wi={}));var fi;(function(y){y.Type=1,y.Parameter=2;function C(p){return p===1||p===2}y.is=C})(fi||(r.InlayHintKind=fi={}));var hi;(function(y){
function C(T){return{value:T}}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&(g.tooltip===void 0||q.string(g.tooltip)||L.is(g.tooltip))&&(g.location===void 0||l.is(g.location))&&(g.command===void 0||Y.is(g.command))}y.is=p})(hi||(r.InlayHintLabelPart=hi={}));var $n;(function(y){function C(T,g,x){var v={position:T,label:g};return x!==void 0&&(v.kind=x),v}y.create=C;function p(T){var g=T;return q.objectLiteral(g)&&c.is(g.position)&&(q.string(g.label)||q.typedArray(g.label,hi.is))&&(g.
kind===void 0||fi.is(g.kind))&&g.textEdits===void 0||q.typedArray(g.textEdits,J.is)&&(g.tooltip===void 0||q.string(g.tooltip)||L.is(g.tooltip))&&(g.paddingLeft===void 0||q.boolean(g.paddingLeft))&&(g.paddingRight===void 0||q.boolean(g.paddingRight))}y.is=p})($n||(r.InlayHint=$n={}));var Hi;(function(y){function C(p){return{kind:"snippet",value:p}}y.createSnippet=C})(Hi||(r.StringValue=Hi={}));var Ki;(function(y){function C(p,T,g,x){return{insertText:p,filterText:T,range:g,command:x}}y.create=C})(
Ki||(r.InlineCompletionItem=Ki={}));var gr;(function(y){function C(p){return{items:p}}y.create=C})(gr||(r.InlineCompletionList=gr={}));var Vi;(function(y){y.Invoked=0,y.Automatic=1})(Vi||(r.InlineCompletionTriggerKind=Vi={}));var xr;(function(y){function C(p,T){return{range:p,text:T}}y.create=C})(xr||(r.SelectedCompletionInfo=xr={}));var Xi;(function(y){function C(p,T){return{triggerKind:p,selectedCompletionInfo:T}}y.create=C})(Xi||(r.InlineCompletionContext=Xi={}));var jn;(function(y){function C(p){
var T=p;return q.objectLiteral(T)&&s.is(T.uri)&&q.string(T.name)}y.is=C})(jn||(r.WorkspaceFolder=jn={})),r.EOL=[`
`,`\r
`,"\r"];var er;(function(y){function C(x,v,U,ee){return new Qs(x,v,U,ee)}y.create=C;function p(x){var v=x;return!!(q.defined(v)&&q.string(v.uri)&&(q.undefined(v.languageId)||q.string(v.languageId))&&q.uinteger(v.lineCount)&&q.func(v.getText)&&q.func(v.positionAt)&&q.func(v.offsetAt))}y.is=p;function T(x,v){for(var U=x.getText(),ee=g(v,function(Ne,rt){var Ye=Ne.range.start.line-rt.range.start.line;return Ye===0?Ne.range.start.character-rt.range.start.character:Ye}),se=U.length,qe=ee.length-1;qe>=
0;qe--){var Le=ee[qe],Xe=x.offsetAt(Le.range.start),we=x.offsetAt(Le.range.end);if(we<=se)U=U.substring(0,Xe)+Le.newText+U.substring(we,U.length);else throw new Error("Overlapping edit");se=Xe}return U}y.applyEdits=T;function g(x,v){if(x.length<=1)return x;var U=x.length/2|0,ee=x.slice(0,U),se=x.slice(U);g(ee,v),g(se,v);for(var qe=0,Le=0,Xe=0;qe<ee.length&&Le<se.length;){var we=v(ee[qe],se[Le]);we<=0?x[Xe++]=ee[qe++]:x[Xe++]=se[Le++]}for(;qe<ee.length;)x[Xe++]=ee[qe++];for(;Le<se.length;)x[Xe++]=
se[Le++];return x}})(er||(r.TextDocument=er={}));var Qs=function(){function y(C,p,T,g){this._uri=C,this._languageId=p,this._version=T,this._content=g,this._lineOffsets=void 0}return Object.defineProperty(y.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"version",{get:function(){return this._version},enumerable:!1,
configurable:!0}),y.prototype.getText=function(C){if(C){var p=this.offsetAt(C.start),T=this.offsetAt(C.end);return this._content.substring(p,T)}return this._content},y.prototype.update=function(C,p){this._content=C.text,this._version=p,this._lineOffsets=void 0},y.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var C=[],p=this._content,T=!0,g=0;g<p.length;g++){T&&(C.push(g),T=!1);var x=p.charAt(g);T=x==="\r"||x===`
`,x==="\r"&&g+1<p.length&&p.charAt(g+1)===`
`&&g++}T&&p.length>0&&C.push(p.length),this._lineOffsets=C}return this._lineOffsets},y.prototype.positionAt=function(C){C=Math.max(Math.min(C,this._content.length),0);var p=this.getLineOffsets(),T=0,g=p.length;if(g===0)return c.create(0,C);for(;T<g;){var x=Math.floor((T+g)/2);p[x]>C?g=x:T=x+1}var v=T-1;return c.create(v,C-p[v])},y.prototype.offsetAt=function(C){var p=this.getLineOffsets();if(C.line>=p.length)return this._content.length;if(C.line<0)return 0;var T=p[C.line],g=C.line+1<p.length?p[C.
line+1]:this._content.length;return Math.max(Math.min(T+C.character,g),T)},Object.defineProperty(y.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),y}(),q;(function(y){var C=Object.prototype.toString;function p(we){return typeof we<"u"}y.defined=p;function T(we){return typeof we>"u"}y.undefined=T;function g(we){return we===!0||we===!1}y.boolean=g;function x(we){return C.call(we)==="[object String]"}y.string=x;function v(we){return C.call(
we)==="[object Number]"}y.number=v;function U(we,Ne,rt){return C.call(we)==="[object Number]"&&Ne<=we&&we<=rt}y.numberRange=U;function ee(we){return C.call(we)==="[object Number]"&&-2147483648<=we&&we<=2147483647}y.integer=ee;function se(we){return C.call(we)==="[object Number]"&&0<=we&&we<=2147483647}y.uinteger=se;function qe(we){return C.call(we)==="[object Function]"}y.func=qe;function Le(we){return we!==null&&typeof we=="object"}y.objectLiteral=Le;function Xe(we,Ne){return Array.isArray(we)&&
we.every(Ne)}y.typedArray=Xe})(q||(q={}))})}(Bf,Bf.exports)),Bf.exports}var gn={},wE;function vt(){if(wE)return gn;wE=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.ProtocolNotificationType=gn.ProtocolNotificationType0=gn.ProtocolRequestType=gn.ProtocolRequestType0=gn.RegistrationType=gn.MessageDirection=void 0;const t=bs();var e;(function(o){o.clientToServer="clientToServer",o.serverToClient="serverToClient",o.both="both"})(e||(gn.MessageDirection=e={}));class n{constructor(c){this.method=
c}}gn.RegistrationType=n;class r extends t.RequestType0{constructor(c){super(c)}}gn.ProtocolRequestType0=r;class i extends t.RequestType{constructor(c){super(c,t.ParameterStructures.byName)}}gn.ProtocolRequestType=i;class s extends t.NotificationType0{constructor(c){super(c)}}gn.ProtocolNotificationType0=s;class a extends t.NotificationType{constructor(c){super(c,t.ParameterStructures.byName)}}return gn.ProtocolNotificationType=a,gn}var uy={},At={},bE;function ly(){if(bE)return At;bE=1,Object.defineProperty(
At,"__esModule",{value:!0}),At.objectLiteral=At.typedArray=At.stringArray=At.array=At.func=At.error=At.number=At.string=At.boolean=void 0;function t(u){return u===!0||u===!1}At.boolean=t;function e(u){return typeof u=="string"||u instanceof String}At.string=e;function n(u){return typeof u=="number"||u instanceof Number}At.number=n;function r(u){return u instanceof Error}At.error=r;function i(u){return typeof u=="function"}At.func=i;function s(u){return Array.isArray(u)}At.array=s;function a(u){return s(
u)&&u.every(l=>e(l))}At.stringArray=a;function o(u,l){return Array.isArray(u)&&u.every(l)}At.typedArray=o;function c(u){return u!==null&&typeof u=="object"}return At.objectLiteral=c,At}var _c={},$E;function n2(){if($E)return _c;$E=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.ImplementationRequest=void 0;const t=vt();var e;return function(n){n.method="textDocument/implementation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(_c.ImplementationRequest=
e={})),_c}var Cc={},RE;function r2(){if(RE)return Cc;RE=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.TypeDefinitionRequest=void 0;const t=vt();var e;return function(n){n.method="textDocument/typeDefinition",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(Cc.TypeDefinitionRequest=e={})),Cc}var Rs={},kE;function i2(){if(kE)return Rs;kE=1,Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.DidChangeWorkspaceFoldersNotification=Rs.WorkspaceFoldersRequest=
void 0;const t=vt();var e;(function(r){r.method="workspace/workspaceFolders",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)})(e||(Rs.WorkspaceFoldersRequest=e={}));var n;return function(r){r.method="workspace/didChangeWorkspaceFolders",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolNotificationType(r.method)}(n||(Rs.DidChangeWorkspaceFoldersNotification=n={})),Rs}var Pc={},TE;function s2(){if(TE)return Pc;TE=1,Object.defineProperty(
Pc,"__esModule",{value:!0}),Pc.ConfigurationRequest=void 0;const t=vt();var e;return function(n){n.method="workspace/configuration",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(e||(Pc.ConfigurationRequest=e={})),Pc}var ks={},EE;function a2(){if(EE)return ks;EE=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.ColorPresentationRequest=ks.DocumentColorRequest=void 0;const t=vt();var e;(function(r){r.method="textDocument/documentColor",r.messageDirection=
t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(ks.DocumentColorRequest=e={}));var n;return function(r){r.method="textDocument/colorPresentation",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)}(n||(ks.ColorPresentationRequest=n={})),ks}var Ts={},SE;function o2(){if(SE)return Ts;SE=1,Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.FoldingRangeRefreshRequest=Ts.FoldingRangeRequest=void 0;const t=vt();var e;(function(r){
r.method="textDocument/foldingRange",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(Ts.FoldingRangeRequest=e={}));var n;return function(r){r.method="workspace/foldingRange/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)}(n||(Ts.FoldingRangeRefreshRequest=n={})),Ts}var xc={},AE;function c2(){if(AE)return xc;AE=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.DeclarationRequest=void 0;
const t=vt();var e;return function(n){n.method="textDocument/declaration",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(xc.DeclarationRequest=e={})),xc}var Dc={},_E;function u2(){if(_E)return Dc;_E=1,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.SelectionRangeRequest=void 0;const t=vt();var e;return function(n){n.method="textDocument/selectionRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(
n.method)}(e||(Dc.SelectionRangeRequest=e={})),Dc}var Yr={},CE;function l2(){if(CE)return Yr;CE=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.WorkDoneProgressCancelNotification=Yr.WorkDoneProgressCreateRequest=Yr.WorkDoneProgress=void 0;const t=bs(),e=vt();var n;(function(s){s.type=new t.ProgressType;function a(o){return o===s.type}s.is=a})(n||(Yr.WorkDoneProgress=n={}));var r;(function(s){s.method="window/workDoneProgress/create",s.messageDirection=e.MessageDirection.serverToClient,s.type=
new e.ProtocolRequestType(s.method)})(r||(Yr.WorkDoneProgressCreateRequest=r={}));var i;return function(s){s.method="window/workDoneProgress/cancel",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolNotificationType(s.method)}(i||(Yr.WorkDoneProgressCancelNotification=i={})),Yr}var Jr={},PE;function d2(){if(PE)return Jr;PE=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.CallHierarchyOutgoingCallsRequest=Jr.CallHierarchyIncomingCallsRequest=Jr.CallHierarchyPrepareRequest=
void 0;const t=vt();var e;(function(i){i.method="textDocument/prepareCallHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(Jr.CallHierarchyPrepareRequest=e={}));var n;(function(i){i.method="callHierarchy/incomingCalls",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Jr.CallHierarchyIncomingCallsRequest=n={}));var r;return function(i){i.method="callHierarchy/outgoingCalls",i.messageDirection=
t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Jr.CallHierarchyOutgoingCallsRequest=r={})),Jr}var yn={},xE;function f2(){if(xE)return yn;xE=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.SemanticTokensRefreshRequest=yn.SemanticTokensRangeRequest=yn.SemanticTokensDeltaRequest=yn.SemanticTokensRequest=yn.SemanticTokensRegistrationType=yn.TokenFormat=void 0;const t=vt();var e;(function(o){o.Relative="relative"})(e||(yn.TokenFormat=e={}));var n;(function(o){
o.method="textDocument/semanticTokens",o.type=new t.RegistrationType(o.method)})(n||(yn.SemanticTokensRegistrationType=n={}));var r;(function(o){o.method="textDocument/semanticTokens/full",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(r||(yn.SemanticTokensRequest=r={}));var i;(function(o){o.method="textDocument/semanticTokens/full/delta",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(
o.method),o.registrationMethod=n.method})(i||(yn.SemanticTokensDeltaRequest=i={}));var s;(function(o){o.method="textDocument/semanticTokens/range",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(s||(yn.SemanticTokensRangeRequest=s={}));var a;return function(o){o.method="workspace/semanticTokens/refresh",o.messageDirection=t.MessageDirection.serverToClient,o.type=new t.ProtocolRequestType0(o.method)}(a||(yn.SemanticTokensRefreshRequest=
a={})),yn}var Nc={},DE;function h2(){if(DE)return Nc;DE=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.ShowDocumentRequest=void 0;const t=vt();var e;return function(n){n.method="window/showDocument",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)}(e||(Nc.ShowDocumentRequest=e={})),Nc}var Ic={},NE;function p2(){if(NE)return Ic;NE=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.LinkedEditingRangeRequest=void 0;const t=vt();var e;return function(n){
n.method="textDocument/linkedEditingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(Ic.LinkedEditingRangeRequest=e={})),Ic}var Jt={},IE;function m2(){if(IE)return Jt;IE=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.WillDeleteFilesRequest=Jt.DidDeleteFilesNotification=Jt.DidRenameFilesNotification=Jt.WillRenameFilesRequest=Jt.DidCreateFilesNotification=Jt.WillCreateFilesRequest=Jt.FileOperationPatternKind=void 0;const t=vt();var e;
(function(c){c.file="file",c.folder="folder"})(e||(Jt.FileOperationPatternKind=e={}));var n;(function(c){c.method="workspace/willCreateFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolRequestType(c.method)})(n||(Jt.WillCreateFilesRequest=n={}));var r;(function(c){c.method="workspace/didCreateFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolNotificationType(c.method)})(r||(Jt.DidCreateFilesNotification=r={}));var i;(function(c){c.method=
"workspace/willRenameFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolRequestType(c.method)})(i||(Jt.WillRenameFilesRequest=i={}));var s;(function(c){c.method="workspace/didRenameFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolNotificationType(c.method)})(s||(Jt.DidRenameFilesNotification=s={}));var a;(function(c){c.method="workspace/didDeleteFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolNotificationType(
c.method)})(a||(Jt.DidDeleteFilesNotification=a={}));var o;return function(c){c.method="workspace/willDeleteFiles",c.messageDirection=t.MessageDirection.clientToServer,c.type=new t.ProtocolRequestType(c.method)}(o||(Jt.WillDeleteFilesRequest=o={})),Jt}var Qr={},OE;function g2(){if(OE)return Qr;OE=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.MonikerRequest=Qr.MonikerKind=Qr.UniquenessLevel=void 0;const t=vt();var e;(function(i){i.document="document",i.project="project",i.group="group",i.
scheme="scheme",i.global="global"})(e||(Qr.UniquenessLevel=e={}));var n;(function(i){i.$import="import",i.$export="export",i.local="local"})(n||(Qr.MonikerKind=n={}));var r;return function(i){i.method="textDocument/moniker",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Qr.MonikerRequest=r={})),Qr}var Zr={},LE;function y2(){if(LE)return Zr;LE=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.TypeHierarchySubtypesRequest=Zr.TypeHierarchySupertypesRequest=
Zr.TypeHierarchyPrepareRequest=void 0;const t=vt();var e;(function(i){i.method="textDocument/prepareTypeHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(Zr.TypeHierarchyPrepareRequest=e={}));var n;(function(i){i.method="typeHierarchy/supertypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Zr.TypeHierarchySupertypesRequest=n={}));var r;return function(i){i.method="typeHierarch\
y/subtypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)}(r||(Zr.TypeHierarchySubtypesRequest=r={})),Zr}var Es={},ME;function v2(){if(ME)return Es;ME=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.InlineValueRefreshRequest=Es.InlineValueRequest=void 0;const t=vt();var e;(function(r){r.method="textDocument/inlineValue",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(Es.InlineValueRequest=
e={}));var n;return function(r){r.method="workspace/inlineValue/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)}(n||(Es.InlineValueRefreshRequest=n={})),Es}var ei={},zE;function w2(){if(zE)return ei;zE=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.InlayHintRefreshRequest=ei.InlayHintResolveRequest=ei.InlayHintRequest=void 0;const t=vt();var e;(function(i){i.method="textDocument/inlayHint",i.messageDirection=t.MessageDirection.clientToServer,
i.type=new t.ProtocolRequestType(i.method)})(e||(ei.InlayHintRequest=e={}));var n;(function(i){i.method="inlayHint/resolve",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(ei.InlayHintResolveRequest=n={}));var r;return function(i){i.method="workspace/inlayHint/refresh",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType0(i.method)}(r||(ei.InlayHintRefreshRequest=r={})),ei}var zn={},FE;function b2(){if(FE)return zn;
FE=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.DiagnosticRefreshRequest=zn.WorkspaceDiagnosticRequest=zn.DocumentDiagnosticRequest=zn.DocumentDiagnosticReportKind=zn.DiagnosticServerCancellationData=void 0;const t=bs(),e=ly(),n=vt();var r;(function(c){function u(l){const f=l;return f&&e.boolean(f.retriggerRequest)}c.is=u})(r||(zn.DiagnosticServerCancellationData=r={}));var i;(function(c){c.Full="full",c.Unchanged="unchanged"})(i||(zn.DocumentDiagnosticReportKind=i={}));var s;(function(c){
c.method="textDocument/diagnostic",c.messageDirection=n.MessageDirection.clientToServer,c.type=new n.ProtocolRequestType(c.method),c.partialResult=new t.ProgressType})(s||(zn.DocumentDiagnosticRequest=s={}));var a;(function(c){c.method="workspace/diagnostic",c.messageDirection=n.MessageDirection.clientToServer,c.type=new n.ProtocolRequestType(c.method),c.partialResult=new t.ProgressType})(a||(zn.WorkspaceDiagnosticRequest=a={}));var o;return function(c){c.method="workspace/diagnostic/refresh",c.
messageDirection=n.MessageDirection.serverToClient,c.type=new n.ProtocolRequestType0(c.method)}(o||(zn.DiagnosticRefreshRequest=o={})),zn}var wt={},qE;function $2(){if(qE)return wt;qE=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.DidCloseNotebookDocumentNotification=wt.DidSaveNotebookDocumentNotification=wt.DidChangeNotebookDocumentNotification=wt.NotebookCellArrayChange=wt.DidOpenNotebookDocumentNotification=wt.NotebookDocumentSyncRegistrationType=wt.NotebookDocument=wt.NotebookCell=wt.
ExecutionSummary=wt.NotebookCellKind=void 0;const t=cy(),e=ly(),n=vt();var r;(function(h){h.Markup=1,h.Code=2;function m(b){return b===1||b===2}h.is=m})(r||(wt.NotebookCellKind=r={}));var i;(function(h){function m(w,k){const S={executionOrder:w};return(k===!0||k===!1)&&(S.success=k),S}h.create=m;function b(w){const k=w;return e.objectLiteral(k)&&t.uinteger.is(k.executionOrder)&&(k.success===void 0||e.boolean(k.success))}h.is=b;function $(w,k){return w===k?!0:w==null||k===null||k===void 0?!1:w.executionOrder===
k.executionOrder&&w.success===k.success}h.equals=$})(i||(wt.ExecutionSummary=i={}));var s;(function(h){function m(k,S){return{kind:k,document:S}}h.create=m;function b(k){const S=k;return e.objectLiteral(S)&&r.is(S.kind)&&t.DocumentUri.is(S.document)&&(S.metadata===void 0||e.objectLiteral(S.metadata))}h.is=b;function $(k,S){const D=new Set;return k.document!==S.document&&D.add("document"),k.kind!==S.kind&&D.add("kind"),k.executionSummary!==S.executionSummary&&D.add("executionSummary"),(k.metadata!==
void 0||S.metadata!==void 0)&&!w(k.metadata,S.metadata)&&D.add("metadata"),(k.executionSummary!==void 0||S.executionSummary!==void 0)&&!i.equals(k.executionSummary,S.executionSummary)&&D.add("executionSummary"),D}h.diff=$;function w(k,S){if(k===S)return!0;if(k==null||S===null||S===void 0||typeof k!=typeof S||typeof k!="object")return!1;const D=Array.isArray(k),F=Array.isArray(S);if(D!==F)return!1;if(D&&F){if(k.length!==S.length)return!1;for(let Y=0;Y<k.length;Y++)if(!w(k[Y],S[Y]))return!1}if(e.objectLiteral(
k)&&e.objectLiteral(S)){const Y=Object.keys(k),J=Object.keys(S);if(Y.length!==J.length||(Y.sort(),J.sort(),!w(Y,J)))return!1;for(let ie=0;ie<Y.length;ie++){const re=Y[ie];if(!w(k[re],S[re]))return!1}}return!0}})(s||(wt.NotebookCell=s={}));var a;(function(h){function m($,w,k,S){return{uri:$,notebookType:w,version:k,cells:S}}h.create=m;function b($){const w=$;return e.objectLiteral(w)&&e.string(w.uri)&&t.integer.is(w.version)&&e.typedArray(w.cells,s.is)}h.is=b})(a||(wt.NotebookDocument=a={}));var o;
(function(h){h.method="notebookDocument/sync",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.RegistrationType(h.method)})(o||(wt.NotebookDocumentSyncRegistrationType=o={}));var c;(function(h){h.method="notebookDocument/didOpen",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(c||(wt.DidOpenNotebookDocumentNotification=c={}));var u;(function(h){function m($){const w=$;return e.objectLiteral(w)&&
t.uinteger.is(w.start)&&t.uinteger.is(w.deleteCount)&&(w.cells===void 0||e.typedArray(w.cells,s.is))}h.is=m;function b($,w,k){const S={start:$,deleteCount:w};return k!==void 0&&(S.cells=k),S}h.create=b})(u||(wt.NotebookCellArrayChange=u={}));var l;(function(h){h.method="notebookDocument/didChange",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(l||(wt.DidChangeNotebookDocumentNotification=l={}));var f;(function(h){
h.method="notebookDocument/didSave",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method})(f||(wt.DidSaveNotebookDocumentNotification=f={}));var d;return function(h){h.method="notebookDocument/didClose",h.messageDirection=n.MessageDirection.clientToServer,h.type=new n.ProtocolNotificationType(h.method),h.registrationMethod=o.method}(d||(wt.DidCloseNotebookDocumentNotification=d={})),wt}var Oc={},GE;function R2(){if(GE)
return Oc;GE=1,Object.defineProperty(Oc,"__esModule",{value:!0}),Oc.InlineCompletionRequest=void 0;const t=vt();var e;return function(n){n.method="textDocument/inlineCompletion",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)}(e||(Oc.InlineCompletionRequest=e={})),Oc}var jE;function k2(){return jE||(jE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=
t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=
t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=
t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=
t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=
t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=
t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=
t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const e=vt(),n=cy(),r=ly(),i=n2();Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const s=r2();Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return s.TypeDefinitionRequest}});const a=i2();Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),
Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const o=s2();Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return o.ConfigurationRequest}});const c=a2();Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});
const u=o2();Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u.FoldingRangeRefreshRequest}});const l=c2();Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return l.DeclarationRequest}});const f=u2();Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const d=l2();
Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return d.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return d.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return d.WorkDoneProgressCancelNotification}});const h=d2();Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),
Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const m=f2();Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,
"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const b=h2();Object.defineProperty(
t,"ShowDocumentRequest",{enumerable:!0,get:function(){return b.ShowDocumentRequest}});const $=p2();Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return $.LinkedEditingRangeRequest}});const w=m2();Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return w.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return w.DidCreateFilesNotification}}),Object.defineProperty(t,"Wil\
lCreateFilesRequest",{enumerable:!0,get:function(){return w.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return w.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return w.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return w.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,
get:function(){return w.WillDeleteFilesRequest}});const k=g2();Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return k.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return k.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return k.MonikerRequest}});const S=y2();Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return S.TypeHierarchyPrepareRequest}}),Object.defineProperty(
t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySupertypesRequest}});const D=v2();Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return D.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return D.InlineValueRefreshRequest}});const F=w2();Object.defineProperty(
t,"InlayHintRequest",{enumerable:!0,get:function(){return F.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return F.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return F.InlayHintRefreshRequest}});const Y=b2();Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Y.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnost\
icReportKind",{enumerable:!0,get:function(){return Y.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Y.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Y.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Y.DiagnosticRefreshRequest}});const J=$2();Object.defineProperty(t,"NotebookCellKind",
{enumerable:!0,get:function(){return J.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return J.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return J.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return J.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return J.NotebookDocumentSyncRegistrationType}}),Object.
defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return J.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidSaveNotebookDocumentNotification}}),
Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return J.DidCloseNotebookDocumentNotification}});const ie=R2();Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return ie.InlineCompletionRequest}});var re;(function(p){function T(g){const x=g;return r.string(x)||r.string(x.language)||r.string(x.scheme)||r.string(x.pattern)}p.is=T})(re||(t.TextDocumentFilter=re={}));var ye;(function(p){function T(g){const x=g;return r.objectLiteral(
x)&&(r.string(x.notebookType)||r.string(x.scheme)||r.string(x.pattern))}p.is=T})(ye||(t.NotebookDocumentFilter=ye={}));var z;(function(p){function T(g){const x=g;return r.objectLiteral(x)&&(r.string(x.notebook)||ye.is(x.notebook))&&(x.language===void 0||r.string(x.language))}p.is=T})(z||(t.NotebookCellTextDocumentFilter=z={}));var E;(function(p){function T(g){if(!Array.isArray(g))return!1;for(let x of g)if(!r.string(x)&&!re.is(x)&&!z.is(x))return!1;return!0}p.is=T})(E||(t.DocumentSelector=E={}));
var R;(function(p){p.method="client/registerCapability",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolRequestType(p.method)})(R||(t.RegistrationRequest=R={}));var M;(function(p){p.method="client/unregisterCapability",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolRequestType(p.method)})(M||(t.UnregistrationRequest=M={}));var _;(function(p){p.Create="create",p.Rename="rename",p.Delete="delete"})(_||(t.ResourceOperationKind=_={}));var P;(function(p){
p.Abort="abort",p.Transactional="transactional",p.TextOnlyTransactional="textOnlyTransactional",p.Undo="undo"})(P||(t.FailureHandlingKind=P={}));var I;(function(p){p.UTF8="utf-8",p.UTF16="utf-16",p.UTF32="utf-32"})(I||(t.PositionEncodingKind=I={}));var Z;(function(p){function T(g){const x=g;return x&&r.string(x.id)&&x.id.length>0}p.hasId=T})(Z||(t.StaticRegistrationOptions=Z={}));var H;(function(p){function T(g){const x=g;return x&&(x.documentSelector===null||E.is(x.documentSelector))}p.is=T})(H||
(t.TextDocumentRegistrationOptions=H={}));var A;(function(p){function T(x){const v=x;return r.objectLiteral(v)&&(v.workDoneProgress===void 0||r.boolean(v.workDoneProgress))}p.is=T;function g(x){const v=x;return v&&r.boolean(v.workDoneProgress)}p.hasWorkDoneProgress=g})(A||(t.WorkDoneProgressOptions=A={}));var te;(function(p){p.method="initialize",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(te||(t.InitializeRequest=te={}));var me;(function(p){
p.unknownProtocolVersion=1})(me||(t.InitializeErrorCodes=me={}));var Ce;(function(p){p.method="initialized",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(Ce||(t.InitializedNotification=Ce={}));var L;(function(p){p.method="shutdown",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType0(p.method)})(L||(t.ShutdownRequest=L={}));var K;(function(p){p.method="exit",p.messageDirection=e.MessageDirection.clientToServer,
p.type=new e.ProtocolNotificationType0(p.method)})(K||(t.ExitNotification=K={}));var _e;(function(p){p.method="workspace/didChangeConfiguration",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(_e||(t.DidChangeConfigurationNotification=_e={}));var ue;(function(p){p.Error=1,p.Warning=2,p.Info=3,p.Log=4,p.Debug=5})(ue||(t.MessageType=ue={}));var $e;(function(p){p.method="window/showMessage",p.messageDirection=e.MessageDirection.serverToClient,p.
type=new e.ProtocolNotificationType(p.method)})($e||(t.ShowMessageNotification=$e={}));var Pe;(function(p){p.method="window/showMessageRequest",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolRequestType(p.method)})(Pe||(t.ShowMessageRequest=Pe={}));var le;(function(p){p.method="window/logMessage",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolNotificationType(p.method)})(le||(t.LogMessageNotification=le={}));var N;(function(p){p.method="telem\
etry/event",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolNotificationType(p.method)})(N||(t.TelemetryEventNotification=N={}));var j;(function(p){p.None=0,p.Full=1,p.Incremental=2})(j||(t.TextDocumentSyncKind=j={}));var fe;(function(p){p.method="textDocument/didOpen",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(fe||(t.DidOpenTextDocumentNotification=fe={}));var B;(function(p){function T(x){let v=x;return v!=null&&
typeof v.text=="string"&&v.range!==void 0&&(v.rangeLength===void 0||typeof v.rangeLength=="number")}p.isIncremental=T;function g(x){let v=x;return v!=null&&typeof v.text=="string"&&v.range===void 0&&v.rangeLength===void 0}p.isFull=g})(B||(t.TextDocumentContentChangeEvent=B={}));var de;(function(p){p.method="textDocument/didChange",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(de||(t.DidChangeTextDocumentNotification=de={}));var Be;(function(p){
p.method="textDocument/didClose",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(Be||(t.DidCloseTextDocumentNotification=Be={}));var Qe;(function(p){p.method="textDocument/didSave",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(Qe||(t.DidSaveTextDocumentNotification=Qe={}));var oe;(function(p){p.Manual=1,p.AfterDelay=2,p.FocusOut=3})(oe||(t.TextDocumentSaveReason=oe={}));var De;(function(p){
p.method="textDocument/willSave",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolNotificationType(p.method)})(De||(t.WillSaveTextDocumentNotification=De={}));var ne;(function(p){p.method="textDocument/willSaveWaitUntil",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(ne||(t.WillSaveTextDocumentWaitUntilRequest=ne={}));var Re;(function(p){p.method="workspace/didChangeWatchedFiles",p.messageDirection=e.MessageDirection.clientToServer,
p.type=new e.ProtocolNotificationType(p.method)})(Re||(t.DidChangeWatchedFilesNotification=Re={}));var Fe;(function(p){p.Created=1,p.Changed=2,p.Deleted=3})(Fe||(t.FileChangeType=Fe={}));var ft;(function(p){function T(g){const x=g;return r.objectLiteral(x)&&(n.URI.is(x.baseUri)||n.WorkspaceFolder.is(x.baseUri))&&r.string(x.pattern)}p.is=T})(ft||(t.RelativePattern=ft={}));var Ve;(function(p){p.Create=1,p.Change=2,p.Delete=4})(Ve||(t.WatchKind=Ve={}));var zt;(function(p){p.method="textDocument/pub\
lishDiagnostics",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolNotificationType(p.method)})(zt||(t.PublishDiagnosticsNotification=zt={}));var Bt;(function(p){p.Invoked=1,p.TriggerCharacter=2,p.TriggerForIncompleteCompletions=3})(Bt||(t.CompletionTriggerKind=Bt={}));var on;(function(p){p.method="textDocument/completion",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(on||(t.CompletionRequest=on={}));var V;(function(p){p.
method="completionItem/resolve",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(V||(t.CompletionResolveRequest=V={}));var X;(function(p){p.method="textDocument/hover",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(X||(t.HoverRequest=X={}));var he;(function(p){p.Invoked=1,p.TriggerCharacter=2,p.ContentChange=3})(he||(t.SignatureHelpTriggerKind=he={}));var Ut;(function(p){p.method="textDocument/sig\
natureHelp",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Ut||(t.SignatureHelpRequest=Ut={}));var Ft;(function(p){p.method="textDocument/definition",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Ft||(t.DefinitionRequest=Ft={}));var mr;(function(p){p.method="textDocument/references",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(mr||(t.ReferencesRequest=
mr={}));var di;(function(p){p.method="textDocument/documentHighlight",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(di||(t.DocumentHighlightRequest=di={}));var ji;(function(p){p.method="textDocument/documentSymbol",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(ji||(t.DocumentSymbolRequest=ji={}));var Bi;(function(p){p.method="textDocument/codeAction",p.messageDirection=e.MessageDirection.clientToServer,
p.type=new e.ProtocolRequestType(p.method)})(Bi||(t.CodeActionRequest=Bi={}));var Ui;(function(p){p.method="codeAction/resolve",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Ui||(t.CodeActionResolveRequest=Ui={}));var Wi;(function(p){p.method="workspace/symbol",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Wi||(t.WorkspaceSymbolRequest=Wi={}));var fi;(function(p){p.method="workspaceSymbol/reso\
lve",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(fi||(t.WorkspaceSymbolResolveRequest=fi={}));var hi;(function(p){p.method="textDocument/codeLens",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(hi||(t.CodeLensRequest=hi={}));var $n;(function(p){p.method="codeLens/resolve",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})($n||(t.CodeLensResolveRequest=
$n={}));var Hi;(function(p){p.method="workspace/codeLens/refresh",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolRequestType0(p.method)})(Hi||(t.CodeLensRefreshRequest=Hi={}));var Ki;(function(p){p.method="textDocument/documentLink",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Ki||(t.DocumentLinkRequest=Ki={}));var gr;(function(p){p.method="documentLink/resolve",p.messageDirection=e.MessageDirection.clientToServer,p.
type=new e.ProtocolRequestType(p.method)})(gr||(t.DocumentLinkResolveRequest=gr={}));var Vi;(function(p){p.method="textDocument/formatting",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Vi||(t.DocumentFormattingRequest=Vi={}));var xr;(function(p){p.method="textDocument/rangeFormatting",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(xr||(t.DocumentRangeFormattingRequest=xr={}));var Xi;(function(p){
p.method="textDocument/rangesFormatting",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Xi||(t.DocumentRangesFormattingRequest=Xi={}));var jn;(function(p){p.method="textDocument/onTypeFormatting",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(jn||(t.DocumentOnTypeFormattingRequest=jn={}));var er;(function(p){p.Identifier=1})(er||(t.PrepareSupportDefaultBehavior=er={}));var Qs;(function(p){p.method=
"textDocument/rename",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(Qs||(t.RenameRequest=Qs={}));var q;(function(p){p.method="textDocument/prepareRename",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(q||(t.PrepareRenameRequest=q={}));var y;(function(p){p.method="workspace/executeCommand",p.messageDirection=e.MessageDirection.clientToServer,p.type=new e.ProtocolRequestType(p.method)})(y||(t.ExecuteCommandRequest=
y={}));var C;(function(p){p.method="workspace/applyEdit",p.messageDirection=e.MessageDirection.serverToClient,p.type=new e.ProtocolRequestType("workspace/applyEdit")})(C||(t.ApplyWorkspaceEditRequest=C={}))}(uy)),uy}var Lc={},BE;function T2(){if(BE)return Lc;BE=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.createProtocolConnection=void 0;const t=bs();function e(n,r,i,s){return t.ConnectionStrategy.is(s)&&(s={connectionStrategy:s}),(0,t.createMessageConnection)(n,r,i,s)}return Lc.createProtocolConnection=
e,Lc}var UE;function E2(){return UE||(UE=1,function(t){var e=$s&&$s.__createBinding||(Object.create?function(s,a,o,c){c===void 0&&(c=o);var u=Object.getOwnPropertyDescriptor(a,o);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,c,u)}:function(s,a,o,c){c===void 0&&(c=o),s[c]=a[o]}),n=$s&&$s.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(
t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,n(bs(),t),n(cy(),t),n(vt(),t),n(k2(),t);var r=T2();Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}});var i;(function(s){s.lspReservedErrorRangeStart=-32899,s.RequestFailed=-32803,s.ServerCancelled=-32802,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800})(i||(t.LSPErrorCodes=i={}))}($s)),$s}var WE;function _t(){return WE||
(WE=1,function(t){var e=ys&&ys.__createBinding||(Object.create?function(s,a,o,c){c===void 0&&(c=o);var u=Object.getOwnPropertyDescriptor(a,o);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,c,u)}:function(s,a,o,c){c===void 0&&(c=o),s[c]=a[o]}),n=ys&&ys.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.
createProtocolConnection=void 0;const r=yE();n(yE(),t),n(E2(),t);function i(s,a,o,c){return(0,r.createMessageConnection)(s,a,o,c)}t.createProtocolConnection=i}(ys)),ys}var Fn={},HE;function KE(){if(HE)return Fn;HE=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.generateUuid=Fn.parse=Fn.isUUID=Fn.v4=Fn.empty=void 0;class t{constructor(c){this._value=c}asHex(){return this._value}equals(c){return this.asHex()===c.asHex()}}class e extends t{static _oneOf(c){return c[Math.floor(c.length*Math.random())]}static _randomHex(){
return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e.
_randomHex(),e._randomHex(),e._randomHex()].join(""))}}e._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],e._timeHighBits=["8","9","a","b"],Fn.empty=new t("00000000-0000-0000-0000-000000000000");function n(){return new e}Fn.v4=n;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function i(o){return r.test(o)}Fn.isUUID=i;function s(o){if(!i(o))throw new Error("invalid uuid");return new t(o)}Fn.parse=s;function a(){return n().asHex()}return Fn.generateUuid=
a,Fn}var ti={},VE;function S2(){if(VE)return ti;VE=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.attachPartialResult=ti.ProgressFeature=ti.attachWorkDone=void 0;const t=_t(),e=KE();class n{constructor(d,h){this._connection=d,this._token=h,n.Instances.set(this._token,this)}begin(d,h,m,b){let $={kind:"begin",title:d,percentage:h,message:m,cancellable:b};this._connection.sendProgress(t.WorkDoneProgress.type,this._token,$)}report(d,h){let m={kind:"report"};typeof d=="number"?(m.percentage=d,
h!==void 0&&(m.message=h)):m.message=d,this._connection.sendProgress(t.WorkDoneProgress.type,this._token,m)}done(){n.Instances.delete(this._token),this._connection.sendProgress(t.WorkDoneProgress.type,this._token,{kind:"end"})}}n.Instances=new Map;class r extends n{constructor(d,h){super(d,h),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class i{constructor(){}begin(){}report(){}done(){}}
class s extends i{constructor(){super(),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}function a(f,d){if(d===void 0||d.workDoneToken===void 0)return new i;const h=d.workDoneToken;return delete d.workDoneToken,new n(f,h)}ti.attachWorkDone=a;const o=f=>class extends f{constructor(){super(),this._progressSupported=!1}initialize(d){super.initialize(d),d?.window?.workDoneProgress===!0&&(this._progressSupported=
!0,this.connection.onNotification(t.WorkDoneProgressCancelNotification.type,h=>{let m=n.Instances.get(h.token);(m instanceof r||m instanceof s)&&m.cancel()}))}attachWorkDoneProgress(d){return d===void 0?new i:new n(this.connection,d)}createWorkDoneProgress(){if(this._progressSupported){const d=(0,e.generateUuid)();return this.connection.sendRequest(t.WorkDoneProgressCreateRequest.type,{token:d}).then(()=>new r(this.connection,d))}else return Promise.resolve(new s)}};ti.ProgressFeature=o;var c;(function(f){
f.type=new t.ProgressType})(c||(c={}));class u{constructor(d,h){this._connection=d,this._token=h}report(d){this._connection.sendProgress(c.type,this._token,d)}}function l(f,d){if(d===void 0||d.partialResultToken===void 0)return;const h=d.partialResultToken;return delete d.partialResultToken,new u(f,h)}return ti.attachPartialResult=l,ti}var Mc={},XE;function A2(){if(XE)return Mc;XE=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.ConfigurationFeature=void 0;const t=_t(),e=ry(),n=r=>class extends r{getConfiguration(i){
return i?e.string(i)?this._getConfiguration({section:i}):this._getConfiguration(i):this._getConfiguration({})}_getConfiguration(i){let s={items:Array.isArray(i)?i:[i]};return this.connection.sendRequest(t.ConfigurationRequest.type,s).then(a=>Array.isArray(a)?Array.isArray(i)?a:a[0]:Array.isArray(i)?[]:null)}};return Mc.ConfigurationFeature=n,Mc}var zc={},YE;function _2(){if(YE)return zc;YE=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.WorkspaceFoldersFeature=void 0;const t=_t(),e=n=>class extends n{constructor(){
super(),this._notificationIsAutoRegistered=!1}initialize(r){super.initialize(r);let i=r.workspace;i&&i.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new t.Emitter,this.connection.onNotification(t.DidChangeWorkspaceFoldersNotification.type,s=>{this._onDidChangeWorkspaceFolders.fire(s.event)}))}fillServerCapabilities(r){super.fillServerCapabilities(r);const i=r.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=i===!0||typeof i=="string"}getWorkspaceFolders(){
return this.connection.sendRequest(t.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(t.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};return zc.WorkspaceFoldersFeature=e,zc}var Fc={},JE;function C2(){if(JE)
return Fc;JE=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.CallHierarchyFeature=void 0;const t=_t(),e=n=>class extends n{get callHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.CallHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onIncomingCalls:r=>{const i=t.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onOutgoingCalls:r=>{const i=t.
CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Fc.CallHierarchyFeature=e,Fc}var ni={},QE;function ZE(){if(QE)return ni;QE=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SemanticTokensBuilder=ni.SemanticTokensDiff=ni.SemanticTokensFeature=void 0;const t=_t(),e=i=>class extends i{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(t.SemanticTokensRefreshRequest.
type),on:s=>{const a=t.SemanticTokensRequest.type;return this.connection.onRequest(a,(o,c)=>s(o,c,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onDelta:s=>{const a=t.SemanticTokensDeltaRequest.type;return this.connection.onRequest(a,(o,c)=>s(o,c,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onRange:s=>{const a=t.SemanticTokensRangeRequest.type;return this.connection.onRequest(a,(o,c)=>s(o,c,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(
a,o)))}}}};ni.SemanticTokensFeature=e;class n{constructor(s,a){this.originalSequence=s,this.modifiedSequence=a}computeDiff(){const s=this.originalSequence.length,a=this.modifiedSequence.length;let o=0;for(;o<a&&o<s&&this.originalSequence[o]===this.modifiedSequence[o];)o++;if(o<a&&o<s){let c=s-1,u=a-1;for(;c>=o&&u>=o&&this.originalSequence[c]===this.modifiedSequence[u];)c--,u--;(c<o||u<o)&&(c++,u++);const l=c-o+1,f=this.modifiedSequence.slice(o,u+1);return f.length===1&&f[0]===this.originalSequence[c]?
[{start:o,deleteCount:l-1}]:[{start:o,deleteCount:l,data:f}]}else return o<a?[{start:o,deleteCount:0,data:this.modifiedSequence.slice(o)}]:o<s?[{start:o,deleteCount:s-o}]:[]}}ni.SemanticTokensDiff=n;class r{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(s,a,o,c,u){let l=s,f=a;this._dataLen>0&&(l-=this._prevLine,l===0&&(f-=this._prevChar)),this._data[this._dataLen++]=l,this._data[this._dataLen++]=
f,this._data[this._dataLen++]=o,this._data[this._dataLen++]=c,this._data[this._dataLen++]=u,this._prevLine=s,this._prevChar=a}get id(){return this._id.toString()}previousResult(s){this.id===s&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new n(this._prevData,this._data).computeDiff()}:this.build()}}return ni.SemanticTokensBuilder=
r,ni}var qc={},eS;function P2(){if(eS)return qc;eS=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.ShowDocumentFeature=void 0;const t=_t(),e=n=>class extends n{showDocument(r){return this.connection.sendRequest(t.ShowDocumentRequest.type,r)}};return qc.ShowDocumentFeature=e,qc}var Gc={},tS;function x2(){if(tS)return Gc;tS=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.FileOperationsFeature=void 0;const t=_t(),e=n=>class extends n{onDidCreateFiles(r){return this.connection.onNotification(
t.DidCreateFilesNotification.type,i=>{r(i)})}onDidRenameFiles(r){return this.connection.onNotification(t.DidRenameFilesNotification.type,i=>{r(i)})}onDidDeleteFiles(r){return this.connection.onNotification(t.DidDeleteFilesNotification.type,i=>{r(i)})}onWillCreateFiles(r){return this.connection.onRequest(t.WillCreateFilesRequest.type,(i,s)=>r(i,s))}onWillRenameFiles(r){return this.connection.onRequest(t.WillRenameFilesRequest.type,(i,s)=>r(i,s))}onWillDeleteFiles(r){return this.connection.onRequest(
t.WillDeleteFilesRequest.type,(i,s)=>r(i,s))}};return Gc.FileOperationsFeature=e,Gc}var jc={},nS;function D2(){if(nS)return jc;nS=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.LinkedEditingRangeFeature=void 0;const t=_t(),e=n=>class extends n{onLinkedEditingRange(r){return this.connection.onRequest(t.LinkedEditingRangeRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0))}};return jc.LinkedEditingRangeFeature=e,jc}var Bc={},rS;function N2(){if(rS)return Bc;rS=1,Object.defineProperty(
Bc,"__esModule",{value:!0}),Bc.TypeHierarchyFeature=void 0;const t=_t(),e=n=>class extends n{get typeHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.TypeHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onSupertypes:r=>{const i=t.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onSubtypes:r=>{const i=t.TypeHierarchySubtypesRequest.type;return this.
connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Bc.TypeHierarchyFeature=e,Bc}var Uc={},iS;function I2(){if(iS)return Uc;iS=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.InlineValueFeature=void 0;const t=_t(),e=n=>class extends n{get inlineValue(){return{refresh:()=>this.connection.sendRequest(t.InlineValueRefreshRequest.type),on:r=>this.connection.onRequest(t.InlineValueRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(
i)))}}};return Uc.InlineValueFeature=e,Uc}var Wc={},sS;function O2(){if(sS)return Wc;sS=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.FoldingRangeFeature=void 0;const t=_t(),e=n=>class extends n{get foldingRange(){return{refresh:()=>this.connection.sendRequest(t.FoldingRangeRefreshRequest.type),on:r=>{const i=t.FoldingRangeRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Wc.FoldingRangeFeature=
e,Wc}var Hc={},aS;function L2(){if(aS)return Hc;aS=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.InlayHintFeature=void 0;const t=_t(),e=n=>class extends n{get inlayHint(){return{refresh:()=>this.connection.sendRequest(t.InlayHintRefreshRequest.type),on:r=>this.connection.onRequest(t.InlayHintRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i))),resolve:r=>this.connection.onRequest(t.InlayHintResolveRequest.type,(i,s)=>r(i,s))}}};return Hc.InlayHintFeature=e,Hc}var Kc={},oS;function M2(){
if(oS)return Kc;oS=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.DiagnosticFeature=void 0;const t=_t(),e=n=>class extends n{get diagnostics(){return{refresh:()=>this.connection.sendRequest(t.DiagnosticRefreshRequest.type),on:r=>this.connection.onRequest(t.DocumentDiagnosticRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.DocumentDiagnosticRequest.partialResult,i))),onWorkspace:r=>this.connection.onRequest(t.WorkspaceDiagnosticRequest.type,(i,s)=>r(
i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.WorkspaceDiagnosticRequest.partialResult,i)))}}};return Kc.DiagnosticFeature=e,Kc}var Ss={},Vc={},cS;function uS(){if(cS)return Vc;cS=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.TextDocuments=void 0;const t=_t();class e{constructor(r){this._configuration=r,this._syncedDocuments=new Map,this._onDidChangeContent=new t.Emitter,this._onDidOpen=new t.Emitter,this._onDidClose=new t.Emitter,this._onDidSave=new t.Emitter,this.
_onWillSave=new t.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(r){this._willSaveWaitUntil=r}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(r){return this._syncedDocuments.get(r)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(r){r.__textDocumentSync=
t.TextDocumentSyncKind.Incremental;const i=[];return i.push(r.onDidOpenTextDocument(s=>{const a=s.textDocument,o=this._configuration.create(a.uri,a.languageId,a.version,a.text);this._syncedDocuments.set(a.uri,o);const c=Object.freeze({document:o});this._onDidOpen.fire(c),this._onDidChangeContent.fire(c)})),i.push(r.onDidChangeTextDocument(s=>{const a=s.textDocument,o=s.contentChanges;if(o.length===0)return;const{version:c}=a;if(c==null)throw new Error(`Received document change event for ${a.uri}\
 without valid version identifier`);let u=this._syncedDocuments.get(a.uri);u!==void 0&&(u=this._configuration.update(u,o,c),this._syncedDocuments.set(a.uri,u),this._onDidChangeContent.fire(Object.freeze({document:u})))})),i.push(r.onDidCloseTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&(this._syncedDocuments.delete(s.textDocument.uri),this._onDidClose.fire(Object.freeze({document:a})))})),i.push(r.onWillSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.
uri);a!==void 0&&this._onWillSave.fire(Object.freeze({document:a,reason:s.reason}))})),i.push(r.onWillSaveTextDocumentWaitUntil((s,a)=>{let o=this._syncedDocuments.get(s.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:s.reason}),a):[]})),i.push(r.onDidSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&this._onDidSave.fire(Object.freeze({document:a}))})),t.Disposable.create(()=>{i.forEach(s=>s.
dispose())})}}return Vc.TextDocuments=e,Vc}var lS;function dS(){if(lS)return Ss;lS=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.NotebookDocuments=Ss.NotebookSyncFeature=void 0;const t=_t(),e=uS(),n=s=>class extends s{get synchronization(){return{onDidOpenNotebookDocument:a=>this.connection.onNotification(t.DidOpenNotebookDocumentNotification.type,o=>{a(o)}),onDidChangeNotebookDocument:a=>this.connection.onNotification(t.DidChangeNotebookDocumentNotification.type,o=>{a(o)}),onDidSaveNotebookDocument:a=>this.
connection.onNotification(t.DidSaveNotebookDocumentNotification.type,o=>{a(o)}),onDidCloseNotebookDocument:a=>this.connection.onNotification(t.DidCloseNotebookDocumentNotification.type,o=>{a(o)})}}};Ss.NotebookSyncFeature=n;class r{onDidOpenTextDocument(a){return this.openHandler=a,t.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(a){this.openHandler&&this.openHandler(a)}onDidChangeTextDocument(a){return this.changeHandler=a,t.Disposable.create(()=>{this.changeHandler=a})}changeTextDocument(a){
this.changeHandler&&this.changeHandler(a)}onDidCloseTextDocument(a){return this.closeHandler=a,t.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(a){this.closeHandler&&this.closeHandler(a)}onWillSaveTextDocument(){return r.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return r.NULL_DISPOSE}onDidSaveTextDocument(){return r.NULL_DISPOSE}}r.NULL_DISPOSE=Object.freeze({dispose:()=>{}});class i{constructor(a){a instanceof e.TextDocuments?this._cellTextDocuments=a:this._cellTextDocuments=
new e.TextDocuments(a),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new t.Emitter,this._onDidChange=new t.Emitter,this._onDidSave=new t.Emitter,this._onDidClose=new t.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(a){return this._cellTextDocuments.get(a.document)}getNotebookDocument(a){return this.notebookDocuments.get(a)}getNotebookCell(a){const o=this.notebookCellMap.get(a);return o&&o[0]}findNotebookDocumentForCell(a){const o=typeof a==
"string"?a:a.document,c=this.notebookCellMap.get(o);return c&&c[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(a){const o=new r,c=[];return c.push(this.cellTextDocuments.listen(o)),c.push(a.notebooks.synchronization.onDidOpenNotebookDocument(u=>{this.notebookDocuments.set(u.notebookDocument.uri,u.notebookDocument);for(const l of u.cellTextDocuments)
o.openTextDocument({textDocument:l});this.updateCellMap(u.notebookDocument),this._onDidOpen.fire(u.notebookDocument)})),c.push(a.notebooks.synchronization.onDidChangeNotebookDocument(u=>{const l=this.notebookDocuments.get(u.notebookDocument.uri);if(l===void 0)return;l.version=u.notebookDocument.version;const f=l.metadata;let d=!1;const h=u.change;h.metadata!==void 0&&(d=!0,l.metadata=h.metadata);const m=[],b=[],$=[],w=[];if(h.cells!==void 0){const Y=h.cells;if(Y.structure!==void 0){const J=Y.structure.
array;if(l.cells.splice(J.start,J.deleteCount,...J.cells!==void 0?J.cells:[]),Y.structure.didOpen!==void 0)for(const ie of Y.structure.didOpen)o.openTextDocument({textDocument:ie}),m.push(ie.uri);if(Y.structure.didClose)for(const ie of Y.structure.didClose)o.closeTextDocument({textDocument:ie}),b.push(ie.uri)}if(Y.data!==void 0){const J=new Map(Y.data.map(ie=>[ie.document,ie]));for(let ie=0;ie<=l.cells.length;ie++){const re=J.get(l.cells[ie].document);if(re!==void 0){const ye=l.cells.splice(ie,1,
re);if($.push({old:ye[0],new:re}),J.delete(re.document),J.size===0)break}}}if(Y.textContent!==void 0)for(const J of Y.textContent)o.changeTextDocument({textDocument:J.document,contentChanges:J.changes}),w.push(J.document.uri)}this.updateCellMap(l);const k={notebookDocument:l};d&&(k.metadata={old:f,new:l.metadata});const S=[];for(const Y of m)S.push(this.getNotebookCell(Y));const D=[];for(const Y of b)D.push(this.getNotebookCell(Y));const F=[];for(const Y of w)F.push(this.getNotebookCell(Y));(S.length>
0||D.length>0||$.length>0||F.length>0)&&(k.cells={added:S,removed:D,changed:{data:$,textContent:F}}),(k.metadata!==void 0||k.cells!==void 0)&&this._onDidChange.fire(k)})),c.push(a.notebooks.synchronization.onDidSaveNotebookDocument(u=>{const l=this.notebookDocuments.get(u.notebookDocument.uri);l!==void 0&&this._onDidSave.fire(l)})),c.push(a.notebooks.synchronization.onDidCloseNotebookDocument(u=>{const l=this.notebookDocuments.get(u.notebookDocument.uri);if(l!==void 0){this._onDidClose.fire(l);for(const f of u.
cellTextDocuments)o.closeTextDocument({textDocument:f});this.notebookDocuments.delete(u.notebookDocument.uri);for(const f of l.cells)this.notebookCellMap.delete(f.document)}})),t.Disposable.create(()=>{c.forEach(u=>u.dispose())})}updateCellMap(a){for(const o of a.cells)this.notebookCellMap.set(o.document,[o,a])}}return Ss.NotebookDocuments=i,Ss}var Xc={},fS;function z2(){if(fS)return Xc;fS=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.MonikerFeature=void 0;const t=_t(),e=n=>class extends n{get moniker(){
return{on:r=>{const i=t.MonikerRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Xc.MonikerFeature=e,Xc}var hS;function pS(){if(hS)return Ke;hS=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.createConnection=Ke.combineFeatures=Ke.combineNotebooksFeatures=Ke.combineLanguagesFeatures=Ke.combineWorkspaceFeatures=Ke.combineWindowFeatures=Ke.combineClientFeatures=Ke.combineTracerFeatures=Ke.combineTelemetryFeatures=
Ke.combineConsoleFeatures=Ke._NotebooksImpl=Ke._LanguagesImpl=Ke.BulkUnregistration=Ke.BulkRegistration=Ke.ErrorMessageTracker=void 0;const t=_t(),e=ry(),n=KE(),r=S2(),i=A2(),s=_2(),a=C2(),o=ZE(),c=P2(),u=x2(),l=D2(),f=N2(),d=I2(),h=O2(),m=L2(),b=M2(),$=dS(),w=z2();function k(le){if(le!==null)return le}class S{constructor(){this._messages=Object.create(null)}add(N){let j=this._messages[N];j||(j=0),j++,this._messages[N]=j}sendErrors(N){Object.keys(this._messages).forEach(j=>{N.window.showErrorMessage(
j)})}}Ke.ErrorMessageTracker=S;class D{constructor(){}rawAttach(N){this._rawConnection=N}attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(N){}initialize(N){}error(N){this.send(t.MessageType.Error,N)}warn(N){this.send(t.MessageType.Warning,N)}info(N){this.send(t.MessageType.Info,N)}log(N){this.send(t.MessageType.Log,N)}debug(N){this.send(t.MessageType.Debug,N)}send(N,j){
this._rawConnection&&this._rawConnection.sendNotification(t.LogMessageNotification.type,{type:N,message:j}).catch(()=>{(0,t.RAL)().console.error("Sending log message failed")})}}class F{constructor(){}attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}showErrorMessage(N,...j){let fe={type:t.MessageType.Error,message:N,actions:j};return this.connection.sendRequest(
t.ShowMessageRequest.type,fe).then(k)}showWarningMessage(N,...j){let fe={type:t.MessageType.Warning,message:N,actions:j};return this.connection.sendRequest(t.ShowMessageRequest.type,fe).then(k)}showInformationMessage(N,...j){let fe={type:t.MessageType.Info,message:N,actions:j};return this.connection.sendRequest(t.ShowMessageRequest.type,fe).then(k)}}const Y=(0,c.ShowDocumentFeature)((0,r.ProgressFeature)(F));var J;(function(le){function N(){return new ie}le.create=N})(J||(Ke.BulkRegistration=J={}));
class ie{constructor(){this._registrations=[],this._registered=new Set}add(N,j){const fe=e.string(N)?N:N.method;if(this._registered.has(fe))throw new Error(`${fe} is already added to this registration`);const B=n.generateUuid();this._registrations.push({id:B,method:fe,registerOptions:j||{}}),this._registered.add(fe)}asRegistrationParams(){return{registrations:this._registrations}}}var re;(function(le){function N(){return new ye(void 0,[])}le.create=N})(re||(Ke.BulkUnregistration=re={}));class ye{constructor(N,j){
this._connection=N,this._unregistrations=new Map,j.forEach(fe=>{this._unregistrations.set(fe.method,fe)})}get isAttached(){return!!this._connection}attach(N){this._connection=N}add(N){this._unregistrations.set(N.method,N)}dispose(){let N=[];for(let fe of this._unregistrations.values())N.push(fe);let j={unregisterations:N};this._connection.sendRequest(t.UnregistrationRequest.type,j).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(N){const j=e.string(N)?N:N.
method,fe=this._unregistrations.get(j);if(!fe)return!1;let B={unregisterations:[fe]};return this._connection.sendRequest(t.UnregistrationRequest.type,B).then(()=>{this._unregistrations.delete(j)},de=>{this._connection.console.info(`Un-registering request handler for ${fe.id} failed.`)}),!0}}class z{attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}register(N,j,fe){
return N instanceof ie?this.registerMany(N):N instanceof ye?this.registerSingle1(N,j,fe):this.registerSingle2(N,j)}registerSingle1(N,j,fe){const B=e.string(j)?j:j.method,de=n.generateUuid();let Be={registrations:[{id:de,method:B,registerOptions:fe||{}}]};return N.isAttached||N.attach(this.connection),this.connection.sendRequest(t.RegistrationRequest.type,Be).then(Qe=>(N.add({id:de,method:B}),N),Qe=>(this.connection.console.info(`Registering request handler for ${B} failed.`),Promise.reject(Qe)))}registerSingle2(N,j){
const fe=e.string(N)?N:N.method,B=n.generateUuid();let de={registrations:[{id:B,method:fe,registerOptions:j||{}}]};return this.connection.sendRequest(t.RegistrationRequest.type,de).then(Be=>t.Disposable.create(()=>{this.unregisterSingle(B,fe).catch(()=>{this.connection.console.info(`Un-registering capability with id ${B} failed.`)})}),Be=>(this.connection.console.info(`Registering request handler for ${fe} failed.`),Promise.reject(Be)))}unregisterSingle(N,j){let fe={unregisterations:[{id:N,method:j}]};
return this.connection.sendRequest(t.UnregistrationRequest.type,fe).catch(()=>{this.connection.console.info(`Un-registering request handler for ${N} failed.`)})}registerMany(N){let j=N.asRegistrationParams();return this.connection.sendRequest(t.RegistrationRequest.type,j).then(()=>new ye(this._connection,j.registrations.map(fe=>({id:fe.id,method:fe.method}))),fe=>(this.connection.console.info("Bulk registration failed."),Promise.reject(fe)))}}class E{constructor(){}attach(N){this._connection=N}get connection(){
if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}applyEdit(N){function j(B){return B&&!!B.edit}let fe=j(N)?N:{edit:N};return this.connection.sendRequest(t.ApplyWorkspaceEditRequest.type,fe)}}const R=(0,u.FileOperationsFeature)((0,s.WorkspaceFoldersFeature)((0,i.ConfigurationFeature)(E)));class M{constructor(){this._trace=t.Trace.Off}attach(N){this._connection=N}get connection(){if(!this._connection)
throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}set trace(N){this._trace=N}log(N,j){this._trace!==t.Trace.Off&&this.connection.sendNotification(t.LogTraceNotification.type,{message:N,verbose:this._trace===t.Trace.Verbose?j:void 0}).catch(()=>{})}}class _{constructor(){}attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}logEvent(N){
this.connection.sendNotification(t.TelemetryEventNotification.type,N).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}}class P{constructor(){}attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}attachWorkDoneProgress(N){return(0,r.attachWorkDone)(this.connection,N)}attachPartialResultProgress(N,j){return(0,r.attachPartialResult)(
this.connection,j)}}Ke._LanguagesImpl=P;const I=(0,h.FoldingRangeFeature)((0,w.MonikerFeature)((0,b.DiagnosticFeature)((0,m.InlayHintFeature)((0,d.InlineValueFeature)((0,f.TypeHierarchyFeature)((0,l.LinkedEditingRangeFeature)((0,o.SemanticTokensFeature)((0,a.CallHierarchyFeature)(P)))))))));class Z{constructor(){}attach(N){this._connection=N}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(N){}fillServerCapabilities(N){}attachWorkDoneProgress(N){
return(0,r.attachWorkDone)(this.connection,N)}attachPartialResultProgress(N,j){return(0,r.attachPartialResult)(this.connection,j)}}Ke._NotebooksImpl=Z;const H=(0,$.NotebookSyncFeature)(Z);function A(le,N){return function(j){return N(le(j))}}Ke.combineConsoleFeatures=A;function te(le,N){return function(j){return N(le(j))}}Ke.combineTelemetryFeatures=te;function me(le,N){return function(j){return N(le(j))}}Ke.combineTracerFeatures=me;function Ce(le,N){return function(j){return N(le(j))}}Ke.combineClientFeatures=
Ce;function L(le,N){return function(j){return N(le(j))}}Ke.combineWindowFeatures=L;function K(le,N){return function(j){return N(le(j))}}Ke.combineWorkspaceFeatures=K;function _e(le,N){return function(j){return N(le(j))}}Ke.combineLanguagesFeatures=_e;function ue(le,N){return function(j){return N(le(j))}}Ke.combineNotebooksFeatures=ue;function $e(le,N){function j(B,de,Be){return B&&de?Be(B,de):B||de}return{__brand:"features",console:j(le.console,N.console,A),tracer:j(le.tracer,N.tracer,me),telemetry:j(
le.telemetry,N.telemetry,te),client:j(le.client,N.client,Ce),window:j(le.window,N.window,L),workspace:j(le.workspace,N.workspace,K),languages:j(le.languages,N.languages,_e),notebooks:j(le.notebooks,N.notebooks,ue)}}Ke.combineFeatures=$e;function Pe(le,N,j){const fe=j&&j.console?new(j.console(D)):new D,B=le(fe);fe.rawAttach(B);const de=j&&j.tracer?new(j.tracer(M)):new M,Be=j&&j.telemetry?new(j.telemetry(_)):new _,Qe=j&&j.client?new(j.client(z)):new z,oe=j&&j.window?new(j.window(Y)):new Y,De=j&&j.
workspace?new(j.workspace(R)):new R,ne=j&&j.languages?new(j.languages(I)):new I,Re=j&&j.notebooks?new(j.notebooks(H)):new H,Fe=[fe,de,Be,Qe,oe,De,ne,Re];function ft(V){return V instanceof Promise?V:e.thenable(V)?new Promise((X,he)=>{V.then(Ut=>X(Ut),Ut=>he(Ut))}):Promise.resolve(V)}let Ve,zt,Bt,on={listen:()=>B.listen(),sendRequest:(V,...X)=>B.sendRequest(e.string(V)?V:V.method,...X),onRequest:(V,X)=>B.onRequest(V,X),sendNotification:(V,X)=>{const he=e.string(V)?V:V.method;return B.sendNotification(
he,X)},onNotification:(V,X)=>B.onNotification(V,X),onProgress:B.onProgress,sendProgress:B.sendProgress,onInitialize:V=>(zt=V,{dispose:()=>{zt=void 0}}),onInitialized:V=>B.onNotification(t.InitializedNotification.type,V),onShutdown:V=>(Ve=V,{dispose:()=>{Ve=void 0}}),onExit:V=>(Bt=V,{dispose:()=>{Bt=void 0}}),get console(){return fe},get telemetry(){return Be},get tracer(){return de},get client(){return Qe},get window(){return oe},get workspace(){return De},get languages(){return ne},get notebooks(){
return Re},onDidChangeConfiguration:V=>B.onNotification(t.DidChangeConfigurationNotification.type,V),onDidChangeWatchedFiles:V=>B.onNotification(t.DidChangeWatchedFilesNotification.type,V),__textDocumentSync:void 0,onDidOpenTextDocument:V=>B.onNotification(t.DidOpenTextDocumentNotification.type,V),onDidChangeTextDocument:V=>B.onNotification(t.DidChangeTextDocumentNotification.type,V),onDidCloseTextDocument:V=>B.onNotification(t.DidCloseTextDocumentNotification.type,V),onWillSaveTextDocument:V=>B.
onNotification(t.WillSaveTextDocumentNotification.type,V),onWillSaveTextDocumentWaitUntil:V=>B.onRequest(t.WillSaveTextDocumentWaitUntilRequest.type,V),onDidSaveTextDocument:V=>B.onNotification(t.DidSaveTextDocumentNotification.type,V),sendDiagnostics:V=>B.sendNotification(t.PublishDiagnosticsNotification.type,V),onHover:V=>B.onRequest(t.HoverRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),void 0)),onCompletion:V=>B.onRequest(t.CompletionRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),
(0,r.attachPartialResult)(B,X))),onCompletionResolve:V=>B.onRequest(t.CompletionResolveRequest.type,V),onSignatureHelp:V=>B.onRequest(t.SignatureHelpRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),void 0)),onDeclaration:V=>B.onRequest(t.DeclarationRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onDefinition:V=>B.onRequest(t.DefinitionRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onTypeDefinition:V=>B.onRequest(
t.TypeDefinitionRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onImplementation:V=>B.onRequest(t.ImplementationRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onReferences:V=>B.onRequest(t.ReferencesRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onDocumentHighlight:V=>B.onRequest(t.DocumentHighlightRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,
X))),onDocumentSymbol:V=>B.onRequest(t.DocumentSymbolRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onWorkspaceSymbol:V=>B.onRequest(t.WorkspaceSymbolRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onWorkspaceSymbolResolve:V=>B.onRequest(t.WorkspaceSymbolResolveRequest.type,V),onCodeAction:V=>B.onRequest(t.CodeActionRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onCodeActionResolve:V=>B.
onRequest(t.CodeActionResolveRequest.type,(X,he)=>V(X,he)),onCodeLens:V=>B.onRequest(t.CodeLensRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onCodeLensResolve:V=>B.onRequest(t.CodeLensResolveRequest.type,(X,he)=>V(X,he)),onDocumentFormatting:V=>B.onRequest(t.DocumentFormattingRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),void 0)),onDocumentRangeFormatting:V=>B.onRequest(t.DocumentRangeFormattingRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),
void 0)),onDocumentOnTypeFormatting:V=>B.onRequest(t.DocumentOnTypeFormattingRequest.type,(X,he)=>V(X,he)),onRenameRequest:V=>B.onRequest(t.RenameRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),void 0)),onPrepareRename:V=>B.onRequest(t.PrepareRenameRequest.type,(X,he)=>V(X,he)),onDocumentLinks:V=>B.onRequest(t.DocumentLinkRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onDocumentLinkResolve:V=>B.onRequest(t.DocumentLinkResolveRequest.type,(X,he)=>V(X,
he)),onDocumentColor:V=>B.onRequest(t.DocumentColorRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onColorPresentation:V=>B.onRequest(t.ColorPresentationRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onFoldingRanges:V=>B.onRequest(t.FoldingRangeRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),(0,r.attachPartialResult)(B,X))),onSelectionRanges:V=>B.onRequest(t.SelectionRangeRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(
B,X),(0,r.attachPartialResult)(B,X))),onExecuteCommand:V=>B.onRequest(t.ExecuteCommandRequest.type,(X,he)=>V(X,he,(0,r.attachWorkDone)(B,X),void 0)),dispose:()=>B.dispose()};for(let V of Fe)V.attach(on);return B.onRequest(t.InitializeRequest.type,V=>{N.initialize(V),e.string(V.trace)&&(de.trace=t.Trace.fromString(V.trace));for(let X of Fe)X.initialize(V.capabilities);if(zt){let X=zt(V,new t.CancellationTokenSource().token,(0,r.attachWorkDone)(B,V),void 0);return ft(X).then(he=>{if(he instanceof t.
ResponseError)return he;let Ut=he;Ut||(Ut={capabilities:{}});let Ft=Ut.capabilities;Ft||(Ft={},Ut.capabilities=Ft),Ft.textDocumentSync===void 0||Ft.textDocumentSync===null?Ft.textDocumentSync=e.number(on.__textDocumentSync)?on.__textDocumentSync:t.TextDocumentSyncKind.None:!e.number(Ft.textDocumentSync)&&!e.number(Ft.textDocumentSync.change)&&(Ft.textDocumentSync.change=e.number(on.__textDocumentSync)?on.__textDocumentSync:t.TextDocumentSyncKind.None);for(let mr of Fe)mr.fillServerCapabilities(Ft);
return Ut})}else{let X={capabilities:{textDocumentSync:t.TextDocumentSyncKind.None}};for(let he of Fe)he.fillServerCapabilities(X.capabilities);return X}}),B.onRequest(t.ShutdownRequest.type,()=>{if(N.shutdownReceived=!0,Ve)return Ve(new t.CancellationTokenSource().token)}),B.onNotification(t.ExitNotification.type,()=>{try{Bt&&Bt()}finally{N.shutdownReceived?N.exit(0):N.exit(1)}}),B.onNotification(t.SetTraceNotification.type,V=>{de.trace=t.Trace.fromString(V.value)}),on}return Ke.createConnection=
Pe,Ke}var vn={},mS;function F2(){if(mS)return vn;mS=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.resolveModulePath=vn.FileSystem=vn.resolveGlobalYarnPath=vn.resolveGlobalNodePath=vn.resolve=vn.uriToFilePath=void 0;const t=nC,e=mi,n=ro,r=rC;function i(f){let d=t.parse(f);if(d.protocol!=="file:"||!d.path)return;let h=d.path.split("/");for(var m=0,b=h.length;m<b;m++)h[m]=decodeURIComponent(h[m]);if(process.platform==="win32"&&h.length>1){let $=h[0],w=h[1];$.length===0&&w.length>1&&w[1]===
":"&&h.shift()}return e.normalize(h.join("/"))}vn.uriToFilePath=i;function s(){return process.platform==="win32"}function a(f,d,h,m){const b="NODE_PATH",$=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((w,k)=>{let S=process.env,D=Object.create(null);Object.keys(S).forEach(F=>D[F]=S[F]),
d&&n.existsSync(d)&&(D[b]?D[b]=d+e.delimiter+D[b]:D[b]=d,m&&m(`NODE_PATH value is: ${D[b]}`)),D.ELECTRON_RUN_AS_NODE="1";try{let F=(0,r.fork)("",[],{cwd:h,env:D,execArgv:["-e",$]});if(F.pid===void 0){k(new Error(`Starting process to resolve node module  ${f} failed`));return}F.on("error",J=>{k(J)}),F.on("message",J=>{J.c==="r"&&(F.send({c:"e"}),J.s?w(J.r):k(new Error(`Failed to resolve module: ${f}`)))});let Y={c:"rs",a:f};F.send(Y)}catch(F){k(F)}})}vn.resolve=a;function o(f){let d="npm";const h=Object.
create(null);Object.keys(process.env).forEach($=>h[$]=process.env[$]),h.NO_UPDATE_NOTIFIER="true";const m={encoding:"utf8",env:h};s()&&(d="npm.cmd",m.shell=!0);let b=()=>{};try{process.on("SIGPIPE",b);let $=(0,r.spawnSync)(d,["config","get","prefix"],m).stdout;if(!$){f&&f("'npm config get prefix' didn't return a value.");return}let w=$.trim();return f&&f(`'npm config get prefix' value is: ${w}`),w.length>0?s()?e.join(w,"node_modules"):e.join(w,"lib","node_modules"):void 0}catch{return}finally{process.
removeListener("SIGPIPE",b)}}vn.resolveGlobalNodePath=o;function c(f){let d="yarn",h={encoding:"utf8"};s()&&(d="yarn.cmd",h.shell=!0);let m=()=>{};try{process.on("SIGPIPE",m);let b=(0,r.spawnSync)(d,["global","dir","--json"],h),$=b.stdout;if(!$){f&&(f("'yarn global dir' didn't return a value."),b.stderr&&f(b.stderr));return}let w=$.trim().split(/\r?\n/);for(let k of w)try{let S=JSON.parse(k);if(S.type==="log")return e.join(S.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener(
"SIGPIPE",m)}}vn.resolveGlobalYarnPath=c;var u;(function(f){let d;function h(){return d!==void 0||(process.platform==="win32"?d=!1:d=!n.existsSync(__filename.toUpperCase())||!n.existsSync(__filename.toLowerCase())),d}f.isCaseSensitive=h;function m(b,$){return h()?e.normalize($).indexOf(e.normalize(b))===0:e.normalize($).toLowerCase().indexOf(e.normalize(b).toLowerCase())===0}f.isParent=m})(u||(vn.FileSystem=u={}));function l(f,d,h,m){return h?(e.isAbsolute(h)||(h=e.join(f,h)),a(d,h,h,m).then(b=>u.
isParent(h,b)?b:Promise.reject(new Error(`Failed to load ${d} from node path location.`))).then(void 0,b=>a(d,o(m),f,m))):a(d,o(m),f,m)}return vn.resolveModulePath=l,vn}var dy,gS;function yS(){return gS||(gS=1,dy=_t()),dy}var As={},Yc={},vS;function q2(){if(vS)return Yc;vS=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.InlineCompletionFeature=void 0;const t=_t(),e=n=>class extends n{get inlineCompletion(){return{on:r=>this.connection.onRequest(t.InlineCompletionRequest.type,(i,s)=>r(i,s,
this.attachWorkDoneProgress(i)))}}};return Yc.InlineCompletionFeature=e,Yc}var wS;function G2(){return wS||(wS=1,function(t){var e=As&&As.__createBinding||(Object.create?function(c,u,l,f){f===void 0&&(f=l);var d=Object.getOwnPropertyDescriptor(u,l);(!d||("get"in d?!u.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return u[l]}}),Object.defineProperty(c,f,d)}:function(c,u,l,f){f===void 0&&(f=l),c[f]=u[l]}),n=As&&As.__exportStar||function(c,u){for(var l in c)l!=="default"&&
!Object.prototype.hasOwnProperty.call(u,l)&&e(u,c,l)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const r=ZE();Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}});const i=q2();n(_t(),t);const s=uS();Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return s.TextDocuments}});const a=dS();Object.defineProperty(t,"NotebookDocument\
s",{enumerable:!0,get:function(){return a.NotebookDocuments}}),n(pS(),t);var o;(function(c){c.all={__brand:"features",languages:i.InlineCompletionFeature}})(o||(t.ProposedFeatures=o={}))}(As)),As}var bS;function $S(){return bS||(bS=1,function(t){var e=gs&&gs.__createBinding||(Object.create?function(w,k,S,D){D===void 0&&(D=S);var F=Object.getOwnPropertyDescriptor(k,S);(!F||("get"in F?!k.__esModule:F.writable||F.configurable))&&(F={enumerable:!0,get:function(){return k[S]}}),Object.defineProperty(
w,D,F)}:function(w,k,S,D){D===void 0&&(D=S),w[D]=k[S]}),n=gs&&gs.__exportStar||function(w,k){for(var S in w)S!=="default"&&!Object.prototype.hasOwnProperty.call(k,S)&&e(k,w,S)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=Y_,i=ry(),s=pS(),a=F2(),o=yS();n(yS(),t),n(G2(),t);var c;(function(w){w.uriToFilePath=a.uriToFilePath,w.resolveGlobalNodePath=a.resolveGlobalNodePath,w.resolveGlobalYarnPath=a.resolveGlobalYarnPath,w.resolve=a.resolve,w.resolveModulePath=
a.resolveModulePath})(c||(t.Files=c={}));function u(){}let l=!1,f;function d(){const w="--clientProcessId";function k(S){try{let D=parseInt(S);isNaN(D)||(f=setInterval(()=>{try{process.kill(D,0)}catch{process.exit(l?0:1)}},3e3))}catch{}}for(let S=2;S<process.argv.length;S++){let D=process.argv[S];if(D===w&&S+1<process.argv.length){k(process.argv[S+1]);return}else{let F=D.split("=");F[0]===w&&k(F[1])}}}d();const h={initialize:w=>{const k=w.processId;i.number(k)&&f===void 0&&setInterval(()=>{try{process.
kill(k,0)}catch{process.exit(l?0:1)}},3e3)},get shutdownReceived(){return l},set shutdownReceived(w){l=w},exit:w=>{process.exit(w)}};function m(w,k,S,D){let F,Y,J,ie;return w!==void 0&&w.__brand==="features"&&(F=w,w=k,k=S,S=D),o.ConnectionStrategy.is(w)||o.ConnectionOptions.is(w)?ie=w:(Y=w,J=k,ie=S),b(Y,J,ie,F)}t.createConnection=m;function b(w,k,S,D){let F=!1;if(!w&&!k&&process.argv.length>2){let re,ye,z=process.argv.slice(2);for(let E=0;E<z.length;E++){let R=z[E];if(R==="--node-ipc"){w=new o.IPCMessageReader(
process),k=new o.IPCMessageWriter(process);break}else if(R==="--stdio"){F=!0,w=process.stdin,k=process.stdout;break}else if(R==="--socket"){re=parseInt(z[E+1]);break}else if(R==="--pipe"){ye=z[E+1];break}else{var Y=R.split("=");if(Y[0]==="--socket"){re=parseInt(Y[1]);break}else if(Y[0]==="--pipe"){ye=Y[1];break}}}if(re){let E=(0,o.createServerSocketTransport)(re);w=E[0],k=E[1]}else if(ye){let E=(0,o.createServerPipeTransport)(ye);w=E[0],k=E[1]}}var J="Use arguments of createConnection or set com\
mand line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!w)throw new Error("Connection input stream is not set. "+J);if(!k)throw new Error("Connection output stream is not set. "+J);if(i.func(w.read)&&i.func(w.on)){let re=w;re.on("end",()=>{process.exit(l?0:1)}),re.on("close",()=>{process.exit(l?0:1)})}const ie=re=>{const ye=(0,o.createProtocolConnection)(w,k,re,S);return F&&$(re),ye};return(0,s.createConnection)(ie,h,D)}function $(w){function k(D){return D.map(F=>typeof F=="str\
ing"?F:(0,r.inspect)(F)).join(" ")}const S=new Map;console.assert=function(F,...Y){if(!F)if(Y.length===0)w.error("Assertion failed");else{const[J,...ie]=Y;w.error(`Assertion failed: ${J} ${k(ie)}`)}},console.count=function(F="default"){const Y=String(F);let J=S.get(Y)??0;J+=1,S.set(Y,J),w.log(`${Y}: ${Y}`)},console.countReset=function(F){F===void 0?S.clear():S.delete(String(F))},console.debug=function(...F){w.log(k(F))},console.dir=function(F,Y){w.log((0,r.inspect)(F,Y))},console.log=function(...F){
w.log(k(F))},console.error=function(...F){w.error(k(F))},console.trace=function(...F){const Y=new Error().stack.replace(/(.+\n){2}/,"");let J="Trace";F.length!==0&&(J+=`: ${k(F)}`),w.log(`${J}
${Y}`)},console.warn=function(...F){w.warn(k(F))}}}(gs)),gs}var ve=$S();function RS(t,e){const n={stacks:t,tokens:e};return j2(n),n.stacks.flat().forEach(i=>{i.property=void 0}),TS(n.stacks).map(i=>i[i.length-1])}function fy(t){const{next:e,cardinalities:n,visited:r,plus:i}=t,s=[],a=e.feature;if(r.has(a))return[];vi(a)||r.add(a);let o,c=a;for(;c.$container;)if(vi(c.$container)){o=c.$container;break}else if(rm(c.$container))c=c.$container;else break;if(Cb(c.cardinality)){const u=Ta({next:{feature:c,
type:e.type},cardinalities:n,visited:r,plus:i});for(const l of u)i.add(l.feature);s.push(...u)}if(o){const u=o.elements.indexOf(c);u!==void 0&&u<o.elements.length-1&&s.push(...kS({feature:o,type:e.type},u+1,n,r,i)),s.every(l=>oa(l.feature.cardinality,l.feature)||oa(n.get(l.feature))||i.has(l.feature))&&s.push(...fy({next:{feature:o,type:e.type},cardinalities:n,visited:r,plus:i}))}return s}function hy(t){return bt(t)&&(t={feature:t}),Ta({next:t,cardinalities:new Map,visited:new Set,plus:new Set})}
function Ta(t){var e,n,r;const{next:i,cardinalities:s,visited:a,plus:o}=t;if(i===void 0)return[];const{feature:c,type:u}=i;if(vi(c))return a.has(c)?[]:(a.add(c),kS(i,0,s,a,o).map(l=>Uf(l,c.cardinality,s)));if(cm(c)||um(c))return c.elements.flatMap(l=>Ta({next:{feature:l,type:u,property:i.property},cardinalities:s,visited:a,plus:o})).map(l=>Uf(l,c.cardinality,s));if(vr(c)){const l={feature:c.terminal,type:u,property:(e=i.property)!==null&&e!==void 0?e:c.feature};return Ta({next:l,cardinalities:s,
visited:a,plus:o}).map(f=>Uf(f,c.cardinality,s))}else{if(es(c))return fy({next:{feature:c,type:Vo(c),property:(n=i.property)!==null&&n!==void 0?n:c.feature},cardinalities:s,visited:a,plus:o});if(Lr(c)&&en(c.rule.ref)){const l=c.rule.ref,f={feature:l.definition,type:l.fragment||l.dataType?void 0:(r=ts(l))!==null&&r!==void 0?r:l.name,property:i.property};return Ta({next:f,cardinalities:s,visited:a,plus:o}).map(d=>Uf(d,c.cardinality,s))}else return[i]}}function Uf(t,e,n){return n.set(t.feature,e),t}
function kS(t,e,n,r,i){var s;const a=[];let o;for(;e<t.feature.elements.length&&(o={feature:t.feature.elements[e++],type:t.type},a.push(...Ta({next:o,cardinalities:n,visited:r,plus:i})),!!oa((s=o.feature.cardinality)!==null&&s!==void 0?s:n.get(o.feature),o.feature)););return a}function j2(t){for(const e of t.tokens){const n=TS(t.stacks,e);t.stacks=n}}function TS(t,e){const n=[];for(const r of t)n.push(...B2(r,e));return n}function B2(t,e){const n=new Map,r=new Set(t.map(s=>s.feature).filter(U2)),
i=[];for(;t.length>0;){const s=t.pop(),a=fy({next:s,cardinalities:n,plus:r,visited:new Set}).filter(o=>e?py(o.feature,e):!0);for(const o of a)i.push([...t,o]);if(!a.every(o=>oa(o.feature.cardinality,o.feature)||oa(n.get(o.feature))))break}return i}function U2(t){if(t.cardinality==="+")return!0;const e=dn(t,vr);return!!(e&&e.cardinality==="+")}function py(t,e){if(wr(t))return t.value===e.image;if(Lr(t))return W2(t.rule.ref,e);if(xo(t)){const n=vm(t);if(n)return py(n,e)}return!1}function W2(t,e){return en(
t)?hy(t.definition).some(r=>py(r.feature,e)):Or(t)?Xo(t).test(e.image):!1}function H2(t){const e=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.triggerCharacters)!==null&&i!==void 0?i:[]}))),n=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.allCommitCharacters)!==null&&i!==void 0?i:[]})));return{triggerCharacters:e.length>0?e:void 0,allCommitCharacters:n.length>0?n:void 0}}class ES{constructor(e){this.scopeProvider=e.references.ScopeProvider,this.grammar=e.Grammar,this.completionParser=e.
parser.CompletionParser,this.nameProvider=e.references.NameProvider,this.lexer=e.parser.Lexer,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.fuzzyMatcher=e.shared.lsp.FuzzyMatcher,this.grammarConfig=e.parser.GrammarConfig,this.astReflection=e.shared.AstReflection,this.documentationProvider=e.documentation.DocumentationProvider}async getCompletion(e,n,r){const i=[],s=this.buildContexts(e,n.position),a=(u,l)=>{const f=this.fillCompletionItem(u,l);f&&i.push(f)},o=u=>wr(u.feature)?u.feature.
value:u.feature,c=[];for(const u of s)if(await Promise.all(et(u.features).distinct(o).exclude(c).map(l=>this.completionFor(u,l,a))),c.push(...u.features),!this.continueCompletion(i))break;return ve.CompletionList.create(this.deduplicateItems(i),!0)}deduplicateItems(e){return et(e).distinct(n=>`${n.kind}_${n.label}_${n.detail}`).toArray()}findFeaturesAt(e,n){const r=e.getText({start:ve.Position.create(0,0),end:e.positionAt(n)}),i=this.completionParser.parse(r),s=i.tokens;if(i.tokenIndex===0){const c=Nd(
this.grammar),u=hy({feature:c.definition,type:ts(c)});return s.length>0?(s.shift(),RS(u.map(l=>[l]),s)):u}const a=[...s].splice(i.tokenIndex);return RS([i.elementStack.map(c=>({feature:c}))],a)}*buildContexts(e,n){var r,i;const s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument,o=a.getText(),c=a.offsetAt(n),u={document:e,textDocument:a,offset:c,position:n},l=this.findDataTypeRuleStart(s,c);if(l){const[k,S]=l,D=(r=em(s,k))===null||r===void 0?void 0:r.astNode;yield Object.assign(Object.
assign({},u),{node:D,tokenOffset:k,tokenEndOffset:S,features:this.findFeaturesAt(a,k)})}const{nextTokenStart:f,nextTokenEnd:d,previousTokenStart:h,previousTokenEnd:m}=this.backtrackToAnyToken(o,c);let b=f;c<=f&&h!==void 0&&(b=h);const $=(i=em(s,b))===null||i===void 0?void 0:i.astNode;let w=!0;if(h!==void 0&&m!==void 0&&m===c&&(yield Object.assign(Object.assign({},u),{node:$,tokenOffset:h,tokenEndOffset:m,features:this.findFeaturesAt(a,h)}),w=this.performNextTokenCompletion(e,o.substring(h,m),h,m),
w&&(yield Object.assign(Object.assign({},u),{node:$,tokenOffset:m,tokenEndOffset:m,features:this.findFeaturesAt(a,m)}))),$)w&&(yield Object.assign(Object.assign({},u),{node:$,tokenOffset:f,tokenEndOffset:d,features:this.findFeaturesAt(a,f)}));else{const k=Nd(this.grammar);if(!k)throw new Error("Missing entry parser rule");yield Object.assign(Object.assign({},u),{tokenOffset:f,tokenEndOffset:d,features:hy(k.definition)})}}performNextTokenCompletion(e,n,r,i){return new RegExp("\\P{L}$","u").test(n)}findDataTypeRuleStart(e,n){
var r,i;let s=Zi(e,n,this.grammarConfig.nameRegexp),a=!!(!((r=dn(s?.grammarSource,en))===null||r===void 0)&&r.dataType);if(a){for(;a;)s=s?.container,a=!!(!((i=dn(s?.grammarSource,en))===null||i===void 0)&&i.dataType);if(s)return[s.offset,s.end]}}continueCompletion(e){return e.length===0}backtrackToAnyToken(e,n){const r=this.lexer.tokenize(e).tokens;if(r.length===0)return{nextTokenStart:n,nextTokenEnd:n};let i;for(const s of r){if(s.startOffset>=n)return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?
i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};if(s.endOffset>=n)return{nextTokenStart:s.startOffset,nextTokenEnd:s.endOffset+1,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};i=s}return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0}}completionFor(e,n,r){if(wr(n.feature))return this.completionForKeyword(e,n.feature,r);if(xo(n.feature)&&e.node)return this.completionForCrossReference(
e,n,r)}completionForCrossReference(e,n,r){const i=dn(n.feature,vr);let s=e.node;if(i&&s){n.type&&(s={$type:n.type,$container:s,$containerProperty:n.property},fm(this.astReflection,s));const a={reference:{$refText:""},container:s,property:i.feature};try{for(const o of this.getReferenceCandidates(a,e))r(e,this.createReferenceCompletionItem(o))}catch(o){console.error(o)}}}getReferenceCandidates(e,n){return this.scopeProvider.getScope(e).getAllElements()}createReferenceCompletionItem(e){const n=this.
nodeKindProvider.getCompletionItemKind(e),r=this.getReferenceDocumentation(e);return{nodeDescription:e,kind:n,documentation:r,detail:e.type,sortText:"0"}}getReferenceDocumentation(e){if(!e.node)return;const n=this.documentationProvider.getDocumentation(e.node);if(n)return{kind:"markdown",value:n}}completionForKeyword(e,n,r){this.filterKeyword(e,n)&&r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}getKeywordCompletionItemKind(e){return ve.CompletionItemKind.
Keyword}filterKeyword(e,n){return new RegExp("\\p{L}","u").test(n.value)}fillCompletionItem(e,n){var r,i;let s;if(typeof n.label=="string")s=n.label;else if("node"in n){const u=this.nameProvider.getName(n.node);if(!u)return;s=u}else if("nodeDescription"in n)s=n.nodeDescription.name;else return;let a;typeof((r=n.textEdit)===null||r===void 0?void 0:r.newText)=="string"?a=n.textEdit.newText:typeof n.insertText=="string"?a=n.insertText:a=s;const o=(i=n.textEdit)!==null&&i!==void 0?i:this.buildCompletionTextEdit(
e,s,a);return o?{additionalTextEdits:n.additionalTextEdits,command:n.command,commitCharacters:n.commitCharacters,data:n.data,detail:n.detail,documentation:n.documentation,filterText:n.filterText,insertText:n.insertText,insertTextFormat:n.insertTextFormat,insertTextMode:n.insertTextMode,kind:n.kind,labelDetails:n.labelDetails,preselect:n.preselect,sortText:n.sortText,tags:n.tags,textEditText:n.textEditText,textEdit:o,label:s}:void 0}buildCompletionTextEdit(e,n,r){const s=e.textDocument.getText().
substring(e.tokenOffset,e.offset);if(this.fuzzyMatcher.match(s,n)){const a=e.textDocument.positionAt(e.tokenOffset),o=e.position;return{newText:r,range:{start:a,end:o}}}else return}}class K2{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getDefinition(e,n,r){const i=e.parseResult.value;if(i.$cstNode){const s=i.$cstNode,a=Zi(s,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(a)return this.
collectLocationLinks(a,n)}}collectLocationLinks(e,n){var r;const i=this.findLink(e);if(i)return[ve.LocationLink.create(i.targetDocument.textDocument.uri,((r=i.target.astNode.$cstNode)!==null&&r!==void 0?r:i.target).range,i.target.range,i.source.range)]}findLink(e){const n=this.references.findDeclarationNode(e);if(n?.astNode){const r=ht(n.astNode);if(n&&r)return{source:e,target:n,targetDocument:r}}}}class SS{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,
this.grammarConfig=e.parser.GrammarConfig}getDocumentHighlight(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return;const s=Zi(i,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(!s)return;const a=this.references.findDeclaration(s);if(a){const o=Et.equals(ht(a).uri,e.uri),c={documentUri:e.uri,includeDeclaration:o};return this.references.findReferences(a,c).map(l=>this.createDocumentHighlight(l)).toArray()}}createDocumentHighlight(e){return ve.DocumentHighlight.create(e.segment.
range)}}class V2{constructor(e){this.nameProvider=e.references.NameProvider,this.nodeKindProvider=e.shared.lsp.NodeKindProvider}getSymbols(e,n,r){return this.getSymbol(e,e.parseResult.value)}getSymbol(e,n){const r=n.$cstNode,i=this.nameProvider.getNameNode(n);if(i&&r){const s=this.nameProvider.getName(n);return[{kind:this.nodeKindProvider.getSymbolKind(n),name:s||i.text,range:r.range,selectionRange:i.range,children:this.getChildSymbols(e,n)}]}else return this.getChildSymbols(e,n)||[]}getChildSymbols(e,n){
const r=[];for(const i of Uo(n)){const s=this.getSymbol(e,i);r.push(...s)}if(r.length>0)return r}}class X2{constructor(e){this.workspaceManager=e.workspace.WorkspaceManager,this.documentBuilder=e.workspace.DocumentBuilder,this.workspaceLock=e.workspace.WorkspaceLock,this.serviceRegistry=e.ServiceRegistry;let n=!1;e.lsp.LanguageServer.onInitialize(r=>{var i,s;n=!!(!((s=(i=r.capabilities.workspace)===null||i===void 0?void 0:i.didChangeWatchedFiles)===null||s===void 0)&&s.dynamicRegistration)}),e.lsp.
LanguageServer.onInitialized(r=>{n&&this.registerFileWatcher(e)})}registerFileWatcher(e){const n=et(e.ServiceRegistry.all).flatMap(r=>r.LanguageMetaData.fileExtensions).map(r=>r.startsWith(".")?r.substring(1):r).distinct().toArray();if(n.length>0){const r=e.lsp.Connection,i={watchers:[{globPattern:n.length===1?`**/*.${n[0]}`:`**/*.{${n.join(",")}}`}]};r?.client.register(ve.DidChangeWatchedFilesNotification.type,i)}}fireDocumentUpdate(e,n){e=e.filter(r=>this.serviceRegistry.hasServices(r)),this.workspaceManager.
ready.then(()=>{this.workspaceLock.write(r=>this.documentBuilder.update(e,n,r))}).catch(r=>{console.error("Workspace initialization failed. Could not perform document update.",r)})}didChangeContent(e){this.fireDocumentUpdate([Xt.parse(e.document.uri)],[])}didChangeWatchedFiles(e){const n=et(e.changes).filter(i=>i.type!==ve.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>Xt.parse(i.uri)).toArray(),r=et(e.changes).filter(i=>i.type===ve.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>Xt.parse(i.
uri)).toArray();this.fireDocumentUpdate(n,r)}}class Y2{constructor(e){this.commentNames=e.parser.GrammarConfig.multilineCommentRules}getFoldingRanges(e,n,r){const i=[],s=a=>i.push(a);return this.collectFolding(e,s),i}collectFolding(e,n){var r;const i=(r=e.parseResult)===null||r===void 0?void 0:r.value;if(i){if(this.shouldProcessContent(i)){const s=br(i).iterator();let a;do if(a=s.next(),!a.done){const o=a.value;this.shouldProcess(o)&&this.collectObjectFolding(e,o,n),this.shouldProcessContent(o)||
s.prune()}while(!a.done)}this.collectCommentFolding(e,i,n)}}shouldProcess(e){return!0}shouldProcessContent(e){return!0}collectObjectFolding(e,n,r){const i=n.$cstNode;if(i){const s=this.toFoldingRange(e,i);s&&r(s)}}collectCommentFolding(e,n,r){const i=n.$cstNode;if(i){for(const s of uD(i))if(this.commentNames.includes(s.tokenType.name)){const a=this.toFoldingRange(e,s,ve.FoldingRangeKind.Comment);a&&r(a)}}}toFoldingRange(e,n,r){const i=n.range,s=i.start;let a=i.end;if(!(a.line-s.line<2))return this.
includeLastFoldingLine(n,r)||(a=e.textDocument.positionAt(e.textDocument.offsetAt({line:a.line,character:0})-1)),ve.FoldingRange.create(s.line,a.line,s.character,a.character,r)}includeLastFoldingLine(e,n){if(n===ve.FoldingRangeKind.Comment)return!1;const r=e.text,i=r.charAt(r.length-1);return!(i==="}"||i===")"||i==="]")}}class J2{match(e,n){if(e.length===0)return!0;let r=!1,i,s=0;const a=n.length;for(let o=0;o<a;o++){const c=n.charCodeAt(o),u=e.charCodeAt(s);if((c===u||this.toUpperCharCode(c)===
this.toUpperCharCode(u))&&(r||(r=i===void 0||this.isWordTransition(i,c)),r&&s++,s===e.length))return!0;i=c}return!1}isWordTransition(e,n){return AS<=e&&e<=_S&&Q2<=n&&n<=Z2||e===CS&&n!==CS}toUpperCharCode(e){return AS<=e&&e<=_S?e-32:e}}const AS=97,_S=122,Q2=65,Z2=90,CS=95;class PS{constructor(e){this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getHoverContent(e,n){var r,i;const s=(i=(r=e.parseResult)===null||r===void 0?void 0:r.value)===null||i===void 0?void 0:i.$cstNode;
if(s){const a=e.textDocument.offsetAt(n.position),o=Zi(s,a,this.grammarConfig.nameRegexp);if(o&&o.offset+o.length>a){const c=this.references.findDeclaration(o);if(c)return this.getAstNodeHoverContent(c)}}}}class eB extends PS{constructor(e){super(e),this.documentationProvider=e.documentation.DocumentationProvider}getAstNodeHoverContent(e){const n=this.documentationProvider.getDocumentation(e);if(n)return{contents:{kind:"markdown",value:n}}}}var Wf=_t();const tB={[ve.SemanticTokenTypes.class]:0,[ve.
SemanticTokenTypes.comment]:1,[ve.SemanticTokenTypes.enum]:2,[ve.SemanticTokenTypes.enumMember]:3,[ve.SemanticTokenTypes.event]:4,[ve.SemanticTokenTypes.function]:5,[ve.SemanticTokenTypes.interface]:6,[ve.SemanticTokenTypes.keyword]:7,[ve.SemanticTokenTypes.macro]:8,[ve.SemanticTokenTypes.method]:9,[ve.SemanticTokenTypes.modifier]:10,[ve.SemanticTokenTypes.namespace]:11,[ve.SemanticTokenTypes.number]:12,[ve.SemanticTokenTypes.operator]:13,[ve.SemanticTokenTypes.parameter]:14,[ve.SemanticTokenTypes.
property]:15,[ve.SemanticTokenTypes.regexp]:16,[ve.SemanticTokenTypes.string]:17,[ve.SemanticTokenTypes.struct]:18,[ve.SemanticTokenTypes.type]:19,[ve.SemanticTokenTypes.typeParameter]:20,[ve.SemanticTokenTypes.variable]:21,[ve.SemanticTokenTypes.decorator]:22},nB={[ve.SemanticTokenModifiers.abstract]:1,[ve.SemanticTokenModifiers.async]:2,[ve.SemanticTokenModifiers.declaration]:4,[ve.SemanticTokenModifiers.defaultLibrary]:8,[ve.SemanticTokenModifiers.definition]:16,[ve.SemanticTokenModifiers.deprecated]:32,
[ve.SemanticTokenModifiers.documentation]:64,[ve.SemanticTokenModifiers.modification]:128,[ve.SemanticTokenModifiers.readonly]:256,[ve.SemanticTokenModifiers.static]:512};function rB(t){const e=[],n=[];let r=!0,i=!0,s=!0;for(const a of t)a&&(a.legend.tokenTypes.forEach((o,c)=>{const u=e[c];if(u&&u!==o)throw new Error(`Cannot merge '${u}' and '${o}' token types. They use the same index ${c}.`);e[c]=o}),a.legend.tokenModifiers.forEach((o,c)=>{const u=n[c];if(u&&u!==o)throw new Error(`Cannot merge \
'${u}' and '${o}' token modifier. They use the same index ${c}.`);n[c]=o}),a.full?typeof a.full=="object"&&!a.full.delta&&(i=!1):r=!1,a.range||(s=!1));return{legend:{tokenTypes:e,tokenModifiers:n},full:r&&{delta:i},range:s}}class iB extends ve.SemanticTokensBuilder{constructor(){super(...arguments),this._tokens=[]}push(e,n,r,i,s){this._tokens.push({line:e,char:n,length:r,tokenType:i,tokenModifiers:s})}build(){return this.applyTokens(),super.build()}buildEdits(){return this.applyTokens(),super.buildEdits()}flush(){
this.previousResult(this.id)}applyTokens(){for(const e of this._tokens.sort(this.compareTokens))super.push(e.line,e.char,e.length,e.tokenType,e.tokenModifiers);this._tokens=[]}compareTokens(e,n){return e.line===n.line?e.char-n.char:e.line-n.line}}class sB{constructor(e){this.tokensBuilders=new Map,e.shared.workspace.TextDocuments.onDidClose(n=>{this.tokensBuilders.delete(n.document.uri)}),e.shared.lsp.LanguageServer.onInitialize(n=>{var r;this.initialize((r=n.capabilities.textDocument)===null||r===
void 0?void 0:r.semanticTokens)})}initialize(e){this.clientCapabilities=e}get tokenTypes(){return tB}get tokenModifiers(){return nB}get semanticTokensOptions(){return{legend:{tokenTypes:Object.keys(this.tokenTypes),tokenModifiers:Object.keys(this.tokenModifiers)},full:{delta:!0},range:!0}}async semanticHighlight(e,n,r=at.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.
computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightRange(e,n,r=at.CancellationToken.None){return this.currentRange=n.range,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightDelta(e,n,r=at.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,
this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.previousResult(n.previousResultId),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.buildEdits()}createAcceptor(){return n=>{"line"in n?this.highlightToken({range:{start:{line:n.line,character:n.char},end:{line:n.line,character:n.char+n.length}},type:n.type,modifier:n.modifier}):"range"in n?this.highlightToken(n):"keyword"in n?this.highlightKeyword(n):"property"in n?this.highlightProperty(
n):this.highlightNode({node:n.cst,type:n.type,modifier:n.modifier})}}getDocumentTokensBuilder(e){const n=this.tokensBuilders.get(e.uri.toString());if(n)return n;const r=new iB;return this.tokensBuilders.set(e.uri.toString(),r),r}async computeHighlighting(e,n,r){const i=e.parseResult.value,s=Mr(i,{range:this.currentRange}).iterator();let a;do if(a=s.next(),!a.done){await jt(r);const o=a.value;this.highlightElement(o,n)==="prune"&&s.prune()}while(!a.done)}highlightToken(e){var n;const{range:r,type:i}=e;
let s=e.modifier;if(this.currentRange&&!sb(r,this.currentRange)||!this.currentDocument||!this.currentTokensBuilder)return;const a=this.tokenTypes[i];let o=0;if(s!==void 0){typeof s=="string"&&(s=[s]);for(const l of s){const f=this.tokenModifiers[l];o|=f}}const c=r.start.line,u=r.end.line;if(c===u){const l=r.start.character,f=r.end.character-l;this.currentTokensBuilder.push(c,l,f,a,o)}else if(!((n=this.clientCapabilities)===null||n===void 0)&&n.multilineTokenSupport){const l=r.start.character,f=this.
currentDocument.textDocument.offsetAt(r.start),d=this.currentDocument.textDocument.offsetAt(r.end);this.currentTokensBuilder.push(c,l,d-f,a,o)}else{const l=r.start;let f=this.currentDocument.textDocument.offsetAt({line:c+1,character:0});this.currentTokensBuilder.push(l.line,l.character,f-l.character-1,a,o);for(let d=c+1;d<u;d++){const h=f;f=this.currentDocument.textDocument.offsetAt({line:d+1,character:0}),this.currentTokensBuilder.push(d,0,f-h-1,a,o)}this.currentTokensBuilder.push(u,0,r.end.character,
a,o)}}highlightProperty(e){const n=[];if(typeof e.index=="number"){const s=tn(e.node.$cstNode,e.property,e.index);s&&n.push(s)}else n.push(...aa(e.node.$cstNode,e.property));const{type:r,modifier:i}=e;for(const s of n)this.highlightNode({node:s,type:r,modifier:i})}highlightKeyword(e){const{node:n,keyword:r,type:i,index:s,modifier:a}=e,o=[];if(typeof s=="number"){const c=Ko(n.$cstNode,r,s);c&&o.push(c)}else o.push(...bm(n.$cstNode,r));for(const c of o)this.highlightNode({node:c,type:i,modifier:a})}highlightNode(e){
const{node:n,type:r,modifier:i}=e,s=n.range;this.highlightToken({range:s,type:r,modifier:i})}}var xS;(function(t){function e(r,i,s){const a=new Map;Object.entries(i).forEach(([u,l])=>a.set(l,u));let o=0,c=0;return n(r.data,5).map(u=>{o+=u[0],u[0]!==0&&(c=0),c+=u[1];const l=u[2];return{offset:s.textDocument.offsetAt({line:o,character:c}),tokenType:a.get(u[3]),tokenModifiers:u[4],text:s.textDocument.getText({start:{line:o,character:c},end:{line:o,character:c+l}})}})}t.decode=e;function n(r,i){const s=[];
for(let a=0;a<r.length;a+=i){const o=r.slice(a,a+i);s.push(o)}return s}})(xS||(xS={}));function aB(t){const e=[],n=[];t.forEach(i=>{i?.triggerCharacters&&e.push(...i.triggerCharacters),i?.retriggerCharacters&&n.push(...i.retriggerCharacters)});const r={triggerCharacters:e.length>0?Array.from(new Set(e)).sort():void 0,retriggerCharacters:n.length>0?Array.from(new Set(n)).sort():void 0};return r.triggerCharacters?r:void 0}class oB{constructor(e){this.onInitializeEmitter=new Wf.Emitter,this.onInitializedEmitter=
new Wf.Emitter,this.services=e}get onInitialize(){return this.onInitializeEmitter.event}get onInitialized(){return this.onInitializedEmitter.event}async initialize(e){return this.eagerLoadServices(),this.fireInitializeOnDefaultServices(e),this.onInitializeEmitter.fire(e),this.onInitializeEmitter.dispose(),this.buildInitializeResult(e)}eagerLoadServices(){Jg(this.services),this.services.ServiceRegistry.all.forEach(e=>Jg(e))}hasService(e){return this.services.ServiceRegistry.all.some(r=>e(r)!==void 0)}buildInitializeResult(e){
var n,r,i,s;const a=this.services.lsp.DocumentUpdateHandler,o=(n=this.services.lsp.FileOperationHandler)===null||n===void 0?void 0:n.fileOperationOptions,c=this.services.ServiceRegistry.all,u=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.Formatter}),l=c.map(H=>{var A,te;return(te=(A=H.lsp)===null||A===void 0?void 0:A.Formatter)===null||te===void 0?void 0:te.formatOnTypeOptions}).find(H=>!!H),f=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.CodeActionProvider}),
d=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.SemanticTokenProvider}),h=rB(c.map(H=>{var A,te;return(te=(A=H.lsp)===null||A===void 0?void 0:A.SemanticTokenProvider)===null||te===void 0?void 0:te.semanticTokensOptions})),m=(i=(r=this.services.lsp)===null||r===void 0?void 0:r.ExecuteCommandHandler)===null||i===void 0?void 0:i.commands,b=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.DocumentLinkProvider}),$=aB(c.map(H=>{var A,te;return(te=(A=H.lsp)===
null||A===void 0?void 0:A.SignatureHelp)===null||te===void 0?void 0:te.signatureHelpOptions})),w=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.TypeProvider}),k=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.ImplementationProvider}),S=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.CompletionProvider}),D=H2(c.map(H=>{var A,te;return(te=(A=H.lsp)===null||A===void 0?void 0:A.CompletionProvider)===null||te===void 0?void 0:te.completionOptions})),
F=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.ReferencesProvider}),Y=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.DocumentSymbolProvider}),J=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.DefinitionProvider}),ie=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.DocumentHighlightProvider}),re=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.FoldingRangeProvider}),ye=this.hasService(H=>{
var A;return(A=H.lsp)===null||A===void 0?void 0:A.HoverProvider}),z=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.RenameProvider}),E=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.CallHierarchyProvider}),R=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.TypeHierarchyProvider}),M=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.CodeLensProvider}),_=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?
void 0:A.DeclarationProvider}),P=this.hasService(H=>{var A;return(A=H.lsp)===null||A===void 0?void 0:A.InlayHintProvider}),I=(s=this.services.lsp)===null||s===void 0?void 0:s.WorkspaceSymbolProvider;return{capabilities:{workspace:{workspaceFolders:{supported:!0},fileOperations:o},executeCommandProvider:m&&{commands:m},textDocumentSync:{change:Wf.TextDocumentSyncKind.Incremental,openClose:!0,save:!!a.didSaveDocument,willSave:!!a.willSaveDocument,willSaveWaitUntil:!!a.willSaveDocumentWaitUntil},completionProvider:S?
D:void 0,referencesProvider:F,documentSymbolProvider:Y,definitionProvider:J,typeDefinitionProvider:w,documentHighlightProvider:ie,codeActionProvider:f,documentFormattingProvider:u,documentRangeFormattingProvider:u,documentOnTypeFormattingProvider:l,foldingRangeProvider:re,hoverProvider:ye,renameProvider:z?{prepareProvider:!0}:void 0,semanticTokensProvider:d?h:void 0,signatureHelpProvider:$,implementationProvider:k,callHierarchyProvider:E?{}:void 0,typeHierarchyProvider:R?{}:void 0,documentLinkProvider:b?
{resolveProvider:!1}:void 0,codeLensProvider:M?{resolveProvider:!1}:void 0,declarationProvider:_,inlayHintProvider:P?{resolveProvider:!1}:void 0,workspaceSymbolProvider:I?{resolveProvider:!!I.resolveSymbol}:void 0}}}initialized(e){this.fireInitializedOnDefaultServices(e),this.onInitializedEmitter.fire(e),this.onInitializedEmitter.dispose()}fireInitializeOnDefaultServices(e){this.services.workspace.ConfigurationProvider.initialize(e),this.services.workspace.WorkspaceManager.initialize(e)}fireInitializedOnDefaultServices(e){
const n=this.services.lsp.Connection,r=n?Object.assign(Object.assign({},e),{register:i=>n.client.register(Wf.DidChangeConfigurationNotification.type,i),fetchConfiguration:i=>n.workspace.getConfiguration(i)}):e;this.services.workspace.ConfigurationProvider.initialized(r).catch(i=>console.error("Error in ConfigurationProvider initialization:",i)),this.services.workspace.WorkspaceManager.initialized(e).catch(i=>console.error("Error in WorkspaceManager initialization:",i))}}class cB{getSymbolKind(e){
return ve.SymbolKind.Field}getCompletionItemKind(e){return ve.CompletionItemKind.Reference}}class uB{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}findReferences(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return[];const s=Zi(i,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);return s?this.getReferences(s,n,e):[]}getReferences(e,n,r){const i=[],s=this.references.findDeclaration(
e);if(s){const a={includeDeclaration:n.context.includeDeclaration};this.references.findReferences(s,a).forEach(o=>{i.push(ve.Location.create(o.sourceUri.toString(),o.segment.range))})}return i}}class lB{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,this.grammarConfig=e.parser.GrammarConfig}async rename(e,n,r){const i={},s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument.offsetAt(n.position),o=Zi(s,a,this.grammarConfig.nameRegexp);
if(!o)return;const c=this.references.findDeclaration(o);if(!c)return;const u={onlyLocal:!1,includeDeclaration:!0};return this.references.findReferences(c,u).forEach(f=>{const d=An.replace(f.segment.range,n.newName),h=f.sourceUri.toString();i[h]?i[h].push(d):i[h]=[d]}),{changes:i}}prepareRename(e,n,r){return this.renameNodeRange(e,n.position)}renameNodeRange(e,n){const r=e.parseResult.value.$cstNode,i=e.textDocument.offsetAt(n);if(r&&i){const s=Zi(r,i,this.grammarConfig.nameRegexp);if(!s)return;if(this.
references.findDeclaration(s)||this.isNameNode(s))return s.range}}isNameNode(e){return e?.astNode&&Nf(e.astNode)&&e===this.nameProvider.getNameNode(e.astNode)}}class DS{constructor(e){this.indexManager=e.workspace.IndexManager,this.nodeKindProvider=e.lsp.NodeKindProvider,this.fuzzyMatcher=e.lsp.FuzzyMatcher}async getSymbols(e,n=at.CancellationToken.None){const r=[],i=e.query.toLowerCase();for(const s of this.indexManager.allElements())if(await jt(n),this.fuzzyMatcher.match(i,s.name)){const a=this.
getWorkspaceSymbol(s);a&&r.push(a)}return r}getWorkspaceSymbol(e){const n=e.nameSegment;if(n)return{kind:this.nodeKindProvider.getSymbolKind(e),name:e.name,location:{range:n.range,uri:e.documentUri.toString()}}}}class dB{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new ve.Emitter,this._onDidOpen=new ve.Emitter,this._onDidClose=new ve.Emitter,this._onDidSave=new ve.Emitter,this._onWillSave=new ve.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){
return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(Et.normalize(e))}set(e){const n=Et.normalize(e.uri);let r=!0;this._syncedDocuments.has(n)&&(r=!1),this._syncedDocuments.set(n,e);const i=Object.freeze({document:e});return this._onDidOpen.fire(i),this._onDidChangeContent.fire(i),r}delete(e){
const n=Et.normalize(typeof e=="object"&&"uri"in e?e.uri:e),r=this._syncedDocuments.get(n);r!==void 0&&(this._syncedDocuments.delete(n),this._onDidClose.fire(Object.freeze({document:r})))}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=ve.TextDocumentSyncKind.Incremental;const n=[];return n.push(e.onDidOpenTextDocument(r=>{const i=r.textDocument,s=Et.normalize(i.uri),a=this._configuration.create(s,i.languageId,
i.version,i.text);this._syncedDocuments.set(s,a);const o=Object.freeze({document:a});this._onDidOpen.fire(o),this._onDidChangeContent.fire(o)})),n.push(e.onDidChangeTextDocument(r=>{const i=r.textDocument,s=r.contentChanges;if(s.length===0)return;const{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);const o=Et.normalize(i.uri);let c=this._syncedDocuments.get(o);c!==void 0&&(c=this._configuration.update(c,s,a),this._syncedDocuments.
set(o,c),this._onDidChangeContent.fire(Object.freeze({document:c})))})),n.push(e.onDidCloseTextDocument(r=>{const i=Et.normalize(r.textDocument.uri),s=this._syncedDocuments.get(i);s!==void 0&&(this._syncedDocuments.delete(i),this._onDidClose.fire(Object.freeze({document:s})))})),n.push(e.onWillSaveTextDocument(r=>{const i=this._syncedDocuments.get(Et.normalize(r.textDocument.uri));i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil(
(r,i)=>{const s=this._syncedDocuments.get(Et.normalize(r.textDocument.uri));return s!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:s,reason:r.reason}),i):[]})),n.push(e.onDidSaveTextDocument(r=>{const i=this._syncedDocuments.get(Et.normalize(r.textDocument.uri));i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),ve.Disposable.create(()=>{n.forEach(r=>r.dispose())})}}function fB(t){return Lf.merge(zT(t),hB(t))}function hB(t){return{lsp:{CompletionProvider:e=>new ES(
e),DocumentSymbolProvider:e=>new V2(e),HoverProvider:e=>new eB(e),FoldingRangeProvider:e=>new Y2(e),ReferencesProvider:e=>new uB(e),DefinitionProvider:e=>new K2(e),DocumentHighlightProvider:e=>new SS(e),RenameProvider:e=>new lB(e)},shared:()=>t.shared}}function pB(t){return Lf.merge(FT(t),mB(t))}function mB(t){return{lsp:{Connection:()=>t.connection,LanguageServer:e=>new oB(e),DocumentUpdateHandler:e=>new X2(e),WorkspaceSymbolProvider:e=>new DS(e),NodeKindProvider:()=>new cB,FuzzyMatcher:()=>new J2},
workspace:{TextDocuments:()=>new dB(Df)}}}class gB{constructor(){this.collector=()=>{}}getNodeFormatter(e){return new yB(e,this.collector)}formatDocument(e,n){const r=e.parseResult;return r.lexerErrors.length===0&&r.parserErrors.length===0?this.doDocumentFormat(e,n.options):[]}isFormatRangeErrorFree(e,n){const r=e.parseResult;return r.lexerErrors.length||r.parserErrors.length?Math.min(...r.lexerErrors.map(s=>{var a;return(a=s.line)!==null&&a!==void 0?a:Number.MAX_VALUE}),...r.parserErrors.map(s=>{
var a;return(a=s.token.startLine)!==null&&a!==void 0?a:Number.MAX_VALUE}))>n.end.line:!0}formatDocumentRange(e,n){return this.isFormatRangeErrorFree(e,n.range)?this.doDocumentFormat(e,n.options,n.range):[]}formatDocumentOnType(e,n){const r={start:{character:0,line:n.position.line},end:n.position};return this.isFormatRangeErrorFree(e,r)?this.doDocumentFormat(e,n.options,r):[]}get formatOnTypeOptions(){}doDocumentFormat(e,n,r){const i=new Map,s=(o,c,u)=>{var l,f;const d=this.nodeModeToKey(o,c),h=i.
get(d),m=(l=u.options.priority)!==null&&l!==void 0?l:0,b=(f=h?.options.priority)!==null&&f!==void 0?f:0;(!h||b<=m)&&i.set(d,u)};this.collector=s,this.iterateAstFormatting(e,r);const a=this.iterateCstFormatting(e,i,n,r);return this.avoidOverlappingEdits(e.textDocument,a)}avoidOverlappingEdits(e,n){const r=[];for(const i of n){let s=r[r.length-1];for(;s;){const a=e.offsetAt(i.range.start),o=e.offsetAt(s.range.end);if(a<o)r.pop(),s=r[r.length-1];else break}r.push(i)}return r.filter(i=>this.isNecessary(
i,e))}iterateAstFormatting(e,n){const r=e.parseResult.value;this.format(r);const i=br(r).iterator();let s;do if(s=i.next(),!s.done){const a=s.value;this.insideRange(a.$cstNode.range,n)?this.format(a):i.prune()}while(!s.done)}nodeModeToKey(e,n){return`${e.offset}:${e.end}:${n}`}insideRange(e,n){return!n||e.start.line<=n.start.line&&e.end.line>=n.end.line||e.start.line>=n.start.line&&e.end.line<=n.end.line||e.start.line<=n.end.line&&e.end.line>=n.end.line}isNecessary(e,n){return e.newText!==n.getText(
e.range).replace(/\r/g,"")}iterateCstFormatting(e,n,r,i){const s={indentation:0,options:r,document:e.textDocument},a=[],c=this.iterateCstTree(e,s).iterator();let u,l;do if(l=c.next(),!l.done){const f=l.value,d=Qi(f),h=this.nodeModeToKey(f,"prepend"),m=n.get(h);if(n.delete(h),m){const w=this.createTextEdit(u,f,m,s);for(const k of w)k&&this.insideRange(k.range,i)&&a.push(k)}const b=this.nodeModeToKey(f,"append"),$=n.get(b);if(n.delete(b),$){const w=hD(f);if(w){const k=this.createTextEdit(f,w,$,s);
for(const S of k)S&&this.insideRange(S.range,i)&&a.push(S)}}if(!m&&f.hidden){const w=this.createHiddenTextEdits(u,f,void 0,s);for(const k of w)k&&this.insideRange(k.range,i)&&a.push(k)}d&&(u=f)}while(!l.done);return a}createHiddenTextEdits(e,n,r,i){var s;const a=n.range.start.line;if(e&&e.range.end.line===a)return[];const o=[],c={start:{character:0,line:a},end:n.range.start},u=i.document.getText(c),l=this.findFittingMove(c,(s=r?.moves)!==null&&s!==void 0?s:[],i),f=this.getExistingIndentationCharacterCount(
u,i),h=this.getIndentationCharacterCount(i,l)-f;if(h===0)return[];let m="";h>0&&(m=(i.options.insertSpaces?" ":"	").repeat(h));const b=n.text.split(`
`);b[0]=u+b[0];for(let $=0;$<b.length;$++){const w=a+$,k={character:0,line:w};if(h>0)o.push({newText:m,range:{start:k,end:k}});else{const S=b[$];let D=0;for(;D<S.length;D++){const F=S.charAt(D);if(F!==" "&&F!=="	")break}o.push({newText:"",range:{start:k,end:{line:w,character:Math.min(D,Math.abs(h))}}})}}return o}getExistingIndentationCharacterCount(e,n){const r=" ".repeat(n.options.tabSize);return(n.options.insertSpaces?e.replaceAll("	",r):e.replaceAll(r,"	")).length}getIndentationCharacterCount(e,n){
let r=e.indentation;return n&&n.tabs&&(r+=n.tabs),(e.options.insertSpaces?e.options.tabSize:1)*r}createTextEdit(e,n,r,i){var s;if(n.hidden)return this.createHiddenTextEdits(e,n,r,i);if(e&&(e.range.end.line>n.range.start.line||e.range.end.line===n.range.start.line&&e.range.end.character>n.range.start.character))return[];const a={start:(s=e?.range.end)!==null&&s!==void 0?s:{character:0,line:0},end:n.range.start},o=this.findFittingMove(a,r.moves,i);if(!o)return[];const c=o.characters,u=o.lines,l=o.
tabs,f=i.indentation;i.indentation+=l??0;const d=[];return c!==void 0?e?.hidden||d.push(this.createSpaceTextEdit(a,c,r.options)):u!==void 0?d.push(this.createLineTextEdit(a,u,i,r.options)):l!==void 0&&d.push(this.createTabTextEdit(a,!!e,i)),Qi(n)&&(i.indentation=f),d}createSpaceTextEdit(e,n,r){if(e.start.line===e.end.line){const s=e.end.character-e.start.character;n=this.fitIntoOptions(n,s,r)}return{newText:" ".repeat(n),range:e}}createLineTextEdit(e,n,r,i){const s=e.end.line-e.start.line;n=this.
fitIntoOptions(n,s,i);const o=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation);return{newText:`${`
`.repeat(n)}${o}`,range:e}}createTabTextEdit(e,n,r){const s=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation),a=n?1:0,o=Math.max(e.end.line-e.start.line,a);return{newText:`${`
`.repeat(o)}${s}`,range:e}}fitIntoOptions(e,n,r){return r.allowMore?e=Math.max(n,e):r.allowLess&&(e=Math.min(n,e)),e}findFittingMove(e,n,r){if(n.length===0)return;if(n.length===1)return n[0];const i=e.end.line-e.start.line;for(const s of n){if(s.lines!==void 0&&i<=s.lines)return s;if(s.lines===void 0&&i===0)return s}return n[n.length-1]}iterateCstTree(e,n){const i=e.parseResult.value.$cstNode;return i?new ra(i,s=>this.iterateCst(s,n)):na}iterateCst(e,n){if(!yi(e))return na;const r=n.indentation;
return new Mt(()=>({index:0}),i=>i.index<e.content.length?{done:!1,value:e.content[i.index++]}:(n.indentation=r,ln))}}class yB{constructor(e,n){this.astNode=e,this.collector=n}node(e){return new pr(e.$cstNode?[e.$cstNode]:[],this.collector)}nodes(...e){const n=[];for(const r of e)r.$cstNode&&n.push(r.$cstNode);return new pr(n,this.collector)}property(e,n){const r=tn(this.astNode.$cstNode,e,n);return new pr(r?[r]:[],this.collector)}properties(...e){const n=[];for(const r of e){const i=aa(this.astNode.
$cstNode,r);n.push(...i)}return new pr(n,this.collector)}keyword(e,n){const r=Ko(this.astNode.$cstNode,e,n);return new pr(r?[r]:[],this.collector)}keywords(...e){const n=[];for(const r of e){const i=bm(this.astNode.$cstNode,r);n.push(...i)}return new pr(n,this.collector)}cst(e){return new pr([...e],this.collector)}interior(e,n){const r=e.nodes,i=n.nodes;if(r.length!==1||i.length!==1)return new pr([],this.collector);let s=r[0],a=i[0];if(s.offset>a.offset){const o=s;s=a,a=o}return new pr(pD(s,a),this.
collector)}}class pr{constructor(e,n){this.nodes=e,this.collector=n}prepend(e){for(const n of this.nodes)this.collector(n,"prepend",e);return this}append(e){for(const n of this.nodes)this.collector(n,"append",e);return this}surround(e){for(const n of this.nodes)this.collector(n,"prepend",e),this.collector(n,"append",e);return this}slice(e,n){return new pr(this.nodes.slice(e,n),this.collector)}}var Ci;(function(t){function e(...l){return{options:{},moves:l.flatMap(f=>f.moves).sort(u)}}t.fit=e;function n(l){
return i(0,l)}t.noSpace=n;function r(l){return i(1,l)}t.oneSpace=r;function i(l,f){return{options:f??{},moves:[{characters:l}]}}t.spaces=i;function s(l){return a(1,l)}t.newLine=s;function a(l,f){return{options:f??{},moves:[{lines:l}]}}t.newLines=a;function o(l){return{options:l??{},moves:[{tabs:1,lines:1}]}}t.indent=o;function c(l){return{options:l??{},moves:[{tabs:0}]}}t.noIndent=c;function u(l,f){var d,h,m,b,$,w;const k=(d=l.lines)!==null&&d!==void 0?d:0,S=(h=f.lines)!==null&&h!==void 0?h:0,D=(m=
l.tabs)!==null&&m!==void 0?m:0,F=(b=f.tabs)!==null&&b!==void 0?b:0,Y=($=l.characters)!==null&&$!==void 0?$:0,J=(w=f.characters)!==null&&w!==void 0?w:0;return k<S?-1:k>S?1:D<F?-1:D>F?1:Y<J?-1:Y>J?1:0}})(Ci||(Ci={}));var my,NS;function vB(){return NS||(NS=1,my=$S()),my}vB();var _s={},Jc={},Qc={},Cs={},cr={},ri={},IS;function OS(){if(IS)return ri;IS=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.normalizePath=ri.convertSlashes=ri.cleanPath=void 0;const t=mi;function e(s){let a=(0,t.normalize)(
s);return a.length>1&&a[a.length-1]===t.sep&&(a=a.substring(0,a.length-1)),a}ri.cleanPath=e;const n=/[\\/]/g;function r(s,a){return s.replace(n,a)}ri.convertSlashes=r;function i(s,a){const{resolvePaths:o,normalizePath:c,pathSeparator:u}=a,l=process.platform==="win32"&&s.includes("/")||s.startsWith(".");if(o&&(s=(0,t.resolve)(s)),(c||l)&&(s=e(s)),s===".")return"";const f=s[s.length-1]!==u;return r(f?s+u:s,u)}return ri.normalizePath=i,ri}var ii={},LS;function wB(){if(LS)return ii;LS=1,Object.defineProperty(
ii,"__esModule",{value:!0}),ii.build=ii.joinDirectoryPath=ii.joinPathWithBasePath=void 0;const t=mi,e=OS();function n(o,c){return c+o}ii.joinPathWithBasePath=n;function r(o,c){return function(u,l){return l.startsWith(o)?l.replace(o,"")+u:(0,e.convertSlashes)((0,t.relative)(o,l),c.pathSeparator)+c.pathSeparator+u}}function i(o){return o}function s(o,c,u){return c+o+u}ii.joinDirectoryPath=s;function a(o,c){const{relativePaths:u,includeBasePath:l}=c;return u&&o?r(o,c):l?n:i}return ii.build=a,ii}var Zc={},
MS;function bB(){if(MS)return Zc;MS=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.build=void 0;function t(a){return function(o,c){c.push(o.substring(a.length)||".")}}function e(a){return function(o,c,u){const l=o.substring(a.length)||".";u.every(f=>f(l,!0))&&c.push(l)}}const n=(a,o)=>{o.push(a||".")},r=(a,o,c)=>{const u=a||".";c.every(l=>l(u,!0))&&o.push(u)},i=()=>{};function s(a,o){const{includeDirs:c,filters:u,relativePaths:l}=o;return c?l?u&&u.length?e(a):t(a):u&&u.length?r:n:i}return Zc.
build=s,Zc}var eu={},zS;function $B(){if(zS)return eu;zS=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.build=void 0;const t=(a,o,c,u)=>{u.every(l=>l(a,!1))&&c.files++},e=(a,o,c,u)=>{u.every(l=>l(a,!1))&&o.push(a)},n=(a,o,c,u)=>{c.files++},r=(a,o)=>{o.push(a)},i=()=>{};function s(a){const{excludeFiles:o,filters:c,onlyCounts:u}=a;return o?i:c&&c.length?u?t:e:u?n:r}return eu.build=s,eu}var tu={},FS;function RB(){if(FS)return tu;FS=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.build=
void 0;const t=r=>r,e=()=>[""].slice(0,0);function n(r){return r.group?e:t}return tu.build=n,tu}var nu={},qS;function kB(){if(qS)return nu;qS=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.build=void 0;const t=(r,i,s)=>{r.push({directory:i,files:s,dir:i})},e=()=>{};function n(r){return r.group?t:e}return nu.build=n,nu}var Ps={},GS;function TB(){if(GS)return Ps;GS=1;var t=Ps&&Ps.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Ps,"__esModule",{value:!0}),
Ps.build=void 0;const e=t(ro),n=mi,r=function(c,u,l){const{queue:f,options:{suppressErrors:d}}=u;f.enqueue(),e.default.realpath(c,(h,m)=>{if(h)return f.dequeue(d?null:h,u);e.default.stat(m,(b,$)=>{if(b)return f.dequeue(d?null:b,u);if($.isDirectory()&&a(c,m,u))return f.dequeue(null,u);l($,m),f.dequeue(null,u)})})},i=function(c,u,l){const{queue:f,options:{suppressErrors:d}}=u;f.enqueue();try{const h=e.default.realpathSync(c),m=e.default.statSync(h);if(m.isDirectory()&&a(c,h,u))return;l(m,h)}catch(h){
if(!d)throw h}};function s(c,u){return!c.resolveSymlinks||c.excludeSymlinks?null:u?i:r}Ps.build=s;function a(c,u,l){if(l.options.useRealPaths)return o(u,l);let f=(0,n.dirname)(c),d=1;for(;f!==l.root&&d<2;){const h=l.symlinks.get(f);!!h&&(h===u||h.startsWith(u)||u.startsWith(h))?d++:f=(0,n.dirname)(f)}return l.symlinks.set(c,u),d>1}function o(c,u){return u.visited.includes(c+u.options.pathSeparator)}return Ps}var ru={},jS;function EB(){if(jS)return ru;jS=1,Object.defineProperty(ru,"__esModule",{value:!0}),
ru.build=void 0;const t=l=>l.counts,e=l=>l.groups,n=l=>l.paths,r=l=>l.paths.slice(0,l.options.maxFiles),i=(l,f,d)=>(c(f,d,l.counts,l.options.suppressErrors),null),s=(l,f,d)=>(c(f,d,l.paths,l.options.suppressErrors),null),a=(l,f,d)=>(c(f,d,l.paths.slice(0,l.options.maxFiles),l.options.suppressErrors),null),o=(l,f,d)=>(c(f,d,l.groups,l.options.suppressErrors),null);function c(l,f,d,h){f(l&&!h?l:null,d)}function u(l,f){const{onlyCounts:d,group:h,maxFiles:m}=l;return d?f?t:i:h?f?e:o:m?f?r:a:f?n:s}return ru.
build=u,ru}var xs={},BS;function SB(){if(BS)return xs;BS=1;var t=xs&&xs.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(xs,"__esModule",{value:!0}),xs.build=void 0;const e=t(ro),n={withFileTypes:!0},r=(a,o,c,u,l)=>{if(u<0)return a.queue.dequeue(null,a);a.visited.push(o),a.counts.directories++,a.queue.enqueue(),e.default.readdir(o||".",n,(f,d=[])=>{l(d,c,u),a.queue.dequeue(a.options.suppressErrors?null:f,a)})},i=(a,o,c,u,l)=>{if(u<0)return;a.visited.push(o),
a.counts.directories++;let f=[];try{f=e.default.readdirSync(o||".",n)}catch(d){if(!a.options.suppressErrors)throw d}l(f,c,u)};function s(a){return a?i:r}return xs.build=s,xs}var iu={},US;function AB(){if(US)return iu;US=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.Queue=void 0;class t{onQueueEmpty;count=0;constructor(n){this.onQueueEmpty=n}enqueue(){this.count++}dequeue(n,r){(--this.count<=0||n)&&this.onQueueEmpty(n,r)}}return iu.Queue=t,iu}var su={},WS;function _B(){if(WS)return su;WS=
1,Object.defineProperty(su,"__esModule",{value:!0}),su.Counter=void 0;class t{_files=0;_directories=0;set files(n){this._files=n}get files(){return this._files}set directories(n){this._directories=n}get directories(){return this._directories}get dirs(){return this._directories}}return su.Counter=t,su}var HS;function KS(){if(HS)return cr;HS=1;var t=cr&&cr.__createBinding||(Object.create?function($,w,k,S){S===void 0&&(S=k);var D=Object.getOwnPropertyDescriptor(w,k);(!D||("get"in D?!w.__esModule:D.
writable||D.configurable))&&(D={enumerable:!0,get:function(){return w[k]}}),Object.defineProperty($,S,D)}:function($,w,k,S){S===void 0&&(S=k),$[S]=w[k]}),e=cr&&cr.__setModuleDefault||(Object.create?function($,w){Object.defineProperty($,"default",{enumerable:!0,value:w})}:function($,w){$.default=w}),n=cr&&cr.__importStar||function($){if($&&$.__esModule)return $;var w={};if($!=null)for(var k in $)k!=="default"&&Object.prototype.hasOwnProperty.call($,k)&&t(w,$,k);return e(w,$),w};Object.defineProperty(
cr,"__esModule",{value:!0}),cr.Walker=void 0;const r=mi,i=OS(),s=n(wB()),a=n(bB()),o=n($B()),c=n(RB()),u=n(kB()),l=n(TB()),f=n(EB()),d=n(SB()),h=AB(),m=_B();class b{root;isSynchronous;state;joinPath;pushDirectory;pushFile;getArray;groupFiles;resolveSymlink;walkDirectory;callbackInvoker;constructor(w,k,S){this.isSynchronous=!S,this.callbackInvoker=f.build(k,this.isSynchronous),this.root=(0,i.normalizePath)(w,k),this.state={root:this.root.slice(0,-1),paths:[""].slice(0,0),groups:[],counts:new m.Counter,
options:k,queue:new h.Queue((D,F)=>this.callbackInvoker(F,D,S)),symlinks:new Map,visited:[""].slice(0,0)},this.joinPath=s.build(this.root,k),this.pushDirectory=a.build(this.root,k),this.pushFile=o.build(k),this.getArray=c.build(k),this.groupFiles=u.build(k),this.resolveSymlink=l.build(k,this.isSynchronous),this.walkDirectory=d.build(this.isSynchronous)}start(){return this.walkDirectory(this.state,this.root,this.root,this.state.options.maxDepth,this.walk),this.isSynchronous?this.callbackInvoker(this.
state,null):null}walk=(w,k,S)=>{const{paths:D,options:{filters:F,resolveSymlinks:Y,excludeSymlinks:J,exclude:ie,maxFiles:re,signal:ye,useRealPaths:z,pathSeparator:E}}=this.state;if(ye&&ye.aborted||re&&D.length>re)return;this.pushDirectory(k,D,F);const R=this.getArray(this.state.paths);for(let M=0;M<w.length;++M){const _=w[M];if(_.isFile()||_.isSymbolicLink()&&!Y&&!J){const P=this.joinPath(_.name,k);this.pushFile(P,R,this.state.counts,F)}else if(_.isDirectory()){let P=s.joinDirectoryPath(_.name,k,
this.state.options.pathSeparator);if(ie&&ie(_.name,P))continue;this.walkDirectory(this.state,P,P,S-1,this.walk)}else if(_.isSymbolicLink()&&this.resolveSymlink){let P=s.joinPathWithBasePath(_.name,k);this.resolveSymlink(P,this.state,(I,Z)=>{if(I.isDirectory()){if(Z=(0,i.normalizePath)(Z,this.state.options),ie&&ie(_.name,z?Z:P+E))return;this.walkDirectory(this.state,Z,z?Z:P+E,S-1,this.walk)}else{Z=z?Z:P;const H=(0,r.basename)(Z),A=(0,i.normalizePath)((0,r.dirname)(Z),this.state.options);Z=this.joinPath(
H,A),this.pushFile(Z,R,this.state.counts,F)}})}}this.groupFiles(this.state.groups,k,R)}}return cr.Walker=b,cr}var VS;function CB(){if(VS)return Cs;VS=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.callback=Cs.promise=void 0;const t=KS();function e(r,i){return new Promise((s,a)=>{n(r,i,(o,c)=>{if(o)return a(o);s(c)})})}Cs.promise=e;function n(r,i,s){new t.Walker(r,i,s).start()}return Cs.callback=n,Cs}var au={},XS;function PB(){if(XS)return au;XS=1,Object.defineProperty(au,"__esModule",{value:!0}),
au.sync=void 0;const t=KS();function e(n,r){return new t.Walker(n,r).start()}return au.sync=e,au}var YS;function xB(){if(YS)return Qc;YS=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.APIBuilder=void 0;const t=CB(),e=PB();class n{root;options;constructor(i,s){this.root=i,this.options=s}withPromise(){return(0,t.promise)(this.root,this.options)}withCallback(i){(0,t.callback)(this.root,this.options,i)}sync(){return(0,e.sync)(this.root,this.options)}}return Qc.APIBuilder=n,Qc}var gy={},yy,JS;
function Hf(){if(JS)return yy;JS=1;const t="\\\\/",e=`[^${t}]`,n="\\.",r="\\+",i="\\?",s="\\/",a="(?=.)",o="[^/]",c=`(?:${s}|$)`,u=`(?:^|${s})`,l=`${n}{1,2}${c}`,f=`(?!${n})`,d=`(?!${u}${l})`,h=`(?!${n}{0,1}${c})`,m=`(?!${l})`,b=`[^.${s}]`,$=`${o}*?`,k={DOT_LITERAL:n,PLUS_LITERAL:r,QMARK_LITERAL:i,SLASH_LITERAL:s,ONE_CHAR:a,QMARK:o,END_ANCHOR:c,DOTS_SLASH:l,NO_DOT:f,NO_DOTS:d,NO_DOT_SLASH:h,NO_DOTS_SLASH:m,QMARK_NO_DOT:b,STAR:$,START_ANCHOR:u,SEP:"/"},S={...k,SLASH_LITERAL:`[${t}]`,QMARK:e,STAR:`${e}\
*?`,DOTS_SLASH:`${n}{1,2}(?:[${t}]|$)`,NO_DOT:`(?!${n})`,NO_DOTS:`(?!(?:^|[${t}])${n}{1,2}(?:[${t}]|$))`,NO_DOT_SLASH:`(?!${n}{0,1}(?:[${t}]|$))`,NO_DOTS_SLASH:`(?!${n}{1,2}(?:[${t}]|$))`,QMARK_NO_DOT:`[^.${t}]`,START_ANCHOR:`(?:^|[${t}])`,END_ANCHOR:`(?:[${t}]|$)`,SEP:"\\"},D={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",
upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};return yy={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:D,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,
CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,
CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(F){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${F.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"\
(?:",close:")"}}},globChars(F){return F===!0?S:k}},yy}var QS;function Kf(){return QS||(QS=1,function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:i}=Hf();t.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t.hasRegexChars=s=>r.test(s),t.isRegexChar=s=>s.length===1&&t.hasRegexChars(s),t.escapeRegex=s=>s.replace(i,"\\$1"),t.toPosixSlashes=s=>s.replace(e,"/"),t.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){const s=navigator.
platform.toLowerCase();return s==="win32"||s==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1},t.removeBackslashes=s=>s.replace(n,a=>a==="\\"?"":a),t.escapeLast=(s,a,o)=>{const c=s.lastIndexOf(a,o);return c===-1?s:s[c-1]==="\\"?t.escapeLast(s,a,c-1):`${s.slice(0,c)}\\${s.slice(c)}`},t.removePrefix=(s,a={})=>{let o=s;return o.startsWith("./")&&(o=o.slice(2),a.prefix="./"),o},t.wrapOutput=(s,a={},o={})=>{const c=o.contains?"":"^",u=o.contains?"":"$";let l=`${c}\
(?:${s})${u}`;return a.negated===!0&&(l=`(?:^(?!${l}).*$)`),l},t.basename=(s,{windows:a}={})=>{const o=s.split(a?/[\\/]/:"/"),c=o[o.length-1];return c===""?o[o.length-2]:c}}(gy)),gy}var vy,ZS;function DB(){if(ZS)return vy;ZS=1;const t=Kf(),{CHAR_ASTERISK:e,CHAR_AT:n,CHAR_BACKWARD_SLASH:r,CHAR_COMMA:i,CHAR_DOT:s,CHAR_EXCLAMATION_MARK:a,CHAR_FORWARD_SLASH:o,CHAR_LEFT_CURLY_BRACE:c,CHAR_LEFT_PARENTHESES:u,CHAR_LEFT_SQUARE_BRACKET:l,CHAR_PLUS:f,CHAR_QUESTION_MARK:d,CHAR_RIGHT_CURLY_BRACE:h,CHAR_RIGHT_PARENTHESES:m,
CHAR_RIGHT_SQUARE_BRACKET:b}=Hf(),$=S=>S===o||S===r,w=S=>{S.isPrefix!==!0&&(S.depth=S.isGlobstar?1/0:1)};return vy=(S,D)=>{const F=D||{},Y=S.length-1,J=F.parts===!0||F.scanToEnd===!0,ie=[],re=[],ye=[];let z=S,E=-1,R=0,M=0,_=!1,P=!1,I=!1,Z=!1,H=!1,A=!1,te=!1,me=!1,Ce=!1,L=!1,K=0,_e,ue,$e={value:"",depth:0,isGlob:!1};const Pe=()=>E>=Y,le=()=>z.charCodeAt(E+1),N=()=>(_e=ue,z.charCodeAt(++E));for(;E<Y;){ue=N();let Be;if(ue===r){te=$e.backslashes=!0,ue=N(),ue===c&&(A=!0);continue}if(A===!0||ue===c){for(K++;Pe()!==
!0&&(ue=N());){if(ue===r){te=$e.backslashes=!0,N();continue}if(ue===c){K++;continue}if(A!==!0&&ue===s&&(ue=N())===s){if(_=$e.isBrace=!0,I=$e.isGlob=!0,L=!0,J===!0)continue;break}if(A!==!0&&ue===i){if(_=$e.isBrace=!0,I=$e.isGlob=!0,L=!0,J===!0)continue;break}if(ue===h&&(K--,K===0)){A=!1,_=$e.isBrace=!0,L=!0;break}}if(J===!0)continue;break}if(ue===o){if(ie.push(E),re.push($e),$e={value:"",depth:0,isGlob:!1},L===!0)continue;if(_e===s&&E===R+1){R+=2;continue}M=E+1;continue}if(F.noext!==!0&&(ue===f||
ue===n||ue===e||ue===d||ue===a)===!0&&le()===u){if(I=$e.isGlob=!0,Z=$e.isExtglob=!0,L=!0,ue===a&&E===R&&(Ce=!0),J===!0){for(;Pe()!==!0&&(ue=N());){if(ue===r){te=$e.backslashes=!0,ue=N();continue}if(ue===m){I=$e.isGlob=!0,L=!0;break}}continue}break}if(ue===e){if(_e===e&&(H=$e.isGlobstar=!0),I=$e.isGlob=!0,L=!0,J===!0)continue;break}if(ue===d){if(I=$e.isGlob=!0,L=!0,J===!0)continue;break}if(ue===l){for(;Pe()!==!0&&(Be=N());){if(Be===r){te=$e.backslashes=!0,N();continue}if(Be===b){P=$e.isBracket=!0,
I=$e.isGlob=!0,L=!0;break}}if(J===!0)continue;break}if(F.nonegate!==!0&&ue===a&&E===R){me=$e.negated=!0,R++;continue}if(F.noparen!==!0&&ue===u){if(I=$e.isGlob=!0,J===!0){for(;Pe()!==!0&&(ue=N());){if(ue===u){te=$e.backslashes=!0,ue=N();continue}if(ue===m){L=!0;break}}continue}break}if(I===!0){if(L=!0,J===!0)continue;break}}F.noext===!0&&(Z=!1,I=!1);let j=z,fe="",B="";R>0&&(fe=z.slice(0,R),z=z.slice(R),M-=R),j&&I===!0&&M>0?(j=z.slice(0,M),B=z.slice(M)):I===!0?(j="",B=z):j=z,j&&j!==""&&j!=="/"&&j!==
z&&$(j.charCodeAt(j.length-1))&&(j=j.slice(0,-1)),F.unescape===!0&&(B&&(B=t.removeBackslashes(B)),j&&te===!0&&(j=t.removeBackslashes(j)));const de={prefix:fe,input:S,start:R,base:j,glob:B,isBrace:_,isBracket:P,isGlob:I,isExtglob:Z,isGlobstar:H,negated:me,negatedExtglob:Ce};if(F.tokens===!0&&(de.maxDepth=0,$(ue)||re.push($e),de.tokens=re),F.parts===!0||F.tokens===!0){let Be;for(let Qe=0;Qe<ie.length;Qe++){const oe=Be?Be+1:R,De=ie[Qe],ne=S.slice(oe,De);F.tokens&&(Qe===0&&R!==0?(re[Qe].isPrefix=!0,
re[Qe].value=fe):re[Qe].value=ne,w(re[Qe]),de.maxDepth+=re[Qe].depth),(Qe!==0||ne!=="")&&ye.push(ne),Be=De}if(Be&&Be+1<S.length){const Qe=S.slice(Be+1);ye.push(Qe),F.tokens&&(re[re.length-1].value=Qe,w(re[re.length-1]),de.maxDepth+=re[re.length-1].depth)}de.slashes=ie,de.parts=ye}return de},vy}var wy,e0;function NB(){if(e0)return wy;e0=1;const t=Hf(),e=Kf(),{MAX_LENGTH:n,POSIX_REGEX_SOURCE:r,REGEX_NON_SPECIAL_CHARS:i,REGEX_SPECIAL_CHARS_BACKREF:s,REPLACEMENTS:a}=t,o=(l,f)=>{if(typeof f.expandRange==
"function")return f.expandRange(...l,f);l.sort();const d=`[${l.join("-")}]`;try{new RegExp(d)}catch{return l.map(m=>e.escapeRegex(m)).join("..")}return d},c=(l,f)=>`Missing ${l}: "${f}" - use "\\\\${f}" to match literal characters`,u=(l,f)=>{if(typeof l!="string")throw new TypeError("Expected a string");l=a[l]||l;const d={...f},h=typeof d.maxLength=="number"?Math.min(n,d.maxLength):n;let m=l.length;if(m>h)throw new SyntaxError(`Input length: ${m}, exceeds maximum allowed length: ${h}`);const b={
type:"bos",value:"",output:d.prepend||""},$=[b],w=d.capture?"":"?:",k=t.globChars(d.windows),S=t.extglobChars(k),{DOT_LITERAL:D,PLUS_LITERAL:F,SLASH_LITERAL:Y,ONE_CHAR:J,DOTS_SLASH:ie,NO_DOT:re,NO_DOT_SLASH:ye,NO_DOTS_SLASH:z,QMARK:E,QMARK_NO_DOT:R,STAR:M,START_ANCHOR:_}=k,P=oe=>`(${w}(?:(?!${_}${oe.dot?ie:D}).)*?)`,I=d.dot?"":re,Z=d.dot?E:R;let H=d.bash===!0?P(d):M;d.capture&&(H=`(${H})`),typeof d.noext=="boolean"&&(d.noextglob=d.noext);const A={input:l,index:-1,start:0,dot:d.dot===!0,consumed:"",
output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:$};l=e.removePrefix(l,A),m=l.length;const te=[],me=[],Ce=[];let L=b,K;const _e=()=>A.index===m-1,ue=A.peek=(oe=1)=>l[A.index+oe],$e=A.advance=()=>l[++A.index]||"",Pe=()=>l.slice(A.index+1),le=(oe="",De=0)=>{A.consumed+=oe,A.index+=De},N=oe=>{A.output+=oe.output!=null?oe.output:oe.value,le(oe.value)},j=()=>{let oe=1;for(;ue()==="!"&&(ue(2)!=="("||ue(3)==="?");)$e(),A.start++,oe++;return oe%2===0?!1:
(A.negated=!0,A.start++,!0)},fe=oe=>{A[oe]++,Ce.push(oe)},B=oe=>{A[oe]--,Ce.pop()},de=oe=>{if(L.type==="globstar"){const De=A.braces>0&&(oe.type==="comma"||oe.type==="brace"),ne=oe.extglob===!0||te.length&&(oe.type==="pipe"||oe.type==="paren");oe.type!=="slash"&&oe.type!=="paren"&&!De&&!ne&&(A.output=A.output.slice(0,-L.output.length),L.type="star",L.value="*",L.output=H,A.output+=L.output)}if(te.length&&oe.type!=="paren"&&(te[te.length-1].inner+=oe.value),(oe.value||oe.output)&&N(oe),L&&L.type===
"text"&&oe.type==="text"){L.output=(L.output||L.value)+oe.value,L.value+=oe.value;return}oe.prev=L,$.push(oe),L=oe},Be=(oe,De)=>{const ne={...S[De],conditions:1,inner:""};ne.prev=L,ne.parens=A.parens,ne.output=A.output;const Re=(d.capture?"(":"")+ne.open;fe("parens"),de({type:oe,value:De,output:A.output?"":J}),de({type:"paren",extglob:!0,value:$e(),output:Re}),te.push(ne)},Qe=oe=>{let De=oe.close+(d.capture?")":""),ne;if(oe.type==="negate"){let Re=H;if(oe.inner&&oe.inner.length>1&&oe.inner.includes(
"/")&&(Re=P(d)),(Re!==H||_e()||/^\)+$/.test(Pe()))&&(De=oe.close=`)$))${Re}`),oe.inner.includes("*")&&(ne=Pe())&&/^\.[^\\/.]+$/.test(ne)){const Fe=u(ne,{...f,fastpaths:!1}).output;De=oe.close=`)${Fe})${Re})`}oe.prev.type==="bos"&&(A.negatedExtglob=!0)}de({type:"paren",extglob:!0,value:K,output:De}),B("parens")};if(d.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(l)){let oe=!1,De=l.replace(s,(ne,Re,Fe,ft,Ve,zt)=>ft==="\\"?(oe=!0,ne):ft==="?"?Re?Re+ft+(Ve?E.repeat(Ve.length):""):zt===0?Z+(Ve?E.repeat(
Ve.length):""):E.repeat(Fe.length):ft==="."?D.repeat(Fe.length):ft==="*"?Re?Re+ft+(Ve?H:""):H:Re?ne:`\\${ne}`);return oe===!0&&(d.unescape===!0?De=De.replace(/\\/g,""):De=De.replace(/\\+/g,ne=>ne.length%2===0?"\\\\":ne?"\\":"")),De===l&&d.contains===!0?(A.output=l,A):(A.output=e.wrapOutput(De,A,f),A)}for(;!_e();){if(K=$e(),K==="\0")continue;if(K==="\\"){const ne=ue();if(ne==="/"&&d.bash!==!0||ne==="."||ne===";")continue;if(!ne){K+="\\",de({type:"text",value:K});continue}const Re=/^\\+/.exec(Pe());
let Fe=0;if(Re&&Re[0].length>2&&(Fe=Re[0].length,A.index+=Fe,Fe%2!==0&&(K+="\\")),d.unescape===!0?K=$e():K+=$e(),A.brackets===0){de({type:"text",value:K});continue}}if(A.brackets>0&&(K!=="]"||L.value==="["||L.value==="[^")){if(d.posix!==!1&&K===":"){const ne=L.value.slice(1);if(ne.includes("[")&&(L.posix=!0,ne.includes(":"))){const Re=L.value.lastIndexOf("["),Fe=L.value.slice(0,Re),ft=L.value.slice(Re+2),Ve=r[ft];if(Ve){L.value=Fe+Ve,A.backtrack=!0,$e(),!b.output&&$.indexOf(L)===1&&(b.output=J);
continue}}}(K==="["&&ue()!==":"||K==="-"&&ue()==="]")&&(K=`\\${K}`),K==="]"&&(L.value==="["||L.value==="[^")&&(K=`\\${K}`),d.posix===!0&&K==="!"&&L.value==="["&&(K="^"),L.value+=K,N({value:K});continue}if(A.quotes===1&&K!=='"'){K=e.escapeRegex(K),L.value+=K,N({value:K});continue}if(K==='"'){A.quotes=A.quotes===1?0:1,d.keepQuotes===!0&&de({type:"text",value:K});continue}if(K==="("){fe("parens"),de({type:"paren",value:K});continue}if(K===")"){if(A.parens===0&&d.strictBrackets===!0)throw new SyntaxError(
c("opening","("));const ne=te[te.length-1];if(ne&&A.parens===ne.parens+1){Qe(te.pop());continue}de({type:"paren",value:K,output:A.parens?")":"\\)"}),B("parens");continue}if(K==="["){if(d.nobracket===!0||!Pe().includes("]")){if(d.nobracket!==!0&&d.strictBrackets===!0)throw new SyntaxError(c("closing","]"));K=`\\${K}`}else fe("brackets");de({type:"bracket",value:K});continue}if(K==="]"){if(d.nobracket===!0||L&&L.type==="bracket"&&L.value.length===1){de({type:"text",value:K,output:`\\${K}`});continue}
if(A.brackets===0){if(d.strictBrackets===!0)throw new SyntaxError(c("opening","["));de({type:"text",value:K,output:`\\${K}`});continue}B("brackets");const ne=L.value.slice(1);if(L.posix!==!0&&ne[0]==="^"&&!ne.includes("/")&&(K=`/${K}`),L.value+=K,N({value:K}),d.literalBrackets===!1||e.hasRegexChars(ne))continue;const Re=e.escapeRegex(L.value);if(A.output=A.output.slice(0,-L.value.length),d.literalBrackets===!0){A.output+=Re,L.value=Re;continue}L.value=`(${w}${Re}|${L.value})`,A.output+=L.value;continue}
if(K==="{"&&d.nobrace!==!0){fe("braces");const ne={type:"brace",value:K,output:"(",outputIndex:A.output.length,tokensIndex:A.tokens.length};me.push(ne),de(ne);continue}if(K==="}"){const ne=me[me.length-1];if(d.nobrace===!0||!ne){de({type:"text",value:K,output:K});continue}let Re=")";if(ne.dots===!0){const Fe=$.slice(),ft=[];for(let Ve=Fe.length-1;Ve>=0&&($.pop(),Fe[Ve].type!=="brace");Ve--)Fe[Ve].type!=="dots"&&ft.unshift(Fe[Ve].value);Re=o(ft,d),A.backtrack=!0}if(ne.comma!==!0&&ne.dots!==!0){const Fe=A.
output.slice(0,ne.outputIndex),ft=A.tokens.slice(ne.tokensIndex);ne.value=ne.output="\\{",K=Re="\\}",A.output=Fe;for(const Ve of ft)A.output+=Ve.output||Ve.value}de({type:"brace",value:K,output:Re}),B("braces"),me.pop();continue}if(K==="|"){te.length>0&&te[te.length-1].conditions++,de({type:"text",value:K});continue}if(K===","){let ne=K;const Re=me[me.length-1];Re&&Ce[Ce.length-1]==="braces"&&(Re.comma=!0,ne="|"),de({type:"comma",value:K,output:ne});continue}if(K==="/"){if(L.type==="dot"&&A.index===
A.start+1){A.start=A.index+1,A.consumed="",A.output="",$.pop(),L=b;continue}de({type:"slash",value:K,output:Y});continue}if(K==="."){if(A.braces>0&&L.type==="dot"){L.value==="."&&(L.output=D);const ne=me[me.length-1];L.type="dots",L.output+=K,L.value+=K,ne.dots=!0;continue}if(A.braces+A.parens===0&&L.type!=="bos"&&L.type!=="slash"){de({type:"text",value:K,output:D});continue}de({type:"dot",value:K,output:D});continue}if(K==="?"){if(!(L&&L.value==="(")&&d.noextglob!==!0&&ue()==="("&&ue(2)!=="?"){
Be("qmark",K);continue}if(L&&L.type==="paren"){const Re=ue();let Fe=K;(L.value==="("&&!/[!=<:]/.test(Re)||Re==="<"&&!/<([!=]|\w+>)/.test(Pe()))&&(Fe=`\\${K}`),de({type:"text",value:K,output:Fe});continue}if(d.dot!==!0&&(L.type==="slash"||L.type==="bos")){de({type:"qmark",value:K,output:R});continue}de({type:"qmark",value:K,output:E});continue}if(K==="!"){if(d.noextglob!==!0&&ue()==="("&&(ue(2)!=="?"||!/[!=<:]/.test(ue(3)))){Be("negate",K);continue}if(d.nonegate!==!0&&A.index===0){j();continue}}if(K===
"+"){if(d.noextglob!==!0&&ue()==="("&&ue(2)!=="?"){Be("plus",K);continue}if(L&&L.value==="("||d.regex===!1){de({type:"plus",value:K,output:F});continue}if(L&&(L.type==="bracket"||L.type==="paren"||L.type==="brace")||A.parens>0){de({type:"plus",value:K});continue}de({type:"plus",value:F});continue}if(K==="@"){if(d.noextglob!==!0&&ue()==="("&&ue(2)!=="?"){de({type:"at",extglob:!0,value:K,output:""});continue}de({type:"text",value:K});continue}if(K!=="*"){(K==="$"||K==="^")&&(K=`\\${K}`);const ne=i.
exec(Pe());ne&&(K+=ne[0],A.index+=ne[0].length),de({type:"text",value:K});continue}if(L&&(L.type==="globstar"||L.star===!0)){L.type="star",L.star=!0,L.value+=K,L.output=H,A.backtrack=!0,A.globstar=!0,le(K);continue}let oe=Pe();if(d.noextglob!==!0&&/^\([^?]/.test(oe)){Be("star",K);continue}if(L.type==="star"){if(d.noglobstar===!0){le(K);continue}const ne=L.prev,Re=ne.prev,Fe=ne.type==="slash"||ne.type==="bos",ft=Re&&(Re.type==="star"||Re.type==="globstar");if(d.bash===!0&&(!Fe||oe[0]&&oe[0]!=="/")){
de({type:"star",value:K,output:""});continue}const Ve=A.braces>0&&(ne.type==="comma"||ne.type==="brace"),zt=te.length&&(ne.type==="pipe"||ne.type==="paren");if(!Fe&&ne.type!=="paren"&&!Ve&&!zt){de({type:"star",value:K,output:""});continue}for(;oe.slice(0,3)==="/**";){const Bt=l[A.index+4];if(Bt&&Bt!=="/")break;oe=oe.slice(3),le("/**",3)}if(ne.type==="bos"&&_e()){L.type="globstar",L.value+=K,L.output=P(d),A.output=L.output,A.globstar=!0,le(K);continue}if(ne.type==="slash"&&ne.prev.type!=="bos"&&!ft&&
_e()){A.output=A.output.slice(0,-(ne.output+L.output).length),ne.output=`(?:${ne.output}`,L.type="globstar",L.output=P(d)+(d.strictSlashes?")":"|$)"),L.value+=K,A.globstar=!0,A.output+=ne.output+L.output,le(K);continue}if(ne.type==="slash"&&ne.prev.type!=="bos"&&oe[0]==="/"){const Bt=oe[1]!==void 0?"|$":"";A.output=A.output.slice(0,-(ne.output+L.output).length),ne.output=`(?:${ne.output}`,L.type="globstar",L.output=`${P(d)}${Y}|${Y}${Bt})`,L.value+=K,A.output+=ne.output+L.output,A.globstar=!0,le(
K+$e()),de({type:"slash",value:"/",output:""});continue}if(ne.type==="bos"&&oe[0]==="/"){L.type="globstar",L.value+=K,L.output=`(?:^|${Y}|${P(d)}${Y})`,A.output=L.output,A.globstar=!0,le(K+$e()),de({type:"slash",value:"/",output:""});continue}A.output=A.output.slice(0,-L.output.length),L.type="globstar",L.output=P(d),L.value+=K,A.output+=L.output,A.globstar=!0,le(K);continue}const De={type:"star",value:K,output:H};if(d.bash===!0){De.output=".*?",(L.type==="bos"||L.type==="slash")&&(De.output=I+De.
output),de(De);continue}if(L&&(L.type==="bracket"||L.type==="paren")&&d.regex===!0){De.output=K,de(De);continue}(A.index===A.start||L.type==="slash"||L.type==="dot")&&(L.type==="dot"?(A.output+=ye,L.output+=ye):d.dot===!0?(A.output+=z,L.output+=z):(A.output+=I,L.output+=I),ue()!=="*"&&(A.output+=J,L.output+=J)),de(De)}for(;A.brackets>0;){if(d.strictBrackets===!0)throw new SyntaxError(c("closing","]"));A.output=e.escapeLast(A.output,"["),B("brackets")}for(;A.parens>0;){if(d.strictBrackets===!0)throw new SyntaxError(
c("closing",")"));A.output=e.escapeLast(A.output,"("),B("parens")}for(;A.braces>0;){if(d.strictBrackets===!0)throw new SyntaxError(c("closing","}"));A.output=e.escapeLast(A.output,"{"),B("braces")}if(d.strictSlashes!==!0&&(L.type==="star"||L.type==="bracket")&&de({type:"maybe_slash",value:"",output:`${Y}?`}),A.backtrack===!0){A.output="";for(const oe of A.tokens)A.output+=oe.output!=null?oe.output:oe.value,oe.suffix&&(A.output+=oe.suffix)}return A};return u.fastpaths=(l,f)=>{const d={...f},h=typeof d.
maxLength=="number"?Math.min(n,d.maxLength):n,m=l.length;if(m>h)throw new SyntaxError(`Input length: ${m}, exceeds maximum allowed length: ${h}`);l=a[l]||l;const{DOT_LITERAL:b,SLASH_LITERAL:$,ONE_CHAR:w,DOTS_SLASH:k,NO_DOT:S,NO_DOTS:D,NO_DOTS_SLASH:F,STAR:Y,START_ANCHOR:J}=t.globChars(d.windows),ie=d.dot?D:S,re=d.dot?F:S,ye=d.capture?"":"?:",z={negated:!1,prefix:""};let E=d.bash===!0?".*?":Y;d.capture&&(E=`(${E})`);const R=I=>I.noglobstar===!0?E:`(${ye}(?:(?!${J}${I.dot?k:b}).)*?)`,M=I=>{switch(I){case"\
*":return`${ie}${w}${E}`;case".*":return`${b}${w}${E}`;case"*.*":return`${ie}${E}${b}${w}${E}`;case"*/*":return`${ie}${E}${$}${w}${re}${E}`;case"**":return ie+R(d);case"**/*":return`(?:${ie}${R(d)}${$})?${re}${w}${E}`;case"**/*.*":return`(?:${ie}${R(d)}${$})?${re}${E}${b}${w}${E}`;case"**/.*":return`(?:${ie}${R(d)}${$})?${b}${w}${E}`;default:{const Z=/^(.*?)\.(\w+)$/.exec(I);if(!Z)return;const H=M(Z[1]);return H?H+b+Z[2]:void 0}}},_=e.removePrefix(l,z);let P=M(_);return P&&d.strictSlashes!==!0&&
(P+=`${$}?`),P},wy=u,wy}var by,t0;function IB(){if(t0)return by;t0=1;const t=DB(),e=NB(),n=Kf(),r=Hf(),i=a=>a&&typeof a=="object"&&!Array.isArray(a),s=(a,o,c=!1)=>{if(Array.isArray(a)){const $=a.map(k=>s(k,o,c));return k=>{for(const S of $){const D=S(k);if(D)return D}return!1}}const u=i(a)&&a.tokens&&a.input;if(a===""||typeof a!="string"&&!u)throw new TypeError("Expected pattern to be a non-empty string");const l=o||{},f=l.windows,d=u?s.compileRe(a,o):s.makeRe(a,o,!1,!0),h=d.state;delete d.state;
let m=()=>!1;if(l.ignore){const $={...o,ignore:null,onMatch:null,onResult:null};m=s(l.ignore,$,c)}const b=($,w=!1)=>{const{isMatch:k,match:S,output:D}=s.test($,d,o,{glob:a,posix:f}),F={glob:a,state:h,regex:d,posix:f,input:$,output:D,match:S,isMatch:k};return typeof l.onResult=="function"&&l.onResult(F),k===!1?(F.isMatch=!1,w?F:!1):m($)?(typeof l.onIgnore=="function"&&l.onIgnore(F),F.isMatch=!1,w?F:!1):(typeof l.onMatch=="function"&&l.onMatch(F),w?F:!0)};return c&&(b.state=h),b};return s.test=(a,o,c,{
glob:u,posix:l}={})=>{if(typeof a!="string")throw new TypeError("Expected input to be a string");if(a==="")return{isMatch:!1,output:""};const f=c||{},d=f.format||(l?n.toPosixSlashes:null);let h=a===u,m=h&&d?d(a):a;return h===!1&&(m=d?d(a):a,h=m===u),(h===!1||f.capture===!0)&&(f.matchBase===!0||f.basename===!0?h=s.matchBase(a,o,c,l):h=o.exec(m)),{isMatch:!!h,match:h,output:m}},s.matchBase=(a,o,c)=>(o instanceof RegExp?o:s.makeRe(o,c)).test(n.basename(a)),s.isMatch=(a,o,c)=>s(o,c)(a),s.parse=(a,o)=>Array.
isArray(a)?a.map(c=>s.parse(c,o)):e(a,{...o,fastpaths:!1}),s.scan=(a,o)=>t(a,o),s.compileRe=(a,o,c=!1,u=!1)=>{if(c===!0)return a.output;const l=o||{},f=l.contains?"":"^",d=l.contains?"":"$";let h=`${f}(?:${a.output})${d}`;a&&a.negated===!0&&(h=`^(?!${h}).*$`);const m=s.toRegex(h,o);return u===!0&&(m.state=a),m},s.makeRe=(a,o={},c=!1,u=!1)=>{if(!a||typeof a!="string")throw new TypeError("Expected a non-empty string");let l={negated:!1,fastpaths:!0};return o.fastpaths!==!1&&(a[0]==="."||a[0]==="*")&&
(l.output=e.fastpaths(a,o)),l.output||(l=e(a,o)),s.compileRe(l,o,c,u)},s.toRegex=(a,o)=>{try{const c=o||{};return new RegExp(a,c.flags||(c.nocase?"i":""))}catch(c){if(o&&o.debug===!0)throw c;return/$^/}},s.constants=r,by=s,by}var $y,n0;function OB(){if(n0)return $y;n0=1;const t=IB(),e=Kf();function n(r,i,s=!1){return i&&(i.windows===null||i.windows===void 0)&&(i={...i,windows:e.isWindows()}),t(r,i,s)}return Object.assign(n,t),$y=n,$y}var r0;function LB(){if(r0)return Jc;r0=1,Object.defineProperty(
Jc,"__esModule",{value:!0}),Jc.Builder=void 0;const t=mi,e=xB();var n=null;try{require.resolve("picomatch"),n=OB()}catch{}class r{globCache={};options={maxDepth:1/0,suppressErrors:!0,pathSeparator:t.sep,filters:[]};globFunction;constructor(s){this.options={...this.options,...s},this.globFunction=this.options.globFunction}group(){return this.options.group=!0,this}withPathSeparator(s){return this.options.pathSeparator=s,this}withBasePath(){return this.options.includeBasePath=!0,this}withRelativePaths(){
return this.options.relativePaths=!0,this}withDirs(){return this.options.includeDirs=!0,this}withMaxDepth(s){return this.options.maxDepth=s,this}withMaxFiles(s){return this.options.maxFiles=s,this}withFullPaths(){return this.options.resolvePaths=!0,this.options.includeBasePath=!0,this}withErrors(){return this.options.suppressErrors=!1,this}withSymlinks({resolvePaths:s=!0}={}){return this.options.resolveSymlinks=!0,this.options.useRealPaths=s,this.withFullPaths()}withAbortSignal(s){return this.options.
signal=s,this}normalize(){return this.options.normalizePath=!0,this}filter(s){return this.options.filters.push(s),this}onlyDirs(){return this.options.excludeFiles=!0,this.options.includeDirs=!0,this}exclude(s){return this.options.exclude=s,this}onlyCounts(){return this.options.onlyCounts=!0,this}crawl(s){return new e.APIBuilder(s||".",this.options)}withGlobFunction(s){return this.globFunction=s,this}crawlWithOptions(s,a){return this.options={...this.options,...a},new e.APIBuilder(s||".",this.options)}glob(...s){
return this.globFunction?this.globWithOptions(s):this.globWithOptions(s,{dot:!0})}globWithOptions(s,...a){const o=this.globFunction||n;if(!o)throw new Error("Please specify a glob function to use glob matching.");var c=this.globCache[s.join("\0")];return c||(c=o(s,...a),this.globCache[s.join("\0")]=c),this.options.filters.push(u=>c(u)),this}}return Jc.Builder=r,Jc}var Ry={},i0;function MB(){return i0||(i0=1,Object.defineProperty(Ry,"__esModule",{value:!0})),Ry}var s0;function zB(){return s0||(s0=
1,function(t){var e=_s&&_s.__createBinding||(Object.create?function(i,s,a,o){o===void 0&&(o=a);var c=Object.getOwnPropertyDescriptor(s,a);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(i,o,c)}:function(i,s,a,o){o===void 0&&(o=a),i[o]=s[a]}),n=_s&&_s.__exportStar||function(i,s){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,i,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.fdir=
void 0;const r=LB();Object.defineProperty(t,"fdir",{enumerable:!0,get:function(){return r.Builder}}),n(MB(),t)}(_s)),_s}var FB=zB();class qB{constructor(){this.encoding="utf-8"}readFile(e){return sw.promises.readFile(e.fsPath,this.encoding)}async readDirectory(e){return(await sw.promises.readdir(e.fsPath,{withFileTypes:!0})).map(r=>({dirent:r,isFile:r.isFile(),isDirectory:r.isDirectory(),uri:Et.joinPath(e,r.name)}))}}const Vf="DeploymentElement";function a0(t){return W.isInstance(t,Vf)}const ky="\
DeploymentNodeOrElementKind",Xf="DeploymentViewRule";function GB(t){return W.isInstance(t,Xf)}const ou="DynamicViewRule";function Yf(t){return W.isInstance(t,ou)}const cu="ElementExpression";function Ty(t){return W.isInstance(t,cu)}const Jf="ElementPredicate";function jB(t){return W.isInstance(t,Jf)}const Qf="ElementPredicateOrWhere";function BB(t){return W.isInstance(t,Qf)}const Zf="ElementPredicateOrWhereV2";function UB(t){return W.isInstance(t,Zf)}const Ds="ElementProperty";function WB(t){return W.
isInstance(t,Ds)}const Ey="ExpressionV2";function HB(t){return W.isInstance(t,Ey)}const Sy="ExtendElementProperty",uu="FqnExpr";function KB(t){return W.isInstance(t,uu)}const Ay="FqnReferenceable",Ns="LikeC4View";function _y(t){return W.isInstance(t,Ns)}const eh="MetadataProperty";function Pi(t){return W.isInstance(t,eh)}const Cy="Predicate";function VB(t){return W.isInstance(t,Cy)}const lu="Referenceable",th="RelationExpr";function o0(t){return W.isInstance(t,th)}const nh="RelationExpression";function Py(t){
return W.isInstance(t,nh)}const rh="RelationPredicate";function XB(t){return W.isInstance(t,rh)}const ih="RelationPredicateOrWhere";function YB(t){return W.isInstance(t,ih)}const sh="RelationPredicateOrWhereV2";function JB(t){return W.isInstance(t,sh)}const du="RelationProperty",ah="RelationshipStyleProperty";function c0(t){return W.isInstance(t,ah)}const xy="SizeProperty";function QB(t){return W.isInstance(t,xy)}const Ea="StringProperty";function u0(t){return W.isInstance(t,Ea)}const Sa="StyleP\
roperty";function Dy(t){return W.isInstance(t,Sa)}const oh="ViewProperty";function ZB(t){return W.isInstance(t,oh)}const fu="ViewRule";function eU(t){return W.isInstance(t,fu)}const ch="ViewRulePredicate";function uh(t){return W.isInstance(t,ch)}const lh="ViewRuleStyleOrGlobalRef";function Ny(t){return W.isInstance(t,lh)}const hu="WhereElement";function l0(t){return W.isInstance(t,hu)}const pu="WhereElementExpression";function tU(t){return W.isInstance(t,pu)}const d0="WhereExpression",dh="WhereK\
indEqual";function nU(t){return W.isInstance(t,dh)}const mu="WhereRelation";function f0(t){return W.isInstance(t,mu)}const gu="WhereRelationExpression";function rU(t){return W.isInstance(t,gu)}const fh="WhereTagEqual";function iU(t){return W.isInstance(t,fh)}const yu="ArrowProperty";function vu(t){return W.isInstance(t,yu)}const wu="BorderProperty";function hh(t){return W.isInstance(t,wu)}const bu="ColorProperty";function Is(t){return W.isInstance(t,bu)}const Os="CustomColor",ph="CustomElementPr\
operties";function sU(t){return W.isInstance(t,ph)}const mh="CustomRelationProperties";function aU(t){return W.isInstance(t,mh)}const xi="DeployedInstance";function Cn(t){return W.isInstance(t,xi)}const gh="DeployedInstanceBody";function oU(t){return W.isInstance(t,gh)}const Ar="DeploymentNode";function Pn(t){return W.isInstance(t,Ar)}const yh="DeploymentNodeBody";function cU(t){return W.isInstance(t,yh)}const si="DeploymentNodeKind";function uU(t){return W.isInstance(t,si)}const vh="DeploymentR\
elation";function Di(t){return W.isInstance(t,vh)}const wh="DeploymentRelationBody";function lU(t){return W.isInstance(t,wh)}const $u="DeploymentView";function Iy(t){return W.isInstance(t,$u)}const bh="DeploymentViewBody";function dU(t){return W.isInstance(t,bh)}const Ru="DeploymentViewRulePredicate";function Aa(t){return W.isInstance(t,Ru)}const $h="DeploymentViewRulePredicateExpression";function fU(t){return W.isInstance(t,$h)}const ku="DeploymentViewRuleStyle";function h0(t){return W.isInstance(
t,ku)}const Tu="DirectedRelationExpr";function Oy(t){return W.isInstance(t,Tu)}const Eu="DirectedRelationExpression";function Ly(t){return W.isInstance(t,Eu)}const _a="DynamicView";function p0(t){return W.isInstance(t,_a)}const Rh="DynamicViewBody";function hU(t){return W.isInstance(t,Rh)}const Su="DynamicViewGlobalPredicateRef";function m0(t){return W.isInstance(t,Su)}const Au="DynamicViewIncludePredicate";function pU(t){return W.isInstance(t,Au)}const kh="DynamicViewParallelSteps";function My(t){
return W.isInstance(t,kh)}const Th="DynamicViewPredicateIterator";function g0(t){return W.isInstance(t,Th)}const zy="DynamicViewRef",Eh="DynamicViewStep";function Fy(t){return W.isInstance(t,Eh)}const ur="Element";function wn(t){return W.isInstance(t,ur)}const Sh="ElementBody";function _u(t){return W.isInstance(t,Sh)}const Cu="ElementDescedantsExpression";function qy(t){return W.isInstance(t,Cu)}const Ah="ElementExpressionsIterator";function mU(t){return W.isInstance(t,Ah)}const ai="ElementKind";
function y0(t){return W.isInstance(t,ai)}const Pu="ElementKindExpression";function _h(t){return W.isInstance(t,Pu)}const xu="ElementPredicateWhere";function Gy(t){return W.isInstance(t,xu)}const Du="ElementPredicateWhereV2";function gU(t){return W.isInstance(t,Du)}const Nu="ElementPredicateWith";function Ch(t){return W.isInstance(t,Nu)}const Iu="ElementRef";function Ou(t){return W.isInstance(t,Iu)}const Lu="ElementStringProperty";function Mu(t){return W.isInstance(t,Lu)}const zu="ElementStylePro\
perty";function Ni(t){return W.isInstance(t,zu)}const Fu="ElementTagExpression";function Ph(t){return W.isInstance(t,Fu)}const Ca="ElementView";function xh(t){return W.isInstance(t,Ca)}const Dh="ElementViewBody";function v0(t){return W.isInstance(t,Dh)}const jy="ElementViewRef",qu="ExcludePredicate";function Gu(t){return W.isInstance(t,qu)}const ju="ExpandElementExpression";function w0(t){return W.isInstance(t,ju)}const Bu="ExtendDeployment";function Ls(t){return W.isInstance(t,Bu)}const Nh="Ext\
endDeploymentBody";function yU(t){return W.isInstance(t,Nh)}const Ms="ExtendElement";function Pa(t){return W.isInstance(t,Ms)}const Ih="ExtendElementBody";function b0(t){return W.isInstance(t,Ih)}const Oh="FqnExpressions";function vU(t){return W.isInstance(t,Oh)}const Lh="FqnRef";function $0(t){return W.isInstance(t,Lh)}const Uu="FqnRefExpr";function By(t){return W.isInstance(t,Uu)}const xa="GlobalDynamicPredicateGroup";function Wu(t){return W.isInstance(t,xa)}const Da="GlobalPredicateGroup";function Hu(t){
return W.isInstance(t,Da)}const Na="Globals";function Uy(t){return W.isInstance(t,Na)}const Mh="GlobalStyle";function Ia(t){return W.isInstance(t,Mh)}const zh="GlobalStyleGroup";function zs(t){return W.isInstance(t,zh)}const Ku="GlobalStyleId",Vu="IconProperty";function _r(t){return W.isInstance(t,Vu)}const Xu="IncludePredicate";function Fh(t){return W.isInstance(t,Xu)}const Yu="IncomingRelationExpr";function Wy(t){return W.isInstance(t,Yu)}const Ju="IncomingRelationExpression";function R0(t){return W.
isInstance(t,Ju)}const Qu="InOutRelationExpr";function k0(t){return W.isInstance(t,Qu)}const Zu="InOutRelationExpression";function Hy(t){return W.isInstance(t,Zu)}const Fs="LibIcon";function wU(t){return W.isInstance(t,Fs)}const qh="LikeC4Grammar";function bU(t){return W.isInstance(t,qh)}const Gh="LikeC4Lib";function T0(t){return W.isInstance(t,Gh)}const el="LineProperty";function tl(t){return W.isInstance(t,el)}const nl="LinkProperty";function jh(t){return W.isInstance(t,nl)}const rl="MetadataA\
ttribute";function $U(t){return W.isInstance(t,rl)}const il="MetadataBody";function RU(t){return W.isInstance(t,il)}const Oa="Model";function E0(t){return W.isInstance(t,Oa)}const La="ModelDeployments";function S0(t){return W.isInstance(t,La)}const Ma="ModelViews";function sl(t){return W.isInstance(t,Ma)}const al="MultipleProperty";function Ky(t){return W.isInstance(t,al)}const Bh="NavigateToProperty";function Uh(t){return W.isInstance(t,Bh)}const ol="NotationProperty";function za(t){return W.isInstance(
t,ol)}const cl="NotesProperty";function A0(t){return W.isInstance(t,cl)}const ul="OpacityProperty";function Wh(t){return W.isInstance(t,ul)}const ll="OutgoingRelationExpr";function Vy(t){return W.isInstance(t,ll)}const dl="OutgoingRelationExpression";function Xy(t){return W.isInstance(t,dl)}const fl="PaddingSizeProperty";function Yy(t){return W.isInstance(t,fl)}const Hh="Predicates";function _0(t){return W.isInstance(t,Hh)}const Kh="Relation";function oi(t){return W.isInstance(t,Kh)}const Vh="Re\
lationBody";function kU(t){return W.isInstance(t,Vh)}const hl="RelationNavigateToProperty";function pl(t){return W.isInstance(t,hl)}const ml="RelationPredicateWhere";function Jy(t){return W.isInstance(t,ml)}const gl="RelationPredicateWhereV2";function TU(t){return W.isInstance(t,gl)}const yl="RelationPredicateWith";function Qy(t){return W.isInstance(t,yl)}const Ii="RelationshipKind";function EU(t){return W.isInstance(t,Ii)}const vl="RelationStringProperty";function wl(t){return W.isInstance(t,vl)}
const bl="RelationStyleProperty";function Xh(t){return W.isInstance(t,bl)}const $l="ShapeProperty";function Yh(t){return W.isInstance(t,$l)}const Rl="ShapeSizeProperty";function Zy(t){return W.isInstance(t,Rl)}const Jh="SpecificationColor";function Qh(t){return W.isInstance(t,Jh)}const Fa="SpecificationDeploymentNodeKind";function qa(t){return W.isInstance(t,Fa)}const Ga="SpecificationElementKind";function ja(t){return W.isInstance(t,Ga)}const kl="SpecificationElementStringProperty";function ev(t){
return W.isInstance(t,kl)}const Ba="SpecificationRelationshipKind";function Ua(t){return W.isInstance(t,Ba)}const Tl="SpecificationRelationshipStringProperty";function C0(t){return W.isInstance(t,Tl)}const Wa="SpecificationRule";function tv(t){return W.isInstance(t,Wa)}const Ha="SpecificationTag";function Zh(t){return W.isInstance(t,Ha)}const ep="StrictFqnElementRef";function P0(t){return W.isInstance(t,ep)}const tp="StrictFqnRef";function x0(t){return W.isInstance(t,tp)}const Oi="Tag";function D0(t){
return W.isInstance(t,Oi)}const np="Tags";function nv(t){return W.isInstance(t,np)}const El="TextSizeProperty";function rv(t){return W.isInstance(t,El)}const iv="ViewRef",Sl="ViewRuleAutoLayout";function Al(t){return W.isInstance(t,Sl)}const _l="ViewRuleGlobalPredicateRef";function sv(t){return W.isInstance(t,_l)}const Cl="ViewRuleGlobalStyle";function av(t){return W.isInstance(t,Cl)}const Pl="ViewRuleGroup";function rp(t){return W.isInstance(t,Pl)}const xl="ViewRuleStyle";function Dl(t){return W.
isInstance(t,xl)}const Nl="ViewStringProperty";function SU(t){return W.isInstance(t,Nl)}const Il="WhereBinaryExpression";function AU(t){return W.isInstance(t,Il)}const Ol="WhereElementKind";function _U(t){return W.isInstance(t,Ol)}const Ll="WhereElementNegation";function N0(t){return W.isInstance(t,Ll)}const Ml="WhereElementTag";function CU(t){return W.isInstance(t,Ml)}const zl="WhereRelationKind";function I0(t){return W.isInstance(t,zl)}const Fl="WhereRelationNegation";function O0(t){return W.isInstance(
t,Fl)}const ql="WhereRelationParticipantKind";function L0(t){return W.isInstance(t,ql)}const Gl="WhereRelationParticipantTag";function M0(t){return W.isInstance(t,Gl)}const jl="WhereRelationTag";function PU(t){return W.isInstance(t,jl)}const Bl="WildcardExpression";function qs(t){return W.isInstance(t,Bl)}class z0 extends rb{getAllTypes(){return[yu,wu,bu,Os,ph,mh,xi,gh,Vf,Ar,yh,si,ky,vh,wh,$u,bh,Xf,Ru,$h,ku,Tu,Eu,_a,Rh,Su,Au,kh,Th,zy,ou,Eh,ur,Sh,Cu,cu,Ah,ai,Pu,Jf,Qf,Zf,xu,Du,Nu,Ds,Iu,Lu,zu,Fu,Ca,
Dh,jy,qu,ju,Ey,Bu,Nh,Ms,Ih,Sy,uu,Oh,Lh,Uu,Ay,xa,Da,Mh,zh,Ku,Na,Vu,Qu,Zu,Xu,Yu,Ju,Fs,qh,Gh,Ns,el,nl,rl,il,eh,Oa,La,Ma,al,Bh,ol,cl,ul,ll,dl,fl,Cy,Hh,lu,Kh,Vh,th,nh,hl,rh,ih,sh,ml,gl,yl,du,vl,bl,Ii,ah,$l,Rl,xy,Jh,Fa,Ga,kl,Ba,Tl,Wa,Ha,ep,tp,Ea,Sa,Oi,np,El,oh,iv,fu,Sl,_l,Cl,Pl,ch,xl,lh,Nl,Il,hu,pu,Ol,Ll,Ml,d0,dh,mu,gu,zl,Fl,ql,Gl,jl,fh,Bl]}computeIsSubtype(e,n){switch(e){case yu:case el:return this.isSubtype(ah,n);case wu:case al:case ul:case $l:return this.isSubtype(Sa,n);case bu:return this.isSubtype(
ah,n)||this.isSubtype(Sa,n);case xi:case Ar:return this.isSubtype(Vf,n)||this.isSubtype(lu,n);case si:case ai:return this.isSubtype(ky,n);case $u:case _a:case Ca:return this.isSubtype(Ns,n);case Ru:case ku:return this.isSubtype(Xf,n);case Tu:case Yu:case Qu:case ll:return this.isSubtype(th,n);case Eu:case Ju:case Zu:case dl:return this.isSubtype(nh,n);case Su:case Au:return this.isSubtype(ou,n);case ur:return this.isSubtype(Ay,n)||this.isSubtype(lu,n);case Cu:case Pu:case Iu:case Fu:case ju:return this.
isSubtype(cu,n);case cu:case xu:return this.isSubtype(Qf,n);case Jf:case rh:return this.isSubtype(Cy,n);case Qf:case Nu:return this.isSubtype(Jf,n);case Zf:case sh:return this.isSubtype(Ey,n);case Du:case uu:return this.isSubtype(Zf,n);case Lu:return this.isSubtype(Ds,n)||this.isSubtype(Ea,n);case zu:return this.isSubtype(Ds,n);case qu:case Xu:return this.isSubtype(ch,n);case Bu:case Ms:case lu:return this.isSubtype(Ay,n);case Uu:return this.isSubtype(uu,n);case Vu:return this.isSubtype(Ds,n)||this.
isSubtype(Sa,n);case nl:return this.isSubtype(Ds,n)||this.isSubtype(Sy,n)||this.isSubtype(du,n)||this.isSubtype(oh,n);case rl:case ol:case cl:case kl:case Tl:return this.isSubtype(Ea,n);case il:return this.isSubtype(eh,n);case eh:return this.isSubtype(Ds,n)||this.isSubtype(Sy,n)||this.isSubtype(du,n);case fl:case Rl:case El:return this.isSubtype(xy,n)||this.isSubtype(Sa,n);case th:case gl:return this.isSubtype(sh,n);case nh:case ml:return this.isSubtype(ih,n);case hl:case bl:return this.isSubtype(
du,n);case ih:case yl:return this.isSubtype(rh,n);case vl:return this.isSubtype(du,n)||this.isSubtype(Ea,n);case Sl:return this.isSubtype(Xf,n)||this.isSubtype(ou,n)||this.isSubtype(fu,n);case _l:case Pl:case ch:return this.isSubtype(fu,n);case Cl:case xl:return this.isSubtype(lh,n);case lh:return this.isSubtype(ou,n)||this.isSubtype(fu,n);case Nl:return this.isSubtype(Ea,n)||this.isSubtype(oh,n);case Il:return this.isSubtype(pu,n)||this.isSubtype(gu,n);case hu:case Ll:return this.isSubtype(pu,n);case pu:case gu:
return this.isSubtype(d0,n);case Ol:return this.isSubtype(hu,n)||this.isSubtype(dh,n);case Ml:return this.isSubtype(hu,n)||this.isSubtype(fh,n);case mu:case Fl:return this.isSubtype(gu,n);case zl:case ql:return this.isSubtype(dh,n)||this.isSubtype(mu,n);case Gl:case jl:return this.isSubtype(mu,n)||this.isSubtype(fh,n);case Bl:return this.isSubtype(cu,n)||this.isSubtype(uu,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"ColorProperty:customColo\
r":return Os;case"DeploymentNode:kind":return si;case"DeploymentRelation:kind":case"DynamicViewStep:kind":case"OutgoingRelationExpr:kind":case"OutgoingRelationExpression:kind":case"Relation:kind":case"WhereRelationKind:value":return Ii;case"DynamicViewGlobalPredicateRef:predicate":return xa;case"DynamicViewRef:view":return _a;case"Element:kind":case"ElementKindExpression:kind":return ai;case"ElementRef:el":case"StrictFqnElementRef:el":return ur;case"ElementTagExpression:tag":case"Tags:values":case"\
WhereElementTag:value":case"WhereRelationParticipantTag:value":case"WhereRelationTag:value":return Oi;case"ElementViewRef:view":return Ca;case"FqnRef:value":case"StrictFqnRef:value":return lu;case"IconProperty:libicon":return Fs;case"ViewRef:view":return Ns;case"ViewRuleGlobalPredicateRef:predicate":return Da;case"ViewRuleGlobalStyle:style":return Ku;case"WhereElementKind:value":case"WhereRelationParticipantKind:value":return ky;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){
switch(e){case yu:return{name:yu,properties:[{name:"key"},{name:"value"}]};case wu:return{name:wu,properties:[{name:"key"},{name:"value"}]};case bu:return{name:bu,properties:[{name:"customColor"},{name:"key"},{name:"themeColor"}]};case Os:return{name:Os,properties:[{name:"name"}]};case ph:return{name:ph,properties:[{name:"props",defaultValue:[]}]};case mh:return{name:mh,properties:[{name:"props",defaultValue:[]}]};case xi:return{name:xi,properties:[{name:"body"},{name:"element"},{name:"name"},{name:"\
title"}]};case gh:return{name:gh,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Ar:return{name:Ar,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"title"}]};case yh:return{name:yh,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case si:return{name:si,properties:[{name:"name"}]};case vh:return{name:vh,properties:[{name:"body"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case wh:
return{name:wh,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case $u:return{name:$u,properties:[{name:"body"},{name:"name"}]};case bh:return{name:bh,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case Ru:return{name:Ru,properties:[{name:"expr"},{name:"isInclude",defaultValue:!1}]};case $h:return{name:$h,properties:[{name:"prev"},{name:"value"}]};case ku:return{name:ku,properties:[{name:"props",defaultValue:[]},{name:"targets"}]};case Tu:return{
name:Tu,properties:[{name:"source"},{name:"target"}]};case Eu:return{name:Eu,properties:[{name:"source"},{name:"target"}]};case _a:return{name:_a,properties:[{name:"body"},{name:"name"}]};case Rh:return{name:Rh,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"steps",defaultValue:[]},{name:"tags"}]};case Su:return{name:Su,properties:[{name:"predicate"}]};case Au:return{name:Au,properties:[{name:"predicates"}]};case kh:return{name:kh,properties:[{name:"steps",defaultValue:[]}]};case Th:
return{name:Th,properties:[{name:"prev"},{name:"value"}]};case zy:return{name:zy,properties:[{name:"view"}]};case Eh:return{name:Eh,properties:[{name:"custom"},{name:"isBackward",defaultValue:!1},{name:"kind"},{name:"source"},{name:"target"},{name:"title"}]};case ur:return{name:ur,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"props",defaultValue:[]}]};case Sh:return{name:Sh,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Cu:return{
name:Cu,properties:[{name:"parent"},{name:"suffix"}]};case Ah:return{name:Ah,properties:[{name:"prev"},{name:"value"}]};case ai:return{name:ai,properties:[{name:"name"}]};case Pu:return{name:Pu,properties:[{name:"isEqual",defaultValue:!1},{name:"kind"}]};case xu:return{name:xu,properties:[{name:"subject"},{name:"where"}]};case Du:return{name:Du,properties:[{name:"subject"},{name:"where"}]};case Nu:return{name:Nu,properties:[{name:"custom"},{name:"subject"}]};case Iu:return{name:Iu,properties:[{name:"\
el"},{name:"parent"}]};case Lu:return{name:Lu,properties:[{name:"key"},{name:"value"}]};case zu:return{name:zu,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case Fu:return{name:Fu,properties:[{name:"isEqual",defaultValue:!1},{name:"tag"}]};case Ca:return{name:Ca,properties:[{name:"body"},{name:"extends"},{name:"name"},{name:"viewOf"}]};case Dh:return{name:Dh,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case jy:return{name:jy,properties:[{name:"\
view"}]};case qu:return{name:qu,properties:[{name:"predicates"}]};case ju:return{name:ju,properties:[{name:"expand"}]};case Bu:return{name:Bu,properties:[{name:"body"},{name:"deploymentNode"}]};case Nh:return{name:Nh,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ms:return{name:Ms,properties:[{name:"body"},{name:"element"}]};case Ih:return{name:Ih,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Oh:
return{name:Oh,properties:[{name:"prev"},{name:"value"}]};case Lh:return{name:Lh,properties:[{name:"parent"},{name:"value"}]};case Uu:return{name:Uu,properties:[{name:"ref"},{name:"selector"}]};case xa:return{name:xa,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case Da:return{name:Da,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case Na:return{name:Na,properties:[{name:"name"},{name:"predicates",defaultValue:[]},{name:"styles",defaultValue:[]}]};case Mh:return{
name:Mh,properties:[{name:"id"},{name:"props",defaultValue:[]},{name:"target"}]};case zh:return{name:zh,properties:[{name:"id"},{name:"styles",defaultValue:[]}]};case Ku:return{name:Ku,properties:[{name:"name"}]};case Vu:return{name:Vu,properties:[{name:"key"},{name:"libicon"},{name:"value"}]};case Xu:return{name:Xu,properties:[{name:"predicates"}]};case Yu:return{name:Yu,properties:[{name:"to"}]};case Ju:return{name:Ju,properties:[{name:"to"}]};case Qu:return{name:Qu,properties:[{name:"inout"}]};case Zu:
return{name:Zu,properties:[{name:"inout"}]};case Fs:return{name:Fs,properties:[{name:"name"}]};case qh:return{name:qh,properties:[{name:"deployments",defaultValue:[]},{name:"globals",defaultValue:[]},{name:"likec4lib",defaultValue:[]},{name:"models",defaultValue:[]},{name:"specifications",defaultValue:[]},{name:"views",defaultValue:[]}]};case Gh:return{name:Gh,properties:[{name:"icons",defaultValue:[]}]};case el:return{name:el,properties:[{name:"key"},{name:"value"}]};case nl:return{name:nl,properties:[
{name:"key"},{name:"title"},{name:"value"}]};case rl:return{name:rl,properties:[{name:"key"},{name:"value"}]};case il:return{name:il,properties:[{name:"props",defaultValue:[]}]};case Oa:return{name:Oa,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case La:return{name:La,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case Ma:return{name:Ma,properties:[{name:"name"},{name:"styles",defaultValue:[]},{name:"views",defaultValue:[]}]};case al:return{name:al,properties:[{name:"\
key"},{name:"value"}]};case Bh:return{name:Bh,properties:[{name:"key"},{name:"value"}]};case ol:return{name:ol,properties:[{name:"key"},{name:"value"}]};case cl:return{name:cl,properties:[{name:"key"},{name:"value"}]};case ul:return{name:ul,properties:[{name:"key"},{name:"value"}]};case ll:return{name:ll,properties:[{name:"from"},{name:"isBidirectional",defaultValue:!1},{name:"kind"}]};case dl:return{name:dl,properties:[{name:"from"},{name:"isBidirectional",defaultValue:!1},{name:"kind"}]};case fl:
return{name:fl,properties:[{name:"key"},{name:"value"}]};case Hh:return{name:Hh,properties:[{name:"prev"},{name:"value"}]};case Kh:return{name:Kh,properties:[{name:"body"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case Vh:return{name:Vh,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case hl:return{name:hl,properties:[{name:"key"},{name:"value"}]};case ml:return{name:ml,properties:[{name:"subject"},{name:"where"}]};case gl:return{
name:gl,properties:[{name:"subject"},{name:"where"}]};case yl:return{name:yl,properties:[{name:"custom"},{name:"subject"}]};case Ii:return{name:Ii,properties:[{name:"name"}]};case vl:return{name:vl,properties:[{name:"key"},{name:"value"}]};case bl:return{name:bl,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case $l:return{name:$l,properties:[{name:"key"},{name:"value"}]};case Rl:return{name:Rl,properties:[{name:"key"},{name:"value"}]};case Jh:return{name:Jh,properties:[{name:"color"},
{name:"name"}]};case Fa:return{name:Fa,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case Ga:return{name:Ga,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case kl:return{name:kl,properties:[{name:"key"},{name:"value"}]};case Ba:return{name:Ba,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case Tl:return{name:Tl,properties:[{name:"key"},{name:"value"}]};case Wa:return{name:Wa,properties:[{name:"colors",defaultValue:[]},{name:"deploymentNodes",defaultValue:[]},
{name:"elements",defaultValue:[]},{name:"name"},{name:"relationships",defaultValue:[]},{name:"tags",defaultValue:[]}]};case Ha:return{name:Ha,properties:[{name:"tag"}]};case ep:return{name:ep,properties:[{name:"el"},{name:"parent"}]};case tp:return{name:tp,properties:[{name:"parent"},{name:"value"}]};case Oi:return{name:Oi,properties:[{name:"name"}]};case np:return{name:np,properties:[{name:"prev"},{name:"values",defaultValue:[]}]};case El:return{name:El,properties:[{name:"key"},{name:"value"}]};case iv:
return{name:iv,properties:[{name:"view"}]};case Sl:return{name:Sl,properties:[{name:"direction"},{name:"nodeSep"},{name:"rankSep"}]};case _l:return{name:_l,properties:[{name:"predicate"}]};case Cl:return{name:Cl,properties:[{name:"style"}]};case Pl:return{name:Pl,properties:[{name:"groupRules",defaultValue:[]},{name:"props",defaultValue:[]},{name:"title"}]};case xl:return{name:xl,properties:[{name:"props",defaultValue:[]},{name:"target"}]};case Nl:return{name:Nl,properties:[{name:"key"},{name:"v\
alue"}]};case Il:return{name:Il,properties:[{name:"left"},{name:"operator"},{name:"right"}]};case Ol:return{name:Ol,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Ll:return{name:Ll,properties:[{name:"value"}]};case Ml:return{name:Ml,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case zl:return{name:zl,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Fl:return{name:Fl,properties:[{name:"value"}]};case ql:
return{name:ql,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"value"}]};case Gl:return{name:Gl,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"value"}]};case jl:return{name:jl,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case Bl:return{name:Bl,properties:[{name:"isWildcard",defaultValue:!1}]};default:return{name:e,properties:[]}}}}const W=new z0;let F0;const xU=()=>F0??(F0=jG(`{"$type":"\
Grammar","isDeclared":true,"name":"LikeC4","rules":[{"$type":"ParserRule","entry":true,"name":"LikeC4Grammar","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"specifications","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@8"},"arguments":[]}},{"$type":"Assignment","feature":"models","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@16"},"arguments":[]}},{"$type":"Assignment","feature":"views","operator":"+=","terminal"\
:{"$type":"RuleCall","rule":{"$ref":"#/rules@35"},"arguments":[]}},{"$type":"Assignment","feature":"globals","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"arguments":[]}},{"$type":"Assignment","feature":"deployments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@96"},"arguments":[]}},{"$type":"Assignment","feature":"likec4lib","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1"},"arguments":[]}}],"cardinality":"*"},"d\
efinesHiddenTokens":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LikeC4Lib","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"likec4lib"},{"$type":"Keyword","value":"{"},{"$type":"Keyword","value":"icons"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"icons","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@2"},"arguments":[]},"cardinality":"+"},{"$type":"Keyword","value":"}"},\
{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LibIcon","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@154"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementKind","definition":{"$t\
ype":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tag","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"par\
ameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColor","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1\
58"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRule","definition"\
:{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"specification"}},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]}},{"$type":"Assignment","feature":"tags","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@12"},"arguments":[]}},{"$type":"Assignment","fe\
ature":"relationships","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@14"},"arguments":[]}},{"$type":"Assignment","feature":"colors","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@13"},"arguments":[]}},{"$type":"Assignment","feature":"deploymentNodes","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@11"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":\
false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"element"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@3"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"Ru\
leCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives"\
,"elements":[{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationDeploymentNodeK\
ind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deploymentNode"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@7"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@143"}\
,"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationTag","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"tag"},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,\
"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationColor","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"color"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@6"},"arguments":[]}},{"$type":"Assignment","feature":"color","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@153"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":fa\
lse,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"relationship"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@5"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives"\
,"elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@15"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","ter\
minal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name"\
:"Model","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"model"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@21"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByN\
ame":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Element","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/\
rules@3"},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$r\
ef":"#/rules@3"},"deprecatedSyntax":false}}]}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$\
ref":"#/rules@177"},"arguments":[]}},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildca\
rd":false},{"$type":"ParserRule","name":"ElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"\
$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementProperty","definition":{"$type":"Altern\
atives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementSt\
ringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardina\
lity":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElement","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"element","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@24"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arg\
uments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":\
"#/rules@23"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenT\
okens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StrictFqnElementRef","definition":{"$type":"Group","elements":[{"$type":"Assignm\
ent","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@17"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"StrictFqnElementRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"Cross\
Reference","type":{"$ref":"#/rules@17"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@17"},"terminal":{"$type":"\
RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@17"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyn\
tax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tags","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"+"},{"$type":"Group","elements":[{"$\
type":"Action","inferredType":{"$type":"InferredType","name":"Tags"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragmen\
t":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Relation","parameters":[{"$type":"Parameter","name":"isExplicit"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@27/parameters@0"}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}}]},{"$ty\
pe":"Group","guardCondition":{"$type":"Negation","value":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@27/parameters@0"}}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]},"cardinality":"?"}]}]},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$r\
ef":"#/rules@157"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}},{"$type":"Group","elements\
":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body",\
"operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"RelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","fea\
ture":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]},{"$\
type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements"\
:[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"\
RelationStyleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$ty\
pe":"ParserRule","name":"MetadataProperty","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"metadata"},{"$type":"RuleCall","rule":{"$ref":"#/rules@33"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Rul\
eCall","rule":{"$ref":"#/rules@34"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataAttribute","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"As\
signment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelViews","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"views"}},{"$type":"Keyword","value":"{"\
},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"views","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]}},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"\
LikeC4ViewRule","returnType":{"$ref":"#/types@0"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@37"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@38"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@107"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementView","definition":{"$type":"Group","elements":[{"$type\
":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"extends"},{"$type":"Assignment","feature":"extends","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@40"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Keyword","value":"of"},{"$type":"Assignment"\
,"feature":"viewOf","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}}]}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@42"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicView","definition":{"$type":"Group","elements":[{"$type":"Keyword",\
"value":"dynamic"},{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@43"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRef","definition":\
{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@37"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":f\
alse,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@38"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","\
value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@44"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@47"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"de\
finesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@44"},"argum\
ents":[]},"cardinality":"*"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"steps","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@50"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]}]}},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@49"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHidd\
enTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@45"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewStringProperty","definition":{\
"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":fal\
se,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewLayoutDirection","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"TopBottom"},{"$type":"Keyword","value":"LeftRight"},{"$type":"Keyword","value":"BottomTop"},{"$type":"Keyword","value":"RightLeft"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRule","definition"\
:{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@89"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","na\
me":"ViewRuleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"group"},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@131"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},\
"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]}]},"cardinality":"*"},{"$type":"Assignment","feature":"groupRules","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":\
false},{"$type":"ParserRule","name":"DynamicViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@83"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@84"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@89"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","n\
ame":"DynamicViewParallelSteps","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"parallel"},{"$type":"Keyword","value":"par"}]},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"steps","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wild\
card":false},{"$type":"ParserRule","name":"DynamicViewStep","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBackward","operator":"?=","terminal":{"$type":"Keyword","value":"<-"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","featu\
re":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"argu\
ments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@93"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRulePredicate","definition":{"$type":"A\
lternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"IncludePredicate"}},{"$type":"Keyword","value":"include"},{"$type":"Assignment","feature":"predicates","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@53"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ExcludePredicate"}},{"$type":"Keyword","value":"exclude"},{"$type":"Assignment","feature":\
"predicates","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@53"},"arguments":[]}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Predicates","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@54"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"\
$type":"InferredType","name":"Predicates"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@54"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Predicate","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall"\
,"rule":{"$ref":"#/rules@68"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGlobalPredicateRef","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","ty\
pe":{"$ref":"#/rules@125"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementPredicate","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@57"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementPredicates","inferredType":{"$type":"InferredType","name":"\
ElementPredicate"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@58"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementPredicateWith"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@92"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHidde\
nTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementPredicateOrWhere","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementPredicateWhere"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator"\
:"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementExpression","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","n\
ame":"WhereElementOr","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$type":"Assignment","feature":"right","oper\
ator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementAnd","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferr\
edType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Wher\
eElementPrimary","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@63"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenToke\
ns":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElement","definition":{"$type":"Alternatives","elem\
ents":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereElementTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type\
":"Action","inferredType":{"$type":"InferredType","name":"WhereElementKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@2"},"deprecatedSyntax":false},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementExpr\
ession","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@66"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@67"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementSelectorExpression","inferredType":{"$type":"InferredType","name":"ElementExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements"\
:[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WildcardExpression"}},{"$type":"Assignment","feature":"isWildcard","operator":"?=","terminal":{"$type":"Keyword","value":"*"}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementTagExpression"}},{"$type":"Keyword","value":"element.tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"Cros\
sReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementKindExpression"}},{"$type":"Keyword","value":"element.kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#\
/rules@3"},"deprecatedSyntax":false},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementDescedantsExpression","inferredType":{"$type":"InferredType","name":"ElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType\
":{"$type":"InferredType","name":"ExpandElementExpression"},"feature":"expand","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@169"},"arguments":[]}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementDescedantsExpression"},"feature":"parent","operator":"="},{"$type":"Assignment","feature":"suffix","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@170"},"arguments":[]}}]}],"cardinality":"?"}]},"definesHiddenTokens\
":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationPredicate","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@69"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationPredicates","inferredType":{"$type":"InferredType","name":"RelationPredicate"},"definition":{"$type":"Group","elements":[{"$type":"Ru\
leCall","rule":{"$ref":"#/rules@70"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationPredicateWith"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@93"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"paramet\
ers":[],"wildcard":false},{"$type":"ParserRule","name":"RelationPredicateOrWhere","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@77"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationPredicateWhere"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"argu\
ments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationExpression","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@72"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationOr","inferredType":{"$type":"InferredType","name":\
"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@73"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@73\
"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationAnd","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"\
feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationPrimary","inferredType":{"$type":"InferredType","name":"\
WhereRelationExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@75"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule",\
"name":"WhereRelationNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelation","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferr\
edType":{"$type":"InferredType","name":"WhereRelationTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Wh\
ereRelationKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationParticipantTag"}},{"$type":"A\
ssignment","feature":"participant","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecat\
edSyntax":false},"cardinality":"?"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationParticipantKind"}},{"$type":"Assignment","feature":"participant","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},{"$type":"Assignment","feature\
":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@2"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExpression","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@78"},"arguments":[]},{"$type":\
"RuleCall","rule":{"$ref":"#/rules@80"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"InOutRelationExpressions","inferredType":{"$type":"InferredType","name":"RelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@79"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"InOutR\
elationExpression"},"feature":"inout","operator":"="},{"$type":"Keyword","value":"->"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IncomingRelationExpression","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"->"},{"$type":"Assignment","feature":"to","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]}}]},"definesHiddenTo\
kens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DirectedRelationExpressions","inferredType":{"$type":"InferredType","name":"RelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@81"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DirectedRelationExpression"},"feature":"source","operator":"="},{"$type":"Ass\
ignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]}}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"OutgoingRelationExpression","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"from","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]}},{"$type":"Altern\
atives","elements":[{"$type":"Assignment","feature":"isBidirectional","operator":"?=","terminal":{"$type":"Keyword","value":"<->"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assi\
gnment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},"deprecatedSyntax":false}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementExpressionsIterator","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"\
RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementExpressionsIterator"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parame\
ters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewIncludePredicate","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"include"},{"$type":"Assignment","feature":"predicates","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@85"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewGlobalPredicateRef","definition":{"$type":"\
Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@126"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewPredicateIterator","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"val\
ue","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DynamicViewPredicateIterator"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,\
"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/ru\
les@142"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"style","operator":"=","terminal":{"$type":"C\
rossReference","type":{"$ref":"#/rules@127"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyleOrGlobalRef","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@86"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@87"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"\
parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleAutoLayout","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"autoLayout"},{"$type":"Assignment","feature":"direction","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@46"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"rankSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@179"},"arguments":[]}},{"$type":"Assignment","feature":"n\
odeSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@179"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NotationProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"notation"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$t\
ype":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NotesProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"notes"}},{"$type":"Keyword","\
value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomElementProperties","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","oper\
ator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@94"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Parse\
rRule","name":"CustomRelationProperties","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@91"},"arguments":[]},{"$type":"RuleCall","r\
ule":{"$ref":"#/rules@146"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NavigateToProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@39"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationNavigateToProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@41"},"arguments":[]}}]},"define\
sHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelDeployments","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"deployment"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":\
[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@101"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNode","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"kind","opera\
tor":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},{"$type":"RuleCall","rule":\
{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}}]}]},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall\
","rule":{"$ref":"#/rules@98"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operato\
r":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":fals\
e,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstance","definition":{"$type":"Group","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]}],"cardinality":"?"},{"$type":"Keyword","value":"instanceOf"},{"$type":"Assignment","feature":"element","operator\
":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@100"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hidd\
enTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstanceBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":\
"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendDeployment","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"deploymentNode","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@104"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@102"\
},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendDeploymentBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@23"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"paramet\
ers":[],"wildcard":false},{"$type":"ParserRule","name":"FqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$re\
f":"#/rules@172"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StrictFqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","\
feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"StrictFqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReferenc\
e","type":{"$ref":"#/types@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentRelation","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[]}},{"$typ\
e":"Alternatives","elements":[{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5\
"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rul\
e":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@106"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type\
":"ParserRule","name":"DeploymentRelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fr\
agment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deployment"},{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@108"},"arguments":[]},"cardin\
ality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":\
"#/rules@44"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@109"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@111"},"argu\
ments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@110"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@89"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@\
123"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewR\
ulePredicate","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isInclude","operator":"?=","terminal":{"$type":"Keyword","value":"include"}},{"$type":"Keyword","value":"exclude"}]},{"$type":"Assignment","feature":"expr","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@112"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Par\
serRule","name":"DeploymentViewRulePredicateExpression","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@113"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DeploymentViewRulePredicateExpression"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$t\
ype":"RuleCall","rule":{"$ref":"#/rules@113"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExpressionV2","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@115"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@114"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,\
"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementPredicateOrWhereV2","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementPredicateWhereV2"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule\
":{"$ref":"#/rules@59"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationPredicateOrWhereV2","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@118"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationPredicateWhereV2"},"feature":"subject","\
operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExpr","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"Inferr\
edType","name":"WildcardExpression"}},{"$type":"Assignment","feature":"isWildcard","operator":"?=","terminal":{"$type":"Keyword","value":"*"}}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@117"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnRefExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"ref","operator":"=","terminal":{"$type":"RuleCall","rule":{\
"$ref":"#/rules@103"},"arguments":[]}},{"$type":"Assignment","feature":"selector","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@169"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@170"},"arguments":[]}]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExpr","definition":{"$type":"Alternatives","elements\
":[{"$type":"RuleCall","rule":{"$ref":"#/rules@119"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@121"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"InOutRelationExpr","inferredType":{"$type":"InferredType","name":"RelationExpr"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@120"},"arguments":[]},{"$type":"Group","elements":[{"$t\
ype":"Action","inferredType":{"$type":"InferredType","name":"InOutRelationExpr"},"feature":"inout","operator":"="},{"$type":"Keyword","value":"->"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IncomingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"->"},{"$type":"Assignment","feature":"to","operator":"=","terminal":{"$type":"RuleCall","rule":{"\
$ref":"#/rules@116"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DirectedRelationExpr","inferredType":{"$type":"InferredType","name":"RelationExpr"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@122"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DirectedRelationExpr"},"feature":\
"source","operator":"="},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]}}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"OutgoingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"from","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@116"}\
,"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBidirectional","operator":"?=","terminal":{"$type":"Keyword","value":"<->"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keywor\
d","value":"]->"}]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]},"deprecatedSyntax":false}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExpressions","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"="\
,"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExpressions"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens\
":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Globals","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"global"}},{"$type":"Keyword","value":"{"},{"$type":"Group","elements":[{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@125"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rule\
s@126"},"arguments":[]}]},"cardinality":"*"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]}]},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Glo\
balPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"predicateGroup"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":fals\
e,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalDynamicPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"dynamicPredicateGroup"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/ru\
les@83"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleId","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"\
ParserRule","name":"GlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"id","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@127"},"arguments":[]}},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","el\
ements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"styleGroup"},{"$type":"Assignment","feature":"id","operator":"=","terminal":\
{"$type":"RuleCall","rule":{"$ref":"#/rules@127"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@86"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LinkProperty","definition":{"$type":"Group","elements":[{"$type":"Assignme\
nt","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"link"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@155"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"ent\
ry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ColorProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"color"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"themeColor","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@150"},"arguments":[]}},{"$type":\
"Assignment","feature":"customColor","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@6"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"OpacityProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","fe\
ature":"key","operator":"=","terminal":{"$type":"Keyword","value":"opacity"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@176"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MultipleProperty","definition":{"$type":"Group\
","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"multiple"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconPr\
operty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"icon"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"libicon","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@2"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@154"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"value\
","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"RuleCall","rule":{"$ref":"#/rules@155"},"arguments":[]}]}}]},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keywor\
d","value":"shape"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@151"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderStyleValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCa\
ll","rule":{"$ref":"#/rules@148"},"arguments":[]},{"$type":"Keyword","value":"none"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"border"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","termin\
al":{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SizeValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"xs"},{"$type":"Keyword","value":"sm"},{"$type":"Keyword","value":"md"},{"$type":"Keyword","value":"lg"},{"$type":"Keyword","valu\
e":"xl"},{"$type":"Keyword","value":"xsmall"},{"$type":"Keyword","value":"small"},{"$type":"Keyword","value":"medium"},{"$type":"Keyword","value":"large"},{"$type":"Keyword","value":"xlarge"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"size"}},{"$t\
ype":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PaddingSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{\
"$type":"Keyword","value":"padding"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TextSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","fea\
ture":"key","operator":"=","terminal":{"$type":"Keyword","value":"textSize"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StyleProperty","definition":{"$type":"Alternat\
ives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@131"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@133"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@139"},"arguments":[]},{"$type":"RuleCall",\
"rule":{"$ref":"#/rules@140"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@141"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementStyleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operato\
r":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LineProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"line"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assig\
nment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrowProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"head\
"},{"$type":"Keyword","value":"tail"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@149"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipStyleProperty","definition":{"$type":"Alternatives","elements":[{"$type\
":"RuleCall","rule":{"$ref":"#/rules@131"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@144"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Boolean","dataType":"boolean","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"true"},{"$type":"Keyword","value":"false"}]},"definesHidden\
Tokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LineOptions","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"solid"},{"$type":"Keyword","value":"dashed"},{"$type":"Keyword","value":"dotted"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrowType","dataType":"string","defini\
tion":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"Keyword","value":"normal"},{"$type":"Keyword","value":"onormal"},{"$type":"Keyword","value":"dot"},{"$type":"Keyword","value":"odot"},{"$type":"Keyword","value":"diamond"},{"$type":"Keyword","value":"odiamond"},{"$type":"Keyword","value":"crow"},{"$type":"Keyword","value":"open"},{"$type":"Keyword","value":"vee"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wi\
ldcard":false},{"$type":"ParserRule","name":"ThemeColor","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"primary"},{"$type":"Keyword","value":"secondary"},{"$type":"Keyword","value":"muted"},{"$type":"Keyword","value":"slate"},{"$type":"Keyword","value":"blue"},{"$type":"Keyword","value":"indigo"},{"$type":"Keyword","value":"sky"},{"$type":"Keyword","value":"red"},{"$type":"Keyword","value":"gray"},{"$type":"Keyword","value":"green"},{"$type":"Key\
word","value":"amber"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementShape","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"rectangle"},{"$type":"Keyword","value":"person"},{"$type":"Keyword","value":"browser"},{"$type":"Keyword","value":"mobile"},{"$type":"Keyword","value":"cylinder"},{"$type":"Keyword","value":"storage"},{"$type":"Keyword","va\
lue":"queue"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Participant","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"source"},{"$type":"Keyword","value":"target"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColorValue","dataType":"string","defin\
ition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@171"},"arguments":[]},{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@180"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@179"},"arguments":[]}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconId","dataType":\
"string","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@166"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Uri","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@167"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@168"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hid\
denTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TagId","dataType":"string","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@171"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DotId","dataType":"string","definition":{"$type":"Group","elements":[{"$type":\
"RuleCall","rule":{"$ref":"#/rules@173"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColorId","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@151"},"arguments":[]},{"$type":"RuleCall\
","rule":{"$ref":"#/rules@149"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Id","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]},{"$type":"RuleCall","rule":{"$\
ref":"#/rules@151"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@150"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@149"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"},{"$type":"Keyword","value":"group"},{"$type":"Keyword","valu\
e":"node"},{"$type":"Keyword","value":"deployment"},{"$type":"Keyword","value":"instance"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"EqOperator","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"RuleCall\
","rule":{"$ref":"#/rules@174"},"arguments":[]}]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"is"}},{"$type":"Assignment","feature":"not","operator":"?=","terminal":{"$type":"Keyword","value":"not"},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"IsEqual","definition":{"$type":"Alternatives","elements\
":[{"$type":"Assignment","feature":"isEqual","operator":"?=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@174"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"TerminalRule","hidden":true,"name":"BLOCK_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\//"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"LIN\
E_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\/[^\\\\n\\\\r]*/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"WS","definition":{"$type":"RegexToken","regex":"/[\\\\t ]+/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"NL","definition":{"$type":"RegexToken","regex":"/[\\\\r\\\\n]+/"},"fragment":false},{"$type":"TerminalRule","name":"LIB_ICON","definition":{"$type":"RegexToken","regex":"/(aws|azure|gcp|tech):[-\\\\w]*/"},"fragment":false,"hidden":false},{"$t\
ype":"TerminalRule","name":"URI_WITH_SCHEMA","definition":{"$type":"RegexToken","regex":"/\\\\w+:\\\\/\\\\/\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_RELATIVE","definition":{"$type":"RegexToken","regex":"/\\\\.{0,2}\\\\/[^\\\\/]\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"DotUnderscore","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\._(?![_a-zA-Z])/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"DotWildcard","definition":{"\
$type":"RegexToken","regex":"/\\\\b\\\\.\\\\*{1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hash","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"#"}},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"StickyDot","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\./"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Dot","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"."}},"fragment":false,"hidd\
en":false},{"$type":"TerminalRule","name":"NotEqual","definition":{"$type":"RegexToken","regex":"/\\\\!\\\\={1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Eq","definition":{"$type":"RegexToken","regex":"/\\\\={1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Percent","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+%/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"String","definition":{"$type":"RegexToken","regex":"/\\"[^\\"]*\\"|'\
[^']*'/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"IdTerminal","definition":{"$type":"RegexToken","regex":"/[_]*[a-zA-Z][-\\\\w]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Number","type":{"$type":"ReturnType","name":"number"},"definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+\\\\b/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hex","definition":{"$type":"RegexToken","regex":"/\\\\b[a-zA-Z0-9]+\\\\b/"},"fragment":false,"hidden":fals\
e}],"types":[{"$type":"Type","name":"LikeC4View","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@37"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@38"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@107"}}]}},{"$type":"Type","name":"StringProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@45"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@30"}},{"$\
type":"SimpleType","typeRef":{"$ref":"#/rules@34"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@10"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@15"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@90"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@91"}}]}},{"$type":"Type","name":"DeploymentNodeOrElementKind","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@3"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@7"}}]}},{"$type":"Type","name":"\
WhereTagEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@64/definition/elements@0/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@76/definition/elements@0/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@76/definition/elements@2/elements@0/inferredType"}}]}},{"$type":"Type","name":"WhereKindEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@64/definition/el\
ements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@76/definition/elements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@76/definition/elements@3/elements@0/inferredType"}}]}},{"$type":"Type","name":"WhereExpression","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@59"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@71"}}]}},{"$type":"Type","name":"DeploymentElement","type":{"$type":"UnionTyp\
e","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@97"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@99"}}]}},{"$type":"Type","name":"Referenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@97"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@99"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}}]}},{"$type":"Type","name":"FqnReferenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/types@7"}\
},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@21"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@101"}}]}},{"$type":"Type","name":"SizeProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@139"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@140"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@141"}}]}}],"definesHiddenTokens":false,"hiddenTokens":[],"imports":[],"interfaces":[],"usedGr\
ammars":[]}`)),ov={languageId:"likec4",fileExtensions:[".c4",".likec4",".like-c4"],caseInsensitive:!1,mode:"production"},DU={skipValidations:!0,recoveryEnabled:!0,nodeLocationTracking:"full"},NU={AstReflection:()=>new z0},IU={Grammar:()=>xU(),LanguageMetaData:()=>ov,parser:{ParserConfig:()=>DU}},q0=`likec4lib { icons {
  aws:activate
  aws:alexa-for-business
  aws:amplify
  aws:apache-mxnet-on-aws
  aws:api-gateway
  aws:app-config
  aws:app-flow
  aws:app-mesh
  aws:app-runner
  aws:app-stream
  aws:app-sync
  aws:application-auto-scaling
  aws:application-composer
  aws:application-cost-profiler
  aws:application-discovery-service
  aws:application-migration-service
  aws:artifact
  aws:athena
  aws:audit-manager
  aws:augmented-ai-a2i
  aws:aurora
  aws:auto-scaling
  aws:backint-agent
  aws:backup
  aws:batch
  aws:billing-conductor
  aws:bottlerocket
  aws:braket
  aws:budgets
  aws:certificate-manager
  aws:chatbot
  aws:chime
  aws:chime-sdk
  aws:chime-voice-connector
  aws:clean-rooms
  aws:client-vpn
  aws:cloud-control-api
  aws:cloud-development-kit
  aws:cloud-directory
  aws:cloud-formation
  aws:cloud-front
  aws:cloud-hsm
  aws:cloud-map
  aws:cloud-search
  aws:cloud-shell
  aws:cloud-trail
  aws:cloud-wan
  aws:cloud-watch
  aws:cloud9
  aws:code-artifact
  aws:code-build
  aws:code-catalyst
  aws:code-commit
  aws:code-deploy
  aws:code-guru
  aws:code-pipeline
  aws:code-star
  aws:code-whisperer
  aws:cognito
  aws:command-line-interface
  aws:comprehend
  aws:comprehend-medical
  aws:compute-optimizer
  aws:config
  aws:connect
  aws:console-mobile-application
  aws:control-tower
  aws:corretto
  aws:cost-and-usage-report
  aws:cost-explorer
  aws:data-exchange
  aws:data-pipeline
  aws:data-sync
  aws:data-zone
  aws:database-migration-service
  aws:deep-composer
  aws:deep-learning-amis
  aws:deep-learning-containers
  aws:deep-lens
  aws:deep-racer
  aws:detective
  aws:dev-ops-guru
  aws:device-farm
  aws:direct-connect
  aws:directory-service
  aws:distro-for-open-telemetry
  aws:document-db
  aws:dynamo-db
  aws:ec2
  aws:ec2-auto-scaling
  aws:ec2-image-builder
  aws:ecs-anywhere
  aws:efs
  aws:eks-anywhere
  aws:eks-cloud
  aws:eks-distro
  aws:elasti-cache
  aws:elastic-beanstalk
  aws:elastic-block-store
  aws:elastic-container-registry
  aws:elastic-container-service
  aws:elastic-disaster-recovery
  aws:elastic-fabric-adapter
  aws:elastic-inference
  aws:elastic-kubernetes-service
  aws:elastic-load-balancing
  aws:elastic-transcoder
  aws:elemental-appliances-software
  aws:elemental-conductor
  aws:elemental-delta
  aws:elemental-link
  aws:elemental-live
  aws:elemental-media-connect
  aws:elemental-media-convert
  aws:elemental-media-live
  aws:elemental-media-package
  aws:elemental-media-store
  aws:elemental-media-tailor
  aws:elemental-server
  aws:emr
  aws:event-bridge
  aws:express-workflows
  aws:fargate
  aws:fault-injection-simulator
  aws:file-cache
  aws:fin-space
  aws:firewall-manager
  aws:forecast
  aws:fraud-detector
  aws:free-rtos
  aws:fsx
  aws:fsx-for-lustre
  aws:fsx-for-net-app-ontap
  aws:fsx-for-open-zfs
  aws:fsx-for-wfs
  aws:game-kit
  aws:game-lift
  aws:game-sparks
  aws:genomics-cli
  aws:global-accelerator
  aws:glue
  aws:glue-data-brew
  aws:glue-elastic-views
  aws:ground-station
  aws:guard-duty
  aws:health-lake
  aws:honeycode
  aws:iam-identity-center
  aws:identity-and-access-management
  aws:inspector
  aws:interactive-video-service
  aws:io-t-1-click
  aws:io-t-analytics
  aws:io-t-button
  aws:io-t-core
  aws:io-t-device-defender
  aws:io-t-device-management
  aws:io-t-edu-kit
  aws:io-t-events
  aws:io-t-express-link
  aws:io-t-fleet-wise
  aws:io-t-greengrass
  aws:io-t-robo-runner
  aws:io-t-site-wise
  aws:io-t-things-graph
  aws:io-t-twin-maker
  aws:iq
  aws:kendra
  aws:key-management-service
  aws:keyspaces
  aws:kinesis
  aws:kinesis-data-analytics
  aws:kinesis-data-streams
  aws:kinesis-firehose
  aws:kinesis-video-streams
  aws:lake-formation
  aws:lambda
  aws:launch-wizard
  aws:lex
  aws:license-manager
  aws:lightsail
  aws:local-zones
  aws:location-service
  aws:lookout-for-equipment
  aws:lookout-for-metrics
  aws:lookout-for-vision
  aws:lumberyard
  aws:macie
  aws:mainframe-modernization
  aws:managed-blockchain
  aws:managed-grafana
  aws:managed-service-for-prometheus
  aws:managed-services
  aws:managed-streaming-for-apache-kafka
  aws:managed-workflows-for-apache-airflow
  aws:management-console
  aws:marketplace-dark
  aws:marketplace-light
  aws:memory-db-for-redis
  aws:migration-evaluator
  aws:migration-hub
  aws:monitron
  aws:mq
  aws:neptune
  aws:network-firewall
  aws:neuron
  aws:nice-dcv
  aws:nice-engin-frame
  aws:nimble-studio
  aws:nitro-enclaves
  aws:omics
  aws:open-3d-engine
  aws:open-search-service
  aws:ops-works
  aws:organizations
  aws:outposts-family
  aws:outposts-rack
  aws:outposts-servers
  aws:panorama
  aws:parallel-cluster
  aws:personal-health-dashboard
  aws:personalize
  aws:pinpoint
  aws:pinpoint-apis
  aws:polly
  aws:private-5g
  aws:private-certificate-authority
  aws:private-link
  aws:professional-services
  aws:proton
  aws:quantum-ledger-database
  aws:quick-sight
  aws:rds
  aws:rds-on-vmware
  aws:re-post
  aws:red-hat-open-shift-service-on-aws
  aws:redshift
  aws:rekognition
  aws:reserved-instance-reporting
  aws:resilience-hub
  aws:resource-access-manager
  aws:resource-explorer
  aws:robo-maker
  aws:route-53
  aws:s3-on-outposts
  aws:sage-maker
  aws:sage-maker-ground-truth
  aws:sage-maker-studio-lab
  aws:savings-plans
  aws:secrets-manager
  aws:security-hub
  aws:security-lake
  aws:server-migration-service
  aws:serverless-application-repository
  aws:service-catalog
  aws:service-management-connector
  aws:shield
  aws:signer
  aws:sim-space-weaver
  aws:simple-email-service
  aws:simple-notification-service
  aws:simple-queue-service
  aws:simple-storage-service
  aws:simple-storage-service-glacier
  aws:site-to-site-vpn
  aws:snowball
  aws:snowball-edge
  aws:snowcone
  aws:snowmobile
  aws:step-functions
  aws:storage-gateway
  aws:sumerian
  aws:supply-chain
  aws:support
  aws:systems-manager
  aws:tensor-flow-on-aws
  aws:textract
  aws:thinkbox-deadline
  aws:thinkbox-frost
  aws:thinkbox-krakatoa
  aws:thinkbox-sequoia
  aws:thinkbox-stoke
  aws:thinkbox-xmesh
  aws:timestream
  aws:tools-and-sdks
  aws:torch-serve
  aws:training-certification
  aws:transcribe
  aws:transfer-family
  aws:transit-gateway
  aws:translate
  aws:trusted-advisor
  aws:verified-access
  aws:verified-permissions
  aws:virtual-private-cloud
  aws:vmware-cloud-on-aws
  aws:vpc-lattice
  aws:waf
  aws:wavelength
  aws:well-architected-tool
  aws:wickr
  aws:work-docs
  aws:work-docs-sdk
  aws:work-link
  aws:work-mail
  aws:work-spaces-family
  aws:x-ray
  azure:abs-member
  azure:active-directory-connect-health
  azure:activity-log
  azure:administrative-units
  azure:advisor
  azure:ai-studio
  azure:aks-automatic
  azure:aks-istio
  azure:alerts
  azure:all-resources
  azure:analysis-services
  azure:anomaly-detector
  azure:api-center
  azure:api-connections
  azure:api-management-services
  azure:api-proxy
  azure:app-compliance-automation
  azure:app-configuration
  azure:app-registrations
  azure:app-service-certificates
  azure:app-service-domains
  azure:app-service-environments
  azure:app-service-plans
  azure:app-services
  azure:app-space
  azure:app-space-component
  azure:applens
  azure:application-gateway-containers
  azure:application-gateways
  azure:application-group
  azure:application-insights
  azure:application-security-groups
  azure:aquila
  azure:arc-data-services
  azure:arc-kubernetes
  azure:arc-machines
  azure:arc-postgre-sql
  azure:arc-sql-managed-instance
  azure:arc-sql-server
  azure:atm-multistack
  azure:auto-scale
  azure:automanaged-vm
  azure:automation-accounts
  azure:availability-sets
  azure:avs-vm
  azure:azure-a
  azure:azure-ad-b2c
  azure:azure-api-for-fhir
  azure:azure-applied-ai-services
  azure:azure-arc
  azure:azure-attestation
  azure:azure-backup-center
  azure:azure-blockchain-service
  azure:azure-center-for-sap
  azure:azure-chaos-studio
  azure:azure-cloud-shell
  azure:azure-communication-services
  azure:azure-communications-gateway
  azure:azure-compute-galleries
  azure:azure-cosmos-db
  azure:azure-data-catalog
  azure:azure-data-explorer-clusters
  azure:azure-database-maria-db-server
  azure:azure-database-migration-services
  azure:azure-database-my-sql-server
  azure:azure-database-postgre-sql-server
  azure:azure-database-postgre-sql-server-group
  azure:azure-databox-gateway
  azure:azure-databricks
  azure:azure-deployment-environments
  azure:azure-dev-ops
  azure:azure-dev-tunnels
  azure:azure-edge-hardware-center
  azure:azure-experimentation-studio
  azure:azure-fileshares
  azure:azure-firewall-manager
  azure:azure-firewall-policy
  azure:azure-hcp-cache
  azure:azure-hpc-workbenches
  azure:azure-hybrid-center
  azure:azure-information-protection
  azure:azure-io-t-operations
  azure:azure-lighthouse
  azure:azure-load-testing
  azure:azure-managed-grafana
  azure:azure-maps-accounts
  azure:azure-media-service
  azure:azure-migrate
  azure:azure-monitor-dashboard
  azure:azure-monitor-pipeline
  azure:azure-monitors-for-sap-solutions
  azure:azure-net-app-files
  azure:azure-network-function-manager
  azure:azure-network-function-manager-functions
  azure:azure-object-understanding
  azure:azure-open-ai
  azure:azure-operator-5g-core
  azure:azure-operator-insights
  azure:azure-operator-nexus
  azure:azure-operator-service-manager
  azure:azure-orbital
  azure:azure-programmable-connectivity
  azure:azure-purview-accounts
  azure:azure-quotas
  azure:azure-red-hat-open-shift
  azure:azure-sentinel
  azure:azure-service-bus
  azure:azure-sphere
  azure:azure-spring-apps
  azure:azure-sql
  azure:azure-sql-edge
  azure:azure-sql-server-stretch-databases
  azure:azure-sql-vm
  azure:azure-stack
  azure:azure-stack-edge
  azure:azure-stack-hci-sizer
  azure:azure-storage-mover
  azure:azure-support-center-blue
  azure:azure-sustainability
  azure:azure-synapse-analytics
  azure:azure-token-service
  azure:azure-video-indexer
  azure:azure-virtual-desktop
  azure:azure-vmware-solution
  azure:azure-workbooks
  azure:azurite
  azure:backlog
  azure:backup-vault
  azure:bare-metal-infrastructure
  azure:bastions
  azure:batch-accounts
  azure:batch-ai
  azure:biz-talk
  azure:blob-block
  azure:blob-page
  azure:blockchain-applications
  azure:blueprints
  azure:bonsai
  azure:bot-services
  azure:branch
  azure:browser
  azure:bug
  azure:builds
  azure:business-process-tracking
  azure:cache
  azure:cache-redis
  azure:capacity
  azure:capacity-reservation-groups
  azure:cdn-profiles
  azure:central-service-instance-for-sap
  azure:ceres
  azure:change-analysis
  azure:client-apps
  azure:cloud-services-classic
  azure:cloud-services-extended-support
  azure:cloud-test
  azure:code
  azure:code-optimization
  azure:cognitive-search
  azure:cognitive-services
  azure:cognitive-services-decisions
  azure:collaborative-service
  azure:commit
  azure:community-images
  azure:compliance
  azure:compliance-center
  azure:compute-fleet
  azure:computer-vision
  azure:conditional-access
  azure:confidential-ledgers
  azure:connected-cache
  azure:connected-vehicle-platform
  azure:connections
  azure:consortium
  azure:container-apps-environments
  azure:container-instances
  azure:container-registries
  azure:container-services-deprecated
  azure:content-moderators
  azure:content-safety
  azure:controls
  azure:controls-horizontal
  azure:cost-alerts
  azure:cost-analysis
  azure:cost-budgets
  azure:cost-export
  azure:cost-management
  azure:cost-management-and-billing
  azure:counter
  azure:cubes
  azure:custom-ip-prefix
  azure:custom-vision
  azure:customer-lockbox-for-microsoft-azure
  azure:dashboard
  azure:dashboard-hub
  azure:data-box
  azure:data-collection-rules
  azure:data-factories
  azure:data-lake-analytics
  azure:data-lake-storage-gen1
  azure:data-lake-store-gen1
  azure:data-share-invitations
  azure:data-shares
  azure:database-instance-for-sap
  azure:ddo-s-protection-plans
  azure:dedicated-hsm
  azure:defender-cm-local-manager
  azure:defender-dcs-controller
  azure:defender-distributer-control-system
  azure:defender-engineering-station
  azure:defender-external-management
  azure:defender-freezer-monitor
  azure:defender-historian
  azure:defender-hmi
  azure:defender-industrial-packaging-system
  azure:defender-industrial-printer
  azure:defender-industrial-robot
  azure:defender-industrial-scale-system
  azure:defender-marquee
  azure:defender-meter
  azure:defender-plc
  azure:defender-pneumatic-device
  azure:defender-programable-board
  azure:defender-relay
  azure:defender-robot-controller
  azure:defender-rtu
  azure:defender-sensor
  azure:defender-slot
  azure:defender-web-guiding-system
  azure:detonation
  azure:dev-console
  azure:dev-ops-starter
  azure:dev-test-labs
  azure:device-compliance
  azure:device-configuration
  azure:device-enrollment
  azure:device-provisioning-services
  azure:device-security-apple
  azure:device-security-google
  azure:device-security-windows
  azure:device-update-io-t-hub
  azure:devices
  azure:diagnostics-settings
  azure:digital-twins
  azure:disk-encryption-sets
  azure:disk-pool
  azure:disks
  azure:disks-classic
  azure:disks-snapshots
  azure:dns-multistack
  azure:dns-private-resolver
  azure:dns-security-policy
  azure:dns-zones
  azure:download
  azure:e-books
  azure:edge-management
  azure:education
  azure:elastic-job-agents
  azure:elastic-san
  azure:endpoint-analytics
  azure:enterprise-applications
  azure:entra-connect
  azure:entra-connect-health
  azure:entra-connect-sync
  azure:entra-domain-services
  azure:entra-global-secure-access
  azure:entra-id-protection
  azure:entra-identity-custom-roles
  azure:entra-identity-licenses
  azure:entra-identity-risky-signins
  azure:entra-identity-risky-users
  azure:entra-identity-roles-and-administrators
  azure:entra-internet-access
  azure:entra-managed-identities
  azure:entra-private-access
  azure:entra-privleged-identity-management
  azure:entra-verified-id
  azure:error
  azure:event-grid-domains
  azure:event-grid-subscriptions
  azure:event-grid-topics
  azure:event-hub-clusters
  azure:event-hubs
  azure:exchange-access
  azure:exchange-on-premises-access
  azure:express-route-circuits
  azure:express-route-direct
  azure:express-route-traffic-collector
  azure:extended-security-updates
  azure:extensions
  azure:external-identities
  azure:face-apis
  azure:feature-previews
  azure:fhir-service
  azure:fiji
  azure:file
  azure:files
  azure:firewalls
  azure:folder-blank
  azure:folder-website
  azure:form-recognizers
  azure:free-services
  azure:front-door-and-cdn-profiles
  azure:ftp
  azure:function-apps
  azure:gear
  azure:genomics
  azure:genomics-accounts
  azure:globe-error
  azure:globe-success
  azure:globe-warning
  azure:groups
  azure:guide
  azure:hd-insight-clusters
  azure:hdi-aks-cluster
  azure:heart
  azure:help-and-support
  azure:host-groups
  azure:host-pools
  azure:hosts
  azure:ic-m-troubleshooting
  azure:identity-governance
  azure:identity-multi-factor-authentication
  azure:identity-secure-score
  azure:image
  azure:image-definitions
  azure:image-templates
  azure:image-versions
  azure:images
  azure:immersive-readers
  azure:import-export-jobs
  azure:industrial-io-t
  azure:information
  azure:infrastructure-backup
  azure:input-output
  azure:instance-pools
  azure:integration-accounts
  azure:integration-environments
  azure:integration-service-environments
  azure:internet-analyzer-profiles
  azure:intune
  azure:intune-app-protection
  azure:intune-for-education
  azure:intune-trends
  azure:io-t-central-applications
  azure:io-t-edge
  azure:io-t-hub
  azure:ip-address-manager
  azure:ip-groups
  azure:journey-hub
  azure:key-vaults
  azure:keys
  azure:kubernetes-fleet-manager
  azure:kubernetes-services
  azure:lab-accounts
  azure:lab-services
  azure:language
  azure:language-understanding
  azure:launch-portal
  azure:learn
  azure:load-balancer-hub
  azure:load-balancers
  azure:load-test
  azure:load-testing
  azure:local-network-gateways
  azure:location
  azure:log-analytics-query-pack
  azure:log-analytics-workspaces
  azure:log-streaming
  azure:logic-apps
  azure:logic-apps-custom-connector
  azure:machine-learning
  azure:machine-learning-studio-classic-web-services
  azure:machine-learning-studio-web-service-plans
  azure:machine-learning-studio-workspaces
  azure:machines-azure-arc
  azure:maintenance-configuration
  azure:managed-applications-center
  azure:managed-database
  azure:managed-desktop
  azure:managed-dev-ops-pools
  azure:managed-file-shares
  azure:managed-identities
  azure:managed-instance-apache-cassandra
  azure:managed-service-fabric
  azure:management-groups
  azure:management-portal
  azure:marketplace
  azure:marketplace-management
  azure:med-tech-service
  azure:media
  azure:media-file
  azure:mesh-applications
  azure:metrics
  azure:metrics-advisor
  azure:microsoft-defender-easm
  azure:microsoft-defender-for-cloud
  azure:microsoft-defender-for-io-t
  azure:microsoft-dev-box
  azure:mindaro
  azure:mission-landing-zone
  azure:mobile
  azure:mobile-engagement
  azure:mobile-networks
  azure:modular-data-center
  azure:module
  azure:monitor
  azure:monitor-health-models
  azure:multi-tenancy
  azure:multifactor-authentication
  azure:my-customers
  azure:nat
  azure:network-interfaces
  azure:network-managers
  azure:network-security-groups
  azure:network-security-perimeters
  azure:network-watcher
  azure:notification-hub-namespaces
  azure:notification-hubs
  azure:offers
  azure:on-premises-data-gateways
  azure:open-supply-chain-platform
  azure:operation-log-classic
  azure:oracle-database
  azure:os-images-classic
  azure:osconfig
  azure:outbound-connection
  azure:partner-namespace
  azure:partner-registration
  azure:partner-topic
  azure:peering-service
  azure:peerings
  azure:personalizers
  azure:plans
  azure:policy
  azure:power
  azure:power-bi-embedded
  azure:power-platform
  azure:power-up
  azure:powershell
  azure:preview-features
  azure:private-endpoints
  azure:private-link
  azure:private-link-service
  azure:private-link-services
  azure:process-explorer
  azure:production-ready-database
  azure:proximity-placement-groups
  azure:public-ip-addresses
  azure:public-ip-addresses-classic
  azure:public-ip-prefixes
  azure:qn-a-makers
  azure:quickstart-center
  azure:recent
  azure:recovery-services-vaults
  azure:region-management
  azure:relays
  azure:remote-rendering
  azure:reservations
  azure:reserved-capacity
  azure:reserved-ip-addresses-classic
  azure:resource-explorer
  azure:resource-graph-explorer
  azure:resource-group-list
  azure:resource-groups
  azure:resource-guard
  azure:resource-linked
  azure:resource-management-private-link
  azure:resource-mover
  azure:resources-provider
  azure:restore-points
  azure:restore-points-collections
  azure:route-filters
  azure:route-tables
  azure:rtos
  azure:savings-plans
  azure:scheduler
  azure:scheduler-job-collections
  azure:scvmm-management-servers
  azure:search
  azure:search-grid
  azure:security
  azure:security-baselines
  azure:send-grid-accounts
  azure:server-farm
  azure:serverless-search
  azure:service-catalog-mad
  azure:service-endpoint-policies
  azure:service-fabric-clusters
  azure:service-health
  azure:service-providers
  azure:shared-image-galleries
  azure:signal-r
  azure:software-as-a-service
  azure:software-updates
  azure:solutions
  azure:sonic-dash
  azure:spatial-anchor-accounts
  azure:speech-services
  azure:spot-vm
  azure:spot-vmss
  azure:sql-data-warehouses
  azure:sql-database
  azure:sql-elastic-pools
  azure:sql-managed-instance
  azure:sql-server
  azure:sql-server-registries
  azure:ssd
  azure:ssh-keys
  azure:ssis-lift-and-shift-ir
  azure:stack-hci-premium
  azure:static-apps
  azure:stor-simple-data-managers
  azure:stor-simple-device-managers
  azure:storage-accounts
  azure:storage-accounts-classic
  azure:storage-actions
  azure:storage-azure-files
  azure:storage-container
  azure:storage-explorer
  azure:storage-functions
  azure:storage-queue
  azure:storage-sync-services
  azure:stream-analytics-jobs
  azure:subnet
  azure:subscriptions
  azure:system-topic
  azure:table
  azure:tag
  azure:tags
  azure:targets-management
  azure:template-specs
  azure:templates
  azure:tenant-properties
  azure:tenant-status
  azure:test-base
  azure:tfs-vc-repository
  azure:time-series-data-sets
  azure:time-series-insights-access-policies
  azure:time-series-insights-environments
  azure:time-series-insights-event-sources
  azure:toolbox
  azure:traffic-manager-profiles
  azure:translator-text
  azure:troubleshoot
  azure:universal-print
  azure:update-management-center
  azure:updates
  azure:user-privacy
  azure:user-settings
  azure:user-subscriptions
  azure:users
  azure:verifiable-credentials
  azure:verification-as-a-service
  azure:versions
  azure:video-analyzers
  azure:virtual-clusters
  azure:virtual-enclaves
  azure:virtual-instance-for-sap
  azure:virtual-machine
  azure:virtual-machines-classic
  azure:virtual-network-gateways
  azure:virtual-networks
  azure:virtual-networks-classic
  azure:virtual-router
  azure:virtual-visits-builder
  azure:virtual-wan-hub
  azure:virtual-wans
  azure:vm-app-definitions
  azure:vm-app-versions
  azure:vm-image-version
  azure:vm-images-classic
  azure:vm-scale-sets
  azure:wac
  azure:wac-installer
  azure:web-app-database
  azure:web-application-firewall-policies-waf
  azure:web-jobs
  azure:web-slots
  azure:web-test
  azure:website-power
  azure:website-staging
  azure:windows-notification-services
  azure:windows10-core-services
  azure:workbooks
  azure:worker-container-app
  azure:workflow
  azure:workspace-gateway
  azure:workspaces
  gcp:access-context-manager
  gcp:administration
  gcp:advanced-agent-modeling
  gcp:advanced-solutions-lab
  gcp:agent-assist
  gcp:ai-hub
  gcp:ai-platform
  gcp:ai-platform-unified
  gcp:analytics-hub
  gcp:anthos
  gcp:anthos-config-management
  gcp:anthos-service-mesh
  gcp:api
  gcp:api-analytics
  gcp:api-monetization
  gcp:apigee-api-platform
  gcp:apigee-sense
  gcp:app-engine
  gcp:artifact-registry
  gcp:asset-inventory
  gcp:assured-workloads
  gcp:auto-ml
  gcp:auto-ml-natural-language
  gcp:auto-ml-tables
  gcp:auto-ml-translation
  gcp:auto-ml-video-intelligence
  gcp:auto-ml-vision
  gcp:bare-metal-solutions
  gcp:batch
  gcp:beyondcorp
  gcp:big-query
  gcp:bigtable
  gcp:billing
  gcp:binary-authorization
  gcp:catalog
  gcp:certificate-authority-service
  gcp:certificate-manager
  gcp:cloud-api-gateway
  gcp:cloud-apis
  gcp:cloud-armor
  gcp:cloud-asset-inventory
  gcp:cloud-audit-logs
  gcp:cloud-build
  gcp:cloud-cdn
  gcp:cloud-code
  gcp:cloud-composer
  gcp:cloud-data-fusion
  gcp:cloud-deploy
  gcp:cloud-deployment-manager
  gcp:cloud-dns
  gcp:cloud-domains
  gcp:cloud-ekm
  gcp:cloud-endpoints
  gcp:cloud-external-ip-addresses
  gcp:cloud-firewall-rules
  gcp:cloud-for-marketing
  gcp:cloud-functions
  gcp:cloud-generic
  gcp:cloud-gpu
  gcp:cloud-healthcare-api
  gcp:cloud-healthcare-marketplace
  gcp:cloud-hsm
  gcp:cloud-ids
  gcp:cloud-inference-api
  gcp:cloud-interconnect
  gcp:cloud-jobs-api
  gcp:cloud-load-balancing
  gcp:cloud-logging
  gcp:cloud-media-edge
  gcp:cloud-monitoring
  gcp:cloud-nat
  gcp:cloud-natural-language-api
  gcp:cloud-network
  gcp:cloud-ops
  gcp:cloud-optimization-ai
  gcp:cloud-optimization-ai-fleet-routing-api
  gcp:cloud-router
  gcp:cloud-routes
  gcp:cloud-run
  gcp:cloud-run-for-anthos
  gcp:cloud-scheduler
  gcp:cloud-security-scanner
  gcp:cloud-shell
  gcp:cloud-spanner
  gcp:cloud-sql
  gcp:cloud-storage
  gcp:cloud-tasks
  gcp:cloud-test-lab
  gcp:cloud-tpu
  gcp:cloud-translation-api
  gcp:cloud-vision-api
  gcp:cloud-vpn
  gcp:compute-engine
  gcp:configuration-management
  gcp:connectivity-test
  gcp:connectors
  gcp:contact-center-ai
  gcp:container-optimized-os
  gcp:container-registry
  gcp:data-catalog
  gcp:data-labeling
  gcp:data-layers
  gcp:data-loss-prevention-api
  gcp:data-qn-a
  gcp:data-studio
  gcp:data-transfer
  gcp:database-migration-service
  gcp:dataflow
  gcp:datalab
  gcp:dataplex
  gcp:datapol
  gcp:dataprep
  gcp:dataproc
  gcp:dataproc-metastore
  gcp:datashare
  gcp:datastore
  gcp:datastream
  gcp:debugger
  gcp:developer-portal
  gcp:dialogflow
  gcp:dialogflow-cx
  gcp:dialogflow-insights
  gcp:document-ai
  gcp:early-access-center
  gcp:error-reporting
  gcp:eventarc
  gcp:filestore
  gcp:financial-services-marketplace
  gcp:firestore
  gcp:fleet-engine
  gcp:free-trial
  gcp:game-servers
  gcp:gce-systems-management
  gcp:genomics
  gcp:gke-on-prem
  gcp:google-cloud-marketplace
  gcp:google-kubernetes-engine
  gcp:google-maps-platform
  gcp:healthcare-nlp-api
  gcp:home
  gcp:identity-and-access-management
  gcp:identity-aware-proxy
  gcp:identity-platform
  gcp:iot-core
  gcp:iot-edge
  gcp:key-access-justifications
  gcp:key-management-service
  gcp:kuberun
  gcp:launcher
  gcp:local-ssd
  gcp:looker
  gcp:managed-service-for-microsoft-active-directory
  gcp:media-translation-api
  gcp:memorystore
  gcp:migrate-for-anthos
  gcp:migrate-for-compute-engine
  gcp:my-cloud
  gcp:network-connectivity-center
  gcp:network-intelligence-center
  gcp:network-security
  gcp:network-tiers
  gcp:network-topology
  gcp:onboarding
  gcp:os-configuration-management
  gcp:os-inventory-management
  gcp:os-patch-management
  gcp:partner-interconnect
  gcp:partner-portal
  gcp:performance-dashboard
  gcp:permissions
  gcp:persistent-disk
  gcp:phishing-protection
  gcp:policy-analyzer
  gcp:premium-network-tier
  gcp:private-connectivity
  gcp:private-service-connect
  gcp:producer-portal
  gcp:profiler
  gcp:project
  gcp:pub-sub
  gcp:quantum-engine
  gcp:quotas
  gcp:real-world-insights
  gcp:recommendations-ai
  gcp:release-notes
  gcp:retail-api
  gcp:risk-manager
  gcp:runtime-config
  gcp:secret-manager
  gcp:security
  gcp:security-command-center
  gcp:security-health-advisor
  gcp:security-key-enforcement
  gcp:service-discovery
  gcp:speech-to-text
  gcp:stackdriver
  gcp:standard-network-tier
  gcp:stream-suite
  gcp:support
  gcp:tensorflow-enterprise
  gcp:text-to-speech
  gcp:tools-for-powershell
  gcp:trace
  gcp:traffic-director
  gcp:transfer
  gcp:transfer-appliance
  gcp:user-preferences
  gcp:vertex-ai
  gcp:video-intelligence-api
  gcp:virtual-private-cloud
  gcp:visual-inspection
  gcp:vmware-engine
  gcp:web-risk
  gcp:web-security-scanner
  gcp:workflows
  gcp:workload-identity-pool
  tech:aarch64
  tech:adobe-illustrator
  tech:adobe-photoshop
  tech:adobe-premiere-pro
  tech:adobe-xd
  tech:adonis-js
  tech:after-effects
  tech:airflow
  tech:akka
  tech:algolia
  tech:alpine-js
  tech:amazon-web-services
  tech:anaconda
  tech:android
  tech:android-studio
  tech:angular
  tech:angular-js
  tech:ansible
  tech:ant-design
  tech:apache
  tech:apl
  tech:appcelerator
  tech:apple
  tech:apple-safari
  tech:appwrite
  tech:arch-linux
  tech:arduino
  tech:argo-cd
  tech:astro
  tech:atom
  tech:autodesk-maya
  tech:autodesk-shot-grid
  tech:awk
  tech:azios
  tech:azure
  tech:azure-devops
  tech:azure-sql-database
  tech:babel
  tech:backbone-js
  tech:ballerina
  tech:bamboo
  tech:bash
  tech:behance
  tech:bitbucket
  tech:blender
  tech:bootstrap
  tech:bower
  tech:browserstack
  tech:bulma
  tech:bun
  tech:c
  tech:cairo-graphics
  tech:cake-php
  tech:canva
  tech:capacitor
  tech:cassandra
  tech:cent-os
  tech:chrome
  tech:circle-ci
  tech:clarity
  tech:clion
  tech:clojure
  tech:clojure-script
  tech:cloudflare
  tech:cloudflare-workers
  tech:cmake
  tech:code-igniter
  tech:code-pen
  tech:codeac
  tech:codecov
  tech:coffee-script
  tech:composer
  tech:confluence
  tech:consul
  tech:contao
  tech:corejs
  tech:cosmosdb
  tech:couchdb
  tech:cplusplus
  tech:crystal
  tech:csharp
  tech:css3
  tech:cucumber
  tech:cypress
  tech:d3js
  tech:dart
  tech:data-grip
  tech:data-spell
  tech:dbeaver
  tech:debian
  tech:deno
  tech:devicon
  tech:digital-ocean
  tech:discord-js
  tech:django
  tech:django-rest
  tech:docker
  tech:doctrine
  tech:dropwizard
  tech:drupal
  tech:eclipse-ceylon
  tech:eclipse-ide
  tech:eclipse-vert-x
  tech:elasticbeats
  tech:elasticsearch
  tech:electron
  tech:eleventy-11ty
  tech:elixir
  tech:elm
  tech:embedded-c
  tech:ember-js
  tech:envoy
  tech:erlang
  tech:eslint
  tech:express
  tech:facebook
  tech:fast-api
  tech:fastify
  tech:fauna
  tech:feathers
  tech:fedora
  tech:figma
  tech:file-zilla
  tech:firebase
  tech:firefox
  tech:flask
  tech:flutter
  tech:fortran
  tech:foundation
  tech:fsharp
  tech:gatling
  tech:gatsby
  tech:gazebo
  tech:gcc
  tech:gentoo
  tech:ghost
  tech:gimp
  tech:git
  tech:gitbook
  tech:github
  tech:github-actions
  tech:github-codespaces
  tech:gitlab
  tech:gitpod
  tech:gitter
  tech:gnu-emacs
  tech:go
  tech:go-land
  tech:godot-engine
  tech:google
  tech:google-cloud
  tech:gradle
  tech:grafana
  tech:grails
  tech:graphql
  tech:groovy
  tech:grunt-js
  tech:gulp-js
  tech:hadoop
  tech:handlebars
  tech:hardhat
  tech:harvester
  tech:hashicorp-vault
  tech:haskell
  tech:haxe
  tech:helm
  tech:heroku
  tech:hibernate
  tech:homebrew
  tech:html5
  tech:hugo
  tech:ibm-spss-statistics
  tech:ie10
  tech:ifttt
  tech:influxdb
  tech:inkscape
  tech:insomnia
  tech:intellij-idea
  tech:ionic
  tech:jaeger
  tech:jamstack
  tech:jasmine
  tech:java
  tech:javascript
  tech:jeet
  tech:jekyll
  tech:jenkins
  tech:jest
  tech:jetbrains
  tech:jira
  tech:jira-align
  tech:jquery
  tech:json
  tech:jule
  tech:julia
  tech:junit
  tech:jupyter
  tech:k3os
  tech:k3s
  tech:kafka
  tech:kaggle
  tech:karate
  tech:karma
  tech:keras
  tech:kibana
  tech:knex-js
  tech:knockout
  tech:kotlin
  tech:krakenjs
  tech:ktor
  tech:kubernetes
  tech:labview
  tech:laravel
  tech:latex
  tech:less-js
  tech:linkedin
  tech:linux
  tech:liquibase
  tech:livewire
  tech:llvm
  tech:logstash
  tech:lua
  tech:lumen
  tech:magento
  tech:markdown
  tech:material-ui
  tech:materialize
  tech:matlab
  tech:matplotlib
  tech:maven
  tech:meteor-js
  tech:microsoft-sql-server
  tech:minitab
  tech:mob-x
  tech:mocha
  tech:modx
  tech:moleculer
  tech:mongodb
  tech:mongoose-js
  tech:moodle
  tech:ms-dos
  tech:mysql
  tech:nano
  tech:nerog
  tech:nestjs
  tech:net
  tech:net-core
  tech:network-x
  tech:new4j
  tech:nextjs
  tech:nginx
  tech:nhibernate
  tech:nim
  tech:nimble
  tech:nix
  tech:nodejs
  tech:nodemon
  tech:nodewebkit
  tech:npm
  tech:nuget
  tech:num-py
  tech:nuxt-js
  tech:objective-c
  tech:ocaml
  tech:oh-my-zsh
  tech:okta
  tech:open-al
  tech:open-api
  tech:open-cl
  tech:open-cv
  tech:open-gl
  tech:open-stack
  tech:open-suse
  tech:open-telemetry
  tech:opera
  tech:oracle
  tech:p5js
  tech:packer
  tech:pandas
  tech:perl
  tech:pf-sense
  tech:phalcon
  tech:phoenix-framework
  tech:photon-engine
  tech:php
  tech:php-storm
  tech:playwrite
  tech:ploty
  tech:podman
  tech:polygon
  tech:portainer
  tech:postcss
  tech:postgresql
  tech:postman
  tech:powershell
  tech:processing
  tech:prometheus
  tech:protractor
  tech:purescript
  tech:putty
  tech:pycharm
  tech:pyscript
  tech:pytest
  tech:python
  tech:python-poetry
  tech:pytorch
  tech:qodana
  tech:qt
  tech:quarkus
  tech:quasar
  tech:qwik
  tech:r
  tech:rabbitmq
  tech:rancher
  tech:raspberrypi
  tech:reach
  tech:react
  tech:react-bootstrap
  tech:realm
  tech:red-cube-s-epic-compiler-thingy-programming-re-ct
  tech:redhat
  tech:redis
  tech:redux
  tech:ren-py
  tech:rider
  tech:robot-operating-system-ros
  tech:rocksdb
  tech:rollup-js
  tech:rspec
  tech:rstudio
  tech:ruby
  tech:ruby-mine
  tech:ruby-on-rails
  tech:rust
  tech:salesforce
  tech:sanity
  tech:sass
  tech:scala
  tech:scalingo
  tech:sdl
  tech:selenium
  tech:sema-software
  tech:sequelize
  tech:shopware
  tech:sketch
  tech:slack
  tech:socket-io
  tech:solid-js
  tech:solidity
  tech:sonarqube
  tech:sourcetree
  tech:spark
  tech:splunk
  tech:spring
  tech:sql-developer
  tech:sqlalchemy
  tech:sqlite
  tech:ssh
  tech:stackoverflow
  tech:stata
  tech:storybook
  tech:streamlit
  tech:stylus
  tech:subversion
  tech:svelte
  tech:swagger
  tech:swift
  tech:symfony
  tech:tailwind-css
  tech:tauri
  tech:tensorflow
  tech:terraform
  tech:tex
  tech:the-algorithms
  tech:three-js
  tech:titanium-sdk
  tech:tomcat
  tech:tortoise-git
  tech:tower
  tech:traefik-mesh
  tech:traefik-proxy
  tech:travis-ci
  tech:trello
  tech:twitter
  tech:typescript
  tech:typo3
  tech:ubuntu
  tech:uml
  tech:unity
  tech:unix
  tech:unreal-engine
  tech:uwsgi
  tech:v8
  tech:vagrant
  tech:vala
  tech:vercel
  tech:veutify
  tech:vim
  tech:visualstudio
  tech:vite
  tech:vitejs
  tech:vscode
  tech:vsphere
  tech:vue
  tech:vue-storefront
  tech:vyper
  tech:webassembly
  tech:webflow
  tech:weblate
  tech:webpack
  tech:webstorm
  tech:windows8
  tech:windows11
  tech:woo-commerce
  tech:wordpress
  tech:xamarin
  tech:xcode
  tech:xml
  tech:yaml
  tech:yarn
  tech:yii-framework
  tech:yuno-host
  tech:zend-framework
  tech:zig
}}`,cv="likec4builtin",OU=`${cv}:///likec4/lib/icons.c4`;function G0(t){return t.scheme===cv}const nt=un.getChild("server");function uv(t){nt.error(Ji(t))}function ke(t){nt.warn(Ji(t))}const LU={fileSystemProvider:()=>new zU},MU=t=>ov.fileExtensions.some(e=>t.endsWith(e));let zU=class extends qB{async readFile(e){return G0(e)?Promise.resolve(q0):await super.readFile(e)}async readDirectory(e){const n=[];try{const r=await new FB.fdir().withSymlinks({resolvePaths:!1}).withFullPaths().filter(MU).crawl(
e.fsPath).withPromise();for(const i of r)n.push({isFile:!0,isDirectory:!1,uri:Xt.file(i)})}catch(r){uv(r)}return n}};var FU=Object.getOwnPropertyNames,qU=Object.getOwnPropertySymbols,GU=Object.prototype.hasOwnProperty;function j0(t,e){return function(r,i,s){return t(r,i,s)&&e(r,i,s)}}function ip(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);var s=i.cache,a=s.get(n),o=s.get(r);if(a&&o)return a===r&&o===n;s.set(n,r),s.set(r,n);var c=t(n,r,i);return s.delete(
n),s.delete(r),c}}function B0(t){return FU(t).concat(qU(t))}var jU=Object.hasOwn||function(t,e){return GU.call(t,e)};function Gs(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var BU="__v",UU="__o",WU="_owner",U0=Object.getOwnPropertyDescriptor,W0=Object.keys;function HU(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function KU(t,e){return Gs(t.getTime(),e.getTime())}function VU(t,e){return t.name===e.name&&t.message===e.message&&t.cause===
e.cause&&t.stack===e.stack}function XU(t,e){return t===e}function H0(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.entries(),a,o,c=0;(a=s.next())&&!a.done;){for(var u=e.entries(),l=!1,f=0;(o=u.next())&&!o.done;){if(i[f]){f++;continue}var d=a.value,h=o.value;if(n.equals(d[0],h[0],c,f,t,e,n)&&n.equals(d[1],h[1],d[0],h[0],t,e,n)){l=i[f]=!0;break}f++}if(!l)return!1;c++}return!0}var YU=Gs;function JU(t,e,n){var r=W0(t),i=r.length;if(W0(e).length!==i)return!1;for(;i-- >
0;)if(!V0(t,e,n,r[i]))return!1;return!0}function Ul(t,e,n){var r=B0(t),i=r.length;if(B0(e).length!==i)return!1;for(var s,a,o;i-- >0;)if(s=r[i],!V0(t,e,n,s)||(a=U0(t,s),o=U0(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function QU(t,e){return Gs(t.valueOf(),e.valueOf())}function ZU(t,e){return t.source===e.source&&t.flags===e.flags}function K0(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(
r),s=t.values(),a,o;(a=s.next())&&!a.done;){for(var c=e.values(),u=!1,l=0;(o=c.next())&&!o.done;){if(!i[l]&&n.equals(a.value,o.value,a.value,o.value,t,e,n)){u=i[l]=!0;break}l++}if(!u)return!1}return!0}function eW(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function tW(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function V0(t,e,n,r){
return(r===WU||r===UU||r===BU)&&(t.$$typeof||e.$$typeof)?!0:jU(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var nW="[object Arguments]",rW="[object Boolean]",iW="[object Date]",sW="[object Error]",aW="[object Map]",oW="[object Number]",cW="[object Object]",uW="[object RegExp]",lW="[object Set]",dW="[object String]",fW="[object URL]",hW=Array.isArray,X0=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Y0=Object.assign,pW=Object.prototype.toString.call.bind(Object.prototype.toString);
function mW(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,i=t.areFunctionsEqual,s=t.areMapsEqual,a=t.areNumbersEqual,o=t.areObjectsEqual,c=t.arePrimitiveWrappersEqual,u=t.areRegExpsEqual,l=t.areSetsEqual,f=t.areTypedArraysEqual,d=t.areUrlsEqual;return function(m,b,$){if(m===b)return!0;if(m==null||b==null)return!1;var w=typeof m;if(w!==typeof b)return!1;if(w!=="object")return w==="number"?a(m,b,$):w==="function"?i(m,b,$):!1;var k=m.constructor;if(k!==b.constructor)return!1;if(k===
Object)return o(m,b,$);if(hW(m))return e(m,b,$);if(X0!=null&&X0(m))return f(m,b,$);if(k===Date)return n(m,b,$);if(k===RegExp)return u(m,b,$);if(k===Map)return s(m,b,$);if(k===Set)return l(m,b,$);var S=pW(m);return S===iW?n(m,b,$):S===uW?u(m,b,$):S===aW?s(m,b,$):S===lW?l(m,b,$):S===cW?typeof m.then!="function"&&typeof b.then!="function"&&o(m,b,$):S===fW?d(m,b,$):S===sW?r(m,b,$):S===nW?o(m,b,$):S===rW||S===oW||S===dW?c(m,b,$):!1}}function gW(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={
areArraysEqual:r?Ul:HU,areDatesEqual:KU,areErrorsEqual:VU,areFunctionsEqual:XU,areMapsEqual:r?j0(H0,Ul):H0,areNumbersEqual:YU,areObjectsEqual:r?Ul:JU,arePrimitiveWrappersEqual:QU,areRegExpsEqual:ZU,areSetsEqual:r?j0(K0,Ul):K0,areTypedArraysEqual:r?Ul:eW,areUrlsEqual:tW};if(n&&(i=Y0({},i,n(i))),e){var s=ip(i.areArraysEqual),a=ip(i.areMapsEqual),o=ip(i.areObjectsEqual),c=ip(i.areSetsEqual);i=Y0({},i,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:c})}return i}function yW(t){return function(e,n,r,i,s,a,o){
return t(e,n,o)}}function vW(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,s=t.strict;if(r)return function(c,u){var l=r(),f=l.cache,d=f===void 0?e?new WeakMap:void 0:f,h=l.meta;return n(c,u,{cache:d,equals:i,meta:h,strict:s})};if(e)return function(c,u){return n(c,u,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var a={cache:void 0,equals:i,meta:void 0,strict:s};return function(c,u){return n(c,u,a)}}var lv=Li();Li({strict:!0}),Li({circular:!0}),Li({circular:!0,strict:!0}),Li(
{createInternalComparator:function(){return Gs}}),Li({strict:!0,createInternalComparator:function(){return Gs}}),Li({circular:!0,createInternalComparator:function(){return Gs}}),Li({circular:!0,createInternalComparator:function(){return Gs},strict:!0});function Li(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,i=t.createState,s=t.strict,a=s===void 0?!1:s,o=gW(t),c=mW(o),u=r?r(c):yW(c);return vW({circular:n,comparator:c,createState:i,equals:u,strict:a})}function J0(t,e){
const n=t.nodes.map(i=>{const s=e.nodes[i.id];if(!s)return i;const{x:a,y:o,width:c,height:u}=s;return{...i,width:c,height:u,position:[a,o]}}),r=t.edges.map(i=>{const s=e.edges[i.id];return s?{...i,...s}:i});return{...t,bounds:{x:e.x,y:e.y,width:e.width,height:e.height},nodes:n,edges:r}}const Q0=(t,e)=>t.width>e.width+10||t.height>e.height+10;function wW(t,e){if(t.hash===e.hash)return{diagram:J0(t,e)};if(lv(t.autoLayout,e.autoLayout)&&t.nodes.every(r=>{const i=e.nodes[r.id];return!!i&&(r.children.
length>0&&i.isCompound||r.children.length===0&&!i.isCompound)&&(i.isCompound||Q0(r,i)===!1)})&&t.edges.every(r=>{const i=e.edges[r.id];return!!i&&(!r.labelBBox&&!i.labelBBox||!!r.labelBBox&&!!i.labelBBox&&r.labelBBox.width<=i.labelBBox.width&&r.labelBBox.height<=i.labelBBox.height)}))return{diagram:J0(t,e)};const n=t.nodes.reduce((r,i)=>{const s=e.nodes[i.id];if(i.children.length>0||!s)return r;const a={id:i.id,center:{x:Math.round(s.x+s.width/2),y:Math.round(s.y+s.height/2)}};return s.isCompound||
Q0(i,s)||(a.fixedsize={width:s.width,height:s.height}),r.push(a),r},[]);return{relayout:{x:e.x,y:e.y,height:e.height,nodes:n,edges:Gf(e.edges).flatMap(([r,i])=>i.dotpos?{id:r,dotpos:i.dotpos}:[])}}}function Z0(t){return typeof t=="object"&&t!==null&&typeof t.id=="string"}function dv(t){return typeof t=="object"&&t!==null&&t.$$type==="Node"&&typeof t.id=="string"}function eA(t){return dv(t)||Z0(t)}function Wl(t){return typeof t=="string"||eA(t)}function bW(t){return Array.isArray(t)&&t.every(Wl)}
function $W(t){return["n","ne","e","se","s","sw","w","nw","c"].includes(t)}function tA(t){if(eA(t))return t;const[e,n,r]=t.split(":");return $W(r)?{id:e,port:n,compass:r}:{id:e,port:n}}function RW(t){if(t.length<2&&(Wl(t[0])&&Wl(t[1]))===!1)throw Error("EdgeTargets must have at least 2 elements.");return t.map(e=>tA(e))}const sp=Object.seal({Graph:null,Digraph:null,Subgraph:null,Node:null,Edge:null});function kW(t){return Object.assign(Object.seal(Object.assign({},sp)),t)}function TW(...t){const[
e,...n]=t;return(...r)=>n.reduce((i,s)=>s(i),e(...r))}function Xn(t,...e){return TW(t,...e)}const EW=t=>(...e)=>n=>t(n,...e),SW=t=>({[Symbol.iterator]:t}),lr=EW((t,e)=>Array.from(SW(function*(){for(const n of t)yield e(n)})));class nA{options;getLocation(){return this.options?.locationFunction?.()??null}constructor(e){this.options=e}createElement(e,n,r=[]){return{location:this.getLocation(),...n,type:e,children:r}}}const Je=nA.prototype.createElement.bind(new nA),AW=/\r?\n/;function dr(t){return e=>e.
join(t)}function _W(t){return e=>t+e+t}function Mi(t,e){return n=>t+n+e}function ap(t){return e=>t+e}const rA=t=>t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"'),op=t=>t.split(AW),Hl=(t,e,n)=>Xn(op,lr(ap(t==="space"?" ".repeat(e):`
`)),dr(n)),js=t=>{switch(t){case"crlf":return`\r
`;case"lf":return`
`}},CW={match(t){return t.type==="AttributeList"},print(t,e){if(e.children.length===0)return`${e.kind.toLocaleLowerCase()} [];`;const n=js(t.endOfLine);return Xn(lr(t.print),dr(n),Hl(t.indentStyle,t.indentSize,n),Mi(`${e.kind.toLocaleLowerCase()} [${n}`,`${n}];`))(e.children)}},PW={match(t){return t.type==="Attribute"},print(t,e){return`${t.print(e.key)} = ${t.print(e.value)};`}},xW={match(t){return t.type==="Comment"},print(t,e){const n=js(t.endOfLine);switch(e.kind){case"Block":return Xn(op,lr(
ap(" * ")),dr(n),Mi(`/**${n}`,`${n} */`))(e.value);case"Macro":return Xn(op,lr(ap("# ")),dr(n))(e.value);case"Slash":default:return Xn(op,lr(ap("// ")),dr(n))(e.value)}}},DW={match(t){return t.type==="Dot"},print(t,e){return e.children.map(t.print).join(js(t.endOfLine))}},NW={match(t){return t.type==="Edge"},print(t,e){const n=Xn(lr(t.print),dr(t.directed?" -> ":" -- "))(e.targets);if(e.children.length===0)return`${n};`;const r=js(t.endOfLine),i=Xn(lr(t.print),dr(r),Hl(t.indentStyle,t.indentSize,
r),Mi(`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},IW={match(t){return t.type==="Graph"},print(t,e){t.directed=e.directed;const n=[];if(e.strict&&n.push("strict"),n.push(e.directed?"digraph":"graph"),e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=js(t.endOfLine),i=Xn(lr(t.print),dr(r),Hl(t.indentStyle,t.indentSize,r),Mi(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},OW=Xn(rA,_W('"')),LW=Mi("<",">"),MW={match(t){return t.type==="Literal"},print(t,e){
switch(e.quoted){case"html":return LW(e.value);case!0:return OW(e.value);case!1:default:return rA(e.value)}}},zW={match(t){return t.type==="Node"},print(t,e){const n=t.print(e.id);if(e.children.length===0)return`${n};`;const r=js(t.endOfLine),i=Xn(lr(t.print),dr(r),Hl(t.indentStyle,t.indentSize,r),Mi(`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},FW={match(t){return t.type==="NodeRefGroup"},print(t,e){return Xn(lr(t.print),dr(" "),Mi("{","}"))(e.children)}},qW={match(t){return t.type==="Node\
Ref"},print(t,e){const n=[t.print(e.id)];return e.port&&n.push(t.print(e.port)),e.compass&&n.push(t.print(e.compass)),n.join(":")}},GW={match(t){return t.type==="Subgraph"},print(t,e){const n=["subgraph"];if(e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=js(t.endOfLine),i=Xn(lr(t.print),dr(r),Hl(t.indentStyle,t.indentSize,r),Mi(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},jW=[CW,PW,xW,DW,NW,IW,MW,zW,FW,qW,GW];class BW{options;#e=[...jW];constructor(e={}){
this.options=e}print(e){const n=[...this.#e],{indentSize:r=2,indentStyle:i="space",endOfLine:s="lf"}=this.options,a={directed:!0,indentSize:r,indentStyle:i,endOfLine:s,print(o){for(const c of n)if(c.match(o))return c.print(a,o);throw Error()}};return a.print(e)}}function UW(t,e){const n=new BW(e).print(t);if(!n)throw new Error;return n}function cp(t,e){if(typeof e=="string"){const n=e.trim();return/^<.+>$/ms.test(n)?Je("Attribute",{key:Je("Literal",{value:t,quoted:!1},[]),value:Je("Literal",{value:n.
slice(1,n.length-1),quoted:"html"},[])},[]):Je("Attribute",{key:Je("Literal",{value:t,quoted:!1},[]),value:Je("Literal",{value:e,quoted:!0},[])},[])}return Je("Attribute",{key:Je("Literal",{value:t,quoted:!1},[]),value:Je("Literal",{value:String(e),quoted:!1},[])},[])}function Bs(t,e){return Je("Comment",{kind:e,value:t},[])}function iA(t,e){return Array.from(function*(){for(const[n,r]of e.values)yield cp(n,r);for(const n of Object.values(e.attributes))n.size>0&&(n.comment&&(yield Bs(n.comment,t.
commentKind)),yield t.convert(n));for(const n of e.nodes)n.comment&&(yield Bs(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.subgraphs)n.comment&&(yield Bs(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.edges)n.comment&&(yield Bs(n.comment,t.commentKind)),yield t.convert(n)}())}const WW={match(t){return t.$$type==="AttributeList"},convert(t,e){return Je("AttributeList",{kind:e.$$kind},e.values.map(([n,r])=>cp(n,r)))}},HW={match(t){return t.$$type==="Edge"},convert(t,e){
return Je("Edge",{targets:e.targets.map(n=>dv(n)?Je("NodeRef",{id:Je("Literal",{value:n.id,quoted:!0},[])},[]):Z0(n)?Je("NodeRef",{id:Je("Literal",{value:n.id,quoted:!0},[]),port:n.port?Je("Literal",{value:n.port,quoted:!0},[]):void 0,compass:n.compass?Je("Literal",{value:n.compass,quoted:!0},[]):void 0},[]):Je("NodeRefGroup",{},n.map(r=>dv(r)?Je("NodeRef",{id:Je("Literal",{value:r.id,quoted:!0},[])},[]):Je("NodeRef",{id:Je("Literal",{value:r.id,quoted:!0},[]),port:r.port?Je("Literal",{value:r.port,
quoted:!0},[]):void 0,compass:r.compass?Je("Literal",{value:r.compass,quoted:!0},[]):void 0},[]))))},[...e.attributes.comment?[Bs(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>cp(n,r))])}},KW={match(t){return t.$$type==="Graph"},convert(t,e){return Je("Dot",{},[...e.comment?[Bs(e.comment,t.commentKind)]:[],Je("Graph",{directed:e.directed,strict:e.strict,id:e.id?Je("Literal",{value:e.id,quoted:!0},[]):void 0},iA(t,e))])}},VW={match(t){return t.$$type==="Node"},convert(t,e){
return Je("Node",{id:Je("Literal",{value:e.id,quoted:!0},[])},[...e.attributes.comment?[Bs(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>cp(n,r))])}},XW={match(t){return t.$$type==="Subgraph"},convert(t,e){return Je("Subgraph",{id:e.id?Je("Literal",{value:e.id,quoted:!0},[]):void 0},iA(t,e))}},YW=[WW,HW,VW,KW,XW];class JW{options;#e=[...YW];constructor(e={}){this.options=e}convert(e){const n=[...this.#e],{commentKind:r="Slash"}=this.options,i={commentKind:r,convert(s){
for(const a of n)if(a.match(s))return a.convert(i,s);throw Error()}};return i.convert(e)}}function QW(t,e){return new JW(e).convert(t)}const O=new Proxy(Object.freeze({}),{get:(t,e)=>e});class fv{}class hv extends fv{#e=new Map;constructor(e){super(),e!==void 0&&this.apply(e)}get values(){return Array.from(this.#e.entries())}get size(){return this.#e.size}get(e){return this.#e.get(e)}set(e,n){n!=null&&this.#e.set(e,n)}delete(e){this.#e.delete(e)}apply(e){const n=Array.isArray(e)?e:Object.entries(
e);for(const[r,i]of n)this.set(r,i)}clear(){this.#e.clear()}}class pv extends hv{$$kind;get $$type(){return"AttributeList"}comment;constructor(e,n){super(n),this.$$kind=e}}class sA extends hv{#e=sp;id;comment;attributes=Object.freeze({graph:new pv("Graph"),edge:new pv("Edge"),node:new pv("Node")});get nodes(){return Array.from(this.#t.nodes.values())}get edges(){return Array.from(this.#t.edges.values())}get subgraphs(){return Array.from(this.#t.subgraphs.values())}#t={nodes:new Map,edges:new Set,
subgraphs:new Set};with(e){this.#e=kW(e)}addNode(e){this.#t.nodes.set(e.id,e)}addEdge(e){this.#t.edges.add(e)}addSubgraph(e){this.#t.subgraphs.add(e)}existNode(e){return this.#t.nodes.has(e)}existEdge(e){return this.#t.edges.has(e)}existSubgraph(e){return this.#t.subgraphs.has(e)}createSubgraph(...e){const n=new this.#e.Subgraph(...e);return n.with(this.#e),this.addSubgraph(n),n}removeNode(e){this.#t.nodes.delete(typeof e=="string"?e:e.id)}removeEdge(e){this.#t.edges.delete(e)}removeSubgraph(e){
this.#t.subgraphs.delete(e)}createNode(e,n){const r=new this.#e.Node(e,n);return this.addNode(r),r}getSubgraph(e){return Array.from(this.#t.subgraphs.values()).find(n=>n.id===e)}getNode(e){return this.#t.nodes.get(e)}createEdge(e,n){const r=e.map(s=>bW(s)?RW(s):tA(s)),i=new this.#e.Edge(r,n);return this.addEdge(i),i}subgraph(...e){const n=e.find(a=>typeof a=="string"),r=e.find(a=>typeof a=="object"&&a!==null),i=e.find(a=>typeof a=="function"),s=n?this.getSubgraph(n)??this.createSubgraph(n):this.
createSubgraph();return r!==void 0&&s.apply(r),i!==void 0&&i(s),s}node(e,...n){if(typeof e=="string"){const r=e,i=n.find(o=>typeof o=="object"&&o!==null),s=n.find(o=>typeof o=="function"),a=this.getNode(r)??this.createNode(r);return i!==void 0&&a.attributes.apply(i),s!==void 0&&s(a),a}typeof e=="object"&&e!==null&&this.attributes.node.apply(e)}edge(e,...n){if(Array.isArray(e)){const r=e,i=n.find(o=>typeof o=="object"),s=n.find(o=>typeof o=="function"),a=this.createEdge(r,i);return s!==void 0&&s(
a),a}typeof e=="object"&&e!==null&&this.attributes.edge.apply(e)}graph(e){this.attributes.graph.apply(e)}}class aA extends sA{get $$type(){return"Graph"}id;strict;constructor(...e){super(),this.id=e.find(r=>typeof r=="string"),this.strict=e.find(r=>typeof r=="boolean")??!1;const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}}class ZW extends aA{get directed(){return!0}}let eH=class extends aA{get directed(){return!1}};class tH extends sA{get $$type(){return"Subgraph"}id;constructor(...e){
super(),this.id=e.find(r=>typeof r=="string");const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}isSubgraphCluster(){return typeof this.id=="string"?this.id.startsWith("cluster"):!1}}class oA extends hv{comment}let nH=class extends fv{id;get $$type(){return"Node"}comment;attributes;constructor(e,n){super(),this.id=e,this.attributes=new oA(n)}port(e){return typeof e=="string"?{id:this.id,port:e}:{id:this.id,...e}}};class rH extends fv{targets;get $$type(){return"Edge"}comment;attributes;constructor(e,n){
if(super(),this.targets=e,e.length<2&&(Wl(e[0])&&Wl(e[1]))===!1)throw Error("The element of Edge target is missing or not satisfied as Edge target.");this.attributes=new oA(n)}}Object.assign(sp,{Graph:eH,Digraph:ZW,Subgraph:tH,Node:nH,Edge:rH});function cA(t,e){return(...n)=>{const r=t?this.Digraph:this.Graph,i=n.find(c=>typeof c=="string"),s=n.find(c=>typeof c=="object"),a=n.find(c=>typeof c=="function"),o=new r(i,e,s);return o.with(this),typeof a=="function"&&a(o),o}}function uA(t,e=sp){return Object.
freeze({digraph:cA.call(e,!0,t),graph:cA.call(e,!1,t)})}const lA=uA(!1),iH=lA.digraph;lA.graph;const sH=uA(!0);function dA(t,e){const n=QW(t,e?.convert);return UW(n,e?.print)}var mv,fA;function aH(){if(fA)return mv;fA=1;function t(r){let i=r.length-1,s=r[i];for(;s===" "||s==="	";)s=r[--i];return r.substring(0,i+1)}function e(r){return r.split(`
`).map(a=>t(a)).join(`
`)}mv=function(r,i){if(i=i||{},r==null)return r;var s=i.width||50,a=typeof i.indent=="string"?i.indent:"  ",o=i.newline||`
`+a,c=typeof i.escape=="function"?i.escape:n,u=".{1,"+s+"}";i.cut!==!0&&(u+="([\\s\u200B]+|$)|[^\\s\u200B]+?([\\s\u200B]+|$)");var l=new RegExp(u,"g"),f=r.match(l)||[],d=a+f.map(function(h){return h.slice(-1)===`
`&&(h=h.slice(0,h.length-1)),c(h)}).join(o);return i.trim===!0&&(d=e(d)),d};function n(r){return r}return mv}var oH=aH();const cH=Dr(oH),up={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:t=>t>=255?255:t<0?0:t,g:t=>t>=255?255:t<0?0:t,b:t=>t>=255?255:t<0?0:t,h:t=>t%360,s:t=>t>=100?100:t<0?0:t,l:t=>t>=100?100:t<0?0:t,a:t=>t>=1?1:t<0?0:t},toLinear:t=>{const e=t/255;return t>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92},hue2rgb:(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<
1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),hsl2rgb:({h:t,s:e,l:n},r)=>{if(!e)return n*2.55;t/=360,e/=100,n/=100;const i=n<.5?n*(1+e):n+e-n*e,s=2*n-i;switch(r){case"r":return up.hue2rgb(s,i,t+1/3)*255;case"g":return up.hue2rgb(s,i,t)*255;case"b":return up.hue2rgb(s,i,t-1/3)*255}},rgb2hsl:({r:t,g:e,b:n},r)=>{t/=255,e/=255,n/=255;const i=Math.max(t,e,n),s=Math.min(t,e,n),a=(i+s)/2;if(r==="l")return a*100;if(i===s)return 0;const o=i-s,c=a>.5?o/(2-i-s):o/(i+s);if(r==="s")return c*100;switch(i){case t:
return((e-n)/o+(e<n?6:0))*60;case e:return((n-t)/o+2)*60;case n:return((t-e)/o+4)*60;default:return-1}}},uH={clamp:(t,e,n)=>e>n?Math.min(e,Math.max(n,t)):Math.min(n,Math.max(e,t)),round:t=>Math.round(t*1e10)/1e10},lH={dec2hex:t=>{const e=Math.round(t).toString(16);return e.length>1?e:`0${e}`}},Oe={channel:up,lang:uH,unit:lH},zi={};for(let t=0;t<=255;t++)zi[t]=Oe.unit.dec2hex(t);const sn={ALL:0,RGB:1,HSL:2};class dH{constructor(){this.type=sn.ALL}get(){return this.type}set(e){if(this.type&&this.type!==
e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=sn.ALL}is(e){return this.type===e}}class fH{constructor(e,n){this.color=n,this.changed=!1,this.data=e,this.type=new dH}set(e,n){return this.color=n,this.changed=!1,this.data=e,this.type.type=sn.ALL,this}_ensureHSL(){const e=this.data,{h:n,s:r,l:i}=e;n===void 0&&(e.h=Oe.channel.rgb2hsl(e,"h")),r===void 0&&(e.s=Oe.channel.rgb2hsl(e,"s")),i===void 0&&(e.l=Oe.channel.rgb2hsl(e,"l"))}_ensureRGB(){
const e=this.data,{r:n,g:r,b:i}=e;n===void 0&&(e.r=Oe.channel.hsl2rgb(e,"r")),r===void 0&&(e.g=Oe.channel.hsl2rgb(e,"g")),i===void 0&&(e.b=Oe.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,n=e.r;return!this.type.is(sn.HSL)&&n!==void 0?n:(this._ensureHSL(),Oe.channel.hsl2rgb(e,"r"))}get g(){const e=this.data,n=e.g;return!this.type.is(sn.HSL)&&n!==void 0?n:(this._ensureHSL(),Oe.channel.hsl2rgb(e,"g"))}get b(){const e=this.data,n=e.b;return!this.type.is(sn.HSL)&&n!==void 0?n:(this._ensureHSL(),Oe.
channel.hsl2rgb(e,"b"))}get h(){const e=this.data,n=e.h;return!this.type.is(sn.RGB)&&n!==void 0?n:(this._ensureRGB(),Oe.channel.rgb2hsl(e,"h"))}get s(){const e=this.data,n=e.s;return!this.type.is(sn.RGB)&&n!==void 0?n:(this._ensureRGB(),Oe.channel.rgb2hsl(e,"s"))}get l(){const e=this.data,n=e.l;return!this.type.is(sn.RGB)&&n!==void 0?n:(this._ensureRGB(),Oe.channel.rgb2hsl(e,"l"))}get a(){return this.data.a}set r(e){this.type.set(sn.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(sn.RGB),
this.changed=!0,this.data.g=e}set b(e){this.type.set(sn.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(sn.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(sn.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(sn.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}const gv=new fH({r:0,g:0,b:0,a:0},"transparent"),Ka={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:t=>{if(t.charCodeAt(0)!==35)return;const e=t.match(Ka.re);if(!e)return;const n=e[1],
r=parseInt(n,16),i=n.length,s=i%4===0,a=i>4,o=a?1:17,c=a?8:4,u=s?0:-1,l=a?255:15;return gv.set({r:(r>>c*(u+3)&l)*o,g:(r>>c*(u+2)&l)*o,b:(r>>c*(u+1)&l)*o,a:s?(r&l)*o/255:1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`#${zi[Math.round(e)]}${zi[Math.round(n)]}${zi[Math.round(r)]}${zi[Math.round(i*255)]}`:`#${zi[Math.round(e)]}${zi[Math.round(n)]}${zi[Math.round(r)]}`}},Us={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,
hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:t=>{const e=t.match(Us.hueRe);if(e){const[,n,r]=e;switch(r){case"grad":return Oe.channel.clamp.h(parseFloat(n)*.9);case"rad":return Oe.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return Oe.channel.clamp.h(parseFloat(n)*360)}}return Oe.channel.clamp.h(parseFloat(t))},parse:t=>{const e=t.charCodeAt(0);if(e!==104&&e!==72)return;const n=t.match(Us.re);if(!n)return;const[,r,i,s,a,o]=n;return gv.set({h:Us._hue2deg(r),s:Oe.channel.clamp.s(parseFloat(
i)),l:Oe.channel.clamp.l(parseFloat(s)),a:a?Oe.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},t)},stringify:t=>{const{h:e,s:n,l:r,a:i}=t;return i<1?`hsla(${Oe.lang.round(e)}, ${Oe.lang.round(n)}%, ${Oe.lang.round(r)}%, ${i})`:`hsl(${Oe.lang.round(e)}, ${Oe.lang.round(n)}%, ${Oe.lang.round(r)}%)`}},Kl={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",
blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8f\
bc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c\
5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"\
#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"\
#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"\
#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:t=>{t=t.toLowerCase();const e=Kl.colors[t];if(e)return Ka.parse(e)},stringify:t=>{const e=Ka.stringify(t);for(const n in Kl.colors)if(Kl.colors[n]===e)return n}},Vl={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,
parse:t=>{const e=t.charCodeAt(0);if(e!==114&&e!==82)return;const n=t.match(Vl.re);if(!n)return;const[,r,i,s,a,o,c,u,l]=n;return gv.set({r:Oe.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:Oe.channel.clamp.g(a?parseFloat(s)*2.55:parseFloat(s)),b:Oe.channel.clamp.b(c?parseFloat(o)*2.55:parseFloat(o)),a:u?Oe.channel.clamp.a(l?parseFloat(u)/100:parseFloat(u)):1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`rgba(${Oe.lang.round(e)}, ${Oe.lang.round(n)}, ${Oe.lang.round(r)}, ${Oe.lang.
round(i)})`:`rgb(${Oe.lang.round(e)}, ${Oe.lang.round(n)}, ${Oe.lang.round(r)})`}},Fi={format:{keyword:Kl,hex:Ka,rgb:Vl,rgba:Vl,hsl:Us,hsla:Us},parse:t=>{if(typeof t!="string")return t;const e=Ka.parse(t)||Vl.parse(t)||Us.parse(t)||Kl.parse(t);if(e)return e;throw new Error(`Unsupported color format: "${t}"`)},stringify:t=>!t.changed&&t.color?t.color:t.type.is(sn.HSL)||t.data.r===void 0?Us.stringify(t):t.a<1||!Number.isInteger(t.r)||!Number.isInteger(t.g)||!Number.isInteger(t.b)?Vl.stringify(t):Ka.
stringify(t)},hH=(t,e)=>{const n=Fi.parse(t);for(const r in e)n[r]=Oe.channel.clamp[r](e[r]);return Fi.stringify(n)},hA=t=>Fi.format.hex.stringify(Fi.parse(t)),pH=(t,e,n)=>{const r=Fi.parse(t),i=r[e],s=Oe.channel.clamp[e](i+n);return i!==s&&(r[e]=s),Fi.stringify(r)},mH=(t,e)=>pH(t,"a",-.3),gH=(t,e)=>{const n=Fi.parse(t),r={};for(const i in e)e[i]&&(r[i]=n[i]+e[i]);return hH(t,r)},yH=(t,e)=>{const n=Fi.parse(t),r={},i=(s,a,o)=>a>0?(o-s)*a/100:s*a/100;for(const s in e)r[s]=i(n[s],e[s],Oe.channel.max[s]);
return gH(t,r)};function qn(t){return t.children.length>0}function an(t){switch(t){case"open":return"vee";default:return t}}function Cr(t){return Array.isArray(t)?[Cr(t[0]),Cr(t[1])]:(Ie(isFinite(t),`Invalid not finite point value ${t}`),Math.round(t))}const pA=t=>(Ie(isFinite(t),`Invalid not finite inch value ${t}`),Math.floor(t*72)),dt=t=>Math.ceil(t/72*1e3)/1e3,Yn=t=>Math.ceil(t);Yn(40).toString();function mA(t,e){return hA(yH(t,{l:-35-5*e,s:-15-5*e}))}function vH(t){return hA(mH(t))}function wH(t){
return t.trim().replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")}function gA(t,{maxchars:e,maxLines:n,sanitize:r=vj()}){let i=cH(t,{width:e,indent:"",escape:r}).split(`
`);return Yt(n)&&n>0&&i.length>n&&(i=i.slice(0,n-1)),i}function Ws({text:t,maxchars:e,fontsize:n,maxLines:r,bold:i,color:s}){let a=gA(t,{maxchars:e,maxLines:r,sanitize:wH}).join("<BR/>");i&&(a=`<B>${a}</B>`);const o=s?` COLOR="${s}"`:"";return`<FONT POINT-SIZE="${Yn(n)}"${o}>${a}</FONT>`}function yv(t){return qt.textSizes[t]}function bH(t){switch(t){case"xs":case"sm":return 25;case"md":return 35;case"lg":case"xl":return 45;default:Me(t)}}function $H(t,e,n){const r=["sm","xs"].includes(n.shape),i=ce(
t.icon),s=[Ws({text:t.title,fontsize:yv(n.text),maxchars:bH(n.shape),maxLines:r?1:3})];if(n.shape!=="xs"&&(ce(t.technology?.trim())&&s.push(Ws({text:t.technology,fontsize:Math.ceil(yv(n.text)*.65),maxchars:i?35:45,maxLines:1,color:e.loContrast})),ce(t.description?.trim())&&s.push(Ws({text:t.description,fontsize:Math.ceil(yv(n.text)*.75),maxchars:i?35:45,maxLines:r?3:5,color:e.loContrast}))),s.length===1&&!i)return`<${s[0]}>`;const a=i?(o,c,u)=>{let l=`<TD ALIGN="TEXT" BALIGN="LEFT">${o}</TD>`;if(c===
0){const f=u.length>1?` ROWSPAN="${u.length}"`:"";let d=76;["xs","sm"].includes(n.shape)&&(d=16),(t.shape==="queue"||t.shape==="mobile")&&(d+=20),l=`<TD${f} WIDTH="${d}"> </TD>${l}`,l=`${l}<TD${f} WIDTH="16"> </TD>`}return`<TR>${l}</TR>`}:o=>`<TR><TD>${o}</TD></TR>`;return`<<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="4">${s.map(a).join("")}</TABLE>>`}function RH(t,e){const n=Ws({text:t.title.toUpperCase(),maxchars:50,fontsize:11,maxLines:1,bold:!0,color:e});return n.includes("<BR/>")?`<<TABLE\
 BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD ALIGN="TEXT" BALIGN="LEFT">${n}</TD></TR></TABLE>>`:`<${n}>`}const lp=40,yA=5,vv=`BGCOLOR="${qt.relationships[io].labelBgColor}A0"`;function vA({label:t,technology:e}){const n=[];if(ce(t?.trim())&&n.push(Ws({text:t,maxchars:lp,fontsize:14,maxLines:yA,bold:t==="[...]"})),ce(e?.trim())&&n.push(Ws({text:`[ ${e} ]`,fontsize:12,maxLines:1,maxchars:lp})),n.length===0)return null;const r=n.map(i=>`<TR><TD ALIGN="TEXT" BALIGN="LEFT">${i}</TD></TR>`).join(
"");return`<<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" ${vv}>${r}</TABLE>>`}function kH(t,e){const n=`<TABLE BORDER="0" CELLPADDING="6" ${vv}><TR><TD WIDTH="20" HEIGHT="20"><FONT POINT-SIZE="${Yn(14)}"><B>${t}</B></FONT></TD></TR></TABLE>`;return ce(e?.trim())?`<${['<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">',"<TR>",`<TD>${n}</TD>`,`<TD ${vv} CELLPADDING="3">`,Ws({text:e,maxchars:lp,fontsize:14,maxLines:5}),"</TD>","</TR>","</TABLE>"].join("")}>`:`<${n}>`}var wv,wA;function bv(){if(wA)
return wv;wA=1;function t(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}return typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=function(){return this}),t.of=function(){var e=arguments,n=e.length,r=0;return new t(function(){return r>=n?{done:!0}:{done:!1,value:e[r++]}})},t.empty=function(){var e=new t(function(){return{done:!0}});return e},t.fromSequence=function(e){var n=0,r=e.length;return new t(function(){return n>=r?{done:!0}:{done:!1,value:e[n++]}})},
t.is=function(e){return e instanceof t?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"},wv=t,wv}var TH=bv();const Jn=Dr(TH);var dp={},bA;function EH(){return bA||(bA=1,dp.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u",dp.SYMBOL_SUPPORT=typeof Symbol<"u"),dp}var $v,$A;function RA(){if($A)return $v;$A=1;var t=bv(),e=EH(),n=e.ARRAY_BUFFER_SUPPORT,r=e.SYMBOL_SUPPORT;function i(s){return typeof s=="string"||Array.isArray(s)||n&&ArrayBuffer.isView(s)?t.fromSequence(s):typeof s!="object"||s===null?
null:r&&typeof s[Symbol.iterator]=="function"?s[Symbol.iterator]():typeof s.next=="function"?s:null}return $v=function(a){var o=i(a);if(!o)throw new Error("obliterator: target is not iterable nor a valid iterator.");return o},$v}var Rv,kA;function SH(){if(kA)return Rv;kA=1;var t=RA();return Rv=function(n,r){for(var i=arguments.length>1?r:1/0,s=i!==1/0?new Array(i):[],a,o=0,c=t(n);;){if(o===i)return s;if(a=c.next(),a.done)return o!==r&&(s.length=o),s;s[o++]=a.value}},Rv}var AH=SH();const TA=Dr(AH);
var kv,EA;function _H(){if(EA)return kv;EA=1;var t=bv(),e=RA();return kv=function(){var r=arguments,i=null,s=-1;return new t(function(){var o=null;do{if(i===null){if(s++,s>=r.length)return{done:!0};i=e(r[s])}if(o=i.next(),o.done===!0){i=null;continue}break}while(!0);return o})},kv}var CH=_H();const ci=Dr(CH);function PH(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const r in arguments[e])t[r]=arguments[e][r];return t}let Lt=PH;typeof Object.assign=="function"&&
(Lt=Object.assign);function Qn(t,e,n,r){const i=t._nodes.get(e);let s=null;return i&&(r==="mixed"?s=i.out&&i.out[n]||i.undirected&&i.undirected[n]:r==="directed"?s=i.out&&i.out[n]:s=i.undirected&&i.undirected[n]),s}function Qt(t){return typeof t=="object"&&t!==null}function SA(t){let e;for(e in t)return!1;return!0}function Zn(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function fr(t,e,n){const r={enumerable:!0,configurable:!0};typeof n=="function"?r.get=
n:(r.value=n,r.writable=!1),Object.defineProperty(t,e,r)}function AA(t){return!(!Qt(t)||t.attributes&&!Array.isArray(t.attributes))}function xH(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class Tv extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class pe extends Tv{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,pe.prototype.constructor)}}class ae extends Tv{constructor(e){
super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ae.prototype.constructor)}}class Se extends Tv{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Se.prototype.constructor)}}function _A(t,e){this.key=t,this.attributes=e,this.clear()}_A.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=
0,this.in={},this.out={},this.undirected={}};function CA(t,e){this.key=t,this.attributes=e,this.clear()}CA.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function PA(t,e){this.key=t,this.attributes=e,this.clear()}PA.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Va(t,e,n,r,i){this.key=e,this.attributes=i,this.undirected=t,this.source=n,this.target=r}Va.prototype.attach=function(){let t="\
out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,r=this.target.key;this.source[t][r]=this,!(this.undirected&&n===r)&&(this.target[e][n]=this)},Va.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,r=this.target.key;this.undirected&&(t=e="undirected");const i=this.source[t],s=i[r];if(typeof s>"u"){i[r]=this,this.undirected&&n===r||(this.target[e][n]=this);return}s.previous=this,this.next=s,i[r]=this,this.target[e][n]=this},Va.prototype.detach=function(){
const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][e],delete this.target[r][t]},Va.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[r][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[r][t]=this.next):(this.previous.next=this.next,this.next!==
void 0&&(this.next.previous=this.previous))};const xA=0,DA=1,DH=2,NA=3;function ui(t,e,n,r,i,s,a){let o,c,u,l;if(r=""+r,n===xA){if(o=t._nodes.get(r),!o)throw new ae(`Graph.${e}: could not find the "${r}" node in the graph.`);u=i,l=s}else if(n===NA){if(i=""+i,c=t._edges.get(i),!c)throw new ae(`Graph.${e}: could not find the "${i}" edge in the graph.`);const f=c.source.key,d=c.target.key;if(r===f)o=c.target;else if(r===d)o=c.source;else throw new ae(`Graph.${e}: the "${r}" node is not attached to \
the "${i}" edge (${f}, ${d}).`);u=s,l=a}else{if(c=t._edges.get(r),!c)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`);n===DA?o=c.source:o=c.target,u=i,l=s}return[o,u,l]}function NH(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);return a.attributes[o]}}function IH(t,e,n){t.prototype[e]=function(r,i){const[s]=ui(this,e,n,r,i);return s.attributes}}function OH(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);return a.attributes.hasOwnProperty(
o)}}function LH(t,e,n){t.prototype[e]=function(r,i,s,a){const[o,c,u]=ui(this,e,n,r,i,s,a);return o.attributes[c]=u,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:c}),this}}function MH(t,e,n){t.prototype[e]=function(r,i,s,a){const[o,c,u]=ui(this,e,n,r,i,s,a);if(typeof u!="function")throw new pe(`Graph.${e}: updater should be a function.`);const l=o.attributes,f=u(l[c]);return l[c]=f,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,
name:c}),this}}function zH(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);return delete a.attributes[o],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:o}),this}}function FH(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);if(!Qt(o))throw new pe(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=o,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function qH(t,e,n){
t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);if(!Qt(o))throw new pe(`Graph.${e}: provided attributes are not a plain object.`);return Lt(a.attributes,o),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:o}),this}}function GH(t,e,n){t.prototype[e]=function(r,i,s){const[a,o]=ui(this,e,n,r,i,s);if(typeof o!="function")throw new pe(`Graph.${e}: provided updater is not a function.`);return a.attributes=o(a.attributes),this.emit("nodeAttributesUpdat\
ed",{key:a.key,type:"update",attributes:a.attributes}),this}}const jH=[{name:t=>`get${t}Attribute`,attacher:NH},{name:t=>`get${t}Attributes`,attacher:IH},{name:t=>`has${t}Attribute`,attacher:OH},{name:t=>`set${t}Attribute`,attacher:LH},{name:t=>`update${t}Attribute`,attacher:MH},{name:t=>`remove${t}Attribute`,attacher:zH},{name:t=>`replace${t}Attributes`,attacher:FH},{name:t=>`merge${t}Attributes`,attacher:qH},{name:t=>`update${t}Attributes`,attacher:GH}];function BH(t){jH.forEach(function({name:e,
attacher:n}){n(t,e("Node"),xA),n(t,e("Source"),DA),n(t,e("Target"),DH),n(t,e("Opposite"),NA)})}function UH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);
const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes[i]}}function WH(t,e,n){t.prototype[e]=function(r){
let i;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,a=""+arguments[1];if(i=Qn(this,s,a,n),!i)throw new ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${a}").`)}else{
if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function HH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);
if(arguments.length>2){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edg\
e with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes.hasOwnProperty(i)}}function KH(t,e,n){t.prototype[e]=function(r,i,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about\
 an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,c=""+i;if(i=arguments[2],s=arguments[3],a=Qn(this,o,c,n),!a)throw new ae(`Graph.${e}: could not find an edge for the given path ("${o}" - "${c}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new ae(`Graph.${e}\
: could not find the "${r}" edge in the graph.`)}return a.attributes[i]=s,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function VH(t,e,n){t.prototype[e]=function(r,i,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes \
in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,c=""+i;if(i=arguments[2],s=arguments[3],a=Qn(this,o,c,n),!a)throw new ae(`Graph.${e}: could not find an edge for the given path ("${o}" - "${c}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new ae(`Graph.${e}: could not find th\
e "${r}" edge in the graph.`)}if(typeof s!="function")throw new pe(`Graph.${e}: updater should be a function.`);return a.attributes[i]=s(a.attributes[i]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function XH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Se(`Graph.${e}\
: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this.
_edges.get(r),!s)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete s.attributes[i],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:i}),this}}function YH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target\
} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ae(
`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!Qt(i))throw new pe(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=i,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function JH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Se(`G\
raph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+
r,s=this._edges.get(r),!s)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!Qt(i))throw new pe(`Graph.${e}: provided attributes are not a plain object.`);return Lt(s.attributes,i),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:i}),this}}function QH(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Se(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.
length>2){if(this.multi)throw new Se(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+i;if(i=arguments[2],s=Qn(this,a,o,n),!s)throw new ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Se(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this k\
ey could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new pe(`Graph.${e}: provided updater is not a function.`);return s.attributes=i(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const ZH=[{name:t=>`get${t}Attribute`,attacher:UH},{name:t=>`get${t}Attributes`,attacher:WH},{name:t=>`has${t}Attribute`,attacher:HH},{name:t=>`se\
t${t}Attribute`,attacher:KH},{name:t=>`update${t}Attribute`,attacher:VH},{name:t=>`remove${t}Attribute`,attacher:XH},{name:t=>`replace${t}Attributes`,attacher:YH},{name:t=>`merge${t}Attributes`,attacher:JH},{name:t=>`update${t}Attributes`,attacher:QH}];function eK(t){ZH.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const tK=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"o\
utEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function nK(t,e,n,r){let i=!1;for(const s in e){if(s===r)continue;const a=e[s];if(i=n(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),t&&i)return a.key}}function rK(t,e,n,r){let i,s,a,o=!1;for(const c in e)if(c!==r){i=e[c];
do{if(s=i.source,a=i.target,o=n(i.key,i.attributes,s.key,a.key,s.attributes,a.attributes,i.undirected),t&&o)return i.key;i=i.next}while(i!==void 0)}}function Ev(t,e){const n=Object.keys(t),r=n.length;let i,s=0;return new Jn(function(){do if(i)i=i.next;else{if(s>=r)return{done:!0};const o=n[s++];if(o===e){i=void 0;continue}i=t[o]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.
attributes,undirected:i.undirected}}})}function iK(t,e,n,r){const i=e[n];if(!i)return;const s=i.source,a=i.target;if(r(i.key,i.attributes,s.key,a.key,s.attributes,a.attributes,i.undirected)&&t)return i.key}function sK(t,e,n,r){let i=e[n];if(!i)return;let s=!1;do{if(s=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),t&&s)return i.key;i=i.next}while(i!==void 0)}function Sv(t,e){let n=t[e];return n.next!==void 0?new Jn(function(){if(!n)return{done:!0};
const r={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:r}}):Jn.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function aK(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="funct\
ion"?Array.from(t._edges.keys()):TA(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,r=new Array(n),i=e==="undirected",s=t._edges.values();let a=0,o,c;for(;o=s.next(),o.done!==!0;)c=o.value,c.undirected===i&&(r[a++]=c.key);return r}function IA(t,e,n,r){if(e.size===0)return;const i=n!=="mixed"&&n!==e.type,s=n==="undirected";let a,o,c=!1;const u=e._edges.values();for(;a=u.next(),a.done!==!0;){if(o=a.value,i&&o.undirected!==s)continue;const{key:l,attributes:f,
source:d,target:h}=o;if(c=r(l,f,d.key,h.key,d.attributes,h.attributes,o.undirected),t&&c)return l}}function oK(t,e){if(t.size===0)return Jn.empty();const n=e!=="mixed"&&e!==t.type,r=e==="undirected",i=t._edges.values();return new Jn(function(){let a,o;for(;;){if(a=i.next(),a.done)return a;if(o=a.value,!(n&&o.undirected!==r))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.
undirected},done:!1}})}function Av(t,e,n,r,i,s){const a=e?rK:nK;let o;if(n!=="undirected"&&(r!=="out"&&(o=a(t,i.in,s),t&&o)||r!=="in"&&(o=a(t,i.out,s,r?void 0:i.key),t&&o))||n!=="directed"&&(o=a(t,i.undirected,s),t&&o))return o}function cK(t,e,n,r){const i=[];return Av(!1,t,e,n,r,function(s){i.push(s)}),i}function uK(t,e,n){let r=Jn.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(r=ci(r,Ev(n.in))),e!=="in"&&typeof n.out<"u"&&(r=ci(r,Ev(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.
undirected<"u"&&(r=ci(r,Ev(n.undirected))),r}function _v(t,e,n,r,i,s,a){const o=n?sK:iK;let c;if(e!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(c=o(t,i.in,s,a),t&&c)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==s)&&(c=o(t,i.out,s,a),t&&c))||e!=="directed"&&typeof i.undirected<"u"&&(c=o(t,i.undirected,s,a),t&&c))return c}function lK(t,e,n,r,i){const s=[];return _v(!1,t,e,n,r,i,function(a){s.push(a)}),s}function dK(t,e,n,r){let i=Jn.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&r in n.
in&&(i=ci(i,Sv(n.in,r))),typeof n.out<"u"&&e!=="in"&&r in n.out&&(e||n.key!==r)&&(i=ci(i,Sv(n.out,r)))),t!=="directed"&&typeof n.undirected<"u"&&r in n.undirected&&(i=ci(i,Sv(n.undirected,r))),i}function fK(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s,a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return aK(this,r);if(arguments.length===1){s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ae(`Graph.${n}: could not find the "${s}\
" node in the graph.`);return cK(this.multi,r==="mixed"?this.type:r,i,o)}if(arguments.length===2){s=""+s,a=""+a;const o=this._nodes.get(s);if(!o)throw new ae(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(a))throw new ae(`Graph.${n}:  could not find the "${a}" target node in the graph.`);return lK(r,this.multi,i,o,a)}throw new pe(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function hK(t,e){const{name:n,type:r,direction:i}=e,
s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,l,f){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return f=u,IA(!1,this,r,f);if(arguments.length===2){u=""+u,f=l;const d=this._nodes.get(u);if(typeof d>"u")throw new ae(`Graph.${s}: could not find the "${u}" node in the graph.`);return Av(!1,this.multi,r==="mixed"?this.type:r,i,d,f)}if(arguments.length===3){u=""+u,l=""+l;const d=this._nodes.get(u);if(!d)throw new ae(`Graph.${s}:  could not fi\
nd the "${u}" source node in the graph.`);if(!this._nodes.has(l))throw new ae(`Graph.${s}:  could not find the "${l}" target node in the graph.`);return _v(!1,r,this.multi,i,d,l,f)}throw new pe(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop();let f;if(u.length===0){let d=0;r!=="directed"&&(d+=this.undirectedSize),r!=="undirected"&&(d+=
this.directedSize),f=new Array(d);let h=0;u.push((m,b,$,w,k,S,D)=>{f[h++]=l(m,b,$,w,k,S,D)})}else f=[],u.push((d,h,m,b,$,w,k)=>{f.push(l(d,h,m,b,$,w,k))});return this[s].apply(this,u),f};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop(),f=[];return u.push((d,h,m,b,$,w,k)=>{l(d,h,m,b,$,w,k)&&f.push(d)}),this[s].apply(this,u),f};const c="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[c]=function(){let u=Array.prototype.
slice.call(arguments);if(u.length<2||u.length>4)throw new pe(`Graph.${c}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new pe(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let l,f;u.length===2?(l=u[0],f=u[1],u=[]):u.length===3?(l=u[1],f=
u[2],u=[u[0]]):u.length===4&&(l=u[2],f=u[3],u=[u[0],u[1]]);let d=f;return u.push((h,m,b,$,w,k,S)=>{d=l(d,h,m,b,$,w,k,S)}),this[s].apply(this,u),d}}function pK(t,e){const{name:n,type:r,direction:i}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,u,l){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return l=c,IA(!0,this,r,l);if(arguments.length===2){c=""+c,l=u;const f=this._nodes.get(c);if(typeof f>"u")throw new ae(`Graph.${s}: could not fi\
nd the "${c}" node in the graph.`);return Av(!0,this.multi,r==="mixed"?this.type:r,i,f,l)}if(arguments.length===3){c=""+c,u=""+u;const f=this._nodes.get(c);if(!f)throw new ae(`Graph.${s}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(u))throw new ae(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return _v(!0,r,this.multi,i,f,u,l)}throw new pe(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+n[0].
toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop();return c.push((f,d,h,m,b,$,w)=>u(f,d,h,m,b,$,w)),!!this[s].apply(this,c)};const o="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop();return c.push((f,d,h,m,b,$,w)=>!u(f,d,h,m,b,$,w)),!this[s].apply(this,c)}}function mK(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a,o){if(r!==
"mixed"&&this.type!=="mixed"&&r!==this.type)return Jn.empty();if(!arguments.length)return oK(this,r);if(arguments.length===1){a=""+a;const c=this._nodes.get(a);if(!c)throw new ae(`Graph.${s}: could not find the "${a}" node in the graph.`);return uK(r,i,c)}if(arguments.length===2){a=""+a,o=""+o;const c=this._nodes.get(a);if(!c)throw new ae(`Graph.${s}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new ae(`Graph.${s}:  could not find the "${o}" target node in \
the graph.`);return dK(r,i,c,o)}throw new pe(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function gK(t){tK.forEach(e=>{fK(t,e),hK(t,e),pK(t,e),mK(t,e)})}const yK=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"\
undirectedNeighbors",type:"undirected"}];function fp(){this.A=null,this.B=null}fp.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)},fp.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function Xl(t,e,n,r,i){for(const s in r){const a=r[s],o=a.source,c=a.target,u=o===n?c:o;if(e&&e.has(u.key))continue;const l=i(u.key,u.attributes);if(t&&l)return u.key}}function Cv(t,e,n,r,i){if(e!=="mixed"){if(e==="undirected")return Xl(t,null,r,r.undirected,
i);if(typeof n=="string")return Xl(t,null,r,r[n],i)}const s=new fp;let a;if(e!=="undirected"){if(n!=="out"){if(a=Xl(t,null,r,r.in,i),t&&a)return a;s.wrap(r.in)}if(n!=="in"){if(a=Xl(t,s,r,r.out,i),t&&a)return a;s.wrap(r.out)}}if(e!=="directed"&&(a=Xl(t,s,r,r.undirected,i),t&&a))return a}function vK(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const r=[];return Cv(!1,t,e,n,function(i){r.push(i)}),r}function Yl(t,e,n){const r=Object.
keys(n),i=r.length;let s=0;return new Jn(function(){let o=null;do{if(s>=i)return t&&t.wrap(n),{done:!0};const c=n[r[s++]],u=c.source,l=c.target;if(o=u===e?l:u,t&&t.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}})}function wK(t,e,n){if(t!=="mixed"){if(t==="undirected")return Yl(null,n,n.undirected);if(typeof e=="string")return Yl(null,n,n[e])}let r=Jn.empty();const i=new fp;return t!=="undirected"&&(e!=="out"&&(r=ci(r,Yl(i,n,n.in))),e!==
"in"&&(r=ci(r,Yl(i,n,n.out)))),t!=="directed"&&(r=ci(r,Yl(i,n,n.undirected))),r}function bK(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ae(`Graph.${n}: could not find the "${s}" node in the graph.`);return vK(r==="mixed"?this.type:r,i,a)}}function $K(t,e){const{name:n,type:r,direction:i}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,l){
if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const f=this._nodes.get(u);if(typeof f>"u")throw new ae(`Graph.${s}: could not find the "${u}" node in the graph.`);Cv(!1,r==="mixed"?this.type:r,i,f,l)};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(u,l){const f=[];return this[s](u,(d,h)=>{f.push(l(d,h))}),f};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,l){const f=[];return this[s](u,(d,h)=>{l(d,h)&&f.push(d)}),f};const c="reduce"+
n[0].toUpperCase()+n.slice(1);t.prototype[c]=function(u,l,f){if(arguments.length<3)throw new pe(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d=f;return this[s](u,(h,m)=>{d=l(d,h,m)}),d}}function RK(t,e){const{name:n,type:r,direction:i}=e,s=n[0].toUpperCase()+n.slice(1,-1),a="find"+s;t.prototype[a]=function(u,l){if(r!=="mixed"&&this.type!==
"mixed"&&r!==this.type)return;u=""+u;const f=this._nodes.get(u);if(typeof f>"u")throw new ae(`Graph.${a}: could not find the "${u}" node in the graph.`);return Cv(!0,r==="mixed"?this.type:r,i,f,l)};const o="some"+s;t.prototype[o]=function(u,l){return!!this[a](u,l)};const c="every"+s;t.prototype[c]=function(u,l){return!this[a](u,(d,h)=>!l(d,h))}}function kK(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)
return Jn.empty();a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new ae(`Graph.${s}: could not find the "${a}" node in the graph.`);return wK(r==="mixed"?this.type:r,i,o)}}function TK(t){yK.forEach(e=>{bK(t,e),$K(t,e),RK(t,e),kK(t,e)})}function hp(t,e,n,r,i){const s=r._nodes.values(),a=r.type;let o,c,u,l,f,d;for(;o=s.next(),o.done!==!0;){let h=!1;if(c=o.value,a!=="undirected"){l=c.out;for(u in l){f=l[u];do d=f.target,h=!0,i(c.key,d.key,c.attributes,d.attributes,f.key,f.attributes,f.undirected),
f=f.next;while(f)}}if(a!=="directed"){l=c.undirected;for(u in l)if(!(e&&c.key>u)){f=l[u];do d=f.target,d.key!==u&&(d=f.source),h=!0,i(c.key,d.key,c.attributes,d.attributes,f.key,f.attributes,f.undirected),f=f.next;while(f)}}n&&!h&&i(c.key,null,c.attributes,null,null,null,null)}}function EK(t,e){const n={key:t};return SA(e.attributes)||(n.attributes=Lt({},e.attributes)),n}function SK(t,e,n){const r={key:e,source:n.source.key,target:n.target.key};return SA(n.attributes)||(r.attributes=Lt({},n.attributes)),
t==="mixed"&&n.undirected&&(r.undirected=!0),r}function AK(t){if(!Qt(t))throw new pe('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new pe("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!Qt(t.attributes)||t.attributes===null))throw new pe("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function _K(t){if(!Qt(t))throw new pe('Graph.impor\
t: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new pe("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new pe("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!Qt(t.attributes)||t.attributes===null))throw new pe("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!=
"boolean")throw new pe("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const CK=xH(),PK=new Set(["directed","undirected","mixed"]),OA=new Set(["domain","_events","_eventsCount","_maxListeners"]),xK=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}U\
ndirectedEdgeWithKey`,type:"undirected"}],DK={allowSelfLoops:!0,multi:!1,type:"mixed"};function NK(t,e,n){if(n&&!Qt(n))throw new pe(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Se(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function LA(t,e,n){const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("\
nodeAdded",{key:e,attributes:n}),r}function MA(t,e,n,r,i,s,a,o){if(!r&&t.type==="undirected")throw new Se(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Se(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(o&&!Qt(o))throw new pe(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`);if(s=""+s,a=""+a,o=o||
{},!t.allowSelfLoops&&s===a)throw new Se(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const c=t._nodes.get(s),u=t._nodes.get(a);if(!c)throw new ae(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new ae(`Graph.${e}: target node "${a}" not found.`);const l={key:null,undirected:r,source:s,target:a,attributes:o};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Se(`Grap\
h.${e}: the "${i}" edge already exists in the graph.`);if(!t.multi&&(r?typeof c.undirected[a]<"u":typeof c.out[a]<"u"))throw new Se(`Graph.${e}: an edge linking "${s}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const f=new Va(r,i,c,u,o);t._edges.set(i,f);const d=s===a;return r?(c.undirectedDegree++,u.undirectedDegree++,d&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,u.
inDegree++,d&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?f.attachMulti():f.attach(),r?t._undirectedSize++:t._directedSize++,l.key=i,t.emit("edgeAdded",l),i}function IK(t,e,n,r,i,s,a,o,c){if(!r&&t.type==="undirected")throw new Se(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Se(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph\
. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(o){if(c){if(typeof o!="function")throw new pe(`Graph.${e}: invalid updater function. Expecting a function but got "${o}"`)}else if(!Qt(o))throw new pe(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`)}s=""+s,a=""+a;let u;if(c&&(u=o,o=void 0),!t.allowSelfLoops&&s===a)throw new Se(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' optio\
n set to false.`);let l=t._nodes.get(s),f=t._nodes.get(a),d,h;if(!n&&(d=t._edges.get(i),d)){if((d.source.key!==s||d.target.key!==a)&&(!r||d.source.key!==a||d.target.key!==s))throw new Se(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${s}" source & "${a}" target vs. ("${d.source.key}", "${d.target.key}").`);h=d}if(!h&&!t.multi&&l&&(h=r?l.undirected[a]:l.out[a]),h){const k=[h.key,!1,!1,!1];if(c?!u:!o)return k;if(c){const S=h.attributes;h.attributes=u(S),t.emit(
"edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else Lt(h.attributes,o),t.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:o});return k}o=o||{},c&&u&&(o=u(o));const m={key:null,undirected:r,source:s,target:a,attributes:o};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Se(`Graph.${e}: the "${i}" edge already exists in the graph.`);let b=!1,$=!1;l||(l=LA(t,s,{}),b=!0,s===a&&(f=l,$=!0)),f||(f=LA(t,a,{}),$=!0),d=new Va(
r,i,l,f,o),t._edges.set(i,d);const w=s===a;return r?(l.undirectedDegree++,f.undirectedDegree++,w&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,f.inDegree++,w&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),r?t._undirectedSize++:t._directedSize++,m.key=i,t.emit("edgeAdded",m),[i,!0,b,$]}function Xa(t,e){t._edges.delete(e.key);const{source:n,target:r,attributes:i}=e,s=e.undirected,a=n===r;s?(n.undirectedDegree--,r.undirectedDegree--,a&&(n.undirectedLoops--,
t._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,a&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:i,source:n.key,target:r.key,undirected:s})}class it extends $C{constructor(e){if(super(),e=Lt({},DK,e),typeof e.multi!="boolean")throw new pe(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!PK.has(e.type))throw new pe(`Graph.con\
structor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new pe(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?_A:e.type==="directed"?CA:PA;Zn(this,"NodeDataClass",n);const r="geid_"+CK()+"_";let i=0;const s=()=>{let a;do a=r+i++;while(this._edges.has(a));return a};Zn(this,"_attributes",{}),Zn(this,"_nodes",new Map),Zn(
this,"_edges",new Map),Zn(this,"_directedSize",0),Zn(this,"_undirectedSize",0),Zn(this,"_directedSelfLoopCount",0),Zn(this,"_undirectedSelfLoopCount",0),Zn(this,"_edgeKeyGenerator",s),Zn(this,"_options",e),OA.forEach(a=>Zn(this,a,this[a])),fr(this,"order",()=>this._nodes.size),fr(this,"size",()=>this._edges.size),fr(this,"directedSize",()=>this._directedSize),fr(this,"undirectedSize",()=>this._undirectedSize),fr(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),
fr(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),fr(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),fr(this,"multi",this._options.multi),fr(this,"type",this._options.type),fr(this,"allowSelfLoops",this._options.allowSelfLoops),fr(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.
type==="undirected")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(n):!1}throw new pe(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+
e,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(n):!1}throw new pe(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?
typeof r.out<"u"&&r.out.hasOwnProperty(n)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(n):!1}throw new pe(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Se("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & targe\
t. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new ae(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ae(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||void 0;if(i)return i.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Se("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be mul\
tiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new ae(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ae(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const i=r.undirected&&r.undirected[n]||void 0;if(i)return i.key}edge(e,n){if(this.multi)throw new Se("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges b\
etween source & target. See #.edges instead.");e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ae(`Graph.edge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||r.undirected&&r.undirected[n]||void 0;if(i)return i.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areDirectedNeighbors: could not find the "${e}" n\
ode in the graph.`);return this.type==="undirected"?!1:n in r.in||n in r.out}areOutNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.out}areInNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in}areUndirectedNeighbors(e,n){e=
""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in r.undirected}areNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in r.in||n in r.out)||this.type!=="directed"&&n in r.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)
throw new ae(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.in||this.type!=="directed"&&n in r.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ae(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.out||this.type!=="directed"&&n in r.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.inDeg\
ree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this.
_nodes.get(e);if(!n)throw new ae(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree),r}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.outboundDegree: coul\
d not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.outDegree),r}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.inDegreeWithoutSe\
lfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node i\
n the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the \
graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree,i+=n.directedLoops),r-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.outDegree,i+=n.directedLoops),r-i}degreeWithoutSelfLoops(e){
e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree,i+=n.directedLoops*2),r-i}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(
`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const r=this._edges.get(n);if(!r)throw new ae(`Graph.opposite: could not find the "${n}" edge in the graph.`);const i=r.source.key,s=r.target.key;if(e===i)return s;if(e===s)return i;throw new ae(`Graph.opposite: the "${e}\
" node is not attached to the "${n}" edge (${i}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const r=this._edges.get(e);if(!r)throw new ae(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===n||r.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(`Graph.isDirected: could not f\
ind the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ae(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return NK(this,e,n).key}mergeNode(e,n){if(n&&!Qt(n))throw new pe(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let r=this._nodes.get(e);return r?(n&&(Lt(r.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.
attributes,data:n})),[e,!1]):(r=new this.NodeDataClass(e,n),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new pe(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let r=this._nodes.get(e);if(r){if(n){const s=r.attributes;r.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const i=n?n({}):{};return r=new this.NodeDataClass(
e,i),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ae(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in n.out){r=n.out[i];do Xa(this,r),r=r.next;while(r)}for(const i in n.in){r=n.in[i];do Xa(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in n.undirected){r=n.undirected[i];do Xa(this,r),r=r.next;while(r)}this._nodes.delete(e),this.
emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(n=Qn(this,r,i,this.type),!n)throw new ae(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ae(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Xa(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Se("Graph.dropDirectedEdge: it does not make sense to \
try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Se("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const r=Qn(this,e,n,"directed");if(!r)throw new ae(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Xa(this,r),this}dropUndirectedEdge(e,n){
if(arguments.length<2)throw new Se("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Se("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Qn(this,e,n,"undirected");if(!r)throw new ae(`Graph.dropUndirectedEdge: cou\
ld not find a "${e}" -> "${n}" edge in the graph.`);return Xa(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){
return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new pe("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=n(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),
this}replaceAttributes(e){if(!Qt(e))throw new pe("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!Qt(e))throw new pe("Graph.mergeAttributes: provided attributes are not a plain object.");return Lt(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")
throw new pe("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new pe("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!AA(n))throw new pe("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.
values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new pe("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!AA(n))throw new pe("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,s,a,o;for(;i=r.next(),i.done!==!0;)s=i.
value,a=s.source,o=s.target,s.attributes=e(s.key,s.attributes,a.key,o.key,a.attributes,o.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new pe("Graph.forEachAdjacencyEntry: expecting a callback.");hp(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new pe("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");hp(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!=
"function")throw new pe("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");hp(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new pe("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");hp(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):TA(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new pe("Graph.forEachNode: expecting a callback.");const n=this.
_nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new pe("Graph.findNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new pe("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let r,i;const s=new Array(this.order);let a=0;for(;r=n.next(),r.done!==!0;)i=r.value,s[a++]=e(
i.key,i.attributes);return s}someNode(e){if(typeof e!="function")throw new pe("Graph.someNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new pe("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new pe(
"Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let r,i;const s=[];for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)&&s.push(i.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new pe("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new pe("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could \
with a simple array.");let r=n;const i=this._nodes.values();let s,a;for(;s=i.next(),s.done!==!0;)a=s.value,r=e(r,a.key,a.attributes);return r}nodeEntries(){const e=this._nodes.values();return new Jn(()=>{const n=e.next();if(n.done)return n;const r=n.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((i,s)=>{e[n++]=EK(s,i)});const r=new Array(this._edges.size);return n=0,this._edges.forEach((i,s)=>{r[n++]=SK(
this.type,s,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,n=!1){if(e instanceof it)return e.forEachNode((c,u)=>{n?this.mergeNode(c,u):this.addNode(c,u)}),e.forEachEdge((c,u,l,f,d,h,m)=>{n?m?this.mergeUndirectedEdgeWithKey(c,l,f,u):this.mergeDirectedEdgeWithKey(c,l,f,u):m?this.addUndirectedEdgeWithKey(c,l,f,u):this.addDirectedEdgeWithKey(c,l,f,u)}),this;if(!Qt(e))throw new pe("Graph.import: invalid argu\
ment. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!Qt(e.attributes))throw new pe("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,i,s,a,o;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new pe("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=s.length;r<i;r++){a=s[r],AK(a);const{key:c,attributes:u}=a;n?this.mergeNode(c,u):this.addNode(c,u)}}if(e.edges){
let c=!1;if(this.type==="undirected"&&(c=!0),s=e.edges,!Array.isArray(s))throw new pe("Graph.import: invalid edges. Expecting an array.");for(r=0,i=s.length;r<i;r++){o=s[r],_K(o);const{source:u,target:l,attributes:f,undirected:d=c}=o;let h;"key"in o?(h=n?d?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:d?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,o.key,u,l,f)):(h=n?d?this.mergeUndirectedEdge:this.mergeDirectedEdge:d?this.addUndirectedEdge:this.addDirectedEdge,
h.call(this,u,l,f))}}return this}nullCopy(e){const n=new it(Lt({},this._options,e));return n.replaceAttributes(Lt({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((r,i)=>{const s=Lt({},r.attributes);r=new n.NodeDataClass(i,s),n._nodes.set(i,r)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Se(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean lo\
sing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Se("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Se("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not\
 because this would mean losing information about the current graph.");const n=this.emptyCopy(e),r=this._edges.values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,MA(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,Lt({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,a)=>{e[a]=s.attributes});const n={},r={};this._edges.forEach((s,a)=>{const o=s.undirected?"--":"->";let c="",u=s.source.key,l=s.target.
key,f;s.undirected&&u>l&&(f=u,u=l,l=f);const d=`(${u})${o}(${l})`;a.startsWith("geid_")?this.multi&&(typeof r[d]>"u"?r[d]=0:r[d]++,c+=`${r[d]}. `):c+=`[${a}]: `,c+=d,n[c]=s.attributes});const i={};for(const s in this)this.hasOwnProperty(s)&&!OA.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(i[s]=this[s]);return i.attributes=this._attributes,i.nodes=e,i.edges=n,Zn(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(it.prototype[Symbol.for("nodejs.util.inspect.custom")]=it.prototype.
inspect),xK.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),r=e==="add"?MA:IK;t.generateKey?it.prototype[n]=function(i,s,a){return r(this,n,!0,(t.type||this.type)==="undirected",null,i,s,a,e==="update")}:it.prototype[n]=function(i,s,a,o){return r(this,n,!1,(t.type||this.type)==="undirected",i,s,a,o,e==="update")}})}),BH(it),eK(it),gK(it),TK(it);class zA extends it{constructor(e){const n=Lt({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new pe("DirectedGraph.from: inco\
nsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new pe('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class FA extends it{constructor(e){const n=Lt({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new pe("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new pe('UndirectedGraph.from: inconsistent "'+n.type+'" type in given o\
ptions!');super(n)}}class qA extends it{constructor(e){const n=Lt({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new pe("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class GA extends it{constructor(e){const n=Lt({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new pe("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new pe('MultiDirectedGrap\
h.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class jA extends it{constructor(e){const n=Lt({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new pe("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new pe('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Ya(t){t.from=function(e,n){const r=Lt({},e.options,n),i=new t(r);return i.
import(e),i}}Ya(it),Ya(zA),Ya(FA),Ya(qA),Ya(GA),Ya(jA),it.Graph=it,it.DirectedGraph=zA,it.UndirectedGraph=FA,it.MultiGraph=qA,it.MultiDirectedGraph=GA,it.MultiUndirectedGraph=jA,it.InvalidArgumentsGraphError=pe,it.NotFoundGraphError=ae,it.UsageGraphError=Se;const Pv="dashed",xv=qt.font,BA=rD("dot");class Dv{constructor(e){this.view=e,this.compoundIds=new Set(e.nodes.filter(qn).map(r=>r.id)),this.edgesWithCompounds=new Set(this.compoundIds.size>0?e.edges.filter(r=>this.compoundIds.has(r.source)||
this.compoundIds.has(r.target)).map(r=>r.id):[]);for(const r of e.nodes)this.graphology.addNode(r.id,{origin:r,level:r.level,depth:r.depth??0,modelRef:mw.modelRef(r),deploymentRef:mw.deploymentRef(r),maxConnectedHierarchyDistance:0});for(const r of e.edges){let i=this.graphology.getNodeAttribute(r.source,"deploymentRef"),s=this.graphology.getNodeAttribute(r.target,"deploymentRef");(i===null||s===null)&&(i=this.graphology.getNodeAttribute(r.source,"modelRef"),s=this.graphology.getNodeAttribute(r.
target,"modelRef"));let a=-1;i!==null&&s!==null?a=iC(i,s):BA.warn(`Edge ${r.id} of view ${e.id} is invalid, sourceFqn: ${i}, targetFqn: ${s}`),this.graphology.addEdgeWithKey(r.id,r.source,r.target,{origin:r,hierarchyDistance:a,weight:1}),a>this.graphology.getNodeAttribute(r.source,"maxConnectedHierarchyDistance")&&this.graphology.mergeNodeAttributes(r.source,{maxConnectedHierarchyDistance:a}),a>this.graphology.getNodeAttribute(r.target,"maxConnectedHierarchyDistance")&&this.graphology.mergeNodeAttributes(
r.target,{maxConnectedHierarchyDistance:a})}this.graphology.forEachEdge((r,{hierarchyDistance:i},s,a,o,c)=>{const u=Math.max(o.maxConnectedHierarchyDistance,c.maxConnectedHierarchyDistance);if(u>i)this.graphology.mergeEdgeAttributes(r,{weight:u-i+1});else{const l=this.graphology.directedDegree(s),f=this.graphology.directedDegree(a);l===1&&f===1&&i>1&&this.graphology.mergeEdgeAttributes(r,{weight:i})}});const n=this.graphvizModel=this.createGraph();this.applyNodeAttributes(n.attributes.node),this.
applyEdgeAttributes(n.attributes.edge)}ids=new Set;subgraphs=new Map;nodes=new Map;edges=new Map;compoundIds;edgesWithCompounds;graphology=new it({allowSelfLoops:!0,multi:!0,type:"directed"});graphvizModel;get hasEdgesWithCompounds(){return this.edgesWithCompounds.size>0}postBuild(e){}build(e){const n=(i,s)=>{const a=this.generateGraphvizId(i),o=this.elementToSubgraph(i,s.subgraph(a));this.subgraphs.set(i.id,o);for(const c of i.children){const u=this.computedNode(c);if(qn(u))n(u,o);else{const l=Zt(
this.getGraphNode(u.id),`Graphviz Node not found for ${u.id}`);o.node(l.id)}}},r=[];for(const i of this.view.nodes)if(qn(i))yt(i.parent)&&r.push(i);else{const s=this.generateGraphvizId(i),a=this.elementToNode(i,e.node(s));this.nodes.set(i.id,a)}for(const i of r)n(i,e);for(const i of this.view.edges){const s=this.addEdge(i,e);s&&this.edges.set(i.id,s)}}print(){const e=this.graphvizModel;return this.build(e),this.postBuild(e),dA(this.graphvizModel,{print:{indentStyle:"space",indentSize:2}})}createGraph(){
const e=this.view.autoLayout,n=iH({[O.bgcolor]:"transparent",[O.layout]:"dot",[O.compound]:!0,[O.rankdir]:e.direction,[O.TBbalance]:"min",[O.splines]:"spline",[O.outputorder]:"nodesfirst",[O.nodesep]:dt(e.nodeSep??110),[O.ranksep]:dt(e.rankSep??120),[O.pad]:dt(15),[O.fontname]:xv});return n.attributes.graph.apply({[O.fontsize]:Yn(15),[O.labeljust]:e.direction==="RL"?"r":"l",[O.labelloc]:e.direction==="BT"?"b":"t",[O.margin]:50.1}),n}applyNodeAttributes(e){e.apply({[O.fontname]:xv,[O.shape]:"rect",
[O.fillcolor]:qt.elements[Zs].fill,[O.fontcolor]:qt.elements[Zs].hiContrast,[O.color]:qt.elements[Zs].stroke,[O.style]:"filled",[O.penwidth]:0})}applyEdgeAttributes(e){e.apply({[O.arrowsize]:.75,[O.fontname]:xv,[O.fontsize]:Yn(14),[O.penwidth]:Yn(2),[O.color]:qt.relationships[io].lineColor,[O.fontcolor]:qt.relationships[io].labelColor})}checkNodeId(e,n=!1){return n?e="cluster_"+e:e.toLowerCase().startsWith("cluster")&&(e="nd_"+e),this.ids.has(e)?null:(this.ids.add(e),e)}generateGraphvizId(e){const n=qn(
e);let r=Ap(e.id).toLowerCase(),i=this.checkNodeId(r,n);if(i!==null)return i;r=Ap(e.id).toLowerCase();let s=1;do i=this.checkNodeId(r+"_"+s++,n);while(i===null);return i}elementToSubgraph(e,n){Ie(qn(e),"node should be compound"),Ie(qf(e.depth),"node.depth should be defined");const r=this.getElementColorValues(e.color),i=vH(r.loContrast);return n.apply({[O.likec4_id]:e.id,[O.likec4_level]:e.level,[O.likec4_depth]:e.depth,[O.fillcolor]:mA(r.fill,e.depth),[O.color]:mA(r.stroke,e.depth),[O.style]:"f\
illed",[O.margin]:Yn(e.children.length>1?40:32)}),Pt(e.title.trim())||n.set(O.label,RH(e,i)),n}elementToNode(e,n){Ie(!qn(e),"node should not be compound");const r=ce(e.icon),i=this.getElementColorValues(e.color);let s=e.style.size,a=e.style.textSize,o=e.style.padding;!s&&a&&(s=a),!a&&s&&(a=s),!o&&s&&(o=s),s??=yC,a??=vC,o??=wC;const c=qt.spacing[o];switch(n.attributes.apply({[O.likec4_id]:e.id,[O.likec4_level]:e.level,[O.label]:$H(e,i,{shape:s,text:a}),[O.margin]:`${dt(r?8:c)},${dt(c)}`}),n.attributes.
set(O.width,dt(qt.sizes[s].width)),n.attributes.set(O.height,dt(qt.sizes[s].height)),e.color!==Zs&&n.attributes.apply({[O.fillcolor]:i.fill,[O.fontcolor]:i.hiContrast,[O.color]:i.stroke}),e.shape){case"cylinder":case"storage":{n.attributes.apply({[O.margin]:`${dt(r?8:c)},${dt(0)}`,[O.penwidth]:Yn(2),[O.shape]:"cylinder"});break}case"browser":{n.attributes.apply({[O.margin]:`${dt(r?8:c+4)},${dt(c+6)}`});break}case"mobile":{n.attributes.apply({[O.margin]:`${dt(r?8:c+4)},${dt(c)}`});break}case"queu\
e":{n.attributes.apply({[O.width]:dt(qt.sizes[s].width),[O.height]:dt(qt.sizes[s].height-8),[O.margin]:`${dt(r?8:c+4)},${dt(c)}`});break}}return n}leafElements(e){return e===null?this.view.nodes.filter(n=>!qn(n)):this.computedNode(e).children.flatMap(n=>{const r=this.computedNode(n);return qn(r)?this.leafElements(r.id):r})}descendants(e){return e===null?this.view.nodes.slice():this.computedNode(e).children.flatMap(n=>{const r=this.computedNode(n);return[r,...this.descendants(r.id)]})}computedNode(e){
return Zt(this.view.nodes.find(n=>n.id===e),`Node ${e} not found`)}getGraphNode(e){return this.nodes.get(e)??null}getSubgraph(e){return this.subgraphs.get(e)??null}edgeEndpoint(e,n){let r=this.computedNode(e),i=this.getGraphNode(e),s;return i||(Ie(qn(r),"endpoint node should be compound"),s=this.getSubgraph(e)?.id,Ie(s,`subgraph ${e} not found`),r=Zt(n(this.leafElements(e)),`leaf element in ${e} not found`),i=Zt(this.getGraphNode(r.id),`source graphviz node ${r.id} not found`)),[r,i,s]}findInternalEdges(e){
if(e===null)return this.view.edges.slice();const n=this.computedNode(e);return Ze(this.descendants(e),_i(r=>QT(r.inEdges,r.outEdges)),Ra(),Mj(QT(n.inEdges,n.outEdges)),nn(r=>this.view.edges.find(i=>i.id===r)),je(ce))}withoutCompoundEdges(e){return this.edgesWithCompounds.size===0?e:{...e,inEdges:e.inEdges.filter(n=>!this.edgesWithCompounds.has(n)),outEdges:e.outEdges.filter(n=>!this.edgesWithCompounds.has(n))}}assignGroups(){const e=Ze(this.view.nodes,je(qn),nn(r=>r.id),nj(sC),sj(),nn(r=>{const i=this.
findInternalEdges(r).filter(s=>s.source!==s.target&&!this.compoundIds.has(s.source)&&!this.compoundIds.has(s.target));return{id:r,edges:i}}),je(({edges:r})=>r.length>1&&r.length<8),YG(4)),n=new Set;for(const r of e){const i=r.edges.filter(s=>!n.has(s.source)&&!n.has(s.target));for(const s of i)try{const a=Zt(this.getGraphNode(s.source),`Graphviz Node not found for ${s.source}`),o=Zt(this.getGraphNode(s.target),`Graphviz Node not found for ${s.target}`);n.add(s.source),n.add(s.target),a.attributes.
set(O.group,r.id),o.attributes.set(O.group,r.id)}catch(a){BA.error(`Failed to assign group to edge ${s.id}`,{error:a})}}}applyManualLayout({height:e,...n}){const r=n.x<0?-n.x:0,i=n.y<0?-n.y:0,s=r>0||i>0;for(const{id:a,...o}of n.nodes){const c=this.getGraphNode(a);if(!c)continue;const u=dt(o.center.x)+r,l=dt(e-o.center.y);o.fixedsize?c.attributes.apply({[O.pos]:`${u},${l}!`,[O.pin]:!0,[O.width]:dt(o.fixedsize.width),[O.height]:dt(o.fixedsize.height),[O.fixedsize]:!0}):c.attributes.set(O.pos,`${u}\
,${l}`)}for(const[a,o]of this.edges.entries()){o.attributes.delete(O.weight),o.attributes.delete(O.minlen),o.attributes.delete(O.constraint);const c=n.edges.find(u=>u.id===a)?.dotpos;c&&!s&&o.attributes.set(O.pos,c)}return this.graphvizModel.apply({[O.layout]:"fdp",[O.overlap]:"vpsc",[O.sep]:"+50,50",[O.esep]:"+10,10",[O.start]:"random2",[O.splines]:"compound"}),this.graphvizModel.delete(O.compound),this.graphvizModel.delete(O.rankdir),this.graphvizModel.delete(O.nodesep),this.graphvizModel.delete(
O.ranksep),this.graphvizModel.delete(O.pack),this.graphvizModel.delete(O.pad),this.graphvizModel.delete(O.packmode),this.graphvizModel.attributes.graph.delete(O.margin),this}getRelationshipColorValues(e){return aw(e)?qt.relationships[e]:this.view.customColorDefinitions[e]?.relationships??qt.relationships[Zs]}getElementColorValues(e){return aw(e)?qt.elements[e]:this.view.customColorDefinitions[e]?.elements??qt.elements[Zs]}}class OK extends Dv{createGraph(){const e=super.createGraph(),n=this.view.
autoLayout;return e.delete(O.TBbalance),e.apply({[O.nodesep]:dt(n.nodeSep??130),[O.ranksep]:dt(n.rankSep??130)}),e}postBuild(e){Ze(this.view.nodes,nn(n=>({node:n,graphvizNode:this.getGraphNode(n.id)})),Tc(({node:n,graphvizNode:r})=>{if(r!=null)return ad.modelRef(n)??void 0}),Ff(),je(ms(2)),kj(n=>{e.subgraph({[O.rank]:"same"},r=>{for(const{graphvizNode:i}of n)r.node(Zt(i).id)})}),ej(()=>{e.set(O.newrank,!0),e.set(O.clusterrank,"global"),e.delete(O.pack),e.delete(O.packmode)}))}elementToSubgraph(e,n){
const r=super.elementToSubgraph(e,n);return e.children.length>1&&r.set(O.margin,Yn(50)),r}addEdge(e,n){const[r,i]=[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,w=>kc(w)),[c,u,l]=this.edgeEndpoint(i,ka),f=rn(l)||rn(o),d=n.edge([a,u],{[O.likec4_id]:e.id,[O.style]:e.line??Pv});l&&d.attributes.set(O.lhead,l),o&&d.attributes.set(O.ltail,o);const h=this.graphology.getEdgeAttribute(e.id,"weight");h>1&&!this.graphology.hasDirectedEdge(e.target,e.source)&&d.attributes.set(O.weight,h);const m=vA(e);if(m&&
d.attributes.set(f?O.xlabel:O.label,m),e.color){const w=this.getRelationshipColorValues(e.color);d.attributes.apply({[O.color]:w.lineColor,[O.fontcolor]:w.labelColor})}let[b,$]=[e.head??Yi,e.tail??"none"];return b==="none"&&$==="none"?(d.attributes.apply({[O.arrowtail]:"none",[O.arrowhead]:"none",[O.dir]:"none"}),d):e.dir==="both"?(d.attributes.apply({[O.arrowhead]:an(b),[O.arrowtail]:an(e.tail??b),[O.dir]:"both"}),!f&&ad.modelRef(s)!==ad.modelRef(c)&&d.attributes.set(O.constraint,!1),d):(b!==Yi&&
d.attributes.set(O.arrowhead,an(b)),$!=="none"&&d.attributes.set(O.arrowtail,an($)),d)}}class tw extends Dv{static toDot(e){return new tw(e).print()}postBuild(e){e.set(O.TBbalance,"max")}addEdge(e,n){const{nodes:r}=this.view,[i,s]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[a,o,c]=this.edgeEndpoint(i,D=>kc(D)),[u,l,f]=this.edgeEndpoint(s,ka),d=n.edge([o,l],{[O.likec4_id]:e.id,[O.style]:e.line??Pv});if(f&&d.attributes.set(O.lhead,f),c&&d.attributes.set(O.ltail,c),e.color&&e.color!==io){
const D=this.getRelationshipColorValues(e.color);d.attributes.apply({[O.color]:D.lineColor,[O.fontcolor]:D.labelColor})}const h=[e.label?.trim(),e.technology?.trim()].filter(ce).join(`
`),m=aC(e.id),b=kH(m,h);d.attributes.set(O.label,b);const $=this.graphology.getEdgeAttribute(e.id,"weight");e.source!==e.target&&$>1&&d.attributes.set(O.weight,$);const w=r.findIndex(D=>D.id===i);r.findIndex(D=>D.id===s)<w&&e.dir!=="back"&&d.attributes.apply({[O.constraint]:!1});let[k,S]=[e.head??Yi,e.tail??"none"];return e.dir==="back"?(d.attributes.apply({[O.arrowtail]:an(k),[O.minlen]:0,[O.dir]:"back"}),S!=="none"&&d.attributes.apply({[O.arrowhead]:an(S),[O.dir]:"both"}),d):k==="none"&&S==="n\
one"||k!=="none"&&S!=="none"?(d.attributes.apply({[O.arrowhead]:an(k),[O.arrowtail]:an(S),[O.dir]:"both"}),d):k==="none"?(d.attributes.delete(O.arrowhead),d.attributes.apply({[O.arrowtail]:an(S),[O.minlen]:0,[O.dir]:"back"}),d):(k!==Yi&&d.attributes.set(O.arrowhead,an(k)),d)}}class LK extends Dv{postBuild(e){this.assignGroups();const n=new Set,r=this.view.nodes.reduce((s,a)=>(qn(a)&&(n.add(a.id),s.push(a)),s),[]);let i=!1;for(const s of r){const a=Ze(s.children,je(l=>!this.compoundIds.has(l)),nn(
l=>this.computedNode(l)),je(l=>l.inEdges.length===0&&l.outEdges.length===0));if(a.length<=2)continue;let o=2;switch(!0){case a.length>11:o=4;break;case a.length>4:o=3;break}const c=Zt(this.getSubgraph(s.id),`Subgraph not found for ${s.id}`);let u=null;Gj(a,o).forEach(l=>{const f=l.length>1?c.createSubgraph({[O.rank]:"same"}):null;l.forEach((d,h)=>{const m=this.getGraphNode(d.id);m&&(f?.node(m.id),h===0&&(u&&c.edge([u,m],{[O.style]:"invis"}),u=m))}),i=i||!!f})}i&&(e.set(O.newrank,!0),e.set(O.clusterrank,
"global"))}addEdge(e,n){const[r,i]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,S=>kc(S)),[c,u,l]=this.edgeEndpoint(i,ka),f=e.parent,d=this.graphology.getEdgeAttributes(e.id),h=n.edge([a,u],{[O.likec4_id]:e.id,[O.style]:e.line??Pv});l&&h.attributes.set(O.lhead,l),o&&h.attributes.set(O.ltail,o);const m=rn(l)||rn(o);!this.graphology.hasDirectedEdge(e.target,e.source)&&d.weight>1&&h.attributes.set(O.weight,d.weight);const b=vA(e);if(b&&h.attributes.set(m?O.xlabel:
O.label,b),e.color){const S=this.getRelationshipColorValues(e.color);h.attributes.apply({[O.color]:S.lineColor,[O.fontcolor]:S.labelColor})}let[$,w]=[e.head??Yi,e.tail??"none"];if(e.dir==="back")return h.attributes.apply({[O.arrowtail]:an($),[O.dir]:"back"}),w!=="none"&&h.attributes.apply({[O.arrowhead]:an(w),[O.dir]:"both",[O.minlen]:0}),h;if($==="none"&&w==="none")return h.attributes.apply({[O.arrowtail]:"none",[O.arrowhead]:"none",[O.dir]:"none",[O.minlen]:0,[O.constraint]:!1}),h;if($!=="none"&&
w!=="none")return h.attributes.apply({[O.arrowhead]:an($),[O.arrowtail]:an(w),[O.dir]:"both",[O.minlen]:0}),h;if($!==Yi&&h.attributes.set(O.arrowhead,an($)),w!=="none"&&h.attributes.set(O.arrowtail,an(w)),this.view.edges.length===1)return h;let k;return f===null&&s.parent==null&&c.parent==null?k=this.view.edges.filter(S=>{if(S.id===e.id||S.parent!==null||S.source===e.source&&S.target===e.target||S.source===e.target&&S.target===e.source)return!1;const D=this.computedNode(S.source),F=this.computedNode(
S.target);return qn(D)||qn(F)?!1:D.parent==null&&F.parent==null}):k=this.findInternalEdges(f).filter(S=>!(S.id===e.id||S.source===e.source&&S.target===e.target||S.source===e.target&&S.target===e.source)),k.length===0&&(f===null||this.leafElements(f).length<=3)&&h.attributes.set(O.minlen,0),h}}function pp(t){const[e,n,r,i]=t?t.split(",").map(o=>Cr(+o)):[0,0,0,0],s=Math.round(r-e),a=Math.round(n-i);return{x:Math.round(e),y:Math.round(i),width:s,height:a}}function MK(t){try{const[e,n]=t.split(",");
return{x:Cr(parseFloat(e)),y:Cr(parseFloat(n))}}catch(e){throw new Error(`Failed on parsing pos: ${t}`,{cause:e})}}function UA(t){const{x:e,y:n}=MK(t.pos),r=pA(parseFloat(t.width)),i=pA(parseFloat(t.height));return{x:e-Math.round(r/2),y:n-Math.round(i/2),width:r,height:i}}function WA(t,[e,n]=[0,0]){if(!t||t.length===0)return null;let r=1/0,i=1/0,s=-1/0,a=-1/0,o=13;try{for(const u of t){if(u.op==="F"){o=Cr(u.size);continue}if(u.op==="T"){let l=Cr(u.pt[0])-e,f=Cr(u.width);switch(u.align){case"r":l-=
f;break;case"c":l-=Math.round(f/2);break}r=Math.min(r,l),s=Math.max(s,l+f);let d=Cr(u.pt[1])-n;i=Math.min(i,Math.round(d-o)),a=Math.max(a,d)}}}catch(u){return un.warn(`Failed on parsing label draw ops: 
{labelDrawOps}`,{e:u,labelDrawOps:t}),null}if(r===1/0)return null;const c=2;return{x:r-c,y:i-c,width:s-r+2*c,height:a-i+2*c}}function HA({_draw_:t,likec4_id:e="???"},n="<unknown view>"){try{const r=t.filter(s=>s.op.toLowerCase()==="b");Ie(ms(r,1),`view ${n} edge ${e} should have at least one bezier draw op`),r.length>1&&un.warn(`view ${n} edge ${e} has more than one bezier draw op, using the first one only`);const i=r[0].points.map(s=>Cr(s));return Ie(ms(i,2),`view ${n} edge ${e} should have at \
least two points`),i}catch(r){throw new Error(`failed on parsing view ${n} edge ${e} _draw_:
${JSON.stringify(t,null,2)}`,{cause:r})}}function zK(t,{id:e,source:n,target:r,dir:i,label:s,description:a,...o},c){const u=WA(t._ldraw_??t._tldraw_??t._hldraw_),l=t.dir==="back"||i==="back";return s=s&&u?gA(s,{maxchars:lp,maxLines:yA}).join(`
`):null,{id:e,source:n,target:r,label:s,...ce(a)&&{description:a},...ce(t.pos)&&{dotpos:t.pos},points:HA(t,c),labelBBox:u,...l?{dir:"back"}:{},...o}}function KA(t,e){const n=pp(t.bb),{nodes:r,edges:i,manualLayout:s,...a}=e,o={...a,bounds:n,nodes:[],edges:[]},c=t.objects??[];for(const l of r){const f=c.find(d=>d.likec4_id===l.id);Ie(f,`View ${a.id} node ${l.id} not found in graphviz output`);try{const{x:d,y:h,width:m,height:b}="bb"in f?pp(f.bb):UA(f),$=[d,h];o.nodes.push({...l,position:$,width:m,
height:b,labelBBox:WA(f._ldraw_,$)??{x:d,y:h,width:m,height:b}})}catch(d){throw new Error(`Failed on parsing node ${l.id}:
${JSON.stringify(f,null,2)}`,{cause:d})}}const u=t.edges??[];for(const l of i){const f=u.find(d=>d.likec4_id===l.id);if(!f){un.warn`View ${a.id} edge ${l.id} not found in graphviz output, skipping`;continue}o.edges.push(zK(f,l,a.id))}return o}const mp=t=>String(t+1).padStart(2,"0");function FK(t){const e=pp(t.bb),n={nodes:[],edges:[],bounds:e},r=new Map,i=t.objects??[];for(const s of i){if(!s.likec4_type)continue;const a=mp(s._gvid),o=s.likec4_path??"",c=r.get(s._gvid),{x:u,y:l,width:f,height:d}="\
bb"in s?pp(s.bb):UA(s),h={x:u,y:l};if(s.likec4_type==="view")Ie(s.likec4_id,`View ${s} has no likec4_id`),n.nodes.push({id:a,type:"view",parentId:c?.id??null,height:d,width:f,position:h,label:s.label??"",viewId:s.likec4_id});else{const m={id:a,type:s.likec4_type,parentId:c?.id??null,height:d,width:f,position:h,path:o,label:s.label??""},b=[..."subgraphs"in s?s.subgraphs:[],..."nodes"in s?s.nodes:[]];for(const $ of b)r.set($,m);n.nodes.push(m)}}for(const s of t.edges??[])try{const a=mp(s.tail),o=mp(
s.head);n.edges.push({id:`link${mp(s._gvid)}`,source:a,target:o,points:HA(s)})}catch(a){un.warn(`Failed on parsing edge:
{edge}`,{error:a,edge:s})}return n}const VA=qt.font,gp="/";class nw{static toDot(e){return new nw(e).print()}subgraphs=new Map;graphvizModel;constructor(e){const n=this.graphvizModel=sH.graph({[O.layout]:"osage",[O.pack]:Yn(100),[O.packmode]:"array_ltc",[O.pad]:dt(15),[O.fontname]:VA,[O.splines]:"polyline",[O.esep]:"+20"});n.attributes.graph.apply({[O.fontsize]:Yn(20),[O.labeljust]:"l",[O.labelloc]:"t"}),n.attributes.node.apply({[O.fontname]:VA,[O.shape]:"rect",[O.width]:dt(400),[O.height]:dt(300),
[O.fixedsize]:!0,[O.fontsize]:10}),n.attributes.edge.apply({[O.penwidth]:Yn(2)});const r=new Set(e.map(c=>c.relativePath??""));let i=0,s=[...e];const a=r.size>1;a&&s.sort((c,u)=>{const l=c.relativePath?.split(gp)??[""],f=u.relativePath?.split(gp)??[""];l.push(c.title??"Untitled"),f.push(u.title??"Untitled");const d=l.length,h=f.length;switch(i=Math.max(i,d,h),!0){case d>h:return-1;case d<h:return 1;default:{for(let m=0;m<d;m++){const b=l[m].localeCompare(f[m]);if(b!==0)return b}return 0}}});const o=new Map;
s.forEach((c,u)=>{this.addView(a?c:{...c,relativePath:""},u+i);const l=c.nodes.reduce((f,d)=>(d.navigateTo&&f.add(d.navigateTo),f),new Set);l.size>0&&o.set(c.id,l)});for(const[c,u]of o)for(const l of u)n.edge([c,l])}getParentForPath(e){if(e==="")return this.graphvizModel;const n=e.toLowerCase();let r=this.subgraphs.get(n);if(!r){const i=n.endsWith(".c4")||n.endsWith(".likec4"),s=e.includes(gp)?e.slice(0,e.lastIndexOf(gp)):"";r=this.getParentForPath(s).subgraph("cluster"+String(this.subgraphs.size+
1),{[O.likec4_type]:i?"file":"folder",[O.likec4_path]:e,[O.sortv]:this.subgraphs.size,[O.label]:ce(s)?e.slice(s.length+1):e}),this.subgraphs.set(n,r)}return r}addView(e,n=0){return this.getParentForPath(e.relativePath??"").node(e.id,{[O.likec4_type]:"view",[O.likec4_id]:e.id,[O.sortv]:n,[O.label]:e.title||"Untitled"})}print(){return dA(this.graphvizModel,{print:{indentStyle:"space",indentSize:2}})}}const XA=t=>{switch(!0){case so.isDynamic(t):return new tw(t);case so.isDeployment(t):return new OK(
t);case so.isElement(t):return new LK(t);default:Me(t)}},Ja=un.getChild("graphviz-layouter");class YA{constructor(e){this.graphviz=e}get port(){return this.graphviz}changePort(e){this.graphviz=e}async dotToJson(e){let n;try{n=await this.graphviz.layoutJson(e)}catch(r){throw Ja.error(Ji(r)),Ja.error`Failed to convert DOT to JSON:\n${e}`,r}try{return JSON.parse(n)}catch(r){throw Ja.error(Ji(r)),Ja.error`Failed to parse JSON:\n${n}\n. Generated from DOT:\n${e}`,r}}async layout(e){try{let n=await this.
dot(e);const r=await this.dotToJson(n);let i=KA(r,e);if(e.manualLayout){const s=wW(i,e.manualLayout);if(s.diagram)i=s.diagram;else{if(s.relayout.nodes.length>0){const a=XA(e);if(a.hasEdgesWithCompounds)Ja.warn(`Manual layout for view ${e.id} is ignored, as edges with compounds are not supported`);else{a.applyManualLayout(s.relayout);const o=await this.dotToJson(a.print());i=KA(o,e)}}i.hasLayoutDrift=!0}}return n=n.split(`
`).filter(s=>!(s.includes("margin")&&s.includes("50.1"))).join(`
`),{dot:n,diagram:i}}catch(n){throw new Error(`Error during layout: ${e.id}`,{cause:n})}}async svg(e){let n=await this.dot(e);return n=n.split(`
`).filter(r=>!(r.includes("margin")&&r.includes("50.1"))).join(`
`),{svg:await this.graphviz.svg(n),dot:n}}async dot(e){let n=XA(e).print();if(!so.isElement(e))return n;try{return await this.graphviz.unflatten(n)}catch(r){return Ja.warn(`Error during unflatten: ${e.id}`,{error:r}),n}}async layoutOverviewGraph(e){if(e.length===0)return Promise.resolve({nodes:[],edges:[],bounds:{x:0,y:0,width:10,height:10}});const n=nw.toDot(e),r=await this.dotToJson(n);return FK(r)}}class qK{value;next;constructor(e){this.value=e}}class GK{#e;#t;#n;constructor(){this.clear()}enqueue(e){
const n=new qK(e);this.#e?(this.#t.next=n,this.#t=n):(this.#e=n,this.#t=n),this.#n++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#n--,e.value}peek(){if(this.#e)return this.#e.value}clear(){this.#e=void 0,this.#t=void 0,this.#n=0}get size(){return this.#n}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}function Nv(t){JA(t);const e=new GK;let n=0;const r=()=>{n<t&&e.size>0&&(e.dequeue()(),n++)},i=()=>{n--,r()},s=async(c,u,l)=>{const f=(async()=>c(...l))();u(f);
try{await f}catch{}i()},a=(c,u,l)=>{new Promise(f=>{e.enqueue(f)}).then(s.bind(void 0,c,u,l)),(async()=>(await Promise.resolve(),n<t&&r()))()},o=(c,...u)=>new Promise(l=>{a(c,l,u)});return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>t,set(c){JA(c),t=c,queueMicrotask(()=>{for(;n<t&&e.size>0;)r()})}}}),o}function JA(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expecte\
d `concurrency` to be a number from 1 and up")}const jK=Nv(1);class no{static _graphviz=null;graphviz(){return Promise.resolve().then(()=>no._graphviz??=Pp.load())}async attempt(e,n,r){return await jK(async()=>{const i=un.getChild("graphviz-wasm");try{return await r()}catch(s){i.error(`FAILED GraphvizWasm.${e}`,{error:s}),i.warn(`FAILED DOT:
${n}`),Pp.unload(),no._graphviz=null}i.warn("Retrying..."),await oC(50,300);try{return await r()}finally{Pp.unload(),no._graphviz=null}})}async unflatten(e){return await this.attempt("unflatten",e,async()=>(await this.graphviz()).unflatten(e,1,!1,3).replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    "))}async acyclic(e){return await this.attempt("acyclic",e,async()=>{const n=(await this.graphviz()).acyclic(e,!0);return n.acyclic&&n.outFile||e})}async layoutJson(e){return await this.attempt("layout",
e,async()=>(await this.graphviz()).layout(e,"json",void 0,{yInvert:!0}))}async svg(e){return await this.attempt("svg",e,async()=>(await this.graphviz()).layout(e,"svg"))}}const Jl=Symbol.for("idattr"),yp={writeId(t,e){return t[Jl]=e,t},readId(t){return t[Jl]}},vp={writeId(t,e){return yt(e)?t[Jl]=void 0:t[Jl]=e,t},readId(t){return t[Jl]}};function Qa(t){return t.textDocument.languageId===ov.languageId}function QA({value:t}){const e=parseFloat(t);return isNaN(e)?100:ZT(e,{min:0,max:100})}function Za({
value:t}){switch(t){case"xs":case"sm":case"md":case"lg":case"xl":return t;case"xsmall":return"xs";case"small":return"sm";case"medium":return"md";case"large":return"lg";case"xlarge":return"xl";default:Me(t)}}function qi(t,e){const n={};if(!t||t.length===0)return n;for(const r of t)if(e(r))switch(!0){case hh(r):{ce(r.value)&&(n.border=r.value);break}case Is(r):{const i=Ql(r);ce(i)&&(n.color=i);break}case Yh(r):{ce(r.value)&&(n.shape=r.value);break}case _r(r):{const i=r.libicon?.ref?.name??r.value;
ce(i)&&(n.icon=i);break}case Wh(r):{n.opacity=QA(r);break}case Ky(r):{n.multiple=ey(r.value)?r.value:!1;break}case Zy(r):{ce(r.value)&&(n.size=Za(r));break}case Yy(r):{ce(r.value)&&(n.padding=Za(r));break}case rv(r):{ce(r.value)&&(n.textSize=Za(r));break}default:Me(r)}return n}function BK(t,e){const n={};if(!t||t.length===0)return n;for(const r of t)if(e(r))switch(!0){case Is(r):{const i=Ql(r);ce(i)&&(n.color=i);break}case tl(r):{n.line=r.value;break}case vu(r):{switch(r.key){case"head":{n.head=
r.value;break}case"tail":{n.tail=r.value;break}default:Me(r)}break}default:Me(r)}return n}function Iv(t,e){const{color:n,line:r,head:i,tail:s}=BK(t?.filter(c0),e);return{...n&&n!==io?{color:n}:{},...r&&r!==cC?{line:r}:{},...i&&i!==Yi?{head:i}:{},...s?{tail:s}:{}}}function Ql(t){return t?.themeColor??t?.customColor?.$refText}function Ov(t){const e=t.rankSep,n=t.nodeSep;let r;switch(t.direction){case"TopBottom":{r="TB";break}case"BottomTop":{r="BT";break}case"LeftRight":{r="LR";break}case"RightLef\
t":{r="RL";break}default:Me(t.direction)}return{direction:r,...n&&{nodeSep:n},...e&&{rankSep:e}}}function UK(t){switch(t){case"TB":return"TopBottom";case"BT":return"BottomTop";case"LR":return"LeftRight";case"RL":return"RightLeft";default:Me(t)}}function ZA(t){if(Ty(t))return t;if(Gy(t))return t.subject;if(Ch(t))return ZA(t.subject);Me(t)}class WK{parser;locator;constructor(e){this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getDocumentation(e){try{if(Pn(e)){const n=ht(e),r=this.
parser.forDocument(n).parseDeploymentNode(e),i=[r.id];return r.title!==e.name&&i.push(" ",`**${r.title}**`),i.join(`  
`)}if(Cn(e)){const n=ht(e),r=this.parser.forDocument(n).parseDeployedInstance(e),i=this.locator.getParsedElement(r.element),s=[r.id,`_instance of_ ${r.element}`];return i&&s.push(" ",`**${i.title}**`),s.join(`  
`)}if(wn(e)){const n=ht(e),r=this.parser.forDocument(n).parseElement(e);return r?[r.id," ",`**${r.title}**`].join(`  
`):void 0}}catch(n){ke(n)}}}function HK(t,e){return[t,e]=Lv(t,e)>0?[e,t]:[t,e],KK(t.range,e.range.start)}function Lv(t,e){const n=t.range.start.line-e.range.start.line;return n!==0?n:t.range.start.character-e.range.start.character}function KK(t,e){return!(e.line<t.start.line||e.line>t.end.line||e.line==t.start.line&&e.character<t.start.character||e.line==t.end.line&&e.character>t.end.character)}function wp(t){return t.range.start.line!=t.range.end.line}const Q={newLine:Ci.newLine({allowMore:!0}),
oneSpace:Ci.oneSpace(),noSpace:Ci.noSpace(),indent:Ci.indent({allowMore:!0}),noIndent:Ci.noIndent()};class VK extends gB{format(e){this.removeIndentFromTopLevelStatements(e),this.indentContentInBraces(e),this.formatSpecificationRule(e),this.formatGlobals(e),this.formatElementDeclaration(e),this.formatRelation(e),this.formatMetadataProperty(e),this.formatDeploymentNodeDeclaration(e),this.formatDeployedInstance(e),this.formatDeploymentRelation(e),this.formatView(e),this.formatViewRuleGroup(e),this.
formatViewRuleGlobalStyle(e),this.formatViewRuleGlobalPredicate(e),this.formatIncludeExcludeExpressions(e),this.formatDeploymentViewRulePredicateExpressions(e),this.formatWhereExpression(e),this.formatWhereExpressionV2(e),this.formatWhereRelationExpression(e),this.formatWhereElementExpression(e),this.formatRelationExpression(e),this.formatAutolayoutProperty(e),this.formatWithPredicate(e),this.formatViewRuleStyle(e),this.formatLeafProperty(e),this.formatLinkProperty(e),this.formatNavigateToProperty(
e),this.formatTags(e)}formatTags(e){this.on(e,nv,(n,r)=>{r.cst(aa(n.$cstNode,"values").slice(1)).prepend(Q.oneSpace),r.keywords(",").prepend(Q.noSpace).append(Q.oneSpace)})}formatDeploymentRelation(e){this.on(e,Di,(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.$cstNode]:[];r.cst(i).append(Q.oneSpace),r.keywords("]->").prepend(Q.noSpace),r.keywords("-[").append(Q.noSpace),r.nodes(...je([n.target,n.tags],ce)).prepend(Q.oneSpace),r.properties("title","technology").prepend(Q.oneSpace)})}formatRelation(e){
this.on(e,oi,(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.$cstNode]:[];r.cst(i).append(Q.oneSpace),r.keywords("]->").prepend(Q.noSpace),r.keywords("-[").append(Q.noSpace),r.nodes(...je([n.target,n.tags],ce)).prepend(Q.oneSpace),r.properties("title","technology").prepend(Q.oneSpace)}),this.on(e,Fy,(n,r)=>{r.keywords("->","<-").surround(Q.oneSpace);const i=r.property("kind");i.nodes[0]?.text.startsWith(".")&&i.surround(Q.oneSpace),r.keywords("]->").prepend(Q.noSpace).append(Q.oneSpace),r.keywords(
"-[").prepend(Q.oneSpace).append(Q.noSpace),r.properties("title").prepend(Q.oneSpace)}),this.on(e,Ly)?.property("target").prepend(Q.oneSpace),this.on(e,Xy,(n,r)=>{r.property("from").append(Q.oneSpace),r.keywords("]->").prepend(Q.noSpace),r.keywords("-[").append(Q.noSpace)}),this.on(e,R0)?.keywords("->").append(Q.oneSpace),this.on(e,Hy)?.keyword("->").prepend(Q.oneSpace)}removeIndentFromTopLevelStatements(e){(E0(e)||tv(e)||sl(e)||T0(e)||Uy(e)||S0(e))&&this.getNodeFormatter(e).keywords("specificat\
ion","model","views","likec4lib","global","deployments").prepend(Q.noIndent)}indentContentInBraces(e){if(T0(e)||tv(e)||ja(e)||Ua(e)||qa(e)||Uy(e)||Ia(e)||zs(e)||Hu(e)||Wu(e)||zs(e)||E0(e)||_u(e)||b0(e)||kU(e)||Xh(e)||RU(e)||sl(e)||v0(e)||hU(e)||dU(e)||Dl(e)||rp(e)||sU(e)||aU(e)||Ni(e)||My(e)||S0(e)||cU(e)||lU(e)||oU(e)){const n=this.getNodeFormatter(e),r=n.keywords("{"),i=n.keywords("}"),s=n.interior(r,i);let a=null;for(const o of s.nodes)(!a||!HK(a,o))&&n.cst([o]).prepend(Q.indent),a=o;r.prepend(
Q.noIndent).prepend(Q.oneSpace),i.prepend(Q.noIndent).prepend(Ci.newLine({allowMore:!0}))}}appendKeywordsWithSpace(e){this.on(e,y0)?.keywords("element").append(Q.oneSpace)}formatView(e){this.on(e,xh,(n,r)=>{(n.extends||n.viewOf||n.name)&&r.keywords("view").append(Q.oneSpace),r.keywords("of","extends").surround(Q.oneSpace)}),this.on(e,p0)?.keywords("dynamic","view").append(Q.oneSpace),this.on(e,Iy)?.keywords("deployment","view").append(Q.oneSpace)}formatLeafProperty(e){if(Mu(e)||wl(e)||SU(e)||za(
e)||ev(e)||C0(e)||Is(e)||tl(e)||vu(e)||_r(e)||Yh(e)||hh(e)||Wh(e)||Ky(e)||Zy(e)||Yy(e)||rv(e)){const n=this.getNodeFormatter(e),r=n.keyword(":"),i=n.keywords("title","description","technology","notation","color","line","head","tail","icon","shape","border","opacity","multiple","size","padding","textSize");r.nodes.length===0?i.append(Q.oneSpace):r.prepend(Q.noSpace).append(Q.oneSpace),n.keyword(";").prepend(Q.noSpace).append(Q.newLine)}}formatLinkProperty(e){this.on(e,jh,(n,r)=>{r.keyword("link").
append(Q.oneSpace),r.property("value").append(Q.oneSpace),r.keyword(":").prepend(Q.noSpace).append(Q.oneSpace),r.keyword(";").prepend(Q.noSpace).append(Q.newLine)})}formatNavigateToProperty(e){this.on(e,Uh)?.property("key").append(Q.oneSpace)}formatAutolayoutProperty(e){this.on(e,Al,(n,r)=>{r.keyword("autoLayout").append(Q.oneSpace),r.property("rankSep").prepend(Q.oneSpace),r.property("nodeSep").prepend(Q.oneSpace)})}formatMetadataProperty(e){this.on(e,$U,(n,r)=>{r.property("key").append(Q.oneSpace),
r.keyword(":").prepend(Q.noSpace).append(Q.oneSpace),r.keyword(";").prepend(Q.noSpace).append(Q.newLine)})}formatElementDeclaration(e){this.on(e,wn,(n,r)=>{const i=tn(n.$cstNode,"kind"),s=tn(n.$cstNode,"name");s&&i&&(Lv(s,i)>0?r.cst([i]).append(Q.oneSpace):(r.cst([s]).append(Q.oneSpace),r.cst([i]).prepend(Q.oneSpace))),r.properties("props").prepend(Q.oneSpace)})}formatGlobals(e){this.on(e,Ia,(n,r)=>{r.keyword("style").append(Q.oneSpace),r.property("id").append(Q.oneSpace)}),this.on(e,zs,(n,r)=>{
r.keyword("styleGroup").append(Q.oneSpace)}),this.on(e,Hu,(n,r)=>{r.keyword("predicateGroup").append(Q.oneSpace)}),this.on(e,Wu,(n,r)=>{r.keyword("dynamicPredicateGroup").append(Q.oneSpace)})}formatSpecificationRule(e){if((ja(e)||Ua(e)||Zh(e)||qa(e))&&this.getNodeFormatter(e).keywords("element","relationship","tag","deploymentNode").append(Q.oneSpace),Qh(e)){const n=this.getNodeFormatter(e);n.keyword("color").append(Q.oneSpace),n.property("name").append(Q.oneSpace)}}formatWithPredicate(e){const n=this.
getNodeFormatter(e);(Ch(e)||Qy(e))&&n.keyword("with").prepend(Q.oneSpace)}formatDeploymentNodeDeclaration(e){this.on(e,Pn,(n,r)=>{const i=tn(n.$cstNode,"kind"),s=tn(n.$cstNode,"name");s&&i&&(Lv(s,i)>0?r.cst([i]).append(Q.oneSpace):(r.cst([s]).append(Q.oneSpace),r.cst([i]).prepend(Q.oneSpace))),r.properties("title").prepend(Q.oneSpace)})}formatDeployedInstance(e){this.on(e,Cn,(n,r)=>{const i=n.$cstNode?.content.find(s=>s.text==="=");i&&r.cst([i]).surround(Q.oneSpace),r.keyword("instanceOf").append(
Q.oneSpace),r.property("title").prepend(Q.oneSpace)})}formatViewRuleGlobalStyle(e){this.on(e,av,(n,r)=>{r.keywords("global","style").append(Q.oneSpace)})}formatViewRuleGlobalPredicate(e){const n=this.getNodeFormatter(e);(sv(e)||m0(e))&&n.keywords("global","predicate").append(Q.oneSpace)}formatViewRuleGroup(e){this.on(e,rp,(n,r)=>{r.keyword("group").append(Q.oneSpace)})}formatViewRuleStyle(e){this.on(e,Dl)?.keyword("style").append(Q.oneSpace),this.on(e,h0)?.keyword("style").append(Q.oneSpace),this.
on(e,mU)?.keyword(",").prepend(Q.noSpace).append(Q.oneSpace),this.on(e,vU)?.keyword(",").prepend(Q.noSpace).append(Q.oneSpace)}formatWhereExpression(e){(YB(e)||BB(e))&&this.getNodeFormatter(e).keyword("where").append(Q.oneSpace)}formatWhereExpressionV2(e){(JB(e)||UB(e))&&this.getNodeFormatter(e).keyword("where").append(Q.oneSpace)}formatWhereRelationExpression(e){if(this.on(e,rU,(n,r)=>{r.property("operator").surround(Q.oneSpace)}),this.on(e,O0,(n,r)=>{r.keyword("not").append(Q.oneSpace)}),f0(e)||
PU(e)||I0(e)){const n=this.getNodeFormatter(e);n.property("operator").surround(Q.oneSpace),n.property("not").surround(Q.oneSpace)}}formatWhereElementExpression(e){if(this.on(e,tU,(n,r)=>{r.property("operator").surround(Q.oneSpace)}),this.on(e,N0,(n,r)=>{r.keyword("not").append(Q.oneSpace)}),l0(e)||CU(e)||_U(e)){const n=this.getNodeFormatter(e);n.property("operator").surround(Q.oneSpace),n.property("not").surround(Q.oneSpace)}}formatIncludeExcludeExpressions(e){if(Yf(e)||Fh(e)||Gu(e)||Aa(e)){const n=this.
getNodeFormatter(e);(!e.$cstNode||!wp(e.$cstNode))&&n.keywords("include","exclude").append(Q.oneSpace)}if(g0(e)||_0(e)||_0(e)){const n=this.getNodeFormatter(e),r=this.findPredicateExpressionRoot(e),i=r?.$cstNode&&wp(r?.$cstNode);i&&n.property("value").prepend(Q.indent),n.keyword(",").prepend(Q.noSpace).append(i?Q.newLine:Q.oneSpace)}}formatRelationExpression(e){this.on(e,Wy,(n,r)=>{r.keyword("->").append(Q.oneSpace)}),this.on(e,k0,(n,r)=>{r.keyword("->").prepend(Q.oneSpace)}),this.on(e,Vy,(n,r)=>{
r.keywords("->","<->").prepend(Q.oneSpace),r.keywords("-[").prepend(Q.oneSpace).append(Q.noSpace),r.keywords("]->").prepend(Q.noSpace).append(Q.oneSpace);const i=r.property("kind");i.nodes[0]?.text.startsWith(".")&&i.surround(Q.oneSpace)}),this.on(e,Oy,(n,r)=>{r.property("target").prepend(Q.oneSpace)})}formatDeploymentViewRulePredicateExpressions(e){if(Yf(e)||Fh(e)||Gu(e)||Aa(e)){const n=this.getNodeFormatter(e);(!e.$cstNode||!wp(e.$cstNode))&&n.keywords("include","exclude").append(Q.oneSpace)}if(fU(
e)){const n=this.getNodeFormatter(e),r=this.findPredicateExpressionRoot(e),i=r?.$cstNode&&wp(r?.$cstNode);i&&n.property("value").prepend(Q.indent),n.keyword(",").prepend(Q.noSpace).append(i?Q.newLine:Q.oneSpace)}}findPredicateExpressionRoot(e){let n=e.$container;for(;;){if(!n||Yf(n)||Fh(n)||Gu(n)||Aa(n))return n;n=n.$container}}on(e,n,r){const i=n(e)?this.getNodeFormatter(e):void 0;return r&&i&&r(e,i),i}}class XK{constructor(e){this.services=e}async provideCodeLens(e,n,r){return Qa(e)?(e.state!==
ze.Validated&&(nt.debug(`Waiting for document ${e.uri.path} to be validated`),await this.services.shared.workspace.DocumentBuilder.waitUntil(ze.Validated,e.uri,r),nt.debug(`Document ${e.uri.path} is validated`)),r&&await jt(r),e.parseResult.value.views.flatMap(i=>i.views).flatMap(i=>{const s=yp.readId(i),a=i.$cstNode?.range;return!a||!s?[]:{range:{start:a.start,end:{line:a.start.line,character:a.start.character+4}},command:{command:"likec4.open-preview",arguments:[s],title:"open preview"}}})):void 0}}
const Mv=["color","shape","icon","border","opacity","multiple","size","textSize"].join(",");class YK extends ES{completionOptions={triggerCharacters:["."]};completionForKeyword(e,n,r){if(this.filterKeyword(e,n)){if(n.value==="deployment"&&wi(e.node,sl))return r(e,{label:n.value,detail:"Insert deployment view",kind:kt.Class,insertTextFormat:_n.Snippet,insertText:["deployment view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	include $0","}"].join(`
`)});if(["title","description","technology"].includes(n.value))return r(e,{label:n.value,kind:kt.Property,insertTextFormat:_n.Snippet,insertText:`${n.value} '\${0}'`});if(n.value==="color")return r(e,{label:n.value,kind:kt.Property,insertTextFormat:_n.Snippet,insertText:`${n.value} \${1|${uC.join(",")}|}$0`});if(n.value==="opacity")return r(e,{label:n.value,kind:kt.Property,insertTextFormat:_n.Snippet,insertText:`${n.value} \${0:100}%`});if(["views","specification","model","deployment","with"].includes(
n.value))return r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:kt.Module,insertTextFormat:_n.Snippet,insertText:`${n.value} {
	$0
}`});if(n.value==="group")return r(e,{label:n.value,detail:"Insert group block",kind:kt.Class,insertTextFormat:_n.Snippet,insertText:["group '${1:Title}' {","	$0","}"].join(`
`)});if(n.value==="dynamic"&&wi(e.node,sl))return r(e,{label:n.value,detail:"Insert dynamic view",kind:kt.Class,insertTextFormat:_n.Snippet,insertText:["dynamic view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	$0","}"].join(`
`)});if(n.value==="style"&&e.node)return wi(e.node,Ia)?r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:kt.Module,insertTextFormat:_n.Snippet,insertText:`${n.value} \${1:name} \${2:*} {
	\${3|${Mv}|} $0
}`}):wi(e.node,Fj([sl,zs]))?r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:kt.Module,insertTextFormat:_n.Snippet,insertText:`${n.value} \${1:*} {
	\${2|${Mv}|} $0
}`}):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:kt.Module,insertTextFormat:_n.Snippet,insertText:`${n.value} {
	\${1|${Mv}|} $0
}`});if(n.value==="extend")return r(e,{label:n.value,detail:"Extend another view",kind:kt.Class,insertTextFormat:_n.Snippet,insertText:`extend $1 {
	$0
}`});if(n.value==="autoLayout")return r(e,{label:n.value,kind:kt.Class,insertTextFormat:_n.Snippet,insertText:"autoLayout ${1|TopBottom,BottomTop,LeftRight,RightLeft|}$0"});r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}}}class JK extends SS{createDocumentHighlight(e){return ve.DocumentHighlight.create(e.segment.range,ve.DocumentHighlightKind.Read)}}const QK=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,ZK=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,eV=/^([/\\]\s*){2,}[^/\\]/;
function e_(t){return["./","../"].some(e=>t.startsWith(e))}function zv(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?QK.test(t):ZK.test(t)||(e.acceptRelative?eV.test(t):!1)}function tV(t="",e){return t.endsWith("/")}function nV(t="",e){return(tV(t)?t.slice(0,-1):t)||"/"}function rV(t="",e){return t.endsWith("/")?t:t+"/"}function bp(t=""){return t.startsWith("/")}function t_(t=""){return(bp(t)?t.slice(1):t)||"/"}function iV(t=""){return bp(t)?t:"/"+t}function sV(t,e){if(aV(e))
return t;const n=nV(e);if(!t.startsWith(n))return t;const r=t.slice(n.length);return r[0]==="/"?r:"/"+r}function aV(t){return!t||t==="/"}function $p(t=""){const[e="",n="",r=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:r}}const n_=nt.getChild("DocumentLinkProvider");class oV{constructor(e){this.services=e}async getDocumentLinks(e,n,r){return Qa(e)?(e.state!==ze.Validated&&(n_.debug(`Waiting for document ${e.uri.path} to be validated`),await this.services.
shared.workspace.DocumentBuilder.waitUntil(ze.Validated,e.uri,r),n_.debug(`Document ${e.uri.path} is validated`)),r&&await jt(r),br(e.parseResult.value).filter(jh).map(i=>{try{const s=tn(i.$cstNode,"value")?.range,a=this.resolveLink(e,i.value);if(s&&zv(a))return{range:s,target:a}}catch(s){ke(s)}return null}).nonNullable().toArray()):[]}resolveLink(e,n){if(zv(n)||bp(n))return n;const r=e_(n)?new URL(e.uri.toString(!0)):this.services.shared.workspace.WorkspaceManager.workspaceURL;return new URL(n,
r).toString()}relativeLink(e,n){if(bp(n))return t_(n);if(e_(n)){const r=new URL(e.uri.toString(!0)),i=new URL(n,r).toString();return t_(sV(i,this.services.shared.workspace.WorkspaceManager.workspaceURL.toString()))}return null}}function bn(t){return t.el.ref}function Hs(t){const e=[t.$type==="StrictFqnRef"?t.value.$refText:t.el.$refText];let n=t.parent;for(;n;)e.push(n.$type==="StrictFqnRef"?n.value.$refText:n.el.$refText),n=n.parent;return e.length===1?e[0]:e.reverse().join(".")}class cV{constructor(e){
this.services=e,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator,this.nameProvider=e.references.NameProvider}nodeKindProvider;nameProvider;parser;locator;getSymbols({parseResult:{value:{specifications:e,models:n,deployments:r,views:i,likec4lib:s}}}){return[...s.map(a=>()=>this.getLikec4LibSymbol(a)),...e.map(a=>()=>this.getSpecSymbol(a)),...n.map(a=>()=>this.getModelSymbol(a)),...r.map(a=>()=>this.getDeploymentModelSymbol(a)),
...i.map(a=>()=>this.getModelViewsSymbol(a))].flatMap(a=>{try{return a()??[]}catch(o){return ke(o),[]}})}getLikec4LibSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.icons.map(i=>this.getLibIconSymbol(i)).filter(ce);return r.length===0?[]:[{kind:ar.Namespace,name:"icons",range:n.range,selectionRange:Ko(n,"icons")?.range??n.range,children:r}]}getSpecSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=tn(n,"name");if(!r)return[];const i=Ze([...e.elements,...e.tags,...e.relationships],nn(s=>{
try{if(ja(s)||Ua(s)||qa(s))return this.getKindSymbol(s);if(Zh(s))return this.getTagSymbol(s)}catch(a){return ke(a),null}Me(s)}),je(ce));return i.length===0?[]:[{kind:ar.Namespace,name:e.name,range:n.range,selectionRange:r.range,children:i}]}getModelSymbol(e){const n=e.$cstNode;if(!n)return[];const r=tn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.elements.flatMap(i=>this.getElementsSymbol(i))}]:[]}getDeploymentModelSymbol(e){const n=e.$cstNode;
if(!n)return[];const r=tn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.elements.flatMap(i=>this.getDeploymentElementSymbol(i))}]:[]}getElementsSymbol(e){try{if(Pa(e))return this.getExtendElementSymbol(e);if(wn(e))return this.getElementSymbol(e)}catch(n){ke(n)}return[]}getExtendElementSymbol(e){const n=e.$cstNode,r=e.element.$cstNode,i=e.body;return!n||!r?[]:[{kind:this.symbolKind(e),name:Hs(e.element),range:n.range,selectionRange:r.range,
children:i.elements.flatMap(s=>this.getElementsSymbol(s))}]}getElementSymbol(e){const n=e.$cstNode,r=tn(n,"name");if(!r||!n)return[];const i=e.name,s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.range,detail:s,children:e.body?.elements.flatMap(a=>this.getElementsSymbol(a))??[]}]}getModelViewsSymbol(e){const n=e.$cstNode,r=tn(n,"name");return!r||!n?[]:[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.views.flatMap(i=>this.
getViewSymbol(i))}]}getKindSymbol(e){return!e.$cstNode||!e.kind.$cstNode||Pt(e.kind.name)?null:{kind:this.symbolKind(e),name:e.kind.name,range:e.$cstNode.range,selectionRange:e.kind.$cstNode.range}}getTagSymbol(e){return!e.$cstNode||!e.tag.$cstNode||Pt(e.tag.name)?null:{kind:this.symbolKind(e),name:"#"+e.tag.name,range:e.$cstNode.range,selectionRange:e.tag.$cstNode.range}}getLibIconSymbol(e){return!e.$cstNode||Pt(e.name)?null:{kind:this.symbolKind(e),name:e.name,range:e.$cstNode.range,selectionRange:e.
$cstNode.range}}getViewSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.name?tn(n,"name"):null;return r?[{kind:this.symbolKind(e),name:r.text,range:n.range,selectionRange:r.range,children:[]}]:[]}getDeploymentElementSymbol(e){try{if(Pn(e))return this.getDeploymentNodeSymbol(e);if(Cn(e))return this.getDeployedInstanceSymbol(e);if(Ls(e))return[]}catch(n){ke(n)}return[]}getDeploymentNodeSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(e);if(!r||!n)return[];const i=this.nameProvider.
getNameStrict(e),s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.range,detail:s,children:e.body?.elements.flatMap(a=>this.getDeploymentElementSymbol(a))??[]}]}getDeployedInstanceSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(e);if(!r||!n)return[];const i=ht(e),s=this.parser.forDocument(i).parseDeployedInstance(e),a=this.nameProvider.getNameStrict(e),o="instance of "+s.element;return[{kind:this.symbolKind(e),name:a,range:n.range,selectionRange:r.
range,detail:o,children:[]}]}symbolKind(e){return this.nodeKindProvider.getSymbolKind(e)}}class uV extends PS{parser;locator;constructor(e){super(e),this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getAstNodeHoverContent(e){if(D0(e))return{contents:{kind:"markdown",value:"tag `"+e.name+"`"}};if(Pn(e)){const n=ht(e),r=this.parser.forDocument(n).parseDeploymentNode(e),i=[r.id+"  "];return r.title!==e.name&&i.push(`### ${r.title}`),i.push("deployment node `"+r.kind+"` "),{contents:{
kind:"markdown",value:i.join(`
`)}}}if(Cn(e)){const n=ht(e),r=this.parser.forDocument(n).parseDeployedInstance(e),i=this.locator.getParsedElement(r.element),s=[r.id+"  ",`instance of \`${r.element}\``];return i&&s.push(`### ${i.title}`,"element kind `"+i.kind+"` "),{contents:{kind:"markdown",value:s.join(`
`)}}}if(y0(e))return{contents:{kind:"markdown",value:"element kind `"+e.name+"`"}};if(uU(e))return{contents:{kind:"markdown",value:"deployment node `"+e.name+"`"}};if(wn(e)){const n=this.locator.getParsedElement(e);return n?{contents:{kind:"markdown",value:[n.id,`### ${n.title}`,"element kind `"+n.kind+"` "].join(`
`)}}:void 0}}}class lV extends sB{highlightElement(e,n){if(wn(e)||Pn(e))return this.highlightNameAndKind(e,n);if(Cn(e)){"name"in e&&n({node:e,property:"name",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});return}if(_y(e))return this.highlightView(e,n);if(EU(e))return n({node:e,property:"name",type:xe.function});if(wU(e))return n({node:e,property:"name",type:xe.type,modifier:[Ge.definition]}),"prune";if(Xy(e)&&"kind"in e){n({node:e,property:"kind",type:xe.function});return}if(oi(e)&&"kin\
d"in e&&n({node:e,property:"kind",type:xe.function}),Uh(e)||pl(e))return n({node:e,property:"key",type:xe.property}),n({node:e,property:"value",type:xe.variable,modifier:[Ge.definition,Ge.readonly]}),"prune";if((qy(e)||qs(e))&&e.$cstNode)return n({cst:e.$cstNode,type:xe.variable,modifier:[Ge.definition,Ge.readonly]}),"prune";if(By(e)){e.selector&&n({node:e,property:"selector",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});return}if(I0(e)&&ce(e.value)){n({node:e,property:"value",type:xe.
function});return}if((l0(e)||f0(e))&&ce(e.value)){n({node:e,property:"value",type:xe.type,modifier:[Ge.definition,Ge.readonly]});return}if((L0(e)||M0(e))&&n({node:e,property:"participant",type:xe.keyword}),_h(e)&&ce(e.kind))return n({node:e,property:"kind",type:xe.type,modifier:[Ge.definition]}),"prune";if(zs(e)||Ia(e)){n({node:e,property:"id",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});return}if(av(e)){n({node:e,property:"style",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});
return}if(Hu(e)||Wu(e)){n({node:e,property:"name",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});return}if(sv(e)){n({node:e,property:"predicate",type:xe.variable,modifier:[Ge.definition,Ge.readonly]});return}if(Ph(e)&&ce(e.tag))return n({node:e,property:"tag",type:xe.type,modifier:[Ge.definition]}),"prune";if($0(e)||x0(e))return n({node:e,property:"value",type:e.parent?xe.property:xe.variable,modifier:[Ge.definition,Ge.readonly]}),e.parent?void 0:"prune";if(Ou(e)||P0(e))return n({node:e,
property:"el",type:e.parent?xe.property:xe.variable,modifier:[Ge.definition,Ge.readonly]}),e.parent?void 0:"prune";if(Qh(e)){n({node:e,keyword:"color",type:xe.keyword}),n({node:e,property:"name",type:xe.type,modifier:[Ge.declaration,Ge.readonly]});return}if((ja(e)||Ua(e)||qa(e))&&n({node:e,property:"kind",type:xe.type,modifier:[Ge.declaration,Ge.readonly]}),nv(e))return n({node:e,property:"values",type:xe.interface});if(D0(e))return n({node:e,property:"name",type:xe.type,modifier:[Ge.definition]});
if((Xh(e)||Ni(e)&&_u(e.$container))&&n({node:e,property:"key",type:xe.property}),Wh(e))return n({node:e,property:"key",type:xe.property}),n({node:e,property:"value",type:xe.number}),"prune";if(jh(e)||_r(e)||u0(e))return n({node:e,property:"key",type:xe.property}),_r(e)&&(e.libicon||e.value==="none")?(n({node:e,property:e.libicon?"libicon":"value",type:xe.enum,modifier:[Ge.defaultLibrary]}),"prune"):("value"in e&&e.value&&n({node:e,property:"value",type:xe.string}),"prune");if(Is(e)||Yh(e)||vu(e)||
tl(e)||hh(e)||QB(e))return n({node:e,property:"key",type:xe.property}),"value"in e&&n({node:e,property:"value",type:xe.enum}),"prune"}highlightNameAndKind(e,n){if(n({node:e,property:"name",type:xe.variable,modifier:[Ge.declaration,Ge.readonly]}),n({node:e,property:"kind",type:xe.keyword,modifier:[]}),wn(e)){e.props.length>0&&n({node:e,property:"props",type:xe.string});return}e.title&&n({node:e,property:"title",type:xe.string})}highlightView(e,n){e.name&&n({node:e,property:"name",type:xe.variable,
modifier:[Ge.declaration,Ge.readonly,"local"]})}}class Fv{toDispose=[];isDisposed=!1;onDispose(...e){this.toDispose.push(...e)}dispose(){this.throwIfDisposed(),this.isDisposed=!0;let e;for(;e=this.toDispose.pop();)try{e.dispose()}catch(n){uv(n)}}throwIfDisposed(){if(this.isDisposed)throw new Error("This has already been disposed")}}function Zl(...t){var e=t.length>1?t.join(":::"):t[0];return lC(e)}class r_ extends Fv{constructor(e){super(),this.services=e,this.langiumDocuments=e.shared.workspace.
LangiumDocuments,this.documentCache=new kC(n=>this.createDocumentIndex(n)),this.onDispose(e.shared.workspace.DocumentBuilder.onDocumentPhase(ze.IndexedContent,async(n,r)=>(Qa(n)&&this.documentCache.set(n,this.createDocumentIndex(n)),await Promise.resolve())))}langiumDocuments;documentCache;cachePrefix="fqn-index";documents(){return this.langiumDocuments.all.filter(e=>Qa(e)&&e.state>=ze.IndexedContent)}get(e){return e.state<ze.IndexedContent&&ke(`Document ${e.uri.path} is not indexed`),this.documentCache.
get(e)}getFqn(e){let n=vp.readId(e);if(ce(n))return n;const r=ht(e);return Ie(Qa(r)),this.get(r),Zt(vp.readId(e),"Element fqn must be set, invalid state")}byFqn(e){return this.documents().flatMap(n=>this.get(n).byFqn(e))}directChildrenOf(e){return et(this.documents().reduce((n,r)=>(this.get(r).children(e).forEach(i=>{n.add(i.name,i)}),n),new Ot).entriesGroupedByKey().flatMap(([n,r])=>r.length===1?r:[]).toArray().sort((n,r)=>gw(n.name,r.name)))}uniqueDescedants(e){const{children:n,descendants:r}=this.
documents().reduce((a,o)=>{const c=this.get(o);return c.children(e).forEach(u=>{a.children.add(u.name,u)}),c.descendants(e).forEach(u=>{a.descendants.add(u.name,u)}),a},{children:new Ot,descendants:new Ot}),i=n.entriesGroupedByKey().flatMap(([a,o])=>o.length===1?o:[]).toArray().sort((a,o)=>gw(a.name,o.name)),s=r.entriesGroupedByKey().flatMap(([a,o])=>o.length===1&&!n.has(a)?o:[]).toArray();return et([...i,...TC(s)])}createDocumentIndex(e){const n=e.parseResult.value.models.flatMap(l=>l.elements);
if(n.length===0)return to.EMPTY;const r=new Array,i=new Ot,s=new Ot,a=new Ot,o=this.services.workspace.AstNodeDescriptionProvider,c=(l,f,d)=>{const h={...o.createDescription(l,f,e),id:d};return vp.writeId(l,d),a.add(d,h),h},u=(l,f)=>{let d;if(wn(l)){d=bC(l.name,f);const m=c(l,l.name,d);f?i.add(f,m):r.push(m)}else d=Hs(l.element);let h=[];if(Yt(l.body)&&!Pt(l.body.elements)){for(const m of l.body.elements)if(!oi(m))try{h.push(...u(m,d))}catch(b){ke(b)}}return h=[...i.get(d),...h],s.addAll(d,h),Pa(
l)&&EC(d).forEach(m=>{s.addAll(m,h)}),s.get(d)};for(const l of n)try{if(oi(l))continue;u(l,null)}catch(f){ke(f)}return new to(r,i,s,a)}}class to{constructor(e,n,r,i){this._rootElements=e,this._children=n,this._descendants=r,this._byfqn=i}static EMPTY=new to([],new Ot,new Ot,new Ot);rootElements(){return this._rootElements}byFqn(e){return this._byfqn.get(e)}children(e){return this._children.get(e)}descendants(e){return this._descendants.get(e)}}class dV extends r_{constructor(e){super(e),this.services=
e,this.Names=e.references.NameProvider}Names;cachePrefix="deployments-index";createDocumentIndex(e){const n=e.parseResult.value.deployments.flatMap(f=>f.elements);if(n.length===0)return to.EMPTY;const r=new Array,i=new Ot,s=new Ot,a=new Ot,o=this.Names,c=this.services.workspace.AstNodeDescriptionProvider,u=(f,d,h)=>{const m={...c.createDescription(f,d,e),id:h};return vp.writeId(f,h),a.add(h,m),m},l=(f,d)=>{let h;if(Ls(f))h=Hs(f.deploymentNode);else{const b=o.getName(f);if(!ce(b))return[];h=dC(b,
d);const $=u(f,b,h);if(d?i.add(d,$):r.push($),Cn(f))return[]}let m=[];if(Yt(f.body)){for(const b of f.body.elements)if(!Di(b))try{m.push(...l(b,h))}catch($){ke($)}}return m=[...i.get(h),...m],s.addAll(h,m),Ls(f)&&fC(h).forEach(b=>{s.addAll(b,m)}),s.get(h)};for(const f of n)try{if(Di(f))continue;l(f,null)}catch(d){ke(d)}return new to(r,i,s,a)}}function fV(t){const e=new Map;for(const n of t)if(so.isElement(n)&&n.viewOf&&yt(n.extends)){const r=e.get(n.viewOf)??[];r.push(n.id),e.set(n.viewOf,r)}for(const{
id:n,nodes:r}of t)for(const i of r){const s=ad.modelRef(i);if(i.navigateTo||!s)continue;const a=YT(e.get(s)??[],o=>o!==n);a&&(i.navigateTo=a)}return t}function hV(t,e="/"){const n=Ze(t,nn(c=>c.docUri),je(ce),Ra());if(n.length===0)return"";if(n.length===1){const c=$p(n[0]).pathname.split(e);return c.length<=1?e:(c.pop(),c.join(e)+e)}Ie(ms(n,2),"Expected at least 2 unique URIs");const[r,...i]=n,s=$p(r).pathname.split(e);let a=s.length;for(const c of i){if(c===r)continue;const u=$p(c).pathname.split(
e);for(let l=0;l<a;l++)u[l]!==s[l]&&(a=l);if(a===0)return""}const o=s.slice(0,a).join(e);return o.endsWith(e)?o:o+e}function pV(t){const e="/",n=hV(t,e);return t.map(r=>{if(!r.docUri)return{view:r,parts:[]};let i=$p(r.docUri).pathname;return n.length>0?(Ie(i.startsWith(n),`Expect path "${i}" to start with common prefix: "${n}"`),i=i.slice(n.length)):i=i.includes(e)?i.slice(i.lastIndexOf(e)+1):i,{view:r,parts:i.split(e)}}).sort((r,i)=>{if(r.parts.length!==i.parts.length)return r.parts.length-i.parts.
length;for(let s=0;s<r.parts.length;s++){const a=ow(r.parts[s],i.parts[s]);if(a!==0)return a}return ow(r.view.title??r.view.id,i.view.title??i.view.id)}).map(({parts:r,view:i})=>({...i,relativePath:r.join(e)}))}class i_{mergedData=new Map;merge(e){for(const n of e){const{id:r,links:i,tags:s,metadata:a}=n,o=this.mergedData.get(r)??{links:[],tags:[],metadata:{}};i&&o.links.push(...i),s&&(o.tags=Ra([...o.tags,...s])),a&&(o.metadata={...o.metadata,...a}),this.mergedData.set(r,o)}}apply(e){const n=this.
mergedData.get(e.id);if(!n)return e;let r=n.links;e.links&&e.links.length>0&&(r=[...e.links,...r]);let i=n.tags;e.tags&&e.tags.length>0&&(i=Ra([...e.tags,...i]));let s=n.metadata;return e.metadata&&(s={...e.metadata,...n.metadata}),{...e,tags:ms(i,1)?i:null,links:ms(r,1)?r:null,...!Pt(s)&&{metadata:s}}}}class mV{specs={tags:new Set,elements:{},deployments:{},relationships:{},colors:{}};globals={predicates:{},dynamicPredicates:{},styles:{}};constructor(e){for(const n of e){const{c4Specification:r,
c4Globals:i}=n;r.tags.forEach(s=>this.specs.tags.add(s)),Object.assign(this.specs.elements,r.elements),Object.assign(this.specs.relationships,r.relationships),Object.assign(this.specs.colors,r.colors),Object.assign(this.specs.deployments,r.deployments),Object.assign(this.globals.predicates,i.predicates),Object.assign(this.globals.dynamicPredicates,i.dynamicPredicates),Object.assign(this.globals.styles,i.styles)}}toModelElement=({tags:e,links:n,style:{color:r,shape:i,icon:s,opacity:a,border:o,size:c,
multiple:u,padding:l,textSize:f},id:d,kind:h,title:m,description:b,technology:$,metadata:w})=>{try{const k=this.specs.elements[h];return k?(r??=k.style.color,i??=k.style.shape,s??=k.style.icon,a??=k.style.opacity,o??=k.style.border,$??=k.technology,u??=k.style.multiple,c??=k.style.size,l??=k.style.padding,f??=k.style.textSize,{...r&&{color:r},...i&&{shape:i},...s&&{icon:s},...w&&!Pt(w)&&{metadata:w},...k.notation&&{notation:k.notation},style:{...o&&{border:o},...c&&{size:c},...l&&{padding:l},...f&&
{textSize:f},...ey(u)&&{multiple:u},...qf(a)&&{opacity:a}},links:n??null,tags:e??null,technology:$??null,description:b??null,title:m,kind:h,id:d}):(nt.warn`No kind '${h}' found for ${d}`,null)}catch(k){ke(k)}return null};toModelRelation=({astPath:e,source:n,target:r,kind:i,links:s,id:a,...o})=>rn(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:n,target:r,kind:i,id:a}:{...s&&{links:s},...o,source:n,target:r,id:a};toDeploymentElement=e=>{if(!cw.isDeploymentNode(
e))return e;try{const n=this.specs.deployments[e.kind];if(!n)return nt.warn`No kind ${e.kind} found for ${e.id}`,null;let{technology:r=n.technology,notation:i=n.notation,style:s}=e;return{...e,...i&&{notation:i},...r&&{technology:r},style:{border:"dashed",opacity:10,...n.style,...s}}}catch(n){ke(n)}return null};toDeploymentRelation=({astPath:e,source:n,target:r,kind:i,links:s,id:a,...o})=>rn(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:n,target:r,kind:i,
id:a}:{...s&&{links:s},...o,source:n,target:r,id:a}}function gV(t){const e=new mV(t),n=Rc(e.specs.colors,d=>hC(d.color)),r=new i_,i=new i_,s=Ze(t,_i(d=>(r.merge(d.c4ExtendElements),nn(d.c4Elements,e.toModelElement))),je(ce),uw,Qg((d,h)=>{const m=lw(h.id);return m&&yt(d[m])?(nt.debug`No parent found for ${h.id}`,d):(d[h.id]=r.apply(h),d)},{})),a=Ze(t,_i(d=>nn(d.c4Relations,e.toModelRelation)),je(d=>d?yt(s[d.source])||yt(s[d.target])?(nt.debug`Invalid relation ${d.id}
  source: ${d.source} resolved: ${!!s[d.source]}
  target: ${d.target} resolved: ${!!s[d.target]}\n`,!1):!0:!1),ty(Zg("id"))),o=Ze(t,_i(d=>(i.merge(d.c4ExtendDeployments),nn(d.c4Deployments,e.toDeploymentElement))),je(ce),uw,Qg((d,h)=>{const m=lw(h.id);return m&&yt(d[m])?(nt.debug`No parent found for deployment element ${h.id}`,d):(d[h.id]=cw.isDeploymentNode(h)?i.apply(h):h,d)},{})),c=Ze(t,_i(d=>nn(d.c4DeploymentRelations,e.toDeploymentRelation)),je(d=>d?yt(o[d.source.id])||yt(o[d.target.id])?(nt.debug`Invalid deployment relation ${d.id}
  source: ${d.source.id} resolved: ${!!o[d.source.id]}
  target: ${d.target.id} resolved: ${!!o[d.target.id]}\n`,!1):!0:!1),Qg((d,h)=>Yt(d[h.id])?(nt.debug`Duplicate deployment relation ${h.id}`,d):(d[h.id]=h,d),{}));function u(d){const h=d.uri.toString();return m=>{let{id:b,title:$,description:w,astPath:k,...S}=m;return m.__==="element"&&yt($)&&"viewOf"in m&&($=s[m.viewOf]?.title??null),yt($)&&b==="index"&&($="Landscape view"),{...S,customColorDefinitions:n,docUri:h,description:w,title:$,id:b}}}const l=Ze(t,_i(d=>nn(d.c4Views,u(d))),pV);l.some(d=>d.
id==="index")||l.unshift({__:"element",id:"index",title:"Landscape view",description:null,tags:null,links:null,customColorDefinitions:n,rules:[{include:[{wildcard:!0}]}]});const f=Ze(l,ty(Zg("id")),RC);return{specification:{tags:Array.from(e.specs.tags),elements:e.specs.elements,relationships:e.specs.relationships,deployments:e.specs.deployments},elements:s,relations:a,globals:e.globals,views:f,deployments:{elements:o,relations:c}}}const s_="ParsedLikeC4Model",a_="ComputedLikeC4Model",eo=nt.getChild(
"model-builder");class yV extends Fv{parser;listeners=[];cache;DocumentBuilder;constructor(e){super(),this.parser=e.likec4.ModelParser,this.cache=e.ValidatedWorkspaceCache,this.DocumentBuilder=e.shared.workspace.DocumentBuilder,this.onDispose(this.DocumentBuilder.onUpdate((n,r)=>{r.length>0&&this.notifyListeners(r)})),this.onDispose(this.DocumentBuilder.onBuildPhase(ze.Validated,(n,r)=>{eo.debug("onValidated ({docslength} docs)",{docslength:n.length}),this.notifyListeners(n.map(i=>i.uri))})),eo.
debug`created`}unsafeSyncParseModel(){const e=this.documents();return e.length===0?(eo.debug("no documents to build model from"),null):this.cache.get(s_,()=>{eo.debug("unsafeSyncParseModel ({docslength} docs)",{docslength:e.length});const n=gV(e),r=ao.makeCompute(n);return{model:n,computeView:r}})}async parseModel(e){const n=this.cache.get(s_);return n?await Promise.resolve(n):(await this.DocumentBuilder.waitUntil(ze.Validated,e),this.unsafeSyncParseModel())}previousViews={};unsafeSyncBuildModel(){
const e=this.unsafeSyncParseModel();if(!e)return ao.EMPTY;const n=this.cache,r=this.cache;return n.get(a_,()=>{const{model:{views:i,...s},computeView:a}=e,o=[];for(const u of Ff(i)){const l=a(u);if(!l.isSuccess){eo.warn(Ji(l.error));continue}o.push(l.view)}fV(o);const c=Sr(o,u=>{const l=this.previousViews[u.id],f=l&&lv(u,l)?l:u;return r.set(o_(u.id),f),[u.id,f]});return this.previousViews={...c},ao.create({...s,views:c})})}async buildLikeC4Model(e){const n=this.cache.get(a_);return n?await Promise.
resolve(n):await this.parseModel(e)?this.unsafeSyncBuildModel():ao.EMPTY}async computeView(e,n){const r=this.cache,i=o_(e);if(r.has(i))return r.get(i);const s=await this.parseModel(n);return s?r.get(i,()=>{const a=s.model.views[e];if(!a)return eo.warn(`[ModelBuilder] Cannot find view ${e}`),null;const o=s.computeView(a);if(!o.isSuccess)return ke(o.error),null;let c=o.view;const u=Ze(s.model.views,Ff(),je(pC),je(f=>f.id!==e),Tc(f=>f.viewOf));for(const f of c.nodes)if(!f.navigateTo){const d=u[f.id];
d&&(f.navigateTo=d[0].id)}const l=this.previousViews[e];return l&&lv(c,l)?c=l:this.previousViews[e]=c,c}):null}onModelParsed(e){return this.listeners.push(e),ps.create(()=>{const n=this.listeners.indexOf(e);n>=0&&this.listeners.splice(n,1)})}documents(){return this.parser.documents().toArray()}notifyListeners(e){for(const n of this.listeners)try{n(e)}catch(r){ke(r)}}}function o_(t){return`computed-view-${t}`}const{findNodeForKeyword:vV,findNodeForProperty:Rp}=Sm,{getDocument:wV}=Wo;class bV{constructor(e){
this.services=e,this.fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex,this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.parser=e.likec4.ModelParser}fqnIndex;deploymentsIndex;langiumDocuments;parser;documents(){return this.parser.documents().toArray()}getParsedElement(e){if(KT(e)){const r=e,i=this.fqnIndex.byFqn(e).head();if(!i)return null;const s=this.langiumDocuments.getDocument(i.documentUri);return s?this.parser.parse(s).c4Elements.find(a=>a.id===r)??null:
null}const n=this.fqnIndex.getFqn(e);return this.parser.parse(wV(e)).c4Elements.find(r=>r.id===n)??null}locateElement(e,n){const r=this.fqnIndex.byFqn(e).head(),i=r?.nameSegment??r?.selectionSegment;return!r||!i?null:{uri:r.documentUri.toString(),range:i.range}}locateDeploymentElement(e,n){const r=this.deploymentsIndex.byFqn(e).head(),i=r?.nameSegment??r?.selectionSegment;return!r||!i?null:{uri:r.documentUri.toString(),range:i.range}}locateRelation(e){for(const n of this.documents()){const r=n.c4Relations.
find(a=>a.id===e)??n.c4DeploymentRelations.find(a=>a.id===e);if(!r)continue;const i=this.services.workspace.AstNodeLocator.getAstNode(n.parseResult.value,r.astPath);if(!oi(i)&&!Di(i))continue;let s=i.title?Rp(i.$cstNode,"title"):void 0;if(s??=i.kind?Rp(i.$cstNode,"kind"):void 0,s??=Rp(i.$cstNode,"target"),s??=i.$cstNode,!!s)return{uri:n.uri.toString(),range:s.range}}return null}locateViewAst(e){for(const n of this.documents()){const r=n.c4Views.find(s=>s.id===e);if(!r)continue;const i=this.services.
workspace.AstNodeLocator.getAstNode(n.parseResult.value,r.astPath);if(_y(i))return{doc:n,view:r,viewAst:i}}return null}locateView(e){const n=this.locateViewAst(e);if(!n)return null;const r=n.viewAst;let i=r.name?Rp(r.$cstNode,"name"):void 0;return i??=vV(r.$cstNode,"view"),i??=r.$cstNode,i?{uri:n.doc.uri.toString(),range:i.range}:null}}var qv,c_;function $V(){return c_||(c_=1,qv=t=>{const e=t.match(/^[ \t]*(?=\S)/gm);return e?e.reduce((n,r)=>Math.min(n,r.length),1/0):0}),qv}var RV=$V();const kV=Dr(
RV);function u_(t){const e=kV(t);if(e===0)return t;const n=new RegExp(`^[ \\t]{${e}}`,"gm");return t.replace(n,"")}const Ks=["this","it","self","super","likec4lib","global"];function ct(t){return async function(e,n,r){try{const i=t(e,n,r);hj(i)&&await i;return}catch(i){const s=i instanceof Error?i.message:String(i);n("error",`Validation failed: ${s}`,{node:e}),ke(i)}}}const{getDocument:TV}=Wo,EV=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return ct((r,i)=>{const s=n.getName(
r);if(!s){i("error","DeploymentNode must be named",{node:r});return}const a=Zt(n.getNameNode(r),"name CstNode not found").range;Ks.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=e.getFqn(r);e.byFqn(o).limit(2).toArray().length>1&&i("error",`Duplicate node name "${o}"`,{node:r,range:a})})},SV=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return ct((r,i)=>{const s=n.getName(r);if(!s){i("error","Deployed instance must be named, unique inside node",{node:r});
return}const a=Zt(n.getNameNode(r),"name CstNode not found").range;Ks.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=e.getFqn(r);e.byFqn(o).limit(2).toArray().length>1&&i("error",`Duplicate instance name "${o}"`,{node:r,range:a})})},AV=t=>{const e=t.likec4.ModelParser;return ct((n,r)=>{if(!n.source?.value?.ref){let c=n.source?.$cstNode?.text??"";r("error",`DeploymentRelation source '${c}' not resolved`,{node:n,property:"source"});return}if(!n.target?.value?.ref){let c=n.target?.
$cstNode?.text??"";r("error",`DeploymentRelation target '${c}' not resolved`,{node:n,property:"target"});return}const i=TV(n),s=e.forDocument(i),a=s.parseFqnRef(n.source);if(oo.isModelRef(a)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"source"});return}const o=s.parseFqnRef(n.target);if(oo.isModelRef(o)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"target"});return}dw(a.deployment,o.deployment)&&r("error","Invalid parent-child \
relationship",{node:n})})},_V=t=>ct((e,n)=>{const r=e.deploymentNode.value.ref;(!r||!Pn(r))&&n("error","ExtendDeployment allows only DeploymentNode",{node:e,property:"deploymentNode"})}),CV=t=>ct((e,n)=>{const r=ZA(e.value);switch(!0){case _h(r):case Ph(r):case qs(r):{n("warning","Predicate is ignored, as not supported in dynamic views",{node:e});return}}}),PV=t=>{const e=t.likec4.FqnIndex;return ct((n,r)=>{const i=bn(n.source),s=i&&e.getFqn(i);s||r("error","Source not found (not parsed/indexed \
yet)",{node:n,property:"source"});const a=bn(n.target),o=a&&e.getFqn(a);o||r("error","Target not found (not parsed/indexed yet)",{node:n,property:"target"}),s&&o&&(_p(s,o)||_p(o,s))&&r("error","Invalid parent-child relationship",{node:n})})},{getDocument:xV}=Wo,DV=t=>{const e=t.likec4.FqnIndex,n=t.workspace.AstNodeLocator;return ct((r,i)=>{const s=e.getFqn(r);if(!s){i("error","Not indexed element",{node:r,property:"name"});return}Ks.includes(r.name)&&i("error",`Reserved word: ${r.name}`,{node:r,
property:"name"});const a=xV(r).uri,o=n.getAstNodePath(r),c=e.byFqn(s).filter(u=>u.documentUri!==a||u.path!==o).head();if(c){const u=c.documentUri!==a;i("error",`Duplicate element name ${r.name!==s?r.name+" ("+s+")":r.name}`,{node:r,property:"name",...u&&{relatedInformation:[{location:{range:c.nameSegment?.range??c.selectionSegment?.range,uri:c.documentUri.toString()},message:"conflicting element"}]}})}})},NV=t=>ct((e,n)=>{const r=parseFloat(e.value);(isNaN(r)||r<0||r>100)&&n("warning","Value ig\
nored, must be between 0% and 100%",{node:e,property:"value"})}),IV=t=>(e,n)=>{const r=e.$container;r.props.some(i=>_r(i)&&i!==e)&&n("error","Icon must be defined once",{node:e}),Ni(r)&&_u(r.$container)&&r.$container.props.some(i=>_r(i))&&n("warning","Redundant as icon defined on element",{node:e})},OV=t=>(e,n)=>{wi(e,Fy)||n("error","Notes can be defined only inside dynamic view",{node:e})},LV=t=>{const e=t.likec4.FqnIndex;return ct((n,r)=>{const i=bn(n.target),s=i&&e.getFqn(i);s||r("error","Tar\
get not resolved",{node:n,property:"target"});let a;if(Yt(n.source)){if(a=bn(n.source),!a)return r("error","Source not resolved",{node:n,property:"source"})}else{if(!_u(n.$container))return r("error","Sourceless relation must be nested",{node:n});a=n.$container.$container}const o=e.getFqn(a);o||r("error","Source not resolved",{node:n}),o&&s&&dw(o,s)&&r("error","Invalid parent-child relationship",{node:n})})},MV=t=>ct((e,n)=>{e.$container.tags?.values&&e.tags?.values&&n("error","Relation cannot h\
ave tags in both header and body",{node:e.tags})}),zV=t=>ct((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one specification per document",{node:e,property:"name"})}),FV=t=>ct((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one model per document",{node:e,property:"name"})}),qV=t=>ct((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one global block per document",{node:e,property:"name"})}),GV=t=>{const e=t.shared.workspace.IndexManager;
return ct((n,r)=>{Ks.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=e.allElements(ai).filter(s=>s.name===n.name&&s.node!==n).head();if(i){const s=i.documentUri!==ht(n).uri;r("error",`Duplicate element kind '${n.name}'`,{node:n,property:"name",...s&&{relatedInformation:[{location:{range:i.nameSegment.range,uri:i.documentUri.toString()},message:"conflicting definition"}]}})}})},jV=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{Ks.includes(n.
name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=e.allElements(si).filter(s=>s.name===n.name&&s.node!==n).head();if(i){const s=i.documentUri!==ht(n).uri;r("error",`Duplicate deploymentNode kind '${n.name}'`,{node:n,property:"name",...s&&{relatedInformation:[{location:{range:i.nameSegment.range,uri:i.documentUri.toString()},message:"conflicting definition"}]}})}})},BV=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{const i="#"+n.name,s=e.allElements(Oi).
filter(a=>a.name===i&&a.node!==n).head();if(s){const a=s.documentUri!==ht(n).uri;r("error",`Duplicate tag '${n.name}'`,{node:n,property:"name",...a&&{relatedInformation:[{location:{range:s.nameSegment.range,uri:s.documentUri.toString()},message:"conflicting definition"}]}})}})},UV=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{Ks.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"}),e.allElements(Ii).filter(i=>i.name===n.name).limit(2).count()>1&&r("erro\
r",`Duplicate RelationshipKind '${n.name}'`,{node:n,property:"name"})})},l_=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{const i=e.allElements(Da),s=e.allElements(xa);i.concat(s).filter(a=>a.name===n.name).limit(2).count()>1&&r("error",`Duplicate GlobalPredicateGroup or GlobalDynamicPredicateGroup name '${n.name}'`,{node:n,property:"name"})})},WV=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{e.allElements(Ku).filter(i=>i.name===n.name).limit(2).count()>1&&r("erro\
r",`Duplicate GlobalStyleId name '${n.name}'`,{node:n,property:"name"})})},HV=t=>{const e=t.shared.workspace.IndexManager;return ct((n,r)=>{n.name&&(Ks.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"}),e.allElements(Ns).filter(i=>i.name===n.name).limit(2).count()>1&&r("error",`Duplicate view '${n.name}'`,{node:n,property:"name"}))})},KV=t=>ct((e,n)=>{const r=dn(e,uh);Gu(r)&&n("error",'Invalid usage inside "exclude"',{node:e});const i=Gy(e.subject)?e.subject.subject:
e.subject;switch(!0){case Ou(i):case qy(i):case w0(i):case qs(i):return;case _h(i):case Ph(i):n("error","Invalid target (expect reference to specific element)",{node:e,property:"subject"});return;default:Me(i)}}),VV=t=>ct((e,n)=>{wi(e,Py)&&n("warning","Redundant usage, expand predicate resolves parent element only when used in relations",{node:e})}),XV=t=>{const e=t.likec4.ModelParser;return ct((n,r)=>{if(n.$container.$type!=="DeploymentViewRulePredicateExpression")return;const i=dn(n,Aa);if(!i||
i.isInclude!==!0)return;const s=ht(n),a=e.forDocument(s),o="Model reference is allowed in exclude predicate only";if(Oy(n)){co.isModelRef(a.parseFqnExpr(n.source.from))&&r("error",o,{node:n.source,property:"from"}),co.isModelRef(a.parseFqnExpr(n.target))&&r("error",o,{node:n,property:"target"});return}let c;if(Wy(n)?c=n.to:Vy(n)?c=n.from:c=n.inout.to,co.isModelRef(a.parseFqnExpr(c))){r("error",o,{node:n});return}})},YV=t=>{const e=t.likec4.ModelParser;return ct((n,r)=>{const i=n.ref.value.ref;if(yt(
i)){r("error","Invalid empty reference",{node:n});return}const s=ht(n),a=e.forDocument(s).parseFqnRefExpr(n);if(n.$container.$type==="DeploymentViewRulePredicateExpression"){if(co.isModelRef(a)){r("error","Deployment view predicate must reference deployment model",{node:n});return}if(co.isDeploymentRef(a)&&oo.isInsideInstanceRef(a.ref)){r("error","Must reference deployment nodes or instances, but not internals",{node:n});return}}!Pn(i)&&rn(n.selector)&&r("warning",`Selector '${n.selector}' appli\
es to deployment nodes only, ignored here`,{node:n,property:"selector"})})},JV=t=>ct((e,n)=>{if(qs(e.to)&&!Hy(e.$container)){const r=dn(e,xh);yt(r?.viewOf)&&n("warning","Predicate is ignored as it concerns all relationships",{node:e})}}),QV=t=>ct((e,n)=>{if(qs(e.from)&&!Ly(e.$container)){const r=dn(e,xh);yt(r?.viewOf)&&n("warning","Predicate is ignored as it concerns all relationships",{node:e})}}),ZV=t=>ct((e,n)=>{const r=dn(e,uh);Gu(r)&&n("error",'Invalid usage inside "exclude"',{node:e})});function e4(t){
return e=>t.some(n=>n(e))}const t4=e4([Uy,Hu,Wu,Ia,zs,g0,Ch,Qy,Ty,Py,My,Fy,GB,Aa,HB,o0,By,ZB,Dy,VB,nv,eU,Yf,_y,Ny,Cn,Pn,Di,c0,Pi,oi,WB,u0,Uh,wn,Pa,Ls,ja,Ua,qa,Zh,Qh,tv]),n4=t=>{let e=t;for(;e&&!bU(e);){if(t4(e))return e;e=e.$container}};function r4(t){const e=t.state>=ze.Validated?t.diagnostics?.filter(r=>r.severity===gc.Error)??[]:[],n=new WeakSet;for(const{node:r}of e){if(yt(r)||n.has(r))continue;n.add(r);const i=n4(r);i&&n.add(i)}return{isValid:r=>!n.has(r),invalidNodes:n}}function i4(t){nt.debug(
"registerValidationChecks"),t.validation.ValidationRegistry.register({DeployedInstance:SV(t),DeploymentNodeKind:jV(t),DeploymentNode:EV(t),DeploymentRelation:AV(t),ExtendDeployment:_V(),FqnRefExpr:YV(t),RelationExpr:XV(t),NotesProperty:OV(),OpacityProperty:NV(),IconProperty:IV(),SpecificationRule:zV(),Model:FV(),Globals:qV(),GlobalPredicateGroup:l_(t),GlobalDynamicPredicateGroup:l_(t),GlobalStyleId:WV(t),DynamicViewStep:PV(t),LikeC4View:HV(t),Element:DV(t),ElementKind:GV(t),Relation:LV(t),RelationBody:MV(),
Tag:BV(t),DynamicViewPredicateIterator:CV(),ElementPredicateWith:KV(),RelationPredicateWith:ZV(),ExpandElementExpression:VV(),RelationshipKind:UV(t),IncomingRelationExpression:JV(),OutgoingRelationExpression:QV()});const e=t.shared.lsp.Connection;e&&t.shared.workspace.DocumentBuilder.onUpdate((n,r)=>{for(const i of r)nt.debug(`clear diagnostics for deleted ${i.path}`),e.sendDiagnostics({uri:i.toString(),diagnostics:[]})})}function Pr(t){return rn(t)?ut(t).split(`
`).join(" "):void 0}function ut(t){return rn(t)?u_(t).trim():void 0}class s4{constructor(e,n){this.services=e,this.doc=n,this.isValid=r4(n).isValid}isValid;resolveFqn(e){return Pa(e)?Hs(e.element):Ls(e)?Hs(e.deploymentNode):a0(e)?this.services.likec4.DeploymentsIndex.getFqn(e):this.services.likec4.FqnIndex.getFqn(e)}getAstNodePath(e){return this.services.workspace.AstNodeLocator.getAstNodePath(e)}getMetadata(e){if(!e||!this.isValid(e)||Pt(e.props))return;const n=Ze(e.props,nn(r=>[r.key,ut(r.value)]),
je(([r,i])=>ce(i)),Aj());return Pt(n)?void 0:n}convertTags(e){return this.parseTags(e)}parseTags(e){let n=e?.tags;if(!n)return null;let r=[];for(;n;){try{if(this.isValid(n)){const i=n.values.map(s=>s.ref?.name).filter(ce);i.length>0&&r.push(...i)}}catch{}n=n.prev}return r=Ra(r.reverse()),Dn(r)?r:null}convertLinks(e){return this.parseLinks(e)}parseLinks(e){if(!(!e?.props||e.props.length===0))return Ze(e.props,je(jh),_i(n=>{if(!this.isValid(n))return[];const r=n.value;if(ce(r)){const i=ce(n.title)?
Pr(n.title):void 0,s=this.services.lsp.DocumentLinkProvider.relativeLink(this.doc,r);return{url:r,...i&&{title:i},...s&&s!==r&&{relative:s}}}return[]}))}}function*a4(t){const e=fw.from(t.parseResult.value.deployments.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(Di(r)){n.push(r);continue}if(Cn(r)){yield r;continue}if(r.body&&r.body.elements.length>0)for(const i of r.body.elements)e.push(i);yield r}yield*n}function o4(t){return class extends t{parseDeployment(){const e=this.doc;for(const n of a4(
e))try{switch(!0){case Di(n):{this.isValid(n)&&e.c4DeploymentRelations.push(this.parseDeploymentRelation(n));break}case Cn(n):e.c4Deployments.push(this.parseDeployedInstance(n));break;case Pn(n):{e.c4Deployments.push(this.parseDeploymentNode(n));break}case Ls(n):{const r=this.parseExtendDeployment(n);r&&e.c4ExtendDeployments.push(r);break}default:Me(n)}}catch(r){ke(r)}}parseDeploymentNode(e){const n=this.isValid,r=this.resolveFqn(e),i=Zt(e.kind.ref,"DeploymentKind not resolved").name,s=this.convertTags(
e.body),a=e.body?.props.find(Ni)?.props,o=qi(a,n),c=this.getMetadata(e.body?.props.find(Pi)),u=Ze(e.body?.props??[],je(n),je(Mu),Sr(b=>[b.key,b.value||void 0])),l=ut(e.title??u.title),f=ut(u.description),d=Pr(u.technology),h=this.convertLinks(e.body),m=e.body?.props.find(_r);if(m&&n(m)){const b=m.libicon?.ref?.name??m.value;ce(b)&&(o.icon=b)}return{id:r,kind:i,title:l??Ap(r),...c&&{metadata:c},...s&&{tags:s},...h&&Dn(h)&&{links:h},...ce(d)&&{technology:d},...ce(f)&&{description:f},style:o}}parseDeployedInstance(e){
const n=this.isValid,r=this.resolveFqn(e),i=this.resolveFqn(Zt(bn(e.element),"DeployedInstance element not found")),s=this.convertTags(e.body),a=e.body?.props.find(Ni)?.props,o=qi(a,n),c=this.getMetadata(e.body?.props.find(Pi)),u=Ze(e.body?.props??[],je(n),je(Mu),Sr(b=>[b.key,b.value||void 0])),l=ut(e.title??u.title),f=ut(u.description),d=Pr(u.technology),h=this.convertLinks(e.body),m=e.body?.props.find(_r);if(m&&n(m)){const b=m.libicon?.ref?.name??m.value;ce(b)&&(o.icon=b)}return{id:r,element:i,
...c&&{metadata:c},...l&&{title:l},...s&&{tags:s},...h&&Dn(h)&&{links:h},...ce(d)&&{technology:d},...ce(f)&&{description:f},style:o}}parseExtendDeployment(e){if(!this.isValid(e))return null;const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Pi)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&Pt(i??{})&&Pt(a)?null:{id:n,astPath:s,...i&&{metadata:i},...r&&{tags:r},...a&&Dn(a)&&{links:a}}}parseDeploymentRelation(e){const n=this.isValid,r=this.
getAstNodePath(e),i=oo.toDeploymentRef(this.parseFqnRef(e.source)),s=oo.toDeploymentRef(this.parseFqnRef(e.target)),a=this.convertTags(e)??this.convertTags(e.body),o=this.convertLinks(e.body),c=e.kind?.ref?.name,u=this.getMetadata(e.body?.props.find(Pi)),l=Sr(e.body?.props.filter(wl)??[],$=>[$.key,$.value]),f=Ze(e.body?.props??[],je(pl),nn($=>$.value.view.ref?.name),je(ce),ka()),d=ut(e.title??l.title),h=ut(l.description),m=Pr(e.technology)??ut(l.technology),b=e.body?.props.find(Xh);return{id:Zl(
"deployment",r,i.id,s.id),source:i,target:s,...d&&{title:d},...u&&{metadata:u},...ce(m)&&{technology:m},...ce(h)&&{description:h},...c&&{kind:c},...a&&{tags:a},...Dn(o)&&{links:o},...Iv(b?.props,n),...f&&{navigateTo:f},astPath:r}}}}function c4(t){const e=t.length;let n=0,r=0;for(;r<e;){let i=t.charCodeAt(r++);if(i&4294967168)if(!(i&4294965248))n+=2;else{if(i>=55296&&i<=56319&&r<e){const s=t.charCodeAt(r);(s&64512)===56320&&(++r,i=((i&1023)<<10)+(s&1023)+65536)}i&4294901760?n+=4:n+=3}else{n++;continue}}
return n}function u4(t,e,n){const r=t.length;let i=n,s=0;for(;s<r;){let a=t.charCodeAt(s++);if(a&4294967168)if(!(a&4294965248))e[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&s<r){const o=t.charCodeAt(s);(o&64512)===56320&&(++s,a=((a&1023)<<10)+(o&1023)+65536)}a&4294901760?(e[i++]=a>>18&7|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128):(e[i++]=a>>12&15|224,e[i++]=a>>6&63|128)}else{e[i++]=a;continue}e[i++]=a&63|128}}const l4=new TextEncoder,d4=50;function f4(t,e,n){l4.encodeInto(t,e.subarray(n))}function h4(t,e,n){
t.length>d4?f4(t,e,n):u4(t,e,n)}const p4=4096;function d_(t,e,n){let r=e;const i=r+n,s=[];let a="";for(;r<i;){const o=t[r++];if(!(o&128))s.push(o);else if((o&224)===192){const c=t[r++]&63;s.push((o&31)<<6|c)}else if((o&240)===224){const c=t[r++]&63,u=t[r++]&63;s.push((o&31)<<12|c<<6|u)}else if((o&248)===240){const c=t[r++]&63,u=t[r++]&63,l=t[r++]&63;let f=(o&7)<<18|c<<12|u<<6|l;f>65535&&(f-=65536,s.push(f>>>10&1023|55296),f=56320|f&1023),s.push(f)}else s.push(o);s.length>=p4&&(a+=String.fromCharCode(
...s),s.length=0)}return s.length>0&&(a+=String.fromCharCode(...s)),a}const m4=new TextDecoder,g4=200;function y4(t,e,n){const r=t.subarray(e,e+n);return m4.decode(r)}function v4(t,e,n){return n>g4?y4(t,e,n):d_(t,e,n)}class kp{constructor(e,n){this.type=e,this.data=n}}class Gn extends Error{constructor(e){super(e);const n=Object.create(Gn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Gn.name})}}const ed=4294967295;function w4(t,e,n){
const r=n/4294967296,i=n;t.setUint32(e,r),t.setUint32(e+4,i)}function f_(t,e,n){const r=Math.floor(n/4294967296),i=n;t.setUint32(e,r),t.setUint32(e+4,i)}function h_(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function b4(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const $4=-1,R4=4294967296-1,k4=17179869184-1;function T4({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=k4)if(e===0&&t<=R4){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{
const n=t/4294967296,r=t&4294967295,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,e<<2|n&3),s.setUint32(4,r),i}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),f_(r,4,t),n}}function E4(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,i=Math.floor(r/1e9);return{sec:n+i,nsec:r-i*1e9}}function S4(t){if(t instanceof Date){const e=E4(t);return T4(e)}else return null}function A4(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.
byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),i=(n&3)*4294967296+r,s=n>>>2;return{sec:i,nsec:s}}case 12:{const n=h_(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Gn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function _4(t){const e=A4(t);return new Date(e.sec*1e3+e.nsec/1e6)}const C4={type:$4,encode:S4,decode:_4};class Tp{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=
[],this.decoders=[],this.register(C4)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const i=-1-e;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const i=this.builtInEncoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=-1-r;return new kp(a,s)}}}for(let r=0;r<this.encoders.length;r++){const i=this.encoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=r;return new kp(a,s)}}}return e instanceof
kp?e:null}decode(e,n,r){const i=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return i?i(e,n,r):new kp(n,e)}}Tp.defaultCodec=new Tp;function P4(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Gv(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):P4(t)?new Uint8Array(t):Uint8Array.from(t)}var p_=function(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError(
"Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e},m_=function(t){
return function(e){function n(a){e.error=e.hasError?new t(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,i=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&i===1)return i=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(a).then(s,function(o){return n(o),s()})}else i|=1}catch(o){n(o)}if(i===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}}(
typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r});const x4=100,D4=2048;class rw{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Tp.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??x4,this.initialBufferSize=e?.initialBufferSize??D4,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??
!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new rw({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){
this.pos=0}enteringGuard(){return this.entered=!0,{[Symbol.dispose]:()=>{this.entered=!1}}}encodeSharedRef(e){const n={stack:[],error:void 0,hasError:!1};try{if(this.entered)return this.clone().encodeSharedRef(e);const r=p_(n,this.enteringGuard(),!1);return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}catch(r){n.error=r,n.hasError=!0}finally{m_(n)}}encode(e){const n={stack:[],error:void 0,hasError:!1};try{if(this.entered)return this.clone().encode(e);const r=p_(n,this.
enteringGuard(),!1);return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}catch(r){n.error=r,n.hasError=!0}finally{m_(n)}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(
e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),i=new DataView(n);r.set(this.bytes),this.view=i,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?
(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.
writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=c4(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),h4(e,this.bytes,
this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<
4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=Gv(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const i of e)this.doEncode(i,n+1)}countWithoutUndefined(e,n){let r=0;for(const i of n)e[i]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.
sortKeys&&r.sort();const i=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error(`Too large map object: ${i}`);for(const s of r){const a=e[s];this.ignoreUndefined&&a===void 0||(this.encodeString(s),this.doEncode(a,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),i=r.length;if(i>=4294967296)throw new Error(
`Too large extension object: ${i}`);this.writeU8(201),this.writeU32(i),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);
this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.
ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),w4(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),f_(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){
this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function N4(t,e){return new rw(e).encodeSharedRef(t)}function jv(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const I4=16,O4=16;class L4{constructor(e=I4,n=O4){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){
return e>0&&e<=this.maxKeyLength}find(e,n,r){const i=this.caches[r-1];e:for(const s of i){const a=s.bytes;for(let o=0;o<r;o++)if(a[o]!==e[n+o])continue e;return s.str}return null}store(e,n){const r=this.caches[e.length-1],i={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,n,r){const i=this.find(e,n,r);if(i!=null)return this.hit++,i;this.miss++;const s=d_(e,n,r),a=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(a,s),s}}var Ep=function(t,e,n){
if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:r,
async:n})}else n&&t.stack.push({async:!0});return e},Sp=function(t){return function(e){function n(a){e.error=e.hasError?new t(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,i=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&i===1)return i=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(a).then(s,function(o){return n(o),s()})}else i|=1}catch(o){n(o)}if(i===1)return e.hasError?Promise.reject(
e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}}(typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r});const Bv="array",td="map_key",g_="map_value",M4=t=>typeof t=="string"||typeof t=="number";class z4{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();
n.type=Bv,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=td,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Rel\
eased state is not on top of the stack.");if(e.type===Bv){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===td||e.type===g_){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const nd=-1,Uv=new DataView(new ArrayBuffer(0)),F4=new Uint8Array(Uv.buffer);try{Uv.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine\
 because DataView does not throw RangeError on out-of-bounds access")}const y_=new RangeError("Insufficient data"),q4=new L4;class iw{constructor(e){this.totalPos=0,this.pos=0,this.view=Uv,this.bytes=F4,this.headByte=nd,this.stack=new z4,this.entered=!1,this.extensionCodec=e?.extensionCodec??Tp.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??ed,this.maxBinLength=e?.maxBinLength??ed,this.maxArrayLength=e?.
maxArrayLength??ed,this.maxMapLength=e?.maxMapLength??ed,this.maxExtLength=e?.maxExtLength??ed,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:q4}clone(){return new iw({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=
0,this.headByte=nd,this.stack.reset()}setBuffer(e){const n=Gv(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===nd&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=Gv(e),i=new Uint8Array(n.length+r.length);i.set(n),i.set(r,n.length),this.setBuffer(i)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-
r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}enteringGuard(){return this.entered=!0,{[Symbol.dispose]:()=>{this.entered=!1}}}decode(e){const n={stack:[],error:void 0,hasError:!1};try{if(this.entered)return this.clone().decode(e);const r=Ep(n,this.enteringGuard(),!1);this.reinitializeState(),this.setBuffer(e);const i=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return i}catch(r){n.error=r,n.hasError=!0}finally{Sp(n)}}*decodeMulti(e){const n={stack:[],
error:void 0,hasError:!1};try{if(this.entered){yield*this.clone().decodeMulti(e);return}const r=Ep(n,this.enteringGuard(),!1);for(this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}catch(r){n.error=r,n.hasError=!0}finally{Sp(n)}}async decodeAsync(e){const n={stack:[],error:void 0,hasError:!1};try{if(this.entered)return this.clone().decodeAsync(e);const r=Ep(n,this.enteringGuard(),!1);let i=!1,s;for await(const u of e){if(i)throw this.entered=!1,this.createExtraByteError(
this.totalPos);this.appendBuffer(u);try{s=this.doDecodeSync(),i=!0}catch(l){if(!(l instanceof RangeError))throw l}this.totalPos+=this.pos}if(i){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}const{headByte:a,pos:o,totalPos:c}=this;throw new RangeError(`Insufficient data in parsing ${jv(a)} at ${c} (${o} in the current buffer)`)}catch(r){n.error=r,n.hasError=!0}finally{Sp(n)}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(
e,!1)}async*decodeMultiAsync(e,n){const r={stack:[],error:void 0,hasError:!1};try{if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}const i=Ep(r,this.enteringGuard(),!1);let s=n,a=-1;for await(const o of e){if(n&&a===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o),s&&(a=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),--a!==0;);}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}}catch(i){r.error=i,r.hasError=!0}finally{
Sp(r)}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const i=e-128;if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e<160){const i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else{const i=e-160;n=this.decodeString(i,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=
this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const i=this.lookU8();n=this.decodeString(i,1)}else if(e===218){const i=this.lookU16();n=this.decodeString(i,2)}else if(e===219){const i=this.lookU32();n=this.
decodeString(i,4)}else if(e===220){const i=this.readU16();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===221){const i=this.readU32();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===222){const i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===223){const i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===196){const i=this.lookU8();n=this.
decodeBinary(i,1)}else if(e===197){const i=this.lookU16();n=this.decodeBinary(i,2)}else if(e===198){const i=this.lookU32();n=this.decodeBinary(i,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const i=this.lookU8();n=this.decodeExtension(i,1)}else if(e===200){const i=this.lookU16();n=this.decodeExtension(i,
2)}else if(e===201){const i=this.lookU32();n=this.decodeExtension(i,4)}else throw new Gn(`Unrecognized type byte: ${jv(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const i=r.top();if(i.type===Bv)if(i.array[i.position]=n,i.position++,i.position===i.size)n=i.array,r.release(i);else continue e;else if(i.type===td){if(!M4(n))throw new Gn("The type of key must be string or number but "+typeof n);if(n==="__proto__")throw new Gn("The key __proto__ is not allowed");i.key=n,i.type=g_;continue e}else if(i.
map[i.key]=n,i.readCount++,i.readCount===i.size)n=i.map,r.release(i);else{i.key=null,i.type=td;continue e}}return n}}readHeadByte(){return this.headByte===nd&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=nd}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Gn(`Unrecognized array type byte: ${jv(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Gn(`Max length e\
xceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Gn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new Gn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLen\
gth (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw y_;const r=this.pos+n;let i;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?i=this.keyDecoder.decode(this.bytes,r,e):i=v4(this.bytes,r,e),this.pos+=n+e,i}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===td:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Gn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw y_;const r=this.pos+
n,i=this.bytes.subarray(r,r+e);return this.pos+=n+e,i}decodeExtension(e,n){if(e>this.maxExtLength)throw new Gn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),i=this.decodeBinary(e,n+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.
pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=b4(this.view,this.pos);return this.pos+=8,e}readI64(){const e=h_(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.
view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function G4(t,e){return new iw(e).decode(t)}const j4=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",B4=(t,e=0,n=t.byteLength-e)=>{if(!j4(t))throw new TypeError(
`The "input" argument must be ArrayBuffer. Received type ${typeof t} (${t})`);return Cp.from(t,e,n)},v_=(t,e)=>{if(typeof t!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof t} (${t})`);return e?Cp.from(t,e):Cp.from(t)},U4=/^[A-Za-z0-9+/]*={0,2}$/,W4=t=>{if(t.length*3%4!==0)throw new TypeError("Incorrect padding on base64 string.");if(!U4.exec(t))throw new TypeError("Invalid base64 string.");const e=v_(t,"base64");return new Uint8Array(e.buffer,e.
byteOffset,e.byteLength)},H4=t=>{const e=v_(t,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT)},K4=t=>{let e;if(typeof t=="string"?e=H4(t):e=t,typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return B4(e.buffer,e.byteOffset,e.byteLength).toString("base64")},{getDocument:V4}=Wo;function X4({nodes:t,edges:e,...n}){return{...n,
nodes:Rc(t,({x:r,y:i,width:s,height:a,isCompound:o,...c})=>({...c,b:[r,i,s,a],c:o})),edges:Rc(e,({points:r,controlPoints:i,labelBBox:s,dotpos:a,...o})=>({...!!i&&{cp:i},...!!s&&{l:s},...!!a&&{dp:a},...o,p:r}))}}function Y4({nodes:t,edges:e,autoLayout:n,...r}){return{...r,autoLayout:mC(n)?{direction:n}:n,nodes:Rc(t,({b:i,c:s,...a})=>({x:i[0],y:i[1],width:i[2],height:i[3],isCompound:s,...a})),edges:Rc(e,({p:i,cp:s,l:a,dp:o,...c})=>({...!!s&&{controlPoints:s},...!!a&&{labelBBox:a},...!!o&&{dotpos:o},
...c,points:i}))}}const w_=500;function J4(t){const e=N4(X4(t)),n=K4(e),r=[];let i=0;for(;i<n.length;)r.push(" * "+n.slice(i,Math.min(i+w_,n.length))),i+=w_;return r.unshift("/**"," * @likec4-generated(v1)"),r.push(" */"),r.join(`
`)}function b_(t){return t.includes("@likec4-generated")}function Q4(t){if(!b_(t))throw new Error(`Not a likec4-generated comment: ${t}`);const e=t.trim().split(`
`).filter(r=>!r.includes("**")&&!r.includes("@likec4-")&&!r.includes("*/")).map(r=>r.replaceAll("*","").trim()).join(""),n=W4(e);return Y4(G4(n))}function Wv(t){const e=Zp(t.$cstNode,["BLOCK_COMMENT"]);if(!(!e||!b_(e.text)))try{return Q4(e.text)}catch(n){const r=V4(t);ke(n),nt.warn(`Ignoring manual layout of "${t.name??"unnamed"}" at ${r.uri.fsPath}:${1+(e.range.start.line||0)}`);return}}function Z4(t){return class extends t{parseDeploymentView(e){const n=e.body;Ie(n,"DynamicElementView body is \
not defined");const r=n.props.filter(this.isValid),i=this.getAstNodePath(e);let s=e.name;s||(s="deployment_"+Zl(this.doc.uri.toString(),i));const a=Pr(r.find(f=>f.key==="title")?.value)??null,o=ut(r.find(f=>f.key==="description")?.value)??null,c=this.convertTags(n),u=this.convertLinks(n);yp.writeId(e,s);const l=Wv(e);return{__:"deployment",id:s,astPath:i,title:a,description:o,tags:c,links:Dn(u)?u:null,rules:n.rules.flatMap(f=>{try{return this.isValid(f)?this.parseDeploymentViewRule(f):[]}catch(d){
return ke(d),[]}}),...l&&{manualLayout:l}}}parseDeploymentViewRule(e){if(Aa(e))return this.parseDeploymentViewRulePredicate(e);if(Al(e))return Ov(e);if(h0(e))return this.parseDeploymentViewRuleStyle(e);Me(e)}parseDeploymentViewRulePredicate(e){const n=[];let r=e.expr;for(;r;){try{const i=r.value;if(rn(i)&&this.isValid(i))switch(!0){case KB(i):n.unshift(this.parseFqnExpr(i));break;case gU(i):n.unshift(this.parseElementWhereExpr(i));break;case o0(i):n.unshift(this.parseRelationExpr(i));break;case TU(
i):n.unshift(this.parseRelationWhereExpr(i));break;default:Me(i)}}catch(i){ke(i)}r=r.prev}return e.isInclude?{include:n}:{exclude:n}}parseDeploymentViewRuleStyle(e){const n=e.props.filter(Dy),r=e.props.find(za),i=ut(r?.value);return{targets:this.parseFqnExpressions(e.targets),...i&&{notation:i},style:{...qi(n,this.isValid)}}}}}function e3(t){let e;for(;e=t.value?.ref;){if(Pn(e))return null;if(Cn(e))return e;if(yt(t.parent))return null;t=t.parent}return null}const $_=({operator:t,not:e},n)=>t.startsWith(
"!=")?{neq:n}:t.startsWith("=")?{eq:n}:e?{neq:n}:{eq:n};function R_(t){return!L0(t)&&!M0(t)?null:t.participant}function Vs(t){switch(!0){case iU(t):{const e=t.value?.ref?.name,n=R_(t);Ie(e,"Expected tag name");const r={tag:$_(t,e)};return n?{participant:n,operator:r}:r}case nU(t):{const e=t.value?.ref?.name,n=R_(t);Ie(e,"Expected kind name");const r={kind:$_(t,e)};return n?{participant:n,operator:r}:r}case(N0(t)||O0(t)):return{not:Vs(t.value)};case AU(t):{const e=Vs(t.left),n=Vs(t.right),r=t.operator.
toLowerCase();switch(r){case"and":{const i=[pw(e)?e.and:e,pw(n)?n.and:n].flat();return Ie(Dn(i),"Expected non-empty array"),{and:i}}case"or":{const i=[hw(e)?e.or:e,hw(n)?n.or:n].flat();return Ie(Dn(i),"Expected non-empty array"),{or:i}}default:Me(r)}}default:Me(t)}}function t3(t){return class extends t{parseFqnRef(e){const n=Zt(e.value.ref,`FqnRef is empty ${e.$cstNode?.range.start.line}:${e.$cstNode?.range.start.character}`);if(wn(n)){const r=e3(e);if(!r)return{model:this.resolveFqn(n)};const i=this.
resolveFqn(r),s=this.resolveFqn(n);return{deployment:i,element:s}}if(a0(n))return{deployment:this.resolveFqn(n)};Me(n)}parseFqnExpr(e){if(qs(e))return{wildcard:!0};if(By(e))return this.parseFqnRefExpr(e);Me(e)}parseFqnRefExpr(e){const n=this.parseFqnRef(e.ref);switch(!0){case e.selector==="._":return{ref:n,selector:"expanded"};case e.selector===".**":return{ref:n,selector:"descendants"};case e.selector===".*":return{ref:n,selector:"children"};default:return{ref:n}}}parseElementWhereExpr(e){return{
where:{expr:this.parseFqnExpr(e.subject),condition:e.where?Vs(e.where):{kind:{neq:"--always-true--"}}}}}parseFqnExpressions(e){const n=[];let r=e;for(;r;){try{rn(r.value)&&this.isValid(r.value)&&n.push(this.parseFqnExpr(r.value))}catch(i){ke(i)}r=r.prev}return n.reverse()}parseRelationWhereExpr(e){return{where:{expr:this.parseRelationExpr(e.subject),condition:e.where?Vs(e.where):{kind:{neq:"--always-true--"}}}}}parseRelationExpr(e){if(Jy(e),Oy(e))return{source:this.parseFqnExpr(e.source.from),target:this.
parseFqnExpr(e.target),isBidirectional:e.source.isBidirectional};if(k0(e))return{inout:this.parseFqnExpr(e.inout.to)};if(Vy(e))return{outgoing:this.parseFqnExpr(e.from)};if(Wy(e))return{incoming:this.parseFqnExpr(e.to)};Me(e)}}}function n3(t){return class extends t{parseGlobals(){const{parseResult:e,c4Globals:n}=this.doc,r=this.isValid,i=e.value.globals.filter(r),s=i.flatMap(o=>o.predicates.filter(r));for(const o of s)try{const c=o.name;if(!ce(c))continue;if(c in n.predicates){nt.warn(`Global pr\
edicate named "${c}" is already defined`);continue}this.parseAndStoreGlobalPredicateGroupOrDynamic(o,c,n)}catch(c){ke(c)}const a=i.flatMap(o=>o.styles.filter(r));for(const o of a)try{const c=o.id.name;if(!ce(c))continue;if(c in n.styles){nt.warn(`Global style named "${c}" is already defined`);continue}const u=this.parseGlobalStyleOrGroup(o);u.length>0&&(n.styles[c]=u)}catch(c){ke(c)}}parseAndStoreGlobalPredicateGroupOrDynamic(e,n,r){if(Hu(e)){const i=this.parseGlobalPredicateGroup(e);i.length>0&&
(r.predicates[n]=i);return}if(Wu(e)){const i=this.parseGlobalDynamicPredicateGroup(e);i.length>0&&(r.dynamicPredicates[n]=i);return}Me(e)}parseGlobalPredicateGroup(e){return e.predicates.map(n=>this.parseViewRulePredicate(n))}parseGlobalDynamicPredicateGroup(e){return e.predicates.map(n=>this.parseDynamicViewIncludePredicate(n))}parseGlobalStyleOrGroup(e){if(Ia(e))return[this.parseViewRuleStyle(e)];if(zs(e))return e.styles.map(n=>this.parseViewRuleStyle(n));Me(e)}}}function r3(t){const e=bn(t.target);
if(!e)throw new Error("RelationRefError: Invalid reference to target");if(Yt(t.source)){const n=bn(t.source);if(!n)throw new Error("RelationRefError: Invalid reference to source");return{source:n,target:e}}if(!_u(t.$container))throw new Error("RelationRefError: Invalid container for sourceless relation");return{source:t.$container.$container,target:e}}function*i3(t){const e=fw.from(t.parseResult.value.models.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(oi(r)){n.push(r);continue}if(r.
body&&r.body.elements&&r.body.elements.length>0)for(const i of r.body.elements)e.push(i);yield r}yield*n}function s3(t){return class extends t{parseModel(){const e=this.doc;for(const n of i3(e))try{if(wn(n)){e.c4Elements.push(this.parseElement(n));continue}if(oi(n)){this.isValid(n)&&e.c4Relations.push(this.parseRelation(n));continue}if(Pa(n)){const r=this.parseExtendElement(n);r&&e.c4ExtendElements.push(r);continue}Me(n)}catch(r){ke(r)}}parseElement(e){const n=this.isValid,r=this.resolveFqn(e),i=Zt(
e.kind.ref,"Element kind is not resolved").name,s=this.parseTags(e.body),a=e.body?.props.find(Ni)?.props,o=qi(a,n),c=this.getMetadata(e.body?.props.find(Pi)),u=this.getAstNodePath(e);let[l,f,d]=e.props??[];const h=Ze(e.body?.props??[],je(n),je(Mu),Sr($=>[$.key,$.value||void 0]));l=ut(l??h.title),f=ut(h.description??f),d=Pr(h.technology??d);const m=this.parseLinks(e.body),b=e.body?.props.find(_r);if(b&&n(b)){const $=b.libicon?.ref?.name??b.value;ce($)&&(o.icon=$)}return{id:r,kind:i,astPath:u,title:l??
e.name,...c&&{metadata:c},...s&&{tags:s},...m&&Dn(m)&&{links:m},...ce(d)&&{technology:d},...ce(f)&&{description:f},style:o}}parseExtendElement(e){this.isValid;const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Pi)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&Pt(i??{})&&Pt(a)?null:{id:n,astPath:s,...i&&{metadata:i},...r&&{tags:r},...a&&Dn(a)&&{links:a}}}parseRelation(e){const n=this.isValid,r=r3(e),i=this.resolveFqn(r.target),s=this.resolveFqn(
r.source),a=this.parseTags(e)??this.parseTags(e.body),o=this.parseLinks(e.body),c=e.kind?.ref?.name,u=this.getMetadata(e.body?.props.find(Pi)),l=this.getAstNodePath(e),f=Sr(e.body?.props.filter(wl).filter(w=>rn(w.value))??[],w=>[w.key,w.value]),d=Ze(e.body?.props??[],je(pl),nn(w=>w.value.view.ref?.name),je(ce),ka()),h=ut(e.title??f.title)??"",m=ut(f.description),b=Pr(e.technology)??ut(f.technology),$=e.body?.props.find(Xh);return{id:Zl(l,s,i),astPath:l,source:s,target:i,title:h,...u&&{metadata:u},
...ce(b)&&{technology:b},...ce(m)&&{description:m},...c&&{kind:c},...a&&{tags:a},...Dn(o)&&{links:o},...Iv($?.props,n),...d&&{navigateTo:d}}}}}function a3(t){return class extends t{parsePredicate(e){if(jB(e))return this.parseElementPredicate(e);if(XB(e))return this.parseRelationPredicate(e);Me(e)}parseElementPredicate(e){if(Ch(e))return this.parseElementPredicateWith(e);if(Gy(e))return this.parseElementPredicateWhere(e);if(Ty(e))return this.parseElementExpression(e);Me(e)}parseElementExpressionsIterator(e){
const n=[];let r=e;for(;r;){try{r.value&&n.unshift(this.parseElementExpression(r.value))}catch(i){ke(i)}r=r.prev}return n}parseElementExpression(e){if(qs(e))return{wildcard:!0};if(_h(e))return Ie(e.kind?.ref,"ElementKindExpr kind is not resolved: "+e.$cstNode?.text),{elementKind:e.kind.ref.name,isEqual:e.isEqual};if(Ph(e)){Ie(e.tag?.ref,"ElementTagExpr tag is not resolved: "+e.$cstNode?.text);let n=e.tag.$refText;return n.startsWith("#")&&(n=n.slice(1)),{elementTag:n,isEqual:e.isEqual}}if(w0(e)){
const n=bn(e.expand);return Ie(n,"Element not found "+e.expand.$cstNode?.text),{expanded:this.resolveFqn(n)}}if(qy(e)){const n=bn(e.parent);return Ie(n,"Element not found "+e.parent.$cstNode?.text),{element:this.resolveFqn(n),isChildren:e.suffix===".*",isDescendants:e.suffix===".**"}}if(Ou(e)){const n=bn(e);return Ie(n,"Element not found "+e.$cstNode?.text),{element:this.resolveFqn(n)}}Me(e)}parseElementPredicateWhere(e){return{where:{expr:this.parseElementExpression(e.subject),condition:e.where?
Vs(e.where):{kind:{neq:"--always-true--"}}}}}parseElementPredicateWith(e){const n=this.parseElementPredicate(e.subject);return(e.custom?.props??[]).reduce((r,i)=>{if(!this.isValid(i))return r;if(Uh(i)){const s=i.value.view.$refText;return ce(s)&&(r.custom.navigateTo=s),r}if(Mu(i))return Yt(i.value)&&(r.custom[i.key]=ut(i.value)||""),r;if(_r(i)){const s=i.libicon?.ref?.name??i.value;return Yt(s)&&(r.custom[i.key]=s),r}if(Is(i)){const s=Ql(i);return Yt(s)&&(r.custom[i.key]=s),r}if(Yh(i)||hh(i))return Yt(
i.value)&&(r.custom[i.key]=i.value),r;if(Wh(i))return Yt(i.value)&&(r.custom[i.key]=QA(i)),r;if(za(i))return ce(i.value)&&(r.custom[i.key]=ut(i.value)),r;if(Ky(i))return ey(i.value)&&(r.custom[i.key]=i.value),r;if(Zy(i)||rv(i)||Yy(i))return ce(i.value)&&(r.custom[i.key]=Za(i)),r;Me(i)},{custom:{expr:n}})}parseRelationPredicate(e){if(Qy(e)){let n=Jy(e.subject)?this.parseRelationPredicateWhere(e.subject):this.parseRelationExpression(e.subject);return this.parseRelationPredicateWith(e,n)}if(Jy(e))return this.
parseRelationPredicateWhere(e);if(Py(e))return this.parseRelationExpression(e);Me(e)}parseRelationPredicateWhere(e){return{where:{expr:this.parseRelationExpression(e.subject),condition:e.where?Vs(e.where):{kind:{neq:"--always-true--"}}}}}parseRelationPredicateWith(e,n){return(e.custom?.props??[]).reduce((r,i)=>{if(wl(i)||za(i)||A0(i))return Yt(i.value)&&(r.customRelation[i.key]=ut(i.value)??""),r;if(vu(i))return ce(i.value)&&(r.customRelation[i.key]=i.value),r;if(Is(i)){const s=Ql(i);return ce(s)&&
(r.customRelation[i.key]=s),r}if(tl(i))return ce(i.value)&&(r.customRelation[i.key]=i.value),r;if(pl(i)){const s=i.value.view.ref?.name;return ce(s)&&(r.customRelation.navigateTo=s),r}Me(i)},{customRelation:{relation:n}})}parseRelationExpression(e){if(Ly(e))return{source:this.parseElementExpression(e.source.from),target:this.parseElementExpression(e.target),isBidirectional:e.source.isBidirectional};if(Hy(e))return{inout:this.parseElementExpression(e.inout.to)};if(Xy(e))return{outgoing:this.parseElementExpression(
e.from)};if(R0(e))return{incoming:this.parseElementExpression(e.to)};Me(e)}}}function o3(t){return class extends t{parseSpecification(){const{parseResult:{value:{specifications:e}},c4Specification:n}=this.doc,r=this.isValid,i=e.flatMap(u=>u.elements.filter(this.isValid));for(const{kind:u,props:l}of i)try{const f=u.name;if(!ce(f))continue;if(f in n.elements){nt.warn(`Element kind "${f}" is already defined`);continue}const d=l.find(Ni),h=Ze(l.filter(ev)??[],je(m=>this.isValid(m)&&rn(m.value)),Sr(m=>[
m.key,ut(m.value)]));n.elements[f]={...h,style:{...qi(d?.props,this.isValid)}}}catch(f){ke(f)}const s=e.flatMap(u=>u.relationships.filter(this.isValid));for(const{kind:u,props:l}of s)try{const f=u.name;if(!ce(f))continue;if(f in n.relationships){nt.warn(`Relationship kind "${f}" is already defined`);continue}const d=Ze(l.filter(C0)??[],je(h=>this.isValid(h)&&rn(h.value)),Sr(h=>[h.key,ut(h.value)]));n.relationships[f]={...d,...Iv(l,this.isValid)}}catch(f){ke(f)}const a=e.flatMap(u=>u.tags.filter(
this.isValid));for(const u of a){const l=u.tag.name;ce(l)&&n.tags.add(l)}const o=e.flatMap(u=>u.deploymentNodes.filter(r));for(const u of o)try{Object.assign(n.deployments,this.parseSpecificationDeploymentNodeKind(u))}catch(l){ke(l)}const c=e.flatMap(u=>u.colors.filter(r));for(const{name:u,color:l}of c)try{const f=u.name;if(f in n.colors){nt.warn(`Custom color "${f}" is already defined`);continue}n.colors[f]={color:l}}catch(f){ke(f)}}parseSpecificationDeploymentNodeKind({kind:e,props:n}){const r=e.
name;if(!ce(r))throw new Error("DeploymentNodeKind name is not resolved");const i=n.find(Ni),s=Ze(n.filter(ev)??[],je(a=>this.isValid(a)&&rn(a.value)),Sr(a=>[a.key,ut(a.value)]));return{[r]:{...s,style:{...qi(i?.props,this.isValid)}}}}}}function c3(t){return class extends t{parseViews(){const e=this.isValid;for(const n of this.doc.parseResult.value.views){const r=n.styles.flatMap(i=>{try{return e(i)?this.parseViewRuleStyleOrGlobalRef(i):[]}catch(s){return ke(s),[]}});for(const i of n.views)try{if(!e(
i))continue;switch(!0){case xh(i):this.doc.c4Views.push(this.parseElementView(i,r));break;case p0(i):this.doc.c4Views.push(this.parseDynamicElementView(i,r));break;case Iy(i):this.doc.c4Views.push(this.parseDeploymentView(i));break;default:Me(i)}}catch(s){ke(s)}}}parseElementView(e,n){const r=e.body;Ie(r,"ElementView body is not defined");const i=this.getAstNodePath(e);let s=null;if("viewOf"in e){const h=bn(e.viewOf),m=h&&this.resolveFqn(h);m?s=m:nt.warn("viewOf is not resolved: "+e.$cstNode?.text)}
let a=e.name;a||(a="view_"+Zl(this.doc.uri.toString(),i,s??""));const o=Pr(r.props.find(h=>h.key==="title")?.value)??null,c=ut(r.props.find(h=>h.key==="description")?.value)??null,u=this.convertTags(r),l=this.convertLinks(r),f=Wv(e),d={__:"element",id:a,astPath:i,title:o,description:c,tags:u,links:Dn(l)?l:null,rules:[...n,...r.rules.flatMap(h=>{try{return this.isValid(h)?this.parseViewRule(h):[]}catch(m){return ke(m),[]}})],...s&&{viewOf:s},...f&&{manualLayout:f}};if(yp.writeId(e,d.id),"extends"in
e){const h=e.extends.view.ref;return Ie(h?.name,"view extends is not resolved: "+e.$cstNode?.text),Object.assign(d,{extends:h.name})}return d}parseViewRule(e){if(uh(e))return this.parseViewRulePredicate(e);if(sv(e))return this.parseViewRuleGlobalPredicateRef(e);if(Ny(e))return this.parseViewRuleStyleOrGlobalRef(e);if(Al(e))return Ov(e);if(rp(e))return this.parseViewRuleGroup(e);Me(e)}parseViewRulePredicate(e){const n=[];let r=e.predicates;for(;r;){const{value:i,prev:s}=r;try{ce(i)&&this.isValid(
i)&&n.unshift(this.parsePredicate(i))}catch(a){ke(a)}if(!s)break;r=s}return Fh(e)?{include:n}:{exclude:n}}parseViewRuleGlobalPredicateRef(e){return{predicateId:e.predicate.$refText}}parseViewRuleStyleOrGlobalRef(e){if(Dl(e))return this.parseViewRuleStyle(e);if(av(e))return this.parseViewRuleGlobalStyle(e);Me(e)}parseViewRuleGroup(e){const n=[];for(const r of e.groupRules)try{if(!this.isValid(r))continue;if(uh(r)){n.push(this.parseViewRulePredicate(r));continue}if(rp(r)){n.push(this.parseViewRuleGroup(
r));continue}Me(r)}catch(i){ke(i)}return{title:Pr(e.title)??null,groupRules:n,...qi(e.props,this.isValid)}}parseViewRuleStyle(e){const n=e.props.filter(Dy),r=e.target,i=e.props.find(za);return this.parseRuleStyle(n,r,i)}parseRuleStyle(e,n,r){const i=qi(e,this.isValid),s=ut(r?.value);return{targets:this.parseElementExpressionsIterator(n),...s&&{notation:s},style:{...i}}}parseViewRuleGlobalStyle(e){return{styleId:e.style.$refText}}parseDynamicElementView(e,n){const r=e.body;Ie(r,"DynamicElementVie\
w body is not defined");const i=this.isValid,s=r.props.filter(i),a=this.getAstNodePath(e);let o=e.name;o||(o="dynamic_"+Zl(this.doc.uri.toString(),a));const c=Pr(s.find(h=>h.key==="title")?.value)??null,u=ut(s.find(h=>h.key==="description")?.value)??null,l=this.convertTags(r),f=this.convertLinks(r);yp.writeId(e,o);const d=Wv(e);return{__:"dynamic",id:o,astPath:a,title:c,description:u,tags:l,links:Dn(f)?f:null,rules:[...n,...r.rules.flatMap(h=>{try{return i(h)?this.parseDynamicViewRule(h):[]}catch(m){
return ke(m),[]}},[])],steps:r.steps.reduce((h,m)=>{try{i(m)&&(My(m)?h.push(this.parseDynamicParallelSteps(m)):h.push(this.parseDynamicStep(m)))}catch(b){ke(b)}return h},[]),...d&&{manualLayout:d}}}parseDynamicViewRule(e){if(pU(e))return this.parseDynamicViewIncludePredicate(e);if(m0(e))return this.parseViewRuleGlobalPredicateRef(e);if(Ny(e))return this.parseViewRuleStyleOrGlobalRef(e);if(Al(e))return Ov(e);Me(e)}parseDynamicViewIncludePredicate(e){const n=[];let r=e.predicates;for(;r;){try{if(rn(
r.value)&&this.isValid(r.value)){const i=this.parseElementPredicate(r.value);n.unshift(i)}}catch(i){ke(i)}r=r.prev}return{include:n}}parseDynamicParallelSteps(e){return{__parallel:e.steps.map(n=>this.parseDynamicStep(n))}}parseDynamicStep(e){const n=bn(e.source);if(!n)throw new Error("Invalid reference to source");const r=bn(e.target);if(!r)throw new Error("Invalid reference to target");let i=this.resolveFqn(n),s=this.resolveFqn(r);const a=ut(e.title)??null;let o={source:i,target:s,title:a};if(e.
isBackward&&(o={source:s,target:i,title:a,isBackward:!0}),!pj(e.custom?.props))return o;for(const c of e.custom.props)try{switch(!0){case pl(c):{const u=c.value.view.ref?.name;ce(u)&&(o.navigateTo=u);break}case wl(c):case za(c):case A0(c):{Yt(c.value)&&(o[c.key]=ut(c.value)??"");break}case vu(c):{Yt(c.value)&&(o[c.key]=c.value);break}case Is(c):{const u=Ql(c);Yt(u)&&(o[c.key]=u);break}case tl(c):{Yt(c.value)&&(o[c.key]=c.value);break}default:Me(c)}}catch(u){ke(u)}return o}}}const u3=Ze(s4,t3,s3,
o4,Z4,a3,o3,c3,n3);class l3 extends u3{}class d3{constructor(e){this.services=e,this.cachedParsers=new eG(e.shared,ze.IndexedReferences),e.shared.workspace.DocumentBuilder.onDocumentPhase(ze.Validated,n=>{try{this.cachedParsers.set(n.uri,"DocumentParser",this.createParser(n))}catch(r){nt.error(`Error caching parser for document ${n.uri.toString()}`,{error:r})}return Promise.resolve()})}cachedParsers;documents(){return this.services.shared.workspace.LangiumDocuments.all.map(e=>this.parse(e))}parse(e){
try{return this.forDocument(e).doc}catch(n){throw new Error(`Error parsing document ${e.uri.toString()}`,{cause:n})}}forDocument(e){return Ie(e.state>=ze.IndexedReferences,`Not a IndexedReferences: ${e.uri.toString(!0)}`),this.cachedParsers.get(e.uri,"DocumentParser",()=>this.createParser(e))}createParser(e){e=Object.assign(e,{c4Specification:{tags:new Set,elements:{},relationships:{},colors:{},deployments:{}},c4Elements:[],c4ExtendElements:[],c4ExtendDeployments:[],c4Relations:[],c4Deployments:[],
c4DeploymentRelations:[],c4Globals:{predicates:{},dynamicPredicates:{},styles:{}},c4Views:[]});const n=new l3(this.services,e);return n.parseSpecification(),n.parseModel(),n.parseGlobals(),n.parseDeployment(),n.parseViews(),n}}const{findNodeForKeyword:f3}=Sm,h3=(t,e,n=0)=>{const r=n>0?" ".repeat(n):"";return[r+`style ${t} {`,...Gf(e).map(([i,s])=>r+`  ${i} ${i==="opacity"?s.toString()+"%":s}`),r+"}"]},p3=(t,e)=>n=>{if(!Dl(n))return!1;const r=n.target.value;if(!r||ce(n.target.prev)||!Ou(r))return!1;
const i=r.el.ref;return(i?e.getFqn(i):null)===t};function m3(t,{view:e,viewAst:n,targets:r,style:i}){Ie(n.body,`View ${e.id} has no body`);const s=n.$cstNode;Ie(s,"viewCstNode");const a=kc(n.body.rules)?.$cstNode?.range.end??n.body.$cstNode?.range.end;Ie(a,"insertPos is not defined");const o=s.range.start.character+2,c=t.likec4.FqnIndex,u=je(n.body.rules,Dl),l=e.__==="element"?e.viewOf:null,f=[],d=[];r.forEach($=>{const w=JT(u,p3($,c)),k=l&&_p(l,$)?$.substring(l.length+1):$;w?f.push({fqn:k,rule:w}):
d.push({fqn:k})});const h={start:a,end:a},m=$=>{$.start.line<=h.start.line&&($.start.line==h.start.line?h.start.character=Math.min($.start.character,h.start.character):h.start=$.start),$.end.line>=h.end.line&&($.end.line==h.end.line?h.end.character=Math.max($.end.character,h.end.character):h.end=$.end)},b=[];if(d.length>0){const $=d.flatMap(({fqn:w})=>h3(w,i,o));b.push(An.insert(a,`
`+$.join(`
`))),h.start={line:a.line+1,character:o},h.end={line:a.line+$.length,character:kc($)?.length??0}}if(f.length>0)for(const{rule:$}of f){const w=$.$cstNode;Ie(w,"RuleCstNode not found");for(const[k,S]of Gf(i)){const D=k==="opacity"?S.toString()+"%":S,F=$.props.find(re=>re.key===k);if(F&&F.$cstNode){const{range:{start:re,end:ye}}=F.$cstNode;m({start:re,end:ye}),b.push(An.replace({start:re,end:ye},k+" "+D));continue}const Y=f3(w,"{")?.range.end;Ie(Y,"Opening brace not found");const J=" ".repeat(2+w.range.
start.character),ie=J+k+" "+D;b.push(An.insert(Y,`
`+ie)),m({start:{line:Y.line+1,character:J.length},end:{line:Y.line+1,character:ie.length}})}}return{modifiedRange:h,edits:b}}const{findNodeForKeyword:g3}=Sm;function y3(t,{view:e,viewAst:n,layout:r}){Ie(n.body,`View ${e.id} has no body`);const i=n.$cstNode;Ie(i,"viewCstNode");const s=UK(r.direction),a=JT(n.body.rules,Al);let o=`autoLayout ${s}`;if(qf(r.rankSep)&&(o+=` ${r.rankSep}`,qf(r.nodeSep)&&(o+=` ${r.nodeSep}`)),a&&a.$cstNode)return An.replace(a.$cstNode.range,o);const c=g3(n.body.$cstNode,
"}")?.range.start;Ie(c,"Closing brace not found");const u=`	${o}
	`;return An.insert(c,u)}function v3(t,e=1,n={}){const{indent:r=" ",includeEmptyLines:i=!1}=n;if(typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(e<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${e}\``);if(typeof r!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r}\``);if(e===
0)return t;const s=i?/^/gm:/^(?!\s*$)/gm;return t.replace(s,r.repeat(e))}function w3(t,{viewAst:e,layout:n}){Ie(e.$cstNode,"invalid view.$cstNode");const r=Zp(e.$cstNode,["BLOCK_COMMENT"]);let i=J4(n);return e.$cstNode.range.start.character>0&&(i=v3(i,e.$cstNode.range.start.character)),r?An.replace(r.range,i.trimStart()):An.insert({line:e.$cstNode.range.start.line,character:0},i+`
`)}class b3{constructor(e){this.services=e,this.locator=e.likec4.ModelLocator}locator;async applyChange(e){const n=this.services.shared.lsp.Connection;Ie(n,"LSP Connection not available");let r=null;try{await this.services.shared.workspace.WorkspaceLock.write(async()=>{const{doc:i,edits:s,modifiedRange:a}=this.convertToTextEdit(e),o={uri:i.textDocument.uri,version:i.textDocument.version};if(!s.length)return;const c=await n.workspace.applyEdit({label:`LikeC4 - change view ${e.viewId}`,edit:{changes:{
[o.uri]:s}}});if(!c.applied){n.window.showErrorMessage(`Failed to apply changes ${c.failureReason}`);return}r={uri:o.uri,range:a}})}catch(i){un.error(`Failed to apply change ${e.change.op} ${e.viewId}`,{error:i})}return r}convertToTextEdit({viewId:e,change:n}){const r=this.locator.locateViewAst(e);if(!r)throw new Error(`LikeC4ModelChanges: view not found: ${e}`);switch(n.op){case"change-element-style":return{doc:r.doc,...m3(this.services,{...r,targets:n.targets,style:n.style})};case"change-autol\
ayout":{const s=y3(this.services,{...r,layout:n.layout});return{doc:r.doc,modifiedRange:s.range,edits:[s]}}case"save-manual-layout":const i=w3(this.services,{...r,layout:n.layout});return{doc:r.doc,modifiedRange:i.range,edits:[i]};default:Me(n)}}}class $3 extends vT{constructor(e){super(),this.services=e}getNameStrict(e){return Zt(this.getName(e),`Failed getName for ${this.services.workspace.AstNodeLocator.getAstNodePath(e)}`)}getName(e){if(Nf(e))return e.name;if(Cn(e))return e.element.el.$refText}getNameNode(e){
if(Nf(e))return super.getNameNode(e);if(Cn(e))return e.element.el.$refNode}}function R3(t){return Ze(t,Tc(e=>`${e.type}.${e.name}`),Gf(),_i(([e,n])=>n.length===1?n:[]))}class k3 extends bT{constructor(e){super(e)}async computeExports(e,n){const r=[];try{const{specifications:i,models:s,views:a,globals:o,likec4lib:c,deployments:u}=e.parseResult.value;this.exportLibrary(c,r,e),this.exportSpecification(i,r,e),this.exportModel(s,r,e),this.exportViews(a,r,e),this.exportGlobals(o,r,e),this.exportDeployments(
u,r,e)}catch(i){ke(i)}return r}exportViews(e,n,r){const i=e?.flatMap(s=>s.views);if(!(yt(i)||i.length===0))for(const s of i)try{ce(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){ke(a)}}exportGlobals(e,n,r){if(!(yt(e)||e.length===0)){for(const i of e.flatMap(s=>s.predicates))try{const s=i;ce(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(s){ke(s)}for(const i of e.flatMap(s=>s.styles))try{const s=i.id;ce(s.name)&&n.push(this.descriptions.createDescription(
s,s.name,r))}catch(s){ke(s)}}}exportModel(e,n,r){if(!(yt(e)||e.length===0))for(const i of e.flatMap(s=>s.elements))try{wn(i)&&ce(i.name)&&n.push(this.descriptions.createDescription(i,i.name,r))}catch(s){ke(s)}}exportLibrary(e,n,r){if(!yt(e))try{for(const i of e.flatMap(s=>s.icons))n.push(this.descriptions.createDescription(i,i.name,r))}catch(i){ke(i)}}exportSpecification(e,n,r){if(!(yt(e)||e.length===0))for(const i of e.flatMap(s=>[...s.elements,...s.relationships,...s.deploymentNodes,...s.tags,
...s.colors]))try{switch(!0){case qa(i):case ja(i):{ce(i.kind.name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r));continue}case Zh(i):{ce(i.tag.name)&&n.push(this.descriptions.createDescription(i.tag,"#"+i.tag.name,r));continue}case Ua(i):{ce(i.kind.name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r),this.descriptions.createDescription(i.kind,"."+i.kind.name,r));continue}case Qh(i):{ce(i.name.name)&&n.push(this.descriptions.createDescription(i.name,i.name.
name,r));continue}default:Me(i)}}catch(s){ke(s)}}exportDeployments(e,n,r){const i=e?.flatMap(s=>s.elements);if(!(yt(i)||i.length===0))for(const s of i)try{Pn(s)&&ce(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){ke(a)}}computeLocalScopes(e,n){return new Promise(r=>{const i=e.parseResult.value,s=[],a=new Ot;for(const o of i.models)try{s.push(...this.processContainer(o,a,e))}catch(c){ke(c)}for(const o of i.deployments)try{s.push(...this.processDeployments(o,a,e))}catch(c){
ke(c)}R3(s).forEach(o=>{a.add(i,o)}),r(a)})}processContainer(e,n,r){const i=new Ot,s=[];for(const o of e.elements){if(oi(o))continue;let c;if(wn(o)?(ce(o.name)&&i.add(o.name,this.descriptions.createDescription(o,o.name,r)),c=o.body):Pa(o)&&(c=o.body),c&&c.elements.length>0)try{s.push(...this.processContainer(c,n,r))}catch(u){ke(u)}}s.length&&Ze(s,je(o=>!i.has(o.name)),Tc(o=>o.name),VT((o,c)=>{o.length===1&&i.add(c,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}processDeployments(e,n,r){
const i=new Ot,s=[];for(const o of e.elements)if(!Di(o)){if(!Ls(o)){let c=this.nameProvider.getName(o);if(ce(c)){const u=this.descriptions.createDescription(o,c,r);i.add(c,u)}}if(!Cn(o)&&o.body)try{s.push(...this.processDeployments(o.body,n,r))}catch(c){ke(c)}}s.length&&Ze(s,je(o=>!i.has(o.name)),Tc(o=>o.name),VT((o,c)=>{o.length===1&&i.add(c,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}}const{getDocument:T3}=Wo;class E3 extends ET{deploymentsIndex;fqnIndex;constructor(e){super(e),this.
fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex}uniqueDescedants(e){return new Mt(()=>{const n=e();if(n&&wn(n)){const r=this.fqnIndex.getFqn(n);return this.fqnIndex.uniqueDescedants(r).iterator()}if(n&&Pn(n)){const r=this.deploymentsIndex.getFqn(n);return this.deploymentsIndex.uniqueDescedants(r).iterator()}return null},n=>n?n.next():ln)}getScope(e){try{const n=this.reflection.getReferenceType(e);try{const r=e.container;if($0(r))return this.getScopeForFqnRef(r,e);if(x0(
r))return this.getScopeForStrictFqnRef(r,e);if(n!==ur)return this.getGlobalScope(n,e);if(P0(r)&&e.property==="el"){const i=r.parent;return i?new Ai(this.fqnIndex.directChildrenOf(Hs(i))):this.getGlobalScope(n,e)}if(Ou(r)&&e.property==="el"){const i=r.parent;if(i)return new Ai(this.getScopeElementRef(i));if(e.reference.$refText==="this"||e.reference.$refText==="it"){const s=dn(r,wn);return s?new $T([this.descriptions.createDescription(s,e.reference.$refText)]):If}}return this.computeScope(e)}catch(r){
return ke(r),this.getGlobalScope(n,e)}}catch(n){return ke(n),If}}getScopeElementRef(e){return this.uniqueDescedants(()=>e.el.ref)}getScopeExtendElement({element:e}){return et([e.el.$nodeDescription]).nonNullable().concat(this.uniqueDescedants(()=>bn(e)))}getScopeElementView({viewOf:e,extends:n}){return e?et([e.el.$nodeDescription]).nonNullable().concat(this.uniqueDescedants(()=>bn(e))):n?et([n]).flatMap(r=>{const i=r.view.ref;return i?this.getScopeElementView(i):na}):na}getScopeForStrictFqnRef(e,n){
const r=e.parent;return r?new Ai(this.deploymentsIndex.directChildrenOf(Hs(r)).filter(i=>this.reflection.isSubtype(i.type,Ar))):this.getGlobalScope(Ar,n)}getScopeExtendDeployment({deploymentNode:e}){return et([e.value.$nodeDescription]).nonNullable().concat(this.uniqueDescedants(()=>{const n=e.value.ref;return n&&Pn(n)?n:void 0}))}getScopeForFqnRef(e,n){const r=e.parent;if(!r)return this.createScope(this.computeScope(n,Ar).getAllElements(),this.createScope(this.computeScope(n,xi).getAllElements(),
wi(e,Iy)?this.computeScope(n,ur):If));const i=r.value.ref;return i?Pn(i)?new Ai(this.uniqueDescedants(()=>i)):Cn(i)?new Ai(this.getScopeElementRef(i.element)):wn(i)?new Ai(this.uniqueDescedants(()=>i)):Me(i):If}computeScope(e,n=this.reflection.getReferenceType(e)){const r=this.reflection.isSubtype(n,ur),i=this.reflection.isSubtype(n,Vf),s=[],a=T3(e.container).precomputedScopes;if(!a)return this.getGlobalScope(n,e);const o=u=>this.reflection.isSubtype(u.type,n);let c=e.container;for(;c;){const u=a.
get(c).filter(o);u.length>0&&s.push(et(u)),i&&yU(c)&&s.push(this.getScopeExtendDeployment(c.$container)),r&&b0(c)&&s.push(this.getScopeExtendElement(c.$container)),r&&v0(c)&&s.push(this.getScopeElementView(c.$container)),c=c.$container}return s.reduceRight((u,l)=>this.createScope(l,u),this.getGlobalScope(n,e))}}var li=bs();const S3=new li.NotificationType("likec4/onDidChangeModel"),A3=new li.RequestType0("likec4/fetchModel"),_3=new li.RequestType("likec4/fetchComputedModel"),C3=new li.RequestType(
"likec4/computeView"),P3=new li.RequestType("likec4/layout-view"),x3=new li.RequestType("likec4/validate-layout"),D3=new li.RequestType("likec4/build"),N3=new li.RequestType("likec4/locate"),I3=new li.RequestType("likec4/change-view");class O3 extends Fv{constructor(e){super(),this.services=e}init(){const e=this.services.likec4.ModelBuilder,n=this.services.likec4.ModelLocator,r=this.services.likec4.ModelChanges,i=this.services.likec4.Views,s=this.services.shared.lsp.Connection;if(!s){nt.info("[S\
erverRpc] no connection, not initializing");return}nt.info("[ServerRpc] init");const a=this.services.shared.workspace.LangiumDocuments,o=this.services.shared.workspace.DocumentBuilder,c=mj(()=>{s.sendNotification(S3,"").catch(f=>(nt.warn(`[ServerRpc] error sending onDidChangeModel: ${f}`),Promise.resolve()))},{minQuietPeriodMs:250,maxBurstDurationMs:1e3,minGapMs:200});let u=!0;this.onDispose(e.onModelParsed(()=>c.call()),s.onRequest(_3,async({cleanCaches:f},d)=>{if(f){const m=a.all.map(b=>b.uri).
toArray();await o.update(m,[],d)}const h=await e.buildLikeC4Model(d);return h!==ao.EMPTY?{model:h.$model}:{model:null}}),s.onRequest(A3,async f=>({model:(await e.parseModel(f))?.model??null})),s.onRequest(C3,async({viewId:f},d)=>({view:await e.computeView(f,d)})),s.onRequest(P3,async({viewId:f},d)=>({result:await i.layoutView(f,d)})),s.onRequest(x3,async(f,d)=>{const h=await i.layoutAllViews(d);return{result:l(h.map(m=>m.diagram))}}),s.onRequest(D3,async({docs:f},d)=>{const h=f.map($=>Xt.parse($)),
m=$=>h.every(w=>!Et.equals(w,$)),b=a.all.filter($=>Qa($)&&m($.uri)&&$.uri.scheme!==cv).map($=>$.uri).toArray();nt.debug(`[ServerRpc] received request to build:
  changed (total ${h.length}):${f.map($=>`
    - `+$).join("")}
  deleted (total ${b.length}):${b.map($=>`
    - `+$.toString()).join(`
`)}`),!u&&h.length+b.length>0&&await Promise.allSettled([...h,...b].map(async $=>{const w=$.toString();nt.debug(`clear diagnostics for ${w}`);try{await s.sendDiagnostics({uri:w,diagnostics:[]})}catch(k){nt.warn(`error clearing diagnostics for ${w}: ${k}`)}})),u=!1,await jt(d),await o.update(h,b,d)}),s.onRequest(N3,f=>{switch(!0){case"element"in f:return n.locateElement(f.element,f.property??"name");case"relation"in f:return n.locateRelation(f.relation);case"view"in f:return n.locateView(f.view);case"\
deployment"in f:return n.locateDeploymentElement(f.deployment,f.property??"name");default:Me(f)}}),s.onRequest(I3,async(f,d)=>await r.applyChange(f)),ps.create(()=>{c.cancel()}));function l(f){return Ze(f,je(d=>!!d.hasLayoutDrift),nn(d=>({uri:n.locateView(d.id).uri,viewId:d.id,severity:ve.DiagnosticSeverity.Warning,message:`Layout drift detected for view '${d.id}'`,range:n.locateView(d.id).range})))}}}class L3{constructor(e){this.services=e}getSymbolKind(e){const n=bt(e)?e.$type:e.type,r=(...i)=>i.
some(s=>this.services.AstReflection.isSubtype(n,s));switch(!0){case r(ur,Ms,Ar,xi):return ar.Constructor;case r(Oa,Ma,La,Na,Wa):return ar.Namespace;case r(Ns):return ar.Class;case r(Oi,Fs,Os,Ha):return ar.EnumMember;case r(Ii,Ba):return ar.Event;case r(ai,si,Ga,Fa):return ar.TypeParameter}return ar.Field}getCompletionItemKind(e){const n=bt(e)?e.$type:e.type,r=(...i)=>i.some(s=>this.services.AstReflection.isSubtype(n,s));switch(!0){case r(Os):return kt.Color;case r(ur,Ar,xi,Ms):return kt.Constructor;case r(
Oa,Ma,La,Na,Wa):return kt.Module;case r(Ns):return kt.Class;case r(Oi,Fs,Os,Ha):return kt.EnumMember;case r(Ii,Ba):return kt.Event;case r(ai,Ga,si,Fa):return kt.TypeParameter;default:return kt.Reference}}}class M3 extends AT{documentFactory;constructor(e){super(e),this.documentFactory=e.workspace.LangiumDocumentFactory}async loadAdditionalDocuments(e,n){n(this.documentFactory.fromString(q0,Xt.parse(OU))),await super.loadAdditionalDocuments(e,n)}workspace(){return this.folders&&gC(this.folders,1)?
this.folders[0]:null}get workspaceUri(){const e=this.workspace();return Ie(e,"Workspace not initialized"),Xt.parse(e.uri)}get workspaceURL(){const e=this.workspace();return Ie(e,"Workspace not initialized"),new URL(e.uri)}}class z3 extends DS{}class F3{constructor(e){this.services=e,this.ModelBuilder=e.likec4.ModelBuilder}cache=new WeakMap;viewsWithReportedErrors=new Set;ModelBuilder;get layouter(){return this.services.likec4.Layouter}async computedViews(e){const n=await this.ModelBuilder.buildLikeC4Model(
e);return Ff(n.$model.views)}async layoutAllViews(e){const n=await this.computedViews(e);if(n.length===0)return[];const r=[],i=[];for(const s of n)this.viewsWithReportedErrors.delete(s.id),i.push(this.layouter.layout(s).then(a=>(this.viewsWithReportedErrors.delete(s.id),this.cache.set(s,a),a)).catch(a=>(this.cache.delete(s),ke(a),Promise.reject(a))));for(const s of await Promise.allSettled(i))s.status==="fulfilled"&&r.push(s.value);return r}async layoutView(e,n){const r=(await this.ModelBuilder.
buildLikeC4Model(n)).findView(e)?.$view;if(!r)return null;let i=this.cache.get(r);if(i)return await Promise.resolve(i);try{const s=await this.layouter.layout(r);return this.viewsWithReportedErrors.delete(e),this.cache.set(r,s),s}catch(s){if(!this.viewsWithReportedErrors.has(e)){const a=s instanceof Error?s.message:""+s;this.services.shared.lsp.Connection?.window.showErrorMessage(`LikeC4: ${a}`),this.viewsWithReportedErrors.add(e),uv(s)}return Promise.reject(s)}}async diagrams(){return(await this.
layoutAllViews()).map(e=>e.diagram)}async viewsAsGraphvizOut(){const e="All-LayoutedViews-DotWithSvg",n=this.services.ValidatedWorkspaceCache;if(n.has(e))return await Promise.resolve(n.get(e));const r=(await this.computedViews()).map(async a=>{const{dot:o,svg:c}=await this.layouter.svg(a);return{id:a.id,dot:o,svg:c}}),i=[],s=await Promise.allSettled(r);for(const a of s)a.status==="fulfilled"?i.push(a.value):ke(a.reason);return n.set(e,i),i}async overviewGraph(){const e="OverviewGraph",n=this.services.
ValidatedWorkspaceCache;if(n.has(e))return await Promise.resolve(n.get(e));const r=await this.computedViews(),i=await this.layouter.layoutOverviewGraph(r);return n.set(e,i),i}}const q3={lsp:{NodeKindProvider:t=>new L3(t),WorkspaceSymbolProvider:t=>new z3(t)},workspace:{WorkspaceManager:t=>new M3(t)}};function xt(t){return e=>new t(e)}const G3={documentation:{DocumentationProvider:xt(WK)},ValidatedWorkspaceCache:t=>new TT(t.shared,ze.Validated),Rpc:xt(O3),likec4:{Layouter:t=>(nt.debug("Creating G\
raphvizLayouter with GraphvizWasmAdapter"),new YA(new no)),Views:xt(F3),DeploymentsIndex:xt(dV),ModelChanges:xt(b3),FqnIndex:xt(r_),ModelParser:xt(d3),ModelBuilder:xt(yV),ModelLocator:xt(bV)},lsp:{CompletionProvider:xt(YK),DocumentHighlightProvider:xt(JK),DocumentSymbolProvider:xt(cV),SemanticTokenProvider:xt(lV),HoverProvider:xt(uV),CodeLensProvider:xt(XK),DocumentLinkProvider:xt(oV),Formatter:xt(VK)},references:{NameProvider:xt($3),ScopeComputation:xt(k3),ScopeProvider:xt(E3)}};function j3(t,e,n,r){
const i=B3(t),s=[fB({shared:i}),IU,G3,e,n,r].reduce(k_,{}),a=Mf(s);return i.ServiceRegistry.register(a),i4(a),t.connection?a.Rpc.init():i.workspace.ConfigurationProvider.initialized({}),{shared:i,likec4:a}}function B3(t={}){const e={...UT,...t};return Mf(pB(e),NU,q3)}function k_(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=k_(i,r):t[n]=r}}return t}const U3=t=>({start:gi.hrtime.bigint(),command:t.map(e=>W3(
J_(e))).join(" "),state:{stdout:"",stderr:"",output:""}}),W3=t=>/[^\w./-]/.test(t)?`'${t.replaceAll("'","'\\''")}'`:t,H3=({stdin:t,stdout:e,stderr:n,stdio:r=[t,e,n],env:i,preferLocal:s,cwd:a=".",...o})=>{const c=a instanceof URL?K_(a):pi.resolve(a),u=i?{...gi.env,...i}:void 0,l=r[0]?.string;return{...o,input:l,stdio:l===void 0?r:["pipe",...r.slice(1)],env:s?K3(u??gi.env,c):u,cwd:c}},K3=({Path:t="",PATH:e=t,...n},r)=>{const i=e.split(pi.delimiter),s=T_([],pi.resolve(r)).map(a=>pi.join(a,"node_mod\
ules/.bin")).filter(a=>!i.includes(a));return{...n,PATH:[...s,e].filter(Boolean).join(pi.delimiter)}},T_=(t,e)=>t.at(-1)===e?t:T_([...t,e],pi.resolve(e,"..")),V3=async(t,e,n)=>await X3(t,n)?[Hv(t),e.map(r=>Z3(r)),{...n,shell:!0}]:[t,e,n],X3=async(t,{shell:e,cwd:n,env:r=gi.env})=>gi.platform==="win32"&&!e&&!await Y3(t,n,r),Y3=async(t,e,{Path:n="",PATH:r=n})=>E_.some(i=>t.toLowerCase().endsWith(i))||(J3[`${t}\0${e}\0${r}`]??=await Q3(t,e,r)),J3={},Q3=async(t,e,n)=>{const r=n.split(pi.delimiter).filter(
Boolean).map(i=>i.replace(/^"(.*)"$/,"$1"));try{await Promise.all(E_.flatMap(i=>[e,...r].map(s=>`${pi.resolve(s,t)}${i}`)).map(async i=>{try{await CC(i)}catch{return}throw 0}))}catch{return!0}return!1},E_=[".exe",".com"],Z3=t=>Hv(Hv(`"${t.replaceAll(/(\\*)"/g,'$1$1\\"').replace(/(\\*)$/,"$1$1")}"`)),Hv=t=>t.replaceAll(/([()\][%!^"`<>&|;, *?])/g,"^$1"),e8=async(t,{input:e},n)=>{const r=await t;e!==void 0&&r.stdin.end(e);const i=vw(r,"close");try{return await Promise.race([i,...r.stdio.filter(Boolean).
map(s=>t8(s))]),n8(n,A_(r)),__(n)}catch(s){throw await Promise.allSettled([i]),S_(s,r,n)}},t8=async t=>{for await(const[e]of _C(t,"error"))if(!["ERR_STREAM_PREMATURE_CLOSE","EPIPE"].includes(e?.code))throw e},n8=({command:t},{exitCode:e,signalName:n})=>{if(n!==void 0)throw new Xs(`Command was terminated with ${n}: ${t}`);if(e!==void 0)throw new Xs(`Command failed with exit code ${e}: ${t}`)},S_=(t,e,n)=>Object.assign(r8(t,n),A_(e),__(n)),r8=(t,{command:e})=>t instanceof Xs?t:new Xs(`Command fail\
ed: ${e}`,{cause:t});class Xs extends Error{name="SubprocessError"}const A_=({exitCode:t,signalCode:e})=>({...t<1?{}:{exitCode:t},...e===null?{}:{signalName:e}}),__=({state:{stdout:t,stderr:e,output:n},command:r,start:i})=>({stdout:Kv(t),stderr:Kv(e),output:Kv(n),command:r,durationMs:Number(gi.hrtime.bigint()-i)/1e6}),Kv=t=>t.at(-1)===`
`?t.slice(0,t.at(-2)==="\r"?-2:-1):t,i8=async(t,e,n,r)=>{try{[t,e]=["node","node.exe"].includes(t.toLowerCase())?[gi.execPath,[...gi.execArgv.filter(s=>!s.startsWith("--inspect")),...e]]:[t,e];const i=AC(...await V3(t,e,n));return C_(i.stdout,r,"stdout"),C_(i.stderr,r,"stderr"),i.once("error",()=>{}),await vw(i,"spawn"),i}catch(i){throw S_(i,{},r)}},C_=(t,{state:e},n)=>{t&&(t.setEncoding("utf8"),e.isIterating||(e.isIterating=!1,t.on("data",r=>{e[n]+=r,e.output+=r})))},s8=async t=>{const[[e,n]]=await Promise.
all([Promise.allSettled(t),a8(t)]);if(n.reason)throw n.reason.pipedFrom=e.reason??e.value,n.reason;if(e.reason)throw e.reason;return{...n.value,pipedFrom:e.value}},a8=async t=>{try{const[{stdout:e},{stdin:n}]=await Promise.all(t.map(({nodeChildProcess:r})=>r));if(n===null)throw new Error('The "stdin" option must be set on the first "spawn()" call in the pipeline.');if(e===null)throw new Error('The "stdout" option must be set on the last "spawn()" call in the pipeline.');PC(e,n).catch(()=>{})}catch(e){
throw await Promise.allSettled(t.map(({nodeChildProcess:n})=>o8(n))),e}},o8=async t=>{const{stdin:e}=await t;e.end()},P_=async function*(t,{state:e},n){if(e.isIterating===!1)throw new Error(`The subprocess must be iterated right away, for example:
	for await (const line of spawn(...)) { ... }`);e.isIterating=!0;try{const{[n]:r}=await t.nodeChildProcess;if(!r)return;let i="";for await(const s of r.iterator({destroyOnReturn:!1})){const a=`${i}${s}`.split(/\r?\n/);i=a.pop(),yield*a}i&&(yield i)}finally{await t}},c8=async function*(...t){try{let e=[];for(;t.length>0;){e=t.map((a,o)=>e[o]??u8(a));const[{value:n,done:r},i]=await Promise.race(e.map((a,o)=>Promise.all([a,o]))),[s]=t.splice(i,1);e.splice(i,1),r||(t.push(s),yield n)}}finally{await Promise.
all(t.map(e=>e.return()))}},u8=async t=>{try{return await t.next()}catch(e){await t.throw(e)}};function rd(t,e,n,r){const[i=[],s={}]=Array.isArray(e)?[e,n]:[[],e],a=U3([t,...i]),o=H3(s),c=i8(t,i,o,a);let u=e8(c,o,a);Object.assign(u,{nodeChildProcess:c}),u=r?s8([r,u]):u;const l=P_(u,a,"stdout"),f=P_(u,a,"stderr");return Object.assign(u,{nodeChildProcess:c,stdout:l,stderr:f,[Symbol.asyncIterator]:()=>c8(l,f),pipe:(d,h,m)=>rd(d,h,m,u)})}var hr={},Ys={},x_;function l8(){if(x_)return Ys;x_=1,Object.defineProperty(
Ys,"__esModule",{value:!0}),Ys.sync=Ys.isexe=void 0;const t=ro,e=ww,n=async(a,o={})=>{const{ignoreErrors:c=!1}=o;try{return i(await(0,e.stat)(a),o)}catch(u){const l=u;if(c||l.code==="EACCES")return!1;throw l}};Ys.isexe=n;const r=(a,o={})=>{const{ignoreErrors:c=!1}=o;try{return i((0,t.statSync)(a),o)}catch(u){const l=u;if(c||l.code==="EACCES")return!1;throw l}};Ys.sync=r;const i=(a,o)=>a.isFile()&&s(a,o),s=(a,o)=>{const c=o.uid??process.getuid?.(),u=o.groups??process.getgroups?.()??[],l=o.gid??process.
getgid?.()??u[0];if(c===void 0||l===void 0)throw new Error("cannot get uid or gid");const f=new Set([l,...u]),d=a.mode,h=a.uid,m=a.gid,b=parseInt("100",8),$=parseInt("010",8),w=parseInt("001",8),k=b|$;return!!(d&w||d&$&&f.has(m)||d&b&&h===c||d&k&&c===0)};return Ys}var Js={},D_;function d8(){if(D_)return Js;D_=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.sync=Js.isexe=void 0;const t=ro,e=ww,n=async(a,o={})=>{const{ignoreErrors:c=!1}=o;try{return s(await(0,e.stat)(a),a,o)}catch(u){const l=u;
if(c||l.code==="EACCES")return!1;throw l}};Js.isexe=n;const r=(a,o={})=>{const{ignoreErrors:c=!1}=o;try{return s((0,t.statSync)(a),a,o)}catch(u){const l=u;if(c||l.code==="EACCES")return!1;throw l}};Js.sync=r;const i=(a,o)=>{const{pathExt:c=process.env.PATHEXT||""}=o,u=c.split(";");if(u.indexOf("")!==-1)return!0;for(let l=0;l<u.length;l++){const f=u[l].toLowerCase(),d=a.substring(a.length-f.length).toLowerCase();if(f&&d===f)return!0}return!1},s=(a,o,c)=>a.isFile()&&i(o,c);return Js}var Vv={},N_;function f8(){
return N_||(N_=1,Object.defineProperty(Vv,"__esModule",{value:!0})),Vv}var I_;function h8(){return I_||(I_=1,function(t){var e=hr&&hr.__createBinding||(Object.create?function(u,l,f,d){d===void 0&&(d=f);var h=Object.getOwnPropertyDescriptor(l,f);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[f]}}),Object.defineProperty(u,d,h)}:function(u,l,f,d){d===void 0&&(d=f),u[d]=l[f]}),n=hr&&hr.__setModuleDefault||(Object.create?function(u,l){Object.defineProperty(
u,"default",{enumerable:!0,value:l})}:function(u,l){u.default=l}),r=hr&&hr.__importStar||function(u){if(u&&u.__esModule)return u;var l={};if(u!=null)for(var f in u)f!=="default"&&Object.prototype.hasOwnProperty.call(u,f)&&e(l,u,f);return n(l,u),l},i=hr&&hr.__exportStar||function(u,l){for(var f in u)f!=="default"&&!Object.prototype.hasOwnProperty.call(l,f)&&e(l,u,f)};Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.isexe=t.posix=t.win32=void 0;const s=r(l8());t.posix=s;const a=r(d8());t.
win32=a,i(f8(),t);const c=(process.env._ISEXE_TEST_PLATFORM_||process.platform)==="win32"?a:s;t.isexe=c.isexe,t.sync=c.sync}(hr)),hr}var Xv,O_;function p8(){if(O_)return Xv;O_=1;const{isexe:t,sync:e}=h8(),{join:n,delimiter:r,sep:i,posix:s}=mi,a=process.platform==="win32",o=new RegExp(`[${s.sep}${i===s.sep?"":i}]`.replace(/(\\)/g,"\\$1")),c=new RegExp(`^\\.${o.source}`),u=m=>Object.assign(new Error(`not found: ${m}`),{code:"ENOENT"}),l=(m,{path:b=process.env.PATH,pathExt:$=process.env.PATHEXT,delimiter:w=r})=>{
const k=m.match(o)?[""]:[...a?[process.cwd()]:[],...(b||"").split(w)];if(a){const S=$||[".EXE",".CMD",".BAT",".COM"].join(w),D=S.split(w).flatMap(F=>[F,F.toLowerCase()]);return m.includes(".")&&D[0]!==""&&D.unshift(""),{pathEnv:k,pathExt:D,pathExtExe:S}}return{pathEnv:k,pathExt:[""]}},f=(m,b)=>{const $=/^".*"$/.test(m)?m.slice(1,-1):m;return(!$&&c.test(b)?b.slice(0,2):"")+n($,b)},d=async(m,b={})=>{const{pathEnv:$,pathExt:w,pathExtExe:k}=l(m,b),S=[];for(const D of $){const F=f(D,m);for(const Y of w){
const J=F+Y;if(await t(J,{pathExt:k,ignoreErrors:!0})){if(!b.all)return J;S.push(J)}}}if(b.all&&S.length)return S;if(b.nothrow)return null;throw u(m)},h=(m,b={})=>{const{pathEnv:$,pathExt:w,pathExtExe:k}=l(m,b),S=[];for(const D of $){const F=f(D,m);for(const Y of w){const J=F+Y;if(e(J,{pathExt:k,ignoreErrors:!0})){if(!b.all)return J;S.push(J)}}}if(b.all&&S.length)return S;if(b.nothrow)return null;throw u(m)};return Xv=d,d.sync=h,Xv}var m8=p8();const L_=Dr(m8),Yv=Nv(Math.max(1,xC.cpus().length));
class g8{dotpath;unflattenpath;constructor(e){this.dotpath=e||L_.sync("dot"),this.unflattenpath=L_.sync("unflatten")}async unflatten(e){return await Yv(async()=>{const n=un.getChild("graphviz-binary");let r;try{const i=await rd(this.unflattenpath,["-l 1","-c 3"],{timeout:1e4,stdin:{string:e}});r=i.stdout,Pt(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){n.error("FAILED GraphvizBinaryAdapter.unflatten",{error:i}),i instanceof Xs&&!Pt(i.stdout)&&(n.warn`Command: '${i.command}' returned result but also failed (exitcode ${i.
exitCode}): "${i.stderr}"`,r=i.stdout)}return r&&(e=r.replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    ")),e})}async layoutJson(e){return await Yv(async()=>{const n=un.getChild("graphviz-binary");let r;try{const i=await rd(this.dotpath,["-Tjson","-y"],{timeout:1e4,stdin:{string:e}});r=i.stdout,Pt(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){if(n.error("FAILED GraphvizBinaryAdapter.layoutJson",{error:i}),n.warn(`FAILED DOT:
${e}`),i instanceof Xs&&!Pt(i.stdout))n.warn(`Command: '${i.command}' returned result but also failed (exitcode ${i.exitCode}): "${i.stderr}"`),r=i.stdout;else throw i}return r})}async acyclic(e){return Promise.reject(new Error("Method not implemented."))}async svg(e){return await Yv(async()=>{const n=un.getChild("graphviz-binary");let r;try{const i=await rd(this.dotpath,["-Tsvg","-y"],{timeout:1e4,stdin:{string:e}});r=i.stdout,Pt(i.stderr)||n.warn`Command ${i.command} has stderr:\n${i.stderr}`}catch(i){
if(n.error("FAILED GraphvizBinaryAdapter.svg",{error:i}),n.warn`FAILED DOT:\n${e}`,i instanceof Xs&&!Pt(i.stdout))n.warn`Command: '${i.command}' returned result but also failed (exitcode ${i.exitCode}): "${i.stderr}"`,r=i.stdout;else throw i}return r})}}const y8="likec4",M_="1.24.0",z_=t=>Number.isFinite(t)?t:0;function v8(t){return{days:Math.trunc(t/864e5),hours:Math.trunc(t/36e5%24),minutes:Math.trunc(t/6e4%60),seconds:Math.trunc(t/1e3%60),milliseconds:Math.trunc(t%1e3),microseconds:Math.trunc(
z_(t*1e3)%1e3),nanoseconds:Math.trunc(z_(t*1e6)%1e3)}}function w8(t){return{days:t/86400000n,hours:t/3600000n%24n,minutes:t/60000n%60n,seconds:t/1000n%60n,milliseconds:t%1000n,microseconds:0n,nanoseconds:0n}}function b8(t){switch(typeof t){case"number":{if(Number.isFinite(t))return v8(t);break}case"bigint":return w8(t)}throw new TypeError("Expected a finite number or bigint")}const $8=t=>t===0||t===0n,R8=(t,e)=>e===1||e===1n?t:`${t}s`,k8=1e-7,T8=24n*60n*60n*1000n;function E8(t,e){const n=typeof t==
"bigint";if(!n&&!Number.isFinite(t))throw new TypeError("Expected a finite number or bigint");e={...e};const r=t<0?"-":"";t=t<0?-t:t,e.colonNotation&&(e.compact=!1,e.formatSubMilliseconds=!1,e.separateMilliseconds=!1,e.verbose=!1),e.compact&&(e.unitCount=1,e.secondsDecimalDigits=0,e.millisecondsDecimalDigits=0);let i=[];const s=(l,f)=>{const d=Math.floor(l*10**f+k8);return(Math.round(d)/10**f).toFixed(f)},a=(l,f,d,h)=>{if(!((i.length===0||!e.colonNotation)&&$8(l)&&!(e.colonNotation&&d==="m"))){if(h??=
String(l),e.colonNotation){const m=h.includes(".")?h.split(".")[0].length:h.length,b=i.length>0?2:1;h="0".repeat(Math.max(0,b-m))+h}else h+=e.verbose?" "+R8(f,l):d;i.push(h)}},o=b8(t),c=BigInt(o.days);if(e.hideYearAndDays?a(BigInt(c)*24n+BigInt(o.hours),"hour","h"):(e.hideYear?a(c,"day","d"):(a(c/365n,"year","y"),a(c%365n,"day","d")),a(Number(o.hours),"hour","h")),a(Number(o.minutes),"minute","m"),!e.hideSeconds)if(e.separateMilliseconds||e.formatSubMilliseconds||!e.colonNotation&&t<1e3){const l=Number(
o.seconds),f=Number(o.milliseconds),d=Number(o.microseconds),h=Number(o.nanoseconds);if(a(l,"second","s"),e.formatSubMilliseconds)a(f,"millisecond","ms"),a(d,"microsecond","\xB5s"),a(h,"nanosecond","ns");else{const m=f+d/1e3+h/1e6,b=typeof e.millisecondsDecimalDigits=="number"?e.millisecondsDecimalDigits:0,$=m>=1?Math.round(m):Math.ceil(m),w=b?m.toFixed(b):$;a(Number.parseFloat(w),"millisecond","ms",w)}}else{const l=(n?Number(t%T8):t)/1e3%60,f=typeof e.secondsDecimalDigits=="number"?e.secondsDecimalDigits:
1,d=s(l,f),h=e.keepDecimalsOnWholeSeconds?d:d.replace(/\.0+$/,"");a(Number.parseFloat(h),"second","s",h)}if(i.length===0)return r+"0"+(e.verbose?" milliseconds":"ms");const u=e.colonNotation?":":" ";return typeof e.unitCount=="number"&&(i=i.slice(0,Math.max(e.unitCount,1))),r+i.join(u)}const Jv=un.getChild("cli");Tt.bold(Tt.bgRed(Tt.white("ERROR"))),Tt.bold(Tt.yellow("WARN")),Tt.bold(Tt.green("INFO"));function F_(t){const e=un.getChild(t);return{info(n){e.info(n)},warn(n){if(n instanceof Error){
e.warn(`${Tt.red(n.name+" "+n.message)}`,{msg:n});return}if(typeof n=="string"){e.warn(n);return}e.warn`${n}`},warnOnce(n){e.warn(n)},error(n,r){let i=r?.error??n;if(i instanceof Error){if(n===i){e.error(`${Tt.red(i.name+" "+i.message)}`,{error:i});return}e.error(`${n}`,{error:i});return}if(typeof n=="string"){e.error(`${Tt.red(n)}`);return}e.error`${n}`},clearScreen:function(n){},hasErrorLogged:function(n){throw new Error("Function not implemented.")},hasWarned:!1}}const Qv=()=>{},S8={info:Qv,warn:Qv,
error:Qv},A8=1e6;function q_(t){const[e,n]=yw(t),r=e*1e3+n/A8;return{ms:r,pretty:E8(r)}}function _8(t){const e=yw();return{stopAndLog(n="done in "){n=Tt.green(`${n}${q_(e).pretty}`),(t||Jv).info(n)}}}function C8(t,e){console.log(SC(t,{padding:1,margin:1,dimBorder:!0,...e}))}class P8{constructor(e){this.services=e}isInitialized=!1;async initWorkspace(e){if(this.isInitialized)throw new Error("Workspace already initialized");const n=this.services.logger,r=this.services.shared.workspace.WorkspaceManager;
n.info(`${Tt.dim("workspace:")} ${e.uri}`),r.initialize({capabilities:{},processId:null,rootUri:null,workspaceFolders:[e]}),await r.initializeWorkspace([e])}async init(){if(this.isInitialized)throw new Error("Workspace already initialized");this.isInitialized=!0;const e=this.services.logger,n=this.services.likec4.ModelBuilder,r=this.services.shared.workspace.LangiumDocuments,i=this.services.shared.workspace.DocumentBuilder,s=r.all.toArray(),a=s.filter(c=>!G0(c.uri));if(a.length===0)throw e.error(
"no LikeC4 sources found"),new Error("no LikeC4 sources found");e.info(`${Tt.dim("workspace:")} found ${a.length} source files`),a.length>1?await i.update(a.map(c=>c.uri),[],void 0):await i.build(s,{validation:!0});const o=[...(await n.buildLikeC4Model()).views()].length;if(o===0){e.warn(`${Tt.dim("workspace:")} no views found`);return}e.info(`${Tt.dim("workspace:")} ${Tt.green(`\u2713 computed ${o} views`)}`)}}function x8(t){return e=>new t(e)}const D8={logger:()=>{throw new Error("Logger must \
be provided")},likec4:{Layouter:()=>{throw new Error("Layouter must be provided")}},cli:{Workspace:x8(P8)}};function G_(t){const e=Yp(t,{useFileSystem:!0,logger:"default",graphviz:"wasm"});let n;switch(e.logger){case!1:n=S8;break;case"vite":n=F_("lang");break;case"default":n=Jv.getChild("lang");break;default:n=e.logger;break}const r=e.graphviz==="binary";n.info(`${Tt.dim("version")} ${M_}`),n.info(`${Tt.dim("layout")} ${r?"binary":"wasm"}`);const i={logger:()=>n,likec4:{Layouter:()=>new YA(r===!0?
new g8:new no)}};return j3(e.useFileSystem?LU:{},D8,i).likec4}const j_=t=>new Error(`Invalid model:
${t.getErrors().map(e=>`  ${e.sourceFsPath}:${e.line} ${e.message.slice(0,200)}`).join(`
`)}`);class Gi{constructor(e,n,r){this.workspace=e,this.langium=n,this.isPrintErrorEnabled=r,this.logger=n.logger,this.isPrintErrorEnabled&&this.printErrors()}static async fromSource(e,n){const r=G_(Yp(n,{useFileSystem:!1,logger:!1,graphviz:"wasm"})),i=Xt.from({scheme:"virtual",path:"/workspace"});await r.cli.Workspace.initWorkspace({uri:i.toString(),name:"virtual"});const s=Et.joinPath(i,"source.likec4");r.shared.workspace.LangiumDocuments.createDocument(s,e),await r.cli.Workspace.init();const a=new Gi(
i.path,r,n?.printErrors??!0);return n?.throwIfInvalid===!0&&a.hasErrors()?(a.dispose(),Promise.reject(j_(a))):a}static likec4Instances=new Map;static async fromWorkspace(e="",n){const r=W_(e);if(!U_(r))throw new Error(`Workspace not found: ${r}`);let i=Gi.likec4Instances.get(r);if(!i){const s=G_(Yp(n,{useFileSystem:!0,logger:"default",graphviz:"wasm"}));await s.cli.Workspace.initWorkspace({uri:V_(r).toString(),name:H_(r)}),await s.cli.Workspace.init(),i=new Gi(r,s,n?.printErrors??!0),Gi.likec4Instances.
set(r,i)}return n?.throwIfInvalid===!0&&i.hasErrors()?(i.dispose(),Promise.reject(j_(i))):i}modelLayoutedRef;logger;get viewsService(){return this.langium.likec4.Views}get LangiumDocuments(){return this.langium.shared.workspace.LangiumDocuments}async diagrams(){return await this.langium.likec4.Views.diagrams()}computedModel(){return this.langium.likec4.ModelBuilder.unsafeSyncBuildModel()}async layoutedModel(){let e=this.modelLayoutedRef?.deref();if(!e){const n=await this.langium.likec4.ModelBuilder.
parseModel();if(!n)throw new Error("Failed to parse model");const r=await this.viewsService.diagrams();e=DC.create({...n.model,__:"layouted",views:ty(r,Zg("id"))}),this.modelLayoutedRef=new WeakRef(e)}return e}getErrors(){return this.LangiumDocuments.all.toArray().flatMap(e=>(e.diagnostics??[]).filter(n=>n.severity===gc.Error).map(({message:n,range:r})=>({message:n,line:r.start.line,range:r,sourceFsPath:e.uri.fsPath})))}hasErrors(){return this.LangiumDocuments.all.some(e=>e.diagnostics?.some(n=>n.
severity===gc.Error)??!1)}printErrors(){let e=!1;for(const n of this.LangiumDocuments.all){const r=n.diagnostics?.filter(i=>i.severity===1);if(r&&r.length>0){e=!0;const i=r.flatMap(s=>{const a=s.range.start.line,o=s.message.split(`
`);return o.length>10&&(o.length=10,o.push("...")),o.map((c,u)=>u===0?"    "+Tt.dim(`Line ${a}: `)+Tt.red(c):" ".repeat(10)+Tt.red(c))}).join(`
`);this.logger.error(`Invalid ${n.uri.fsPath}
${i}`)}}return e}async notifyUpdate({changed:e,removed:n}){this.modelLayoutedRef=void 0;const r=this.langium.shared.workspace.WorkspaceLock;try{let i=!1;return await r.write(async s=>{await this.langium.shared.workspace.DocumentBuilder.update(e?[Xt.file(e)]:[],n?[Xt.file(n)]:[],s),i=!s.isCancellationRequested}),i}catch(i){return this.logger.error(Ji(i)),!1}}onModelUpdate(e){const n=this.langium.likec4.ModelBuilder.onModelParsed(()=>e());return()=>{n.dispose()}}dispose(){for(const[e,n]of Gi.likec4Instances)
n===this&&Gi.likec4Instances.delete(e)}}export{M_ as A,Jv as B,Ze as C,Ji as D,_8 as E,u_ as F,ms as G,sD as H,Gi as L,Rb as N,nb as Q,ra as T,aa as a,ht as b,F_ as c,Ra as d,je as e,YT as f,Dr as g,ce as h,bt as i,zv as j,iV as k,Sr as l,un as m,yt as n,C8 as o,Nv as p,ka as q,ZT as r,q_ as s,KT as t,Tt as u,zC as v,rV as w,y8 as x,Pt as y,rd as z};
